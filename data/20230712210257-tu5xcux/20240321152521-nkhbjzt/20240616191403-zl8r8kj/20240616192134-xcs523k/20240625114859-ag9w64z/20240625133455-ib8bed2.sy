{
	"ID": "20240625133455-ib8bed2",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20240625133455-ib8bed2",
		"title": "US3S1L2-2——兰伯特光照模型的逐片元光照",
		"type": "doc",
		"updated": "20240625170838"
	},
	"Children": [
		{
			"ID": "20240625133455-6crj6sd",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20240625133455-6crj6sd",
				"updated": "20240625170757"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20240625133527-y5frirz",
					"Type": "NodeHeading",
					"HeadingLevel": 2,
					"Properties": {
						"id": "20240625133527-y5frirz",
						"updated": "20240625170757"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "知识回顾"
						}
					]
				},
				{
					"ID": "20240625133527-txtw49a",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20240625133527-txtw49a",
						"updated": "20240625133528"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "兰伯特光照模型公式："
						}
					]
				},
				{
					"ID": "20240625133527-s63ed36",
					"Type": "NodeMathBlock",
					"Properties": {
						"id": "20240625133527-s63ed36",
						"updated": "20240625170757"
					},
					"Children": [
						{
							"Type": "NodeMathBlockOpenMarker"
						},
						{
							"Type": "NodeMathBlockContent",
							"Data": "Color_{漫反射光}=Color_{光源} \\times Color_{材质的漫反射} \\times \\max(0,\\overrightarrow{标准化后物体表面法线向量} \\cdot \\overrightarrow{标准化后光源方向向量})"
						},
						{
							"Type": "NodeMathBlockCloseMarker"
						}
					]
				},
				{
					"ID": "20240625133527-9y9zf48",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20240625133527-9y9zf48",
						"updated": "20240625170732"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "其中，"
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "inline-math",
							"TextMarkInlineMathContent": "\\overrightarrow{标准化后物体表面法线向量} \\cdot \\overrightarrow{标准化后光源方向向量}"
						},
						{
							"Type": "NodeText",
							"Data": " 等于物体表面法线与光源方向向量的夹角的 "
						},
						{
							"Type": "NodeTextMark",
							"TextMarkType": "inline-math",
							"TextMarkInlineMathContent": "\\cos"
						},
						{
							"Type": "NodeText",
							"Data": " 值"
						}
					]
				},
				{
					"ID": "20240625133527-mhbbvfa",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20240625133527-mhbbvfa",
						"updated": "20240625133528"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "会使用的信息："
						}
					]
				},
				{
					"ID": "20240625133527-x0wx9aa",
					"Type": "NodeList",
					"ListData": {
						"Typ": 1
					},
					"Properties": {
						"id": "20240625133527-x0wx9aa",
						"updated": "20240625133527"
					},
					"Children": [
						{
							"ID": "20240625133527-xsgl19v",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "MS4=",
								"Num": 1
							},
							"Properties": {
								"id": "20240625133527-xsgl19v",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-fpak98j",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-fpak98j",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "光源的颜色"
										}
									]
								},
								{
									"ID": "20240625133527-zrtscw8",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-zrtscw8",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "​"
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "Lighting.cginc"
										},
										{
											"Type": "NodeText",
											"Data": "​ 内置文件中的 "
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "_LightColor0"
										},
										{
											"Type": "NodeText",
											"Data": "​"
										}
									]
								}
							]
						},
						{
							"ID": "20240625133527-wavzsoi",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "Mi4=",
								"Num": 2
							},
							"Properties": {
								"id": "20240625133527-wavzsoi",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-g1viogo",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-g1viogo",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "光源的方向"
										}
									]
								},
								{
									"ID": "20240625133527-g9473v5",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-g9473v5",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "​"
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "_WorldSpaceLightPos0"
										},
										{
											"Type": "NodeText",
											"Data": "​ 表示光源0在世界坐标系下的位置"
										}
									]
								}
							]
						},
						{
							"ID": "20240625133527-3co8hgb",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "My4=",
								"Num": 3
							},
							"Properties": {
								"id": "20240625133527-3co8hgb",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-lg178u7",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-lg178u7",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "向量归一化（标准化）方法 "
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "normalize()"
										},
										{
											"Type": "NodeText",
											"Data": "​"
										}
									]
								}
							]
						},
						{
							"ID": "20240625133527-iec7qlw",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "NC4=",
								"Num": 4
							},
							"Properties": {
								"id": "20240625133527-iec7qlw",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-ja09g5d",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-ja09g5d",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "取最大值方法 "
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "max()"
										},
										{
											"Type": "NodeText",
											"Data": "​"
										}
									]
								}
							]
						},
						{
							"ID": "20240625133527-qgilxgm",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "NS4=",
								"Num": 5
							},
							"Properties": {
								"id": "20240625133527-qgilxgm",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-06598ua",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-06598ua",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "点乘方法 "
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "dot"
										},
										{
											"Type": "NodeText",
											"Data": "​"
										}
									]
								}
							]
						},
						{
							"ID": "20240625133527-3gupgx5",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "Ni4=",
								"Num": 6
							},
							"Properties": {
								"id": "20240625133527-3gupgx5",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-fl2dapa",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-fl2dapa",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "兰伯特光照模型环境光变量（用于模拟环境光对物体的影响，避免物体阴影部分完全黑暗）"
										}
									]
								},
								{
									"ID": "20240625133527-jqwfguz",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-jqwfguz",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "​"
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "UNITY_LIGHTMODEL_AMBIENT.rgb"
										},
										{
											"Type": "NodeText",
											"Data": "​"
										}
									]
								}
							]
						},
						{
							"ID": "20240625133527-1xfw3wt",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "Ny4=",
								"Num": 7
							},
							"Properties": {
								"id": "20240625133527-1xfw3wt",
								"updated": "20240625133527"
							},
							"Children": [
								{
									"ID": "20240625133527-uo8l9j7",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20240625133527-uo8l9j7",
										"updated": "20240625133527"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "将法线从模型空间转换到世界空间 "
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "code",
											"TextMarkTextContent": "UnityObjectToWorldNormal"
										},
										{
											"Type": "NodeText",
											"Data": "​"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20240625133613-gux670l",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20240625133613-gux670l",
				"updated": "20240625135601"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "利用兰伯特光照模型实现光照效果（逐片元光照）"
				}
			]
		},
		{
			"ID": "20240625133529-vb3qmox",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625133529-vb3qmox",
				"updated": "20240625133632"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "关键步骤：基本和"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "block-ref",
					"TextMarkBlockRefID": "20240625122416-j2gq3qr",
					"TextMarkBlockRefSubtype": "s",
					"TextMarkTextContent": "逐顶点"
				},
				{
					"Type": "NodeText",
					"Data": "一致"
				}
			]
		},
		{
			"ID": "20240625133626-4eixmci",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625133626-4eixmci",
				"updated": "20240625133626"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "区别："
				}
			]
		},
		{
			"ID": "20240625133625-b9ah04c",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20240625133625-b9ah04c",
				"updated": "20240625134332"
			},
			"Children": [
				{
					"ID": "20240625133625-4t14h4x",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20240625133625-4t14h4x",
						"updated": "20240625134332"
					},
					"Children": [
						{
							"ID": "20240625133625-tnmiqvx",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240625133625-tnmiqvx",
								"updated": "20240625134332"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在顶点着色器中计算顶点（转换到裁剪空间）和法线（转换到世界空间）"
								}
							]
						}
					]
				},
				{
					"ID": "20240625133625-k9xpwyo",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20240625133625-k9xpwyo",
						"updated": "20240625133625"
					},
					"Children": [
						{
							"ID": "20240625133625-dz37tbw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240625133625-dz37tbw",
								"updated": "20240625133625"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在片元着色器中计算兰伯特光照"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20240625133633-8iacwsc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625133633-8iacwsc",
				"updated": "20240625135254"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "Shader实现如下："
				}
			]
		},
		{
			"ID": "20240625135255-s1dp5b0",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20240625135255-s1dp5b0",
				"style": "line-height: 22px;",
				"updated": "20240625135258"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Yw=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "Shader \"TeachShader/Lesson30\"\n{\n    Properties\n    {\n        _MainColor(\"MainColor\", Color) = (1, 1, 1, 1)\n    }\n    SubShader\n    {\n        Tags { \"LightMode\" = \"ForwardBase\" }\n\n        Pass\n        {\n            CGPROGRAM\n            #pragma vertex vert\n            #pragma fragment frag\n\n            #include \"UnityCG.cginc\"\n            #include \"Lighting.cginc\"\n\n            fixed4 _MainColor;      //材质漫反射的颜色\n\n            struct v2f\n            {\n                float4 pos : SV_POSITION;\n                float3 normal : NORMAL;\n            };\n\n            //顶点着色器函数，主要就是要处理顶点、法线、切线等数据的坐标转换\n            v2f vert (appdata_base v)\n            {\n                v2f v2fData;\n                v2fData.pos = UnityObjectToClipPos(v.vertex);           //将模型空间下的顶点转换到裁剪空间下\n                v2fData.normal = UnityObjectToWorldNormal(v.normal);    //将模型空间下的法线转换到世界空间下\n                return v2fData;\n            }\n\n            fixed4 frag (v2f i) : SV_Target\n            {\n                float3 lightDir = normalize(_WorldSpaceLightPos0.xyz);  //将光源0的位置标准化，得到方向，用于计算夹角\n                //兰伯特光照模型的实现，这里的颜色计算只取rgb，不考虑透明度的情况\n                fixed3 color = _LightColor0.rgb * _MainColor.rgb * max(0, dot(i.normal, lightDir));\n                color = UNITY_LIGHTMODEL_AMBIENT.rgb + color;           //为了让阴影不全黑，需要加上兰伯特环境光颜色公共变量\n                return fixed4(color.rgb, 1);                            //因为传递过来的颜色变量不包括透明度，因此这里需要手动指定透明度\n            }\n            ENDCG\n        }\n    }\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20240625135333-2qokq20",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625135333-2qokq20",
				"updated": "20240625135451"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "使用逐顶点光照和逐片元光照的Shader的材质显示效果如下（左边为逐顶点光照，右边为逐片元光照）："
				}
			]
		},
		{
			"ID": "20240625135327-ifmc85y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625135327-ifmc85y",
				"updated": "20240625135327"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"parent-style": "width: 484px;",
						"style": "width: 474px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20240625135327-67ocg4x.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 474px;\" parent-style=\"width: 484px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20240625135453-pdyd7qv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625135453-pdyd7qv",
				"updated": "20240625135600"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "显然，使用逐片元光照的Shader的材质在阴影处的过渡效果，比逐顶点光照的效果更柔和一些"
				}
			]
		},
		{
			"ID": "20240625135601-si6x4mo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240625135601-si6x4mo"
			}
		}
	]
}