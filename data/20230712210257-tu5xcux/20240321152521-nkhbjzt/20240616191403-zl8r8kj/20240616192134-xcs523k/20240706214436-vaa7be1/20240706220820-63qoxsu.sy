{"ID":"20240706220820-63qoxsu","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240706220820-63qoxsu","title":"US3S1L6-1——Blinn-Phong式高光反射光照模型的逐顶点光照","type":"doc","updated":"20240707131628"},"Children":[{"ID":"20240706220821-525avnl","Type":"NodeBlockquote","Properties":{"id":"20240706220821-525avnl","updated":"20240706220924"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240706220914-mcbz89l","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240706220914-mcbz89l","updated":"20240706220924"},"Children":[{"Type":"NodeText","Data":"知识回顾"}]},{"ID":"20240706220924-peajyjq","Type":"NodeParagraph","Properties":{"id":"20240706220924-peajyjq","updated":"20240706220924"},"Children":[{"Type":"NodeText","Data":"公式："}]},{"ID":"20240706220924-arzq5um","Type":"NodeMathBlock","Properties":{"id":"20240706220924-arzq5um","updated":"20240706220924"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"高光反射光照颜色 = 光源的颜色 \\times 材质高光反射颜色 \\times \\max(0,\\ \\overrightarrow{标准化后顶点法线方向} \\cdot \\overrightarrow{标准化后半角向量方向})^{光泽度}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240706220924-ffvcos2","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240706220924-ffvcos2","updated":"20240706220924"},"Children":[{"ID":"20240706220924-g9cmr8r","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240706220924-g9cmr8r","updated":"20240706220924"},"Children":[{"ID":"20240706220924-7p1xcoy","Type":"NodeParagraph","Properties":{"id":"20240706220924-7p1xcoy","updated":"20240706220924"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\overrightarrow{标准化后顶点法线方向} \\cdot \\overrightarrow{标准化后半角向量方向}"},{"Type":"NodeText","Data":" 得到的结果就是 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\cos\\theta"}]}]},{"ID":"20240706220924-zdejiv7","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240706220924-zdejiv7","updated":"20240706220924"},"Children":[{"ID":"20240706220924-dc0mpw5","Type":"NodeParagraph","Properties":{"id":"20240706220924-dc0mpw5","updated":"20240706220924"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\overrightarrow{半角向量方向} = \\overrightarrow{视角单位向量} + \\overrightarrow{入射光单位向量}"}]}]},{"ID":"20240706220924-flrhsxc","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240706220924-flrhsxc","updated":"20240706220924"},"Children":[{"ID":"20240706220924-1k0wv1a","Type":"NodeParagraph","Properties":{"id":"20240706220924-1k0wv1a","updated":"20240706220924"},"Children":[{"Type":"NodeText","Data":"光泽度是幂运算，假设光泽度为 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n"},{"Type":"NodeText","Data":" ，相当于："},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(max(0,\\cos\\theta))^n"}]}]}]}]},{"ID":"20240706221005-9os31sy","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240706221005-9os31sy","updated":"20240707131628"},"Children":[{"Type":"NodeText","Data":"利用Blinn-Phong式高光反射模型实现光照效果（逐顶点光照）"}]},{"ID":"20240706221005-j4h8icl","Type":"NodeParagraph","Properties":{"id":"20240706221005-j4h8icl","updated":"20240707131628"},"Children":[{"Type":"NodeText","Data":"关键步骤"}]},{"ID":"20240706221005-h5ytgg5","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240706221005-h5ytgg5","updated":"20240707131628"},"Children":[{"ID":"20240706221005-1l2o2za","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240706221005-1l2o2za","updated":"20240706221005"},"Children":[{"ID":"20240706221005-v01dw1k","Type":"NodeParagraph","Properties":{"id":"20240706221005-v01dw1k","updated":"20240706221005"},"Children":[{"Type":"NodeText","Data":"属性声明（材质高光反射颜色、光泽度）"}]},{"ID":"20240706221217-jm64wu2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240706221217-jm64wu2","style":"line-height: 22px;","updated":"20240706222646"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"Properties\n{\n    _SpecularColor(\"SpecularColor\", Color) = (1, 1, 1, 1)   //材质高光反射颜色\n    _SpecularNum(\"SpecularNum\", Range(0, 20)) = 5           //光泽度\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240706221005-n1490q6","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240706221005-n1490q6","updated":"20240706221005"},"Children":[{"ID":"20240706221005-a98kj4p","Type":"NodeParagraph","Properties":{"id":"20240706221005-a98kj4p","updated":"20240706221005"},"Children":[{"Type":"NodeText","Data":"渲染标签 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240615190945-timyw8m","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"Tags"},{"Type":"NodeText","Data":"​ 设置将 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240615191133-56z8a1m","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"LightMode"},{"Type":"NodeText","Data":"​ 光照模式设置为 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240615191302-uvos7ed","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"ForwardBase"},{"Type":"NodeText","Data":"​ 前向渲染（通常用于不透明物体的基本渲染）"}]},{"ID":"20240706221220-bjztc1z","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240706221220-bjztc1z","style":"line-height: 22px;","updated":"20240706222652"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"Tags { \"LightMode\" = \"ForwardBase\" }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240706221005-a34unfd","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240706221005-a34unfd","updated":"20240706221005"},"Children":[{"ID":"20240706221005-spwwt13","Type":"NodeParagraph","Properties":{"id":"20240706221005-spwwt13","updated":"20240706221228"},"Children":[{"Type":"NodeText","Data":"引用内置文件 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240616181725-7p5bld3","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"UnityCG.cginc"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code block-ref","TextMarkBlockRefID":"20240616181725-lhyuacy","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"Lighting.cginc"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240706221223-e2zmstd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240706221223-e2zmstd","style":"line-height: 22px;","updated":"20240706222659"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"#include \"UnityCG.cginc\"\n#include \"Lighting.cginc\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240706221005-v9euh8c","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240706221005-v9euh8c","updated":"20240706221005"},"Children":[{"ID":"20240706221005-haqvfjp","Type":"NodeParagraph","Properties":{"id":"20240706221005-haqvfjp","updated":"20240706221005"},"Children":[{"Type":"NodeText","Data":"结构体声明"}]},{"ID":"20240706221230-414noa3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240706221230-414noa3","style":"line-height: 22px;","updated":"20240706222708"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"struct v2f\n{\n    float4 svPos : SV_POSITION;\n    fixed3 color : COLOR;\n};\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240706221005-7tekzhg","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NS4=","Num":5},"Properties":{"id":"20240706221005-7tekzhg","updated":"20240706221005"},"Children":[{"ID":"20240706221005-ky146hy","Type":"NodeParagraph","Properties":{"id":"20240706221005-ky146hy","updated":"20240706221005"},"Children":[{"Type":"NodeText","Data":"基本公式实现逻辑"}]},{"ID":"20240706221232-33seayg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240706221232-33seayg","style":"line-height: 22px;","updated":"20240706223129"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"fixed4 _SpecularColor;  //材质高光反射颜色\nfloat _SpecularNum;     //光泽度\n\nv2f vert (appdata_base v)\n{\n    v2f v2fData;\n    v2fData.svPos = UnityObjectToClipPos(v.vertex);                 //首先将模型空间下的顶点转换到裁剪空间下\n\n    float3 wNormal = UnityObjectToWorldNormal(v.normal);            //得到世界空间下的法线向量\n    float3 wPos = mul(unity_ObjectToWorld, v.vertex);               //使用unity_ObjectToWorld矩阵，将模型空间下的顶点转换到世界空间下\n    float3 viewDir = normalize(_WorldSpaceCameraPos.xyz - wPos);    //将摄像机坐标和顶点坐标通过相减，得到观察方向向量，并标准化\n    float3 lightDir = normalize(_WorldSpaceLightPos0.xyz);          //得到世界空间下的指向光源方向的标准化向量\n    float3 halfA = normalize(viewDir + lightDir);                   //将光源方向和观察方向相加得到其半角向量，并标准化\n    //Blinn-Phong高光反射模型的实现，这里的颜色计算只取rgb，不考虑透明度的情况\n    v2fData.color = _LightColor0.rgb * _SpecularColor.rgb * pow(max(0, dot(wNormal, halfA)), _SpecularNum);\n    return v2fData;\n}\n\nfixed4 frag (v2f i) : SV_Target\n{\n    return fixed4(i.color.rgb, 1);      //因为传递过来的颜色变量不包括透明度，因此这里需要手动指定透明度\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20240706223130-qjsm1bt","Type":"NodeParagraph","Properties":{"id":"20240706223130-qjsm1bt","updated":"20240707131628"},"Children":[{"Type":"NodeText","Data":"显示效果（光泽度统一为5，左边为Blinn-Phong式高光反射模型的效果，右边为Phong式高光反射模型的效果）："}]},{"ID":"20240706223150-rv3vcge","Type":"NodeParagraph","Properties":{"id":"20240706223150-rv3vcge","updated":"20240707131628"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240706223150-j9w5yxb.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240706223300-9o6yvx4","Type":"NodeParagraph","Properties":{"id":"20240706223300-9o6yvx4","updated":"20240707131628"},"Children":[{"Type":"NodeText","Data":"可见，Blinn-Phong式高光反射模型比Phong式高光反射模型的高光效果更加均匀，面积也更大"}]}]}