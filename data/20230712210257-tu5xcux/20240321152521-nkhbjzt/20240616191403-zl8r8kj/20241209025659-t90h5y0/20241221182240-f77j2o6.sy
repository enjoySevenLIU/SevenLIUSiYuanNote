{
	"ID": "20241221182240-f77j2o6",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20241221182240-f77j2o6",
		"title": "US3S8L6——菲涅尔反射",
		"type": "doc",
		"updated": "20241221193248"
	},
	"Children": [
		{
			"ID": "20241221182241-sxqq9zr",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20241221182241-sxqq9zr",
				"updated": "20241221183918"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "菲涅耳反射效果"
				}
			]
		},
		{
			"ID": "20241221182341-sx1gzlv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182341-sx1gzlv",
				"updated": "20241221182348"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "菲涅耳反射是一种光学现象。简单的讲，就是视线垂直于观察表面时，反射较弱（更多的光会透射到进入新介质）\n而当视线非垂直观察表面时，夹角越小，反射越明显。"
				}
			]
		},
		{
			"ID": "20241221182353-w7nlpkn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182353-w7nlpkn",
				"updated": "20241221182359"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "真实世界中的例子：\n如果你站在湖边，低头看脚下的水，你会发现水是透明的，反射不是特别强烈；\n如果你看远处的湖面，你会发现水并不是透明的，但反射非常强烈，这就是“菲涅耳效应”。"
				}
			]
		},
		{
			"ID": "20241221182420-xysatly",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182420-xysatly",
				"updated": "20241221182620"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 336px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241221182420-2xs60av.png"
						},
						{
							"Type": "NodeLinkSpace"
						},
						{
							"Type": "NodeLinkTitle",
							"Data": "垂直向下看水池时，可以看到水底，反射不强烈"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 336px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 414px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241221182435-6onr7os.png"
						},
						{
							"Type": "NodeLinkSpace"
						},
						{
							"Type": "NodeLinkTitle",
							"Data": "从较偏的位置向下看水池时，看不到水底，反射很强烈"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 414px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20241221182534-qkcvygy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182534-qkcvygy",
				"updated": "20241221182648"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "u",
					"TextMarkTextContent": "菲涅耳反射原理是描述光在两种介质的界面上反射和折射的行为。反射和折射的强度取决于光的入射角和两种介质的折射率差异。"
				}
			]
		},
		{
			"ID": "20241221182638-xmra9mt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182638-xmra9mt",
				"updated": "20241221182641"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "从物理角度来看，世界上所有物体在光线照射下都会遵循菲涅耳反射原理！"
				}
			]
		},
		{
			"ID": "20241221182637-5vsi6yb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182637-5vsi6yb",
				"updated": "20241221182658"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "这意味着光在任何两种介质的界面上都会发生反射和折射，只不过具体反射效果会因为介质的性质和光的入射角度不同而有所变化。\n"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "无论是透明的、半透明的还是不透明的物体，只要有光线入射到其表面，菲涅耳反射都会发生。"
				}
			]
		},
		{
			"ID": "20241221182658-7ylysqu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182658-7ylysqu",
				"updated": "20241221182811"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在 Unity Shader 中，"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "菲涅耳反射一般用来增强真实感，使物体表面在不同角度和光照条件下呈现出更加真实和自然的外观，增强视觉效果。"
				},
				{
					"Type": "NodeText",
					"Data": "\n因为刚才我们提到真实世界中，万物皆遵循菲涅耳反射原理，\n那么我们在游戏中使用 菲涅耳反射 比 直接使用反射 能更加接近真实世界的效果，再实现一些金属感、陶瓷感、玻璃感时效果更好！"
				}
			]
		},
		{
			"ID": "20241221182738-g3om9s9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182738-g3om9s9",
				"updated": "20241221182807"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "也就是说菲涅耳反射在 Unity Shader 当中实现出来的效果基于反射，但是会比反射更加接近真实的效果"
				}
			]
		},
		{
			"ID": "20241221182742-jt4cx6s",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20241221182742-jt4cx6s",
				"updated": "20241221183918"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "菲涅耳反射效果的原理"
				}
			]
		},
		{
			"ID": "20241221182829-yk954p1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182829-yk954p1",
				"updated": "20241221182841"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "菲涅耳反射的原理还是利用立方体纹理（CubeMap）进行环境映射，我们在计算反射光向量时，还是利用之前反射的一套规则去进行计算。\n"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "只是最终我们决定采样颜色时，需要为使用的反射率变量添加新的计算规则"
				}
			]
		},
		{
			"ID": "20241221182910-vf1rro5",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20241221182910-vf1rro5",
				"style": "line-height: 22px;",
				"updated": "20241221182929"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Yw=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "Properties\n{\n    _Cube(\"Cubemap\", Cube) = \"\"{}                   // 立方体纹理\n    _Reflectivity(\"Reflectivity\", Range(0, 1)) = 1  // 反射率，我们需要对反射率添加新的计算规则\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20241221182939-ylsnjgg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182939-ylsnjgg",
				"updated": "20241221182950"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 325px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241219001735-duv1wbr.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 325px;\"}"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 244px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241209030051-43c2sv3.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 244px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20241221182955-6wd56ck",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221182955-6wd56ck",
				"updated": "20241221183103"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "我们将使用菲涅耳等式来计算反射率，但是"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://baike.baidu.com/item/%E8%8F%B2%E6%B6%85%E8%80%B3%E5%85%AC%E5%BC%8F",
					"TextMarkTextContent": "物理学中的菲涅耳等式"
				},
				{
					"Type": "NodeText",
					"Data": "是非常复杂的，如果在实时渲染中使用，计算非常复杂。"
				}
			]
		},
		{
			"ID": "20241221183112-q4xlc0k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221183112-q4xlc0k",
				"updated": "20241221183202"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "因此我们通常会使用近似公式来计算，在 Unity Shader 当中我们会使用 Schlick 菲涅耳近似公式来计算反射率\n该公式是由 Christophe Schlick（克里斯托夫·施利克）于1994年提出的，\n它提出的菲涅耳近似等式极大的简化了菲涅耳反射率的计算，非常适用于实时渲染，同时它还保留了足够的物理真实性！"
				}
			]
		},
		{
			"ID": "20241221183051-hlxsrw0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221183051-hlxsrw0",
				"updated": "20241221183210"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "具体公式如下："
				}
			]
		},
		{
			"ID": "20241221183210-28drhl1",
			"Type": "NodeMathBlock",
			"Properties": {
				"id": "20241221183210-28drhl1",
				"updated": "20241221183725"
			},
			"Children": [
				{
					"Type": "NodeMathBlockOpenMarker"
				},
				{
					"Type": "NodeMathBlockContent",
					"Data": "\\begin{align*}\nR(\\theta) \u0026 = R_0 + (1 - R_0)(1-cos(\\theta))^5 \\\\\n\\Rightarrow R(\\theta) \u0026 = R_0 + (1 - R_0)(1-V \\cdot N)^5\n\\end{align*}"
				},
				{
					"Type": "NodeMathBlockCloseMarker"
				}
			]
		},
		{
			"ID": "20241221183402-9o39qvp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221183402-9o39qvp",
				"updated": "20241221183407"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "其中："
				}
			]
		},
		{
			"ID": "20241221183646-qooeb5j",
			"Type": "NodeSuperBlock",
			"Properties": {
				"id": "20241221183646-qooeb5j",
				"updated": "20241221183647"
			},
			"Children": [
				{
					"Type": "NodeSuperBlockOpenMarker"
				},
				{
					"Type": "NodeSuperBlockLayoutMarker",
					"Data": "col"
				},
				{
					"ID": "20241221183448-zpv9gkm",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20241221183448-zpv9gkm",
						"updated": "20241221183647"
					},
					"Children": [
						{
							"ID": "20241221183456-4yayxr5",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20241221183456-4yayxr5",
								"updated": "20241221183456"
							},
							"Children": [
								{
									"ID": "20241221183456-8jrfv43",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20241221183456-8jrfv43",
										"updated": "20241221183522"
									},
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "inline-math",
											"TextMarkInlineMathContent": "R(\\theta)"
										},
										{
											"Type": "NodeText",
											"Data": " 表示入射角为 "
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "inline-math",
											"TextMarkInlineMathContent": "\\theta"
										},
										{
											"Type": "NodeText",
											"Data": " 时的反射率"
										}
									]
								}
							]
						},
						{
							"ID": "20241221183522-e49pki8",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20241221183522-e49pki8",
								"updated": "20241221183522"
							},
							"Children": [
								{
									"ID": "20241221183522-tocdhea",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20241221183522-tocdhea",
										"updated": "20241221183540"
									},
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "inline-math",
											"TextMarkInlineMathContent": "R_0"
										},
										{
											"Type": "NodeText",
											"Data": " 是垂直入射某介质时的反射率"
										}
									]
								}
							]
						},
						{
							"ID": "20241221183540-rm2w59k",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20241221183540-rm2w59k",
								"updated": "20241221183637"
							},
							"Children": [
								{
									"ID": "20241221183540-b0zhz0i",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20241221183540-b0zhz0i",
										"updated": "20241221183637"
									},
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "inline-math",
											"TextMarkInlineMathContent": "V"
										},
										{
											"Type": "NodeText",
											"Data": " 是视角方向单位向量（入射角）"
										}
									]
								}
							]
						},
						{
							"ID": "20241221183604-o0g80fs",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20241221183604-o0g80fs",
								"updated": "20241221183632"
							},
							"Children": [
								{
									"ID": "20241221183604-vawr1dq",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20241221183604-vawr1dq",
										"updated": "20241221183632"
									},
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "inline-math",
											"TextMarkInlineMathContent": "N"
										},
										{
											"Type": "NodeText",
											"Data": " 是顶点法线单位向量"
										}
									]
								}
							]
						}
					]
				},
				{
					"ID": "20241221183641-swjywv1",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20241221183641-swjywv1",
						"updated": "20241221183647"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "​"
						},
						{
							"Type": "NodeImage",
							"Data": "span",
							"Properties": {
								"style": "width: 259px;"
							},
							"Children": [
								{
									"Type": "NodeBang"
								},
								{
									"Type": "NodeOpenBracket"
								},
								{
									"Type": "NodeLinkText",
									"Data": "image"
								},
								{
									"Type": "NodeCloseBracket"
								},
								{
									"Type": "NodeOpenParen"
								},
								{
									"Type": "NodeLinkDest",
									"Data": "assets/image-20241219001537-bj819j5.png"
								},
								{
									"Type": "NodeCloseParen"
								}
							]
						},
						{
							"Type": "NodeKramdownSpanIAL",
							"Data": "{: style=\"width: 259px;\"}"
						},
						{
							"Type": "NodeText",
							"Data": "​"
						}
					]
				},
				{
					"Type": "NodeSuperBlockCloseMarker"
				}
			]
		},
		{
			"ID": "20241221183657-1iw4w24",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221183657-1iw4w24",
				"updated": "20241221183918"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该公式中视角方向 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "inline-math",
					"TextMarkInlineMathContent": "V"
				},
				{
					"Type": "NodeText",
					"Data": " 和顶点法线 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "inline-math",
					"TextMarkInlineMathContent": "N"
				},
				{
					"Type": "NodeText",
					"Data": " 都是已知的，我们只需要查阅对应物体在真实世界中的反射率 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "inline-math",
					"TextMarkInlineMathContent": "R_0"
				},
				{
					"Type": "NodeText",
					"Data": "，\n将该反射率带入公式进行计算，就可以得到菲涅耳反射率，让其参与最终的颜色计算即可！"
				}
			]
		},
		{
			"ID": "20241221183827-oi02dca",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20241221183827-oi02dca",
				"style": "background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color); --b3-parent-background: var(--b3-card-warning-background);",
				"updated": "20241221183844"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20241221183838-fx7mhaz",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20241221183838-fx7mhaz",
						"updated": "20241221183844"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "注意！通常情况下，我们所说的物体的反射率（或反射系数）通常是指垂直入射光线时的反射率"
						}
					]
				}
			]
		},
		{
			"ID": "20241221183842-u2p1o0f",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20241221183842-u2p1o0f",
				"updated": "20241221191251"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "菲涅尔反射的基础实现"
				}
			]
		},
		{
			"ID": "20241221184113-g9249ri",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20241221184113-g9249ri",
				"updated": "20241221191243"
			},
			"Children": [
				{
					"ID": "20241221184152-5myhc32",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20241221184152-5myhc32",
						"updated": "20241221184152"
					},
					"Children": [
						{
							"ID": "20241221184152-46eozy0",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184152-46eozy0",
								"updated": "20241221184152"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "新建Shader，复用基础反射Shader中代码，在其基础上进行修改"
								}
							]
						},
						{
							"ID": "20241221184155-4v1me1n",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184155-4v1me1n",
								"updated": "20241221184213"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "具体内容详见："
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "block-ref",
									"TextMarkBlockRefID": "20241219001301-uqtlfhe",
									"TextMarkBlockRefSubtype": "d",
									"TextMarkTextContent": "US3S8L4——反射效果"
								},
								{
									"Type": "NodeText",
									"Data": " 的基础反射实现部分"
								}
							]
						}
					]
				},
				{
					"ID": "20241221184152-251c442",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20241221184152-251c442",
						"updated": "20241221191243"
					},
					"Children": [
						{
							"ID": "20241221184152-zkp6yn4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184152-zkp6yn4",
								"updated": "20241221184218"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "属性声明将反射率变量修改为 "
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "code",
									"TextMarkTextContent": "_FresnelScale"
								},
								{
									"Type": "NodeText",
									"Data": "​ 菲涅耳中介质的反射率"
								}
							]
						},
						{
							"ID": "20241221184748-rz2az2e",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221184748-rz2az2e",
								"style": "line-height: 22px;",
								"updated": "20241221191243"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "Properties\n{\n    _Cube(\"Cubemap\", Cube) = \"\"{}                       // 立方体纹理\n    _FresnelScale(\"_FresnelScale\", Range(0, 1)) = 1     // 菲涅尔反射中，对应介质的反射率\n}\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				},
				{
					"ID": "20241221184152-2ain0xb",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20241221184152-2ain0xb",
						"updated": "20241221184152"
					},
					"Children": [
						{
							"ID": "20241221184152-e3q3bgc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184152-e3q3bgc",
								"updated": "20241221184152"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "结构体\n"
								}
							]
						},
						{
							"ID": "20241221184221-i5e2xwr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184221-i5e2xwr",
								"updated": "20241221190800"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "由于使用 ​Schlick 菲涅耳近似等式，需要用到世界空间下视角方向、和法线向量，因此在结构体中加入这两个变量"
								}
							]
						},
						{
							"ID": "20241221184803-ummrlwk",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221184803-ummrlwk",
								"style": "line-height: 22px;",
								"updated": "20241221190744"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "struct v2f\n{\n    float4 pos: SV_POSITION;            // 裁剪空间下的顶点坐标\n    float3 worldNormal: NORMAL;         // 世界空间下的法线\n    float3 worldViewDir: TEXCOORD0;     // 世界空间下的视角方向\n    float3 worldReflection: TEXCOORD1;  // 世界空间下的反射向量\n};\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				},
				{
					"ID": "20241221184152-53fqjan",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20241221184152-53fqjan",
						"updated": "20241221184152"
					},
					"Children": [
						{
							"ID": "20241221184152-t5r7wzm",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184152-t5r7wzm",
								"updated": "20241221184152"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "顶点着色器\n"
								}
							]
						},
						{
							"ID": "20241221184236-71p5xsz",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184236-71p5xsz",
								"updated": "20241221184243"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "关键步骤：添加结构体中变量赋值"
								}
							]
						},
						{
							"ID": "20241221190746-72lsmoc",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221190746-72lsmoc",
								"style": "line-height: 22px;",
								"updated": "20241221190754"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "v2f vert(appdata_base v)\n{\n    v2f data;\n    data.pos = UnityObjectToClipPos(v.vertex);                              // 顶点坐标转裁剪坐标\n    data.worldNormal = UnityObjectToWorldNormal(v.normal);                  // 顶点法线转世界坐标\n    fixed3 worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;               // 顶点坐标装世界坐标\n    data.worldViewDir = UnityWorldSpaceViewDir(worldPos);                   // 计算世界空间下视角所在方向\n    data.worldReflection = reflect(-data.worldViewDir, data.worldNormal);   // 通过反向视角方向得到反射方向\n\n    return data;\n}\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				},
				{
					"ID": "20241221184152-tkjstzq",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20241221184152-tkjstzq",
						"updated": "20241221184152"
					},
					"Children": [
						{
							"ID": "20241221184152-3anvd62",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184152-3anvd62",
								"updated": "20241221184152"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "片元着色器\n"
								}
							]
						},
						{
							"ID": "20241221184237-rzbxsji",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221184237-rzbxsji",
								"updated": "20241221190806"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "关键步骤：利用 Schlick 菲涅耳近似等式计算出菲涅耳反射率，参与最终颜色计算"
								}
							]
						},
						{
							"ID": "20241221190757-tdk2gch",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221190757-tdk2gch",
								"style": "line-height: 22px;",
								"updated": "20241221190814"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "fixed4 frag(v2f i): SV_TARGET\n{\n    // 从立方体纹理内采样得到反射颜色\n    fixed4 cubemapColor = texCUBE(_Cube, i.worldReflection);\n    // 根据schlick菲涅尔近似公式，计算菲涅尔反射率\n    fixed fresnal = _FresnelScale + (1 - _FresnelScale) * pow((1 - dot(normalize(i.worldViewDir), normalize(i.worldNormal))), 5);\n    // 计算最终颜色\n    return cubemapColor * fresnal;\n}\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20241221190319-jwy1aa3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221190319-jwy1aa3",
				"updated": "20241221190412"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "显示效果（左为纯反射Shader，反射率为0.2，右为菲涅尔反射Shader，菲涅尔介质反射率为0.2）："
				}
			]
		},
		{
			"ID": "20241221190616-9ws87fk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221190616-9ws87fk",
				"updated": "20241221190616"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 555px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241221190616-g7e3qqc.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 555px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20241221190419-o5atgbc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221190419-o5atgbc",
				"updated": "20241221190526"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "可见，和左边的全黑相比，右边的菲涅尔反射在茶壶的边缘处呈现了更亮的反射效果"
				}
			]
		},
		{
			"ID": "20241221190825-e5xh2fm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221190825-e5xh2fm",
				"updated": "20241221190832"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "完整 Shader 代码如下："
				}
			]
		},
		{
			"ID": "20241221190832-va5t09k",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20241221190832-va5t09k",
				"style": "line-height: 22px;",
				"updated": "20241221191251"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Yw=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "Shader \"TeachShader/Lesson79_FresnelBase\"\n{\n    Properties\n    {\n        _Cube(\"Cubemap\", Cube) = \"\"{}                       // 立方体纹理\n        _FresnelScale(\"_FresnelScale\", Range(0, 1)) = 1     // 菲涅尔反射中，对应介质的反射率\n    }\n    SubShader\n    {\n        Tags { \"RenderType\" = \"Opaque\" \"Queue\" = \"Geometry\" }\n\n        Pass\n        {\n            Tags { \"LightMode\" = \"ForwardBase\" }\n\n            CGPROGRAM\n            #pragma vertex vert\n            #pragma fragment frag\n\n            #include \"UnityCG.cginc\"\n            #include \"Lighting.cginc\"\n\n            samplerCUBE _Cube;\n            float _FresnelScale;\n\n            struct v2f\n            {\n                float4 pos: SV_POSITION;            // 裁剪空间下的顶点坐标\n                float3 worldNormal: NORMAL;         // 世界空间下的法线\n                float3 worldViewDir: TEXCOORD0;     // 世界空间下的视角方向\n                float3 worldReflection: TEXCOORD1;  // 世界空间下的反射向量\n            };\n\n            v2f vert(appdata_base v)\n            {\n                v2f data;\n                data.pos = UnityObjectToClipPos(v.vertex);                              // 顶点坐标转裁剪坐标\n                data.worldNormal = UnityObjectToWorldNormal(v.normal);                  // 顶点法线转世界坐标\n                fixed3 worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;               // 顶点坐标装世界坐标\n                data.worldViewDir = UnityWorldSpaceViewDir(worldPos);                   // 计算世界空间下视角所在方向\n                data.worldReflection = reflect(-data.worldViewDir, data.worldNormal);   // 通过反向视角方向得到反射方向\n\n                return data;\n            }\n\n            fixed4 frag(v2f i): SV_TARGET\n            {\n                // 从立方体纹理内采样得到反射颜色\n                fixed4 cubemapColor = texCUBE(_Cube, i.worldReflection);\n                // 根据schlick菲涅尔近似公式，计算菲涅尔反射率\n                fixed fresnal = _FresnelScale + (1 - _FresnelScale) * pow((1 - dot(normalize(i.worldViewDir), normalize(i.worldNormal))), 5);\n                // 计算最终颜色\n                return cubemapColor * fresnal;\n            }\n            ENDCG\n        }\n    }\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20241221190515-02ajolx",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20241221190515-02ajolx",
				"updated": "20241221193248"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "菲涅尔反射结合漫反射和阴影"
				}
			]
		},
		{
			"ID": "20241221190724-tyzwjhn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221190724-tyzwjhn",
				"updated": "20241221190725"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "由于菲涅耳反射是基于反射的，因此我们在之前实现的反射结合漫反射的基础上修改即可"
				}
			]
		},
		{
			"ID": "20241221190724-yfm0coe",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20241221190724-yfm0coe",
				"updated": "20241221190848"
			},
			"Children": [
				{
					"ID": "20241221190848-7fpcqc7",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20241221190848-7fpcqc7",
						"updated": "20241221190848"
					},
					"Children": [
						{
							"ID": "20241221190848-zuwmyoc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190848-zuwmyoc",
								"updated": "20241221191004"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "新建 Shader，复用反射结合漫反射和阴影 Shader 中的代码，在其基础上进行修改"
								}
							]
						},
						{
							"ID": "20241221191003-ne3a1xv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221191003-ne3a1xv",
								"updated": "20241221191027"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "具体内容详见："
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "block-ref",
									"TextMarkBlockRefID": "20241219001301-uqtlfhe",
									"TextMarkBlockRefSubtype": "d",
									"TextMarkTextContent": "US3S8L4——反射效果"
								},
								{
									"Type": "NodeText",
									"Data": " 的 反射结合漫反射和阴影 实现部分"
								}
							]
						}
					]
				},
				{
					"ID": "20241221190848-z65fxta",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20241221190848-z65fxta",
						"updated": "20241221190848"
					},
					"Children": [
						{
							"ID": "20241221190848-8ukpzh3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190848-8ukpzh3",
								"updated": "20241221190919"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "修改属性\n"
								}
							]
						},
						{
							"ID": "20241221190919-vfqqon9",
							"Type": "NodeList",
							"ListData": {
								"Typ": 1
							},
							"Properties": {
								"id": "20241221190919-vfqqon9",
								"updated": "20241221190920"
							},
							"Children": [
								{
									"ID": "20241221190920-4rz0tn0",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "MS4=",
										"Num": 1
									},
									"Properties": {
										"id": "20241221190920-4rz0tn0",
										"updated": "20241221190920"
									},
									"Children": [
										{
											"ID": "20241221190920-ppusmhg",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20241221190920-ppusmhg",
												"updated": "20241221191321"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "去掉反射颜色属性"
												}
											]
										}
									]
								},
								{
									"ID": "20241221190922-6pa354l",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "Mi4=",
										"Num": 2
									},
									"Properties": {
										"id": "20241221190922-6pa354l",
										"updated": "20241221190922"
									},
									"Children": [
										{
											"ID": "20241221190922-l7reyrx",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20241221190922-l7reyrx",
												"updated": "20241221191327"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "修改反射率属性为菲涅耳相关的 "
												},
												{
													"Type": "NodeTextMark",
													"TextMarkType": "inline-math",
													"TextMarkInlineMathContent": "R_0"
												},
												{
													"Type": "NodeText",
													"Data": " 反射率属性"
												}
											]
										}
									]
								}
							]
						},
						{
							"ID": "20241221191428-hjrvfmg",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221191428-hjrvfmg",
								"style": "line-height: 22px;",
								"updated": "20241221191437"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "Properties\n{\n    _Color(\"Color\", Color) = (1, 1, 1, 1)               // 漫反射颜色\n    _Cube(\"Cubemap\", Cube) = \"\"{}                       // 立方体纹理\n    _FresnelScale(\"_FresnelScale\", Range(0, 1)) = 1     // 菲涅尔反射中对应介质的反射率\n}\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				},
				{
					"ID": "20241221190848-x4wzlbj",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20241221190848-x4wzlbj",
						"updated": "20241221190848"
					},
					"Children": [
						{
							"ID": "20241221190848-ssm34hk",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190848-ssm34hk",
								"updated": "20241221190856"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "修改 "
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "code",
									"TextMarkTextContent": "v2f"
								},
								{
									"Type": "NodeText",
									"Data": "​ 结构体"
								}
							]
						},
						{
							"ID": "20241221190856-bax5a85",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190856-bax5a85",
								"updated": "20241221190901"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "加入视角方向（需要在片元着色器中用菲涅耳近似公式参与计算）"
								}
							]
						},
						{
							"ID": "20241221191318-y85ac8p",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221191318-y85ac8p",
								"style": "line-height: 22px;",
								"updated": "20241221191419"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "struct v2f\n{\n    float4 pos: SV_POSITION;            // 裁剪空间下的顶点坐标\n    fixed3 worldNormal: NORMAL;         // 世界空间下法线\n    float3 worldPos: TEXCOORD0;         // 世界空间下顶点坐标\n    float3 worldViewDir: TEXCOORD1;     // 世界空间下的视角方向\n    float3 worldReflection: TEXCOORD2;  // 世界空间下的反射向量\n    SHADOW_COORDS(3)                    // 阴影坐标宏\n};\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				},
				{
					"ID": "20241221190848-d4k46vg",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20241221190848-d4k46vg",
						"updated": "20241221190848"
					},
					"Children": [
						{
							"ID": "20241221190848-wrjah0i",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190848-wrjah0i",
								"updated": "20241221190848"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "顶点着色器\n"
								}
							]
						},
						{
							"ID": "20241221190903-68iarkm",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190903-68iarkm",
								"updated": "20241221190903"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "修改视角方向临时变量"
								}
							]
						},
						{
							"ID": "20241221191442-sne98y9",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221191442-sne98y9",
								"style": "line-height: 22px;",
								"updated": "20241221191738"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "v2f vert(appdata_base v)\n{\n    v2f data;\n    data.pos = UnityObjectToClipPos(v.vertex);                              // 顶点坐标转裁剪坐标\n    data.worldNormal = UnityObjectToWorldNormal(v.normal);                  // 顶点法线转世界坐标\n    data.worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;                 // 顶点坐标装世界坐标\n    data.worldViewDir = UnityWorldSpaceViewDir(data.worldPos);              // 计算世界空间下视角所在方向\n    data.worldReflection = reflect(-data.worldViewDir, data.worldNormal);   // 通过反向视角方向得到反射方向\n    TRANSFER_SHADOW(data)                                                   // 阴影转换计算\n\n    return data;\n}\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				},
				{
					"ID": "20241221190848-w2bv14i",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20241221190848-w2bv14i",
						"updated": "20241221190848"
					},
					"Children": [
						{
							"ID": "20241221190848-qujll3o",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20241221190848-qujll3o",
								"updated": "20241221190908"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "片元着色器\n"
								}
							]
						},
						{
							"ID": "20241221190909-q3uil5t",
							"Type": "NodeList",
							"ListData": {
								"Typ": 1
							},
							"Properties": {
								"id": "20241221190909-q3uil5t",
								"updated": "20241221190910"
							},
							"Children": [
								{
									"ID": "20241221190910-wt0jo6u",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "MS4=",
										"Num": 1
									},
									"Properties": {
										"id": "20241221190910-wt0jo6u",
										"updated": "20241221190910"
									},
									"Children": [
										{
											"ID": "20241221190910-inn54i8",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20241221190910-inn54i8",
												"updated": "20241221190912"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "计算菲涅耳反射率\n"
												}
											]
										}
									]
								},
								{
									"ID": "20241221190912-bcrtkgw",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "Mi4=",
										"Num": 2
									},
									"Properties": {
										"id": "20241221190912-bcrtkgw",
										"updated": "20241221190912"
									},
									"Children": [
										{
											"ID": "20241221190912-fcarfix",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20241221190912-fcarfix",
												"updated": "20241221190916"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "用菲涅耳反射率参与 "
												},
												{
													"Type": "NodeTextMark",
													"TextMarkType": "code",
													"TextMarkTextContent": "lerp"
												},
												{
													"Type": "NodeText",
													"Data": "​ 计算"
												}
											]
										}
									]
								}
							]
						},
						{
							"ID": "20241221191740-cqho5l2",
							"Type": "NodeCodeBlock",
							"IsFencedCodeBlock": true,
							"Properties": {
								"id": "20241221191740-cqho5l2",
								"style": "line-height: 22px;",
								"updated": "20241221191748"
							},
							"Children": [
								{
									"Type": "NodeCodeBlockFenceOpenMarker",
									"Data": "```"
								},
								{
									"Type": "NodeCodeBlockFenceInfoMarker",
									"CodeBlockInfo": "Yw=="
								},
								{
									"Type": "NodeCodeBlockCode",
									"Data": "fixed4 frag(v2f i): SV_TARGET\n{\n    // 漫反射计算\n    fixed3 worldLightDir = normalize(UnityWorldSpaceLightDir(i.worldPos));\n    fixed3 diffuse = _LightColor0.rgb * _Color.rgb * max(0, dot(normalize(i.worldNormal), worldLightDir));\n    // 立方体纹理采样反射颜色\n    fixed3 cubemapColor = texCUBE(_Cube, i.worldReflection).rgb;\n    // 计算光照衰减和阴影相关的衰减值\n    UNITY_LIGHT_ATTENUATION(atten, i, i.worldPos)\n    // 根据schlick菲涅尔近似公式，计算菲涅尔反射率\n    fixed fresnal = _FresnelScale + (1 - _FresnelScale) * pow((1 - dot(normalize(i.worldViewDir), normalize(i.worldNormal))), 5);\n    // 利用插值计算，在 漫反射颜色 和 反射颜色 之间进行插值，0和1就是极限状态，0代表没有反射效果，1代表只要反射效果，0~1就是两者的叠加\n    fixed3 color = UNITY_LIGHTMODEL_AMBIENT.rgb + lerp(diffuse, cubemapColor, fresnal) * atten;\n    return fixed4(color, 1);\n}\n"
								},
								{
									"Type": "NodeCodeBlockFenceCloseMarker",
									"Data": "```"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20241221191751-sjoqw4f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221191751-sjoqw4f",
				"updated": "20241221192719"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "材质预览效果（左为使用了菲涅尔反射的Shader的材质球，右为不使用菲涅尔反射的材质球）："
				}
			]
		},
		{
			"ID": "20241221192546-lk2llat",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221192546-lk2llat",
				"updated": "20241221192546"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 351px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241221192546-8t6a5bz.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 351px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20241221192549-g31qd1m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221192549-g31qd1m",
				"updated": "20241221192818"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "显示效果（左不使用菲涅尔反射的Shader，反射率为0.05，右使用菲涅尔反射的Shader，菲涅尔介质反射率为0.05）："
				}
			]
		},
		{
			"ID": "20241221192643-ttgcfca",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221192643-ttgcfca",
				"updated": "20241221192643"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"style": "width: 703px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20241221192643-zukvib7.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 703px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20241221192504-p5w3wyy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221192504-p5w3wyy",
				"updated": "20241221193248"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "可以看到，使用菲涅尔反射的Shader，即使在反射率较低的情况下，在边缘处依然有明显的反射效果，越接近边缘，反射效果越明显"
				}
			]
		},
		{
			"ID": "20241221193039-4wlzkd4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20241221193039-4wlzkd4",
				"updated": "20241221193055"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "完整 Shader 如下："
				}
			]
		},
		{
			"ID": "20241221193056-073yxu2",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20241221193056-073yxu2",
				"style": "line-height: 22px;",
				"updated": "20241221193102"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Yw=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "Shader \"TeachShader/Lesson80_Fresnel\"\n{\n    Properties\n    {\n        _Color(\"Color\", Color) = (1, 1, 1, 1)               // 漫反射颜色\n        _Cube(\"Cubemap\", Cube) = \"\"{}                       // 立方体纹理\n        _FresnelScale(\"_FresnelScale\", Range(0, 1)) = 1     // 菲涅尔反射中对应介质的反射率\n    }\n    SubShader\n    {\n        Tags { \"RenderType\" = \"Opaque\" \"Queue\" = \"Geometry\" }\n\n        Pass\n        {\n            Tags { \"LightMode\" = \"ForwardBase\" }\n\n            CGPROGRAM\n            #pragma vertex vert\n            #pragma fragment frag\n            #pragma multi_compile_fwdbase\n\n            #include \"UnityCG.cginc\"\n            #include \"Lighting.cginc\"\n            #include \"AutoLight.cginc\"\n\n            fixed4 _Color;\n            samplerCUBE _Cube;\n            float _FresnelScale;\n\n            struct v2f\n            {\n                float4 pos: SV_POSITION;            // 裁剪空间下的顶点坐标\n                fixed3 worldNormal: NORMAL;         // 世界空间下法线\n                float3 worldPos: TEXCOORD0;         // 世界空间下顶点坐标\n                float3 worldViewDir: TEXCOORD1;     // 世界空间下的视角方向\n                float3 worldReflection: TEXCOORD2;  // 世界空间下的反射向量\n                SHADOW_COORDS(3)                    // 阴影坐标宏\n            };\n\n            v2f vert(appdata_base v)\n            {\n                v2f data;\n                data.pos = UnityObjectToClipPos(v.vertex);                              // 顶点坐标转裁剪坐标\n                data.worldNormal = UnityObjectToWorldNormal(v.normal);                  // 顶点法线转世界坐标\n                data.worldPos = mul(unity_ObjectToWorld, v.vertex).xyz;                 // 顶点坐标装世界坐标\n                data.worldViewDir = UnityWorldSpaceViewDir(data.worldPos);              // 计算世界空间下视角所在方向\n                data.worldReflection = reflect(-data.worldViewDir, data.worldNormal);   // 通过反向视角方向得到反射方向\n                TRANSFER_SHADOW(data)                                                   // 阴影转换计算\n\n                return data;\n            }\n\n            fixed4 frag(v2f i): SV_TARGET\n            {\n                // 漫反射计算\n                fixed3 worldLightDir = normalize(UnityWorldSpaceLightDir(i.worldPos));\n                fixed3 diffuse = _LightColor0.rgb * _Color.rgb * max(0, dot(normalize(i.worldNormal), worldLightDir));\n                // 立方体纹理采样反射颜色\n                fixed3 cubemapColor = texCUBE(_Cube, i.worldReflection).rgb;\n                // 计算光照衰减和阴影相关的衰减值\n                UNITY_LIGHT_ATTENUATION(atten, i, i.worldPos)\n                // 根据schlick菲涅尔近似公式，计算菲涅尔反射率\n                fixed fresnal = _FresnelScale + (1 - _FresnelScale) * pow((1 - dot(normalize(i.worldViewDir), normalize(i.worldNormal))), 5);\n                // 利用插值计算，在 漫反射颜色 和 反射颜色 之间进行插值，0和1就是极限状态，0代表没有反射效果，1代表只要反射效果，0~1就是两者的叠加\n                fixed3 color = UNITY_LIGHTMODEL_AMBIENT.rgb + lerp(diffuse, cubemapColor, fresnal) * atten;\n                return fixed4(color, 1);\n            }\n            ENDCG\n        }\n    }\n\n    Fallback \"Reflective/VertexLit\"\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		}
	]
}