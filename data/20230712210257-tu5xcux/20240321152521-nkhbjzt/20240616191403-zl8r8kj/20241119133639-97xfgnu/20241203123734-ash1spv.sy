{"ID":"20241203123734-ash1spv","Spec":"1","Type":"NodeDocument","Properties":{"id":"20241203123734-ash1spv","title":"US3S6L1——阴影的基本原理","type":"doc","updated":"20241203124752"},"Children":[{"ID":"20241203123734-6twbi68","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241203123734-6twbi68","updated":"20241203123934"},"Children":[{"Type":"NodeText","Data":"现实中阴影的产生规则"}]},{"ID":"20241203123803-eagsdss","Type":"NodeParagraph","Properties":{"id":"20241203123803-eagsdss","updated":"20241203123815"},"Children":[{"Type":"NodeText","Data":"如图所示，现实中的阴影产生规则是，在不考虑光线反射的前提下\n当一个光源发射的一条光线遇到一个不透明物体 A 时，这条光线就不能够再继续照亮其他物体了（物体B的一部分）\n相当于光线被更靠近光源的A物体挡住了一些，这时物体A就会向旁边的物体B投射阴影\n也就是说，阴影区域的产生就是因为光线无法到达"}]},{"ID":"20241203123930-gqarvus","Type":"NodeParagraph","Properties":{"id":"20241203123930-gqarvus","updated":"20241203123930"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 240px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241203123930-93nazir.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 240px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241203123934-ptdfouu","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20241203123934-ptdfouu","updated":"20241203124752"},"Children":[{"Type":"NodeText","Data":"Shadow Mapping 技术"}]},{"ID":"20241203123958-qg9t4wu","Type":"NodeParagraph","Properties":{"id":"20241203123958-qg9t4wu","updated":"20241203124018"},"Children":[{"Type":"NodeText","Data":"基于 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"阴影区域的产生就是因为光线无法到达"},{"Type":"NodeText","Data":" 的这个规则\n前辈 Lance Williams（兰斯·威廉姆斯）在 1978 年时最早提出了 Shadow Mapping （阴影贴图）技术。\n这是计算机图形学中第一个提出的通用阴影算法。"}]},{"ID":"20241203124027-390y8vu","Type":"NodeParagraph","Properties":{"id":"20241203124027-390y8vu","updated":"20241203124053"},"Children":[{"Type":"NodeText","Data":"Shadow Mapping 的基本原理："},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"将摄像机的位置放在和光源重合的位置上，那么场景中关于这个光源的阴影区域就是摄像机看不到的位置"}]},{"ID":"20241203124212-3onc5qv","Type":"NodeParagraph","Properties":{"id":"20241203124212-3onc5qv","updated":"20241203124212"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 238px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241203124212-qmcnbtk.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 238px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241203124037-z66xgkd","Type":"NodeBlockquote","Properties":{"id":"20241203124037-z66xgkd","style":"color: var(--b3-card-warning-color); background-color: var(--b3-card-warning-background); --b3-parent-background: var(--b3-card-warning-background);","updated":"20241203124039"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20241203124039-qq571ll","Type":"NodeParagraph","Properties":{"id":"20241203124039-qq571ll","updated":"20241203124039"},"Children":[{"Type":"NodeText","Data":"注意：一般情况下，点光源用透视投影，平行光用正交投影"}]}]},{"ID":"20241203124047-vsnukcv","Type":"NodeParagraph","Properties":{"id":"20241203124047-vsnukcv","updated":"20241203124156"},"Children":[{"Type":"NodeText","Data":"Shadow Mapping （阴影贴图）技术在Unity中的本质其实就是 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"生成一张深度图（阴影映射纹理），一般存于显存中"},{"Type":"NodeText","Data":"\n这张深度图记录了从该光源位置出发，能看到的场景中距离它最近表面的位置（一般记录其深度信息，值转换为0"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1之间，0最近，1最远）"}]},{"ID":"20241203124239-sbauwgb","Type":"NodeParagraph","Properties":{"id":"20241203124239-sbauwgb","updated":"20241203124338"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241203124239-ij2djrp.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"摄像机看到的内容"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 262px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241203124303-xbzlel6.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"生成的深度图（阴影隐射原理）"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 262px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20241203124338-aqjep42","Type":"NodeParagraph","Properties":{"id":"20241203124338-aqjep42","updated":"20241203124457"},"Children":[{"Type":"NodeText","Data":"Shadow Mapping 阴影贴图技术就是将摄像机的位置放在和光源重合的位置上，场景中关于这个光源的阴影区域就是摄像机看不到的位置。\n它会生成一张深度图（阴影隐射纹理），一般存于显存中。\n记录了从该光源位置出发，能看到的场景中距离它最近表面的深度信息（0"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1之间，0最近，1最远）"}]},{"ID":"20241203124501-mc7v67u","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20241203124501-mc7v67u","updated":"20241203124752"},"Children":[{"Type":"NodeText","Data":"Unity 如何应用 Shadow Mapping 技术"}]},{"ID":"20241203124518-q8bwjs4","Type":"NodeParagraph","Properties":{"id":"20241203124518-q8bwjs4","updated":"20241203124533"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"阴影映射纹理的生成是由光源完成的。"}]},{"ID":"20241203124534-ha6tmuu","Type":"NodeParagraph","Properties":{"id":"20241203124534-ha6tmuu","updated":"20241203124547"},"Children":[{"Type":"NodeText","Data":"在每帧渲染的早期阶段，Unity会对每个能够投射阴影的光源创建一个对应的摄像机视角，这个视角用于捕获从光源位置看到的场景。\n平行光设置为正交摄像机，点光源可能会设置多个视角，捕获多个方向的立方体阴影贴图。\nUnity会渲染场景的深度信息，这些深度信息表示从光源到场景中每个物体的距离，不考虑颜色信息，最终存储在显存中。\n实时阴影映射纹理需要每帧更新，但对于静态光源和静态场景，可以使用预烘焙的阴影贴图，减少实时计算的开销。"}]},{"ID":"20241203124726-nbcwdkq","Type":"NodeParagraph","Properties":{"id":"20241203124726-nbcwdkq","updated":"20241203124752"},"Children":[{"Type":"NodeText","Data":"有了 阴影映射纹理 后，我们只需要在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Pass"},{"Type":"NodeText","Data":"​ 中将顶点位置变换到光源空间下，得到顶点在光源空间下的三维位置信息。\n然后使用 X 和 Y 分量对阴影映射纹理进行采样，得到阴影纹理中该位置的深度信息。\n如果阴影纹理中取出的深度值小于该顶点的深度值，那么说明该顶点位于阴影中。（深度图中值为0"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1之间，0最近，1最远）"}]}]}