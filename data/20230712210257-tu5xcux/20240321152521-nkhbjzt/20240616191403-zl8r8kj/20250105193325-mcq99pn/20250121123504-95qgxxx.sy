{"ID":"20250121123504-95qgxxx","Spec":"1","Type":"NodeDocument","Properties":{"id":"20250121123504-95qgxxx","title":"US3S11L3——查看深度和法线纹理","type":"doc","updated":"20250121132559"},"Children":[{"ID":"20250121123504-9ye568j","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20250121123504-9ye568j","updated":"20250121130505"},"Children":[{"Type":"NodeText","Data":"查看深度纹理信息"}]},{"ID":"20250121123634-tw2l1hy","Type":"NodeParagraph","Properties":{"id":"20250121123634-tw2l1hy","updated":"20250121130505"},"Children":[{"Type":"NodeText","Data":"我们可以在"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20250104124535-p0aiatt","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"屏幕后期处理"},{"Type":"NodeText","Data":"中使用我们学习过的获取深度信息的知识点，将深度值作为颜色的RGB值显示在屏幕上，感受深度纹理中存储的内容"}]},{"ID":"20250121123709-6mgpwog","Type":"NodeParagraph","Properties":{"id":"20250121123709-6mgpwog","updated":"20250121123709"},"Children":[{"Type":"NodeText","Data":"理论上来说，如果深度值使用 0"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1 范围的线性值，越接近近裁剪面越靠近黑色，越接近远裁剪面越靠近白色"}]},{"ID":"20250121123902-5l4g65b","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250121123902-5l4g65b","updated":"20250121124738"},"Children":[{"Type":"NodeText","Data":"实现 查看深度纹理屏幕后期处理效果 对应 Shader"}]},{"ID":"20250121123909-bmih8t4","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250121123909-bmih8t4","updated":"20250121123915"},"Children":[{"ID":"20250121123915-cga9ml8","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250121123915-cga9ml8","updated":"20250121123915"},"Children":[{"ID":"20250121123915-9jp370d","Type":"NodeParagraph","Properties":{"id":"20250121123915-9jp370d","updated":"20250121123916"},"Children":[{"Type":"NodeText","Data":"新建 Shader，删除无用代码"}]}]},{"ID":"20250121123915-ocy01gl","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250121123915-ocy01gl","updated":"20250121123915"},"Children":[{"ID":"20250121123915-wjf845a","Type":"NodeParagraph","Properties":{"id":"20250121123915-wjf845a","updated":"20250121123915"},"Children":[{"Type":"NodeText","Data":"声明变量\n"}]},{"ID":"20250121123918-0u5890c","Type":"NodeParagraph","Properties":{"id":"20250121123918-0u5890c","updated":"20250121123923"},"Children":[{"Type":"NodeText","Data":"在 Shader 中通过声明 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_CameraDepthTexture"},{"Type":"NodeText","Data":"​ 获取深度纹理"}]},{"ID":"20250121124612-ounkiof","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121124612-ounkiof","updated":"20250121124626"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"sampler2D _MainTex;\nfloat4 _MainTex_ST;\nsampler2D _CameraDepthTexture;  // 按规则命名的深度纹理变量\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250121123915-sduh9xt","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250121123915-sduh9xt","updated":"20250121123915"},"Children":[{"ID":"20250121123915-au0ze30","Type":"NodeParagraph","Properties":{"id":"20250121123915-au0ze30","updated":"20250121123915"},"Children":[{"Type":"NodeText","Data":"顶点着色器\n"}]},{"ID":"20250121123927-e28i3lt","Type":"NodeParagraph","Properties":{"id":"20250121123927-e28i3lt","updated":"20250121123927"},"Children":[{"Type":"NodeText","Data":"只需要修改传入结构体类型"}]},{"ID":"20250121124602-qwbvo0s","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121124602-qwbvo0s","updated":"20250121124610"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"v2f vert (appdata_base v)\n{\n    v2f o;\n    o.vertex = UnityObjectToClipPos(v.vertex);\n    o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);\n    return o;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250121123915-ro27f86","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250121123915-ro27f86","updated":"20250121123915"},"Children":[{"ID":"20250121123915-gxk6bqp","Type":"NodeParagraph","Properties":{"id":"20250121123915-gxk6bqp","updated":"20250121123915"},"Children":[{"Type":"NodeText","Data":"片元着色器\n"}]},{"ID":"20250121123928-zbrtjb4","Type":"NodeParagraph","Properties":{"id":"20250121123928-zbrtjb4","updated":"20250121124014"},"Children":[{"Type":"NodeText","Data":"使用深度纹理采样宏得到的结果是非线性的，将非线性的深度值转换到观察空间下，\n并将像素点到摄像机的距离转换到 [0,1] 区间内（线性深度值），将深度值作为返回颜色的RGB值"}]},{"ID":"20250121124552-58ih3ly","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121124552-58ih3ly","updated":"20250121124600"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"fixed4 frag (v2f i) : SV_Target\n{\n    float depth = SAMPLE_DEPTH_TEXTURE(_CameraDepthTexture, i.uv);  // 非线性的裁剪空间下深度值\n    fixed linearDepth = Linear01Depth(depth);                       // 得到一个线性的0~1区间的深度值\n    // 将深度值作为RGB颜色输入，越接近摄像机就越黑，越远离摄像机就越白，具体就会呈现出深浅灰\n    return fixed4(linearDepth, linearDepth, linearDepth, 1);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250121123915-c6k7ldl","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NS4=","Num":5},"Properties":{"id":"20250121123915-c6k7ldl","updated":"20250121123915"},"Children":[{"ID":"20250121123915-8gbfbli","Type":"NodeParagraph","Properties":{"id":"20250121123915-8gbfbli","updated":"20250121124019"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Fallback Off"},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20250121124637-rmu3irx","Type":"NodeParagraph","Properties":{"id":"20250121124637-rmu3irx","updated":"20250121124653"},"Children":[{"Type":"NodeText","Data":"完整 Shader 代码如下："}]},{"ID":"20250121124020-snanxy2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121124020-snanxy2","updated":"20250121124719"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"Shader \"TeachShader/Lesson110\"\n{\n    Properties\n    {\n        _MainTex (\"Texture\", 2D) = \"white\" {}\n    }\n    SubShader\n    {\n        Pass\n        {\n            CGPROGRAM\n            #pragma vertex vert\n            #pragma fragment frag\n\n            #include \"UnityCG.cginc\"\n\n            struct v2f\n            {\n                float2 uv : TEXCOORD0;\n                float4 vertex : SV_POSITION;\n            };\n\n            sampler2D _MainTex;\n            float4 _MainTex_ST;\n            sampler2D _CameraDepthTexture;  // 按规则命名的深度纹理变量\n\n            v2f vert (appdata_base v)\n            {\n                v2f o;\n                o.vertex = UnityObjectToClipPos(v.vertex);\n                o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);\n                return o;\n            }\n\n            fixed4 frag (v2f i) : SV_Target\n            {\n                float depth = SAMPLE_DEPTH_TEXTURE(_CameraDepthTexture, i.uv);  // 非线性的裁剪空间下深度值\n                fixed linearDepth = Linear01Depth(depth);                       // 得到一个线性的0~1区间的深度值\n                // 将深度值作为RGB颜色输入，越接近摄像机就越黑，越远离摄像机就越白，具体就会呈现出深浅灰\n                return fixed4(linearDepth, linearDepth, linearDepth, 1);\n            }\n            ENDCG\n        }\n    }\n\n    Fallback Off\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250121124738-nf0seyp","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250121124738-nf0seyp","updated":"20250121131848"},"Children":[{"Type":"NodeText","Data":"实现 查看深度纹理屏幕后期处理效果 对应 C# 代码"}]},{"ID":"20250121124755-njehmv5","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250121124755-njehmv5","updated":"20250121124917"},"Children":[{"ID":"20250121124851-t5ospd0","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250121124851-t5ospd0","updated":"20250121124851"},"Children":[{"ID":"20250121124851-6zegf8q","Type":"NodeParagraph","Properties":{"id":"20250121124851-6zegf8q","updated":"20250121124857"},"Children":[{"Type":"NodeText","Data":"新建 C# 脚本，命名和 Shader 相同"}]}]},{"ID":"20250121124851-9jhr9tj","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250121124851-9jhr9tj","updated":"20250121124917"},"Children":[{"ID":"20250121124851-5s3nj2r","Type":"NodeParagraph","Properties":{"id":"20250121124851-5s3nj2r","updated":"20250121124851"},"Children":[{"Type":"NodeText","Data":"继承 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PostEffect"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121124907-wffcqxu","Type":"NodeParagraph","Properties":{"id":"20250121124907-wffcqxu","updated":"20250121124917"},"Children":[{"Type":"NodeText","Data":"具体代码详见："},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20250104163836-9iiumg9","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"US3S10L4——屏幕后处理基类"}]}]},{"ID":"20250121124851-2jwz4hk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250121124851-2jwz4hk","updated":"20250121124851"},"Children":[{"ID":"20250121124851-4nxpfwy","Type":"NodeParagraph","Properties":{"id":"20250121124851-4nxpfwy","updated":"20250121124902"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Start"},{"Type":"NodeText","Data":"​ 函数中设置深度纹理模式"}]}]}]},{"ID":"20250121125352-16u33os","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121125352-16u33os","updated":"20250121125401"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"using UnityEngine;\n\npublic class Lesson110_DepthTexture : PostEffect\n{\n    void Start()\n    {\n        // 设置让Shader可以得到深度纹理信息\n        Camera.main.depthTextureMode = DepthTextureMode.Depth;\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250121131745-s6unel8","Type":"NodeParagraph","Properties":{"id":"20250121131745-s6unel8","updated":"20250121131848"},"Children":[{"Type":"NodeText","Data":"将该脚本挂载到摄像机后，在关联上文实现的 Shader 即可看到效果："}]},{"ID":"20250121131833-3xz732o","Type":"NodeParagraph","Properties":{"id":"20250121131833-3xz732o","updated":"20250121131833"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20250121131833-91s7hqp.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121125402-egh6jym","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250121125402-egh6jym","updated":"20250121125747"},"Children":[{"Type":"NodeText","Data":"效果展示"}]},{"ID":"20250121125501-vmb2buz","Type":"NodeParagraph","Properties":{"id":"20250121125501-vmb2buz","updated":"20250121125509"},"Children":[{"Type":"NodeText","Data":"原画面："}]},{"ID":"20250121125522-wupplgc","Type":"NodeParagraph","Properties":{"id":"20250121125522-wupplgc","updated":"20250121125522"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 472px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20250121125522-caofvqx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 472px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121125426-vvaz4li","Type":"NodeParagraph","Properties":{"id":"20250121125426-vvaz4li","updated":"20250121125553"},"Children":[{"Type":"NodeText","Data":"将摄像机的远裁剪面设置为100，将深度纹理显示在画面上，效果如下："}]},{"ID":"20250121125618-dm23qyg","Type":"NodeParagraph","Properties":{"id":"20250121125618-dm23qyg","updated":"20250121125618"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 470px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20250121125618-qhy3d1s.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 470px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121125622-bb700p7","Type":"NodeParagraph","Properties":{"id":"20250121125622-bb700p7","updated":"20250121125727"},"Children":[{"Type":"NodeText","Data":"可见，屏幕上离摄像机越远的地方越白，离摄像机越近的地方越黑"}]},{"ID":"20250121125747-iwwmbk8","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20250121125747-iwwmbk8","updated":"20250121132014"},"Children":[{"Type":"NodeText","Data":"查看法线纹理信息"}]},{"ID":"20250121130445-upbhles","Type":"NodeParagraph","Properties":{"id":"20250121130445-upbhles","updated":"20250121130510"},"Children":[{"Type":"NodeText","Data":"我们可以在"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20250104124535-p0aiatt","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"屏幕后期处理"},{"Type":"NodeText","Data":"中用我们学习过的获取法线信息的知识点，将法线作为颜色显示在屏幕上，感受法线纹理中存储的内容"}]},{"ID":"20250121130511-glbmvj2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250121130511-glbmvj2","updated":"20250121132014"},"Children":[{"Type":"NodeText","Data":"实现 查看法线纹理屏幕后期处理效果 对应 Shader"}]},{"ID":"20250121130552-1ph2kpt","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250121130552-1ph2kpt","updated":"20250121131706"},"Children":[{"ID":"20250121130558-102nnq2","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250121130558-102nnq2","updated":"20250121130558"},"Children":[{"ID":"20250121130558-7bhdqz2","Type":"NodeParagraph","Properties":{"id":"20250121130558-7bhdqz2","updated":"20250121130609"},"Children":[{"Type":"NodeText","Data":"新建 Shader，删除无用代码"}]}]},{"ID":"20250121130558-nrxl9rk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250121130558-nrxl9rk","updated":"20250121130558"},"Children":[{"ID":"20250121130558-meg5vr0","Type":"NodeParagraph","Properties":{"id":"20250121130558-meg5vr0","updated":"20250121130613"},"Children":[{"Type":"NodeText","Data":"声明变量\n"}]},{"ID":"20250121130618-1y6s8iz","Type":"NodeParagraph","Properties":{"id":"20250121130618-1y6s8iz","updated":"20250121130618"},"Children":[{"Type":"NodeText","Data":"在 Shader 中通过声明 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"_CameraDepthNormalsTexture"},{"Type":"NodeText","Data":"​ 获取深度+法线纹理"}]},{"ID":"20250121131641-ywgylad","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121131641-ywgylad","updated":"20250121131648"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"struct v2f\n{\n    float2 uv : TEXCOORD0;\n    float4 vertex : SV_POSITION;\n};\n\nsampler2D _MainTex;\nfloat4 _MainTex_ST;\nsampler2D _CameraDepthNormalsTexture;  // 按规则命名的深度+法线纹理变量\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250121130558-waekpt2","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250121130558-waekpt2","updated":"20250121130558"},"Children":[{"ID":"20250121130558-sj2225z","Type":"NodeParagraph","Properties":{"id":"20250121130558-sj2225z","updated":"20250121130558"},"Children":[{"Type":"NodeText","Data":"顶点着色器\n"}]},{"ID":"20250121130616-ylibfgx","Type":"NodeParagraph","Properties":{"id":"20250121130616-ylibfgx","updated":"20250121130616"},"Children":[{"Type":"NodeText","Data":"只需要修改传入结构体类型"}]},{"ID":"20250121131650-880ofjw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121131650-880ofjw","updated":"20250121131656"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"v2f vert (appdata_base v)\n{\n    v2f o;\n    o.vertex = UnityObjectToClipPos(v.vertex);\n    o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);\n    return o;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250121130558-d8ocyuk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20250121130558-d8ocyuk","updated":"20250121131706"},"Children":[{"ID":"20250121130558-xgp9wss","Type":"NodeParagraph","Properties":{"id":"20250121130558-xgp9wss","updated":"20250121130621"},"Children":[{"Type":"NodeText","Data":"片元着色器\n"}]},{"ID":"20250121130622-6vlcg0g","Type":"NodeParagraph","Properties":{"id":"20250121130622-6vlcg0g","updated":"20250121131601"},"Children":[{"Type":"NodeText","Data":"对深度+法线纹理进行采样（其中xy是法线信息，zw是深度信息）\n使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnityCG.cginc"},{"Type":"NodeText","Data":"​ 内置文件中的方法一次性处理深度和法线，得到深度值 (0"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1) 和法线信息 (观察空间下）\n将法线的 [-1"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1] 转换到 [0"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"~"}]},{"Type":"NodeText","Data":"1]，作为颜色值输出"}]},{"ID":"20250121131659-o8scnd0","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121131659-o8scnd0","updated":"20250121131706"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"fixed4 frag (v2f i) : SV_Target\n{\n    // 直接采样获取到裁剪空间下的屏幕法线+深度信息\n    float4 depthNormal = tex2D(_CameraDepthNormalsTexture, i.uv);\n    fixed depth;\n    fixed3 normals;\n    DecodeDepthNormal(depthNormal, depth, normals);\n    // 将法线的-1到1之间的区间变换到0~1之间\n    return fixed4(normals * 0.5 + 0.5, 1);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20250121130558-w2kj348","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NS4=","Num":5},"Properties":{"id":"20250121130558-w2kj348","updated":"20250121130558"},"Children":[{"ID":"20250121130558-oqmxg2f","Type":"NodeParagraph","Properties":{"id":"20250121130558-oqmxg2f","updated":"20250121130601"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Fallback Off"},{"Type":"NodeText","Data":"​"}]}]}]},{"ID":"20250121131622-oy3t1rn","Type":"NodeParagraph","Properties":{"id":"20250121131622-oy3t1rn","updated":"20250121131628"},"Children":[{"Type":"NodeText","Data":"完整 Shader 如下："}]},{"ID":"20250121131628-ootaoqc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121131628-ootaoqc","updated":"20250121132014"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"Shader \"TeachShader/Lesson111_DepthNormalTexture\"\n{\n    Properties\n    {\n        _MainTex (\"Texture\", 2D) = \"white\" {}\n    }\n    SubShader\n    {\n        Pass\n        {\n            CGPROGRAM\n            #pragma vertex vert\n            #pragma fragment frag\n\n            #include \"UnityCG.cginc\"\n\n            struct v2f\n            {\n                float2 uv : TEXCOORD0;\n                float4 vertex : SV_POSITION;\n            };\n\n            sampler2D _MainTex;\n            float4 _MainTex_ST;\n            sampler2D _CameraDepthNormalsTexture;  // 按规则命名的深度+法线纹理变量\n\n            v2f vert (appdata_base v)\n            {\n                v2f o;\n                o.vertex = UnityObjectToClipPos(v.vertex);\n                o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);\n                return o;\n            }\n\n            fixed4 frag (v2f i) : SV_Target\n            {\n                // 直接采样获取到裁剪空间下的屏幕法线+深度信息\n                float4 depthNormal = tex2D(_CameraDepthNormalsTexture, i.uv);\n                fixed depth;\n                fixed3 normals;\n                DecodeDepthNormal(depthNormal, depth, normals);\n                // 将法线的-1到1之间的区间变换到0~1之间\n                return fixed4(normals * 0.5 + 0.5, 1);\n            }\n            ENDCG\n        }\n    }\n\n    Fallback Off\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250121130533-olumi70","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250121130533-olumi70","updated":"20250121132103"},"Children":[{"Type":"NodeText","Data":"实现 查看法线纹理屏幕后期处理效果 对应 C# 代码"}]},{"ID":"20250121130545-t8cu5yw","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20250121130545-t8cu5yw","updated":"20250121130545"},"Children":[{"ID":"20250121130545-4jkrd9y","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20250121130545-4jkrd9y","updated":"20250121130545"},"Children":[{"ID":"20250121130545-hyl8cr9","Type":"NodeParagraph","Properties":{"id":"20250121130545-hyl8cr9","updated":"20250121130545"},"Children":[{"Type":"NodeText","Data":"新建 C# 脚本，命名和 Shader 相同"}]}]},{"ID":"20250121130545-03vwifh","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20250121130545-03vwifh","updated":"20250121130545"},"Children":[{"ID":"20250121130545-0wvvdgj","Type":"NodeParagraph","Properties":{"id":"20250121130545-0wvvdgj","updated":"20250121130545"},"Children":[{"Type":"NodeText","Data":"继承 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PostEffect"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121130545-69dpfzg","Type":"NodeParagraph","Properties":{"id":"20250121130545-69dpfzg","updated":"20250121130545"},"Children":[{"Type":"NodeText","Data":"具体代码详见："},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20250104163836-9iiumg9","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"US3S10L4——屏幕后处理基类"}]}]},{"ID":"20250121130545-3x6cpeu","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20250121130545-3x6cpeu","updated":"20250121130545"},"Children":[{"ID":"20250121130545-useup0p","Type":"NodeParagraph","Properties":{"id":"20250121130545-useup0p","updated":"20250121130545"},"Children":[{"Type":"NodeText","Data":"在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Start"},{"Type":"NodeText","Data":"​ 函数中设置深度纹理模式"}]}]}]},{"ID":"20250121131707-ebq3672","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250121131707-ebq3672","updated":"20250121131740"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Yw=="},{"Type":"NodeCodeBlockCode","Data":"using UnityEngine;\n\npublic class Lesson111_DepthNormalTexture : PostEffect\n{\n    void Start()\n    {\n        // 设置让Shader可以得到深度纹理信息\n        Camera.main.depthTextureMode = DepthTextureMode.DepthNormals;\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250121131850-d0lwalv","Type":"NodeParagraph","Properties":{"id":"20250121131850-d0lwalv","updated":"20250121131854"},"Children":[{"Type":"NodeText","Data":"将该脚本挂载到摄像机后，在关联上文实现的 Shader 即可看到效果："}]},{"ID":"20250121132038-5vx4cc3","Type":"NodeParagraph","Properties":{"id":"20250121132038-5vx4cc3","updated":"20250121132038"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20250121132038-7rur1e9.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121132103-h0cltyi","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250121132103-h0cltyi","updated":"20250121132559"},"Children":[{"Type":"NodeText","Data":"效果展示"}]},{"ID":"20250121132103-eixdc6t","Type":"NodeParagraph","Properties":{"id":"20250121132103-eixdc6t","updated":"20250121132103"},"Children":[{"Type":"NodeText","Data":"原画面："}]},{"ID":"20250121132154-fnktckj","Type":"NodeParagraph","Properties":{"id":"20250121132154-fnktckj","updated":"20250121132154"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 455px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20250121132154-e56kw46.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 455px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121132103-yjlofcw","Type":"NodeParagraph","Properties":{"id":"20250121132103-yjlofcw","updated":"20250121132113"},"Children":[{"Type":"NodeText","Data":"将法线纹理显示在画面上，效果如下："}]},{"ID":"20250121132210-hi1ngf1","Type":"NodeParagraph","Properties":{"id":"20250121132210-hi1ngf1","updated":"20250121132210"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 451px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20250121132210-un6memw.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 451px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20250121132103-lydn34n","Type":"NodeParagraph","Properties":{"id":"20250121132103-lydn34n","updated":"20250121132559"},"Children":[{"Type":"NodeText","Data":"可见，屏幕上每个像素点内的顶点法线方向不同，其呈现的颜色也不同，在同一平面上的点拥有相同的法线颜色\n具体法线为何呈现出这样的颜色，可参考："},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20241029120418-arycu45","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"US3S2L4——凹凸纹理基本概念"}]},{"ID":"20250121132218-unn2ic7","Type":"NodeParagraph","Properties":{"id":"20250121132218-unn2ic7","updated":"20250121132218"}}]}