{"ID":"20240510144055-80eaahi","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240510144055-80eaahi","title":"US1L4——渲染管线-光栅化阶段","type":"doc","updated":"20241119124334"},"Children":[{"ID":"20240510144055-sepx8y2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240510144055-sepx8y2","updated":"20240612222103"},"Children":[{"Type":"NodeText","Data":"知识必备——像素"}]},{"ID":"20240510144147-o9pqe2x","Type":"NodeParagraph","Properties":{"id":"20240510144147-o9pqe2x","updated":"20240510144159"},"Children":[{"Type":"NodeText","Data":"像素是计算机图形学中的基本概念，它是组成图像的最小可控单位，具有位置和属性，用于表示图像中的颜色和其他信息\n它是二位图像中的一个点，每个像素都占据屏幕上的一个固定位置\n比如我们常见的显示器分辨率为：1920 x 1080，就表示宽度为1920个像素，高度为1080个像素"}]},{"ID":"20240510144209-wry1sj7","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240510144209-wry1sj7","updated":"20240612222103"},"Children":[{"Type":"NodeText","Data":"知识必备——片元"}]},{"ID":"20240510144224-1como0e","Type":"NodeParagraph","Properties":{"id":"20240510144224-1como0e","updated":"20240510144646"},"Children":[{"Type":"NodeText","Data":"在渲染管线中，片元是指在光栅化阶段生成的像素或像素片段\n片元是渲染管线中进行像素级别操作和计算的基本单位\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"每个片元代表了屏幕上的一个像素，并且具有位置信息和与之相关的属性，比如：颜色、深度值、法线等等"}]},{"ID":"20240510150041-nqpvnid","Type":"NodeParagraph","Properties":{"id":"20240510150041-nqpvnid","updated":"20240510150108"},"Children":[{"Type":"NodeText","Data":"简单来说，片元相比像素包含了更多的消息，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"比如：颜色、深度值、法线等等"}]},{"ID":"20240510144312-llfu2kj","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240510144312-llfu2kj","updated":"20240612222103"},"Children":[{"Type":"NodeText","Data":"渲染管线 的 光栅化阶段"}]},{"ID":"20240510151044-h69zvi0","Type":"NodeParagraph","Properties":{"id":"20240510151044-h69zvi0","updated":"20240510151126"},"Children":[{"Type":"NodeText","Data":"渲染管线（流水线）中的光栅化，主要是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"GPU主导的阶段"},{"Type":"NodeText","Data":"\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"它为渲染完成的最主要的工作就是 确定片元最终是否被渲染，并且确定片元的最终渲染颜色效果等"},{"Type":"NodeText","Data":"\n在光栅化阶段中，我们主要通过自定义 "},{"Type":"NodeTextMark","TextMarkType":"strong u","TextMarkTextContent":"片元着色器"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong"},{"Type":"NodeText","Data":" "},{"Type":"NodeText","Data":"阶段，为我们带来一些不同的表现效果"}]},{"ID":"20240510144740-51o4kan","Type":"NodeParagraph","Properties":{"id":"20240510144740-51o4kan","updated":"20240510144704"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 851px;","style":"width: 841px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240510144740-ik8k3tu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 841px;\" parent-style=\"width: 851px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240510144743-foz0oad","Type":"NodeParagraph","Properties":{"id":"20240510144743-foz0oad","updated":"20240510144704"},"Children":[{"Type":"NodeText","Data":"渲染管线的光栅化阶段同样由GPU主导，同样我们无法拥有绝对的控制权，同样GPU为我们开放了部分控制权\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"光栅化阶段主要做的事情是根据几何阶段输入的信息计算每个图元覆盖哪些像素，以及为这些像素计算他们的颜色等等工作"}]},{"ID":"20240510145044-u2w4pld","Type":"NodeParagraph","Properties":{"id":"20240510145044-u2w4pld","updated":"20240510144704"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 962px;","style":"width: 952px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240510145044-g31trd5.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 952px;\" parent-style=\"width: 962px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240510145239-410n62q","Type":"NodeList","ListData":{},"Properties":{"id":"20240510145239-410n62q","updated":"20240612210453"},"Children":[{"ID":"20240510145257-0ek4k54","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240510145257-0ek4k54","updated":"20240510145257"},"Children":[{"ID":"20240510145257-qjapdb0","Type":"NodeParagraph","Properties":{"id":"20240510145257-qjapdb0","updated":"20240510145321"},"Children":[{"Type":"NodeText","Data":"三角形设置：\n"}]},{"ID":"20240510145328-wl8s4bs","Type":"NodeParagraph","Properties":{"id":"20240510145328-wl8s4bs","updated":"20240510145452"},"Children":[{"Type":"NodeText","Data":"几何阶段输入到光栅化阶段的数据主要是三角形网格的顶点信息，我们得到的只是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"三角形网格每条边的两个端点信息"},{"Type":"NodeText","Data":"\n如果想要得到整个三角形网格对像素的覆盖情况，就必须计算每条边上的像素坐标，\n为了能计算三角形边界像素的坐标信息，我们必须得到三角形边界的表示方式。\n"}]},{"ID":"20240510145457-e6oimg2","Type":"NodeParagraph","Properties":{"id":"20240510145457-e6oimg2","updated":"20240510145540"},"Children":[{"Type":"NodeText","Data":"在"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"三角形设置"},{"Type":"NodeText","Data":"这个小阶段，GPU主要做的事情就是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"计算三角形网格的表示数据"}]}]},{"ID":"20240510145502-lyc800v","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240510145502-lyc800v"},"Children":[{"ID":"20240510145502-vzz7i0y","Type":"NodeParagraph","Properties":{"id":"20240510145502-vzz7i0y","updated":"20240510145515"},"Children":[{"Type":"NodeText","Data":"三角形遍历：\n"}]},{"ID":"20240510145517-rw3sku4","Type":"NodeParagraph","Properties":{"id":"20240510145517-rw3sku4","updated":"20240510145558"},"Children":[{"Type":"NodeText","Data":"该阶段主要根据三角形设置中计算出的三角形网格数据，检查每个像素是否被一个三角形网格所覆盖\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果覆盖的话，就会生成一个片元（包含屏幕坐标、深度、法线等等信息）"},{"Type":"NodeText","Data":"\n这个阶段也被成为扫描变换"}]},{"ID":"20240510145619-vlqcbam","Type":"NodeParagraph","Properties":{"id":"20240510145619-vlqcbam","updated":"20240510145619"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 219px;","style":"width: 209px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240510145619-7y66s28.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 209px;\" parent-style=\"width: 219px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240510145524-u6rcrfy","Type":"NodeParagraph","Properties":{"id":"20240510145524-u6rcrfy","updated":"20240510145543"},"Children":[{"Type":"NodeText","Data":"在"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"三角形遍历"},{"Type":"NodeText","Data":"这个小阶段，GPU主要做的事情就是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"根据三角形网格信息得到被它们覆盖的片元序列"}]}]},{"ID":"20240510145657-2vi6gtq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240510145657-2vi6gtq","name":"片元着色器"},"Children":[{"ID":"20240510145657-0jdrtrn","Type":"NodeParagraph","Properties":{"id":"20240510145657-0jdrtrn","updated":"20240510145708"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong u","TextMarkTextContent":"片元着色器（像素着色器）"},{"Type":"NodeText","Data":"：\n"}]},{"ID":"20240510145702-qxtbamk","Type":"NodeParagraph","Properties":{"id":"20240510145702-qxtbamk"},"Children":[{"Type":"NodeText","Data":"它主要完成对 三角形遍历输入的片元序列中的 每个片元（像素）的着色计算和属性处理\n片元着色器需要完成的工作主要有：\n"}]},{"ID":"20240510145714-oonyv8f","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240510145714-oonyv8f","style":"background-color: var(--b3-card-success-background); color: var(--b3-card-success-color);","updated":"20240510145740"},"Children":[{"ID":"20240510145740-gcjbt46","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240510145740-gcjbt46","updated":"20240510145740"},"Children":[{"ID":"20240510145740-2bhm916","Type":"NodeParagraph","Properties":{"id":"20240510145740-2bhm916","updated":"20240510145805"},"Children":[{"Type":"NodeText","Data":"光照计算 —— 计算片元的"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"光照效果"}]}]},{"ID":"20240510145740-pc6kcad","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240510145740-pc6kcad","updated":"20240510145740"},"Children":[{"ID":"20240510145740-fr1pxnv","Type":"NodeParagraph","Properties":{"id":"20240510145740-fr1pxnv","updated":"20240510145802"},"Children":[{"Type":"NodeText","Data":"纹理映射 —— 根据片元在纹理中的位置，对纹理进行采样，将纹理颜色映射到片元上，"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"实现表面贴图效果"}]}]},{"ID":"20240510145740-nxl1mjq","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240510145740-nxl1mjq","updated":"20240510145740"},"Children":[{"ID":"20240510145740-mpu16xd","Type":"NodeParagraph","Properties":{"id":"20240510145740-mpu16xd","updated":"20240510145820"},"Children":[{"Type":"NodeText","Data":"材质属性处理 —— 根据材质的属性，比如颜色、透明度、反射率等，计算"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"片元的最终颜色和透明度"}]}]},{"ID":"20240510145740-8enmhht","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240510145740-8enmhht","updated":"20240510145740"},"Children":[{"ID":"20240510145740-s6vhdgj","Type":"NodeParagraph","Properties":{"id":"20240510145740-s6vhdgj","updated":"20240510145823"},"Children":[{"Type":"NodeText","Data":"阴影计算 —— 根据光源等信息，计算片元是否处于阴影中，影响"},{"Type":"NodeTextMark","TextMarkType":"u","TextMarkTextContent":"其最终颜色"}]}]}]},{"ID":"20240510145716-e2c1nqd","Type":"NodeParagraph","Properties":{"id":"20240510145716-e2c1nqd","updated":"20240510145735"},"Children":[{"Type":"NodeText","Data":"等等，对于我们来说"},{"Type":"NodeTextMark","TextMarkType":"strong u","TextMarkTextContent":"片元着色器是完全可编程的"}]}]},{"ID":"20240510145910-zlkic35","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240510145910-zlkic35","updated":"20240612210453"},"Children":[{"ID":"20240510145910-ej1lls6","Type":"NodeParagraph","Properties":{"id":"20240510145910-ej1lls6","updated":"20240510150411"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong u","TextMarkTextContent":"逐片元操作（输出合并阶段）"},{"Type":"NodeText","Data":"：\n"}]},{"ID":"20240510150415-qjvrlcw","Type":"NodeParagraph","Properties":{"id":"20240510150415-qjvrlcw","updated":"20240510150415"},"Children":[{"Type":"NodeText","Data":"它主要完成对 片元着色器 输出数据（最终颜色、法线、纹理坐标、深度等）进行各种处理和计算\n逐片元操作主要完成的工作主要有："}]},{"ID":"20240510150424-ex0eqm0","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240510150424-ex0eqm0","style":"background-color: var(--b3-card-success-background); color: var(--b3-card-success-color);","updated":"20240612210453"},"Children":[{"ID":"20240510150425-bgqbbvn","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240510150425-bgqbbvn","updated":"20240612210448"},"Children":[{"ID":"20240510150425-pm7is7y","Type":"NodeParagraph","Properties":{"id":"20240510150425-pm7is7y","updated":"20240612210448"},"Children":[{"Type":"NodeText","Data":"决定每个片元的可见性，比如"},{"Type":"NodeTextMark","TextMarkType":"strong u","TextMarkTextContent":"深度测试"},{"Type":"NodeText","Data":"、模板测试"}]}]},{"ID":"20240510150425-nqoqtco","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240510150425-nqoqtco","updated":"20240612210453"},"Children":[{"ID":"20240510150425-oq1fbi7","Type":"NodeParagraph","Properties":{"id":"20240510150425-oq1fbi7","updated":"20240612210453"},"Children":[{"Type":"NodeText","Data":"如果通过了所有测试，需要把片元的颜色值和已经存储在颜色缓冲区的颜色进行合并（"},{"Type":"NodeTextMark","TextMarkType":"strong u","TextMarkTextContent":"混合"},{"Type":"NodeText","Data":"）"}]}]}]},{"ID":"20240510150417-2nru3yf","Type":"NodeParagraph","Properties":{"id":"20240510150417-2nru3yf","updated":"20240510150419"},"Children":[{"Type":"NodeText","Data":"等等，对于我们来说逐片元操作是可配置的"}]}]}]},{"ID":"20240510145323-jwclser","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240510145323-jwclser","updated":"20240612222103"},"Children":[{"Type":"NodeText","Data":"光栅化阶段为渲染准备了些什么"}]},{"ID":"20240510150638-ofnzex7","Type":"NodeParagraph","Properties":{"id":"20240510150638-ofnzex7","updated":"20240510144704"},"Children":[{"Type":"NodeText","Data":"在渲染管线（流水线）的光栅化阶段，最主要做的工作就是，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"对片元（像素）进行最终处理"},{"Type":"NodeText","Data":"\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"最主要完成的就是确定片元（像素）最终是否渲染到屏幕上，并且确定其的最终渲染的颜色效果"}]},{"ID":"20240510150648-bgrpydg","Type":"NodeParagraph","Properties":{"id":"20240510150648-bgrpydg","updated":"20240510144704"},"Children":[{"Type":"NodeText","Data":"对于我们来说，我们只要在片元着色器中进行一些处理就可以带来不同的表现效果的体现\n比如：逼真的水面效果、火焰、黑白、模糊等等效果"}]},{"ID":"20240612210453-qk7d3de","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240612210453-qk7d3de","updated":"20240612215721"},"Children":[{"Type":"NodeText","Data":"逐片元操作中的深度测试流程"}]},{"ID":"20240612215235-3v73glr","Type":"NodeParagraph","Properties":{"id":"20240612215235-3v73glr","updated":"20240612215411"},"Children":[{"Type":"NodeText","Data":"深度测试和深度写入共同决定了多个物体在屏幕上的显示情况，当多个物体之间相互存在遮挡时，深度测试将确保正确渲染未被遮挡的模型"}]},{"ID":"20240612214524-9uyvrgg","Type":"NodeList","ListData":{},"Properties":{"id":"20240612214524-9uyvrgg","updated":"20240612215721"},"Children":[{"ID":"20240612214532-5uw3qw3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"alias":"深度写入","id":"20240612214532-5uw3qw3","name":"深度缓冲","updated":"20240612215721"},"Children":[{"ID":"20240612214532-cgypiub","Type":"NodeParagraph","Properties":{"id":"20240612214532-cgypiub","updated":"20240612214532"},"Children":[{"Type":"NodeText","Data":"深度缓冲（Depth Buffer）：\n"}]},{"ID":"20240612214534-qgw77ky","Type":"NodeParagraph","Properties":{"id":"20240612214534-qgw77ky","updated":"20240612215721"},"Children":[{"Type":"NodeText","Data":"深度缓冲是一个与屏幕像素对应的缓冲区，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"它用于存储每个像素的深度值（距离相机的距离）。"},{"Type":"NodeText","Data":"\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"在渲染场景之前，深度缓冲被初始化为最大深度值，表示所有像素都在相机之外。"},{"Type":"NodeText","Data":"最后留在深度缓冲中的信息会被渲染"}]}]},{"ID":"20240612214552-xrusdmd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612214552-xrusdmd","updated":"20240612214552"},"Children":[{"ID":"20240612214552-ke8dyne","Type":"NodeParagraph","Properties":{"id":"20240612214552-ke8dyne","updated":"20240612214555"},"Children":[{"Type":"NodeText","Data":"深度测试"}]},{"ID":"20240612214607-et5vp2b","Type":"NodeParagraph","Properties":{"id":"20240612214607-et5vp2b","updated":"20240612214704"},"Children":[{"Type":"NodeText","Data":"深度测试的主要目的是确保在渲染时，像素按照正确的深度（距离相机的距离）顺序进行绘制，从而创建正确的遮挡关系和透视效果\n在渲染场景之前，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"深度缓冲被初始化为最大深度值，表示所有像素都在相机之外。"},{"Type":"NodeText","Data":"\n在渲染过程中，对于每个像素，深度测试会将当前像素的深度值与深度缓冲中对应位置的值进行比较。"}]},{"ID":"20240612211652-89qhec2","Type":"NodeParagraph","Properties":{"id":"20240612211652-89qhec2","updated":"20240612211652"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 573px;","style":"width: 563px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240612211652-cdg1xnh.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 563px;\" parent-style=\"width: 573px;\"}"},{"Type":"NodeText","Data":"​​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 347px;","style":"width: 337px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"深度测试图"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/深度测试图-20240612210658-10voptu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 337px;\" parent-style=\"width: 347px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240612211759-ow27hja","Type":"NodeParagraph","Properties":{"id":"20240612211759-ow27hja","updated":"20240612214644"},"Children":[{"Type":"NodeText","Data":"可以简单理解为，深度测试就是用来确认 不同模型所占的同一块屏幕区域 到底需要渲染哪一个模型上对应的颜色\n深度测试会依次将 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"模型所占屏幕上的片元的深度值（Z-Buffer） 与 对应像素的深度缓冲的深度值 比较，"}]},{"ID":"20240612214716-3q3juh3","Type":"NodeParagraph","Properties":{"id":"20240612214716-3q3juh3","updated":"20240612214728"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果这个片元的深度值比深度缓冲区的深度值更小（也就是说离摄像机更近），则通过深度测试，将会被渲染"}]},{"ID":"20240612214613-2mvwjv6","Type":"NodeParagraph","Properties":{"id":"20240612214613-2mvwjv6","updated":"20240612214720"},"Children":[{"Type":"NodeText","Data":"也就是说，一般情况下："}]},{"ID":"20240612214610-qy6ho7m","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240612214610-qy6ho7m","updated":"20240612214610"},"Children":[{"ID":"20240612214610-3jmd98n","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240612214610-3jmd98n","updated":"20240612214610"},"Children":[{"ID":"20240612214610-pz6kjtz","Type":"NodeParagraph","Properties":{"id":"20240612214610-pz6kjtz","updated":"20240612214814"},"Children":[{"Type":"NodeText","Data":"如果当前像素的深度值小于深度缓冲中的值，说明当前像素在其他物体之前，它会被绘制\n如果此模型开启了深度写入，则更新深度缓冲，若没有，则深度缓冲区的深度值不变"}]}]},{"ID":"20240612214610-bsi4ktk","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240612214610-bsi4ktk","updated":"20240612214610"},"Children":[{"ID":"20240612214610-q3tdz69","Type":"NodeParagraph","Properties":{"id":"20240612214610-q3tdz69","updated":"20240612214610"},"Children":[{"Type":"NodeText","Data":"如果当前像素的深度值大于等于深度缓冲中的值，说明当前像素在其他物体之后，它会被丢弃，不会被绘制，并保持深度缓冲不变。"}]}]}]},{"ID":"20240612214917-a5q14ia","Type":"NodeParagraph","Properties":{"id":"20240612214917-a5q14ia","style":"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color);","updated":"20240612214917"},"Children":[{"Type":"NodeText","Data":"注意，如果一个片元通过了深度测试，但是没有开启深度写入，那么这个片元依然会渲染出来\n也就是说，片元是否会渲染取决于是否通过深度测试，而不是取决于是否存在于深度缓冲区"}]}]},{"ID":"20240612214919-hr6942z","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240612214919-hr6942z","updated":"20240612215627"},"Children":[{"ID":"20240612214919-7anc3m8","Type":"NodeParagraph","Properties":{"id":"20240612214919-7anc3m8","updated":"20240612215539"},"Children":[{"Type":"NodeText","Data":"深度写入"}]},{"ID":"20240612215539-szddvcj","Type":"NodeParagraph","Properties":{"id":"20240612215539-szddvcj","updated":"20240612215627"},"Children":[{"Type":"NodeText","Data":"对于一个通过了深度渲染的片元，如果模型开启了深度写入，则该片元的深度值将被写入到深度缓冲内，与后面的片元进行比较"}]},{"ID":"20240612213836-gdbop0s","Type":"NodeParagraph","Properties":{"id":"20240612213836-gdbop0s","updated":"20240612214442"},"Children":[{"Type":"NodeText","Data":"对于深度写入，一般半透明的模型是不会开启深度写入的，举例：\n假设存在A,B,C三个平面，遮挡关系如下图，其中距离摄像机从近到远的平面依次为：C —— A —— B"}]},{"ID":"20240612213823-srliqog","Type":"NodeParagraph","Properties":{"id":"20240612213823-srliqog","updated":"20240612213823"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 316px;","style":"width: 306px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240612213823-gyk6xo5.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 306px;\" parent-style=\"width: 316px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240612213959-f5fju12","Type":"NodeParagraph","Properties":{"id":"20240612213959-f5fju12","updated":"20240612215008"},"Children":[{"Type":"NodeText","Data":"因此，如果C的和其他平面占屏幕的公共区域的片元开启了深度写入，则A和B与将不能通过深度测试，A和B对应的片元也不会被渲染"}]},{"ID":"20240612215110-11qpvsc","Type":"NodeParagraph","Properties":{"id":"20240612215110-11qpvsc","updated":"20240612215110"},"Children":[{"Type":"NodeText","Data":"但是，如果C是半透明平面，显然我们需要结合后面的A和B的片元的颜色去混合渲染，\n这时我们不能开启C的深度写入，这样A和B对应的片元还是会通过深度测试，可以被渲染出来"}]},{"ID":"20240612215017-mjttg6p","Type":"NodeParagraph","Properties":{"id":"20240612215017-mjttg6p","updated":"20240612215100"},"Children":[{"Type":"NodeText","Data":"如果A也是半透明物体，那么A也不能开启深度写入，这样B对应的片元才通过深度测试，可以混合渲染颜色"}]}]}]},{"ID":"20240612210556-gikuul5","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240612210556-gikuul5","updated":"20241119124334"},"Children":[{"Type":"NodeText","Data":"逐片元操作中的混合流程"}]},{"ID":"20240612210509-9t0yzj0","Type":"NodeParagraph","Properties":{"id":"20240612210509-9t0yzj0","updated":"20240612222054"},"Children":[{"Type":"NodeText","Data":"混合操作是在深度测试后执行的，通过深度测试流程的片元才能去进行混合，混合过后会将像素的颜色存储到对应的颜色缓冲区"}]},{"ID":"20240612222051-yejte05","Type":"NodeParagraph","Properties":{"id":"20240612222051-yejte05","updated":"20240612222051"},"Children":[{"Type":"NodeText","Data":"混合操作是3D图形渲染中的一个重要步骤，它涉及到如何将半透明物体的颜色与背后物体的颜色结合起来。"}]},{"ID":"20240612222051-02r8x4y","Type":"NodeParagraph","Properties":{"id":"20240612222051-02r8x4y","updated":"20240612222103"},"Children":[{"Type":"NodeText","Data":"在深度测试之后，如果一个片段（即像素）通过了测试，接下来就会进行"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"混合操作"},{"Type":"NodeText","Data":"（Blending）。\n混合操作决定了这个片段的最终颜色如何根据其透明度与背后的颜色合成。\n混合操作通常用于实现物体的透明度效果，比如玻璃、水、烟雾等。"}]},{"ID":"20240612221509-gewic1o","Type":"NodeParagraph","Properties":{"id":"20240612221509-gewic1o","updated":"20240612210603"},"Children":[{"Type":"NodeText","Data":"混合流程如下："}]},{"ID":"20240612221446-fxrid4d","Type":"NodeParagraph","Properties":{"id":"20240612221446-fxrid4d","updated":"20241119124334"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"style":"width: 411px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20241119124316-rv7dvdn.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 411px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240612221720-ysxw0ka","Type":"NodeParagraph","Properties":{"id":"20240612221720-ysxw0ka","updated":"20240612210603"}}]}