{"ID":"20230804204346-yi182l2","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230804204346-yi182l2","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20230804204346-yi182l2\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20230804204346-pcj5nop\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20230819192910-e03ar5y\u0026quot;,\u0026quot;scrollTop\u0026quot;:642,\u0026quot;focusId\u0026quot;:\u0026quot;20230804204346-pcj5nop\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0\u0026#125;","title":"U3L14-3——代码控制动画状态机切换","type":"doc","updated":"20250206103003"},"Children":[{"ID":"20230804204346-pcj5nop","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230804204346-pcj5nop","updated":"20230804213707"},"Children":[{"Type":"NodeText","Data":"关键组件Animator参数相关"}]},{"ID":"20230804213804-gtjirsx","Type":"NodeSuperBlock","Properties":{"id":"20230804213804-gtjirsx","updated":"20230809224321"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20230804213801-4alp31x","Type":"NodeParagraph","Properties":{"id":"20230804213801-4alp31x","updated":"20230804213804"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20230804213801-y6iod2x.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20230804213723-lgdrn0d","Type":"NodeList","ListData":{},"Properties":{"id":"20230804213723-lgdrn0d","updated":"20230809224321"},"Children":[{"ID":"20230804213723-tcu3f4o","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213723-tcu3f4o","updated":"20230804213723"},"Children":[{"ID":"20230804213723-hcuthci","Type":"NodeParagraph","Properties":{"id":"20230804213723-hcuthci","updated":"20230804213809"},"Children":[{"Type":"NodeText","Data":"Controller：对应的动画控制器（状态机）"}]}]},{"ID":"20230804213811-a8g5ojd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213811-a8g5ojd","updated":"20230808172900"},"Children":[{"ID":"20230804213811-orfej1n","Type":"NodeParagraph","Properties":{"id":"20230804213811-orfej1n","updated":"20230808172900"},"Children":[{"Type":"NodeText","Data":"Avatar：对应的替身配置信息（"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20230807204448-3y82b13","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"之后讲解3D模型时详细讲解"},{"Type":"NodeText","Data":"）"}]}]},{"ID":"20230804213817-672wvho","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213817-672wvho","updated":"20230809224321"},"Children":[{"ID":"20230804213817-602vmxu","Type":"NodeParagraph","Properties":{"id":"20230804213817-602vmxu","updated":"20230809224307"},"Children":[{"Type":"NodeText","Data":"Apply Root Motion：是否启用动画位移更新\n"}]},{"ID":"20230809224309-lxjiymp","Type":"NodeParagraph","Properties":{"id":"20230809224309-lxjiymp","updated":"20230809224321"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color);"},"TextMarkType":"text","TextMarkTextContent":"如果要使用"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color);\"}"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-font-background2);"},"TextMarkType":"block-ref text","TextMarkBlockRefID":"20230808223358-m7t4esu","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"动作目标匹配"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-font-background2);\"}"},{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color);"},"TextMarkType":"text","TextMarkTextContent":"，则该选项必须启用！"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color);\"}"}]}]},{"ID":"20230804213824-u21kqta","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213824-u21kqta"},"Children":[{"ID":"20230804213824-kp5386d","Type":"NodeParagraph","Properties":{"id":"20230804213824-kp5386d","updated":"20230804213833"},"Children":[{"Type":"NodeText","Data":"UpdateMode：更新模式（一般不修改它）"}]},{"ID":"20230804213835-rzhcwwp","Type":"NodeList","ListData":{},"Properties":{"id":"20230804213835-rzhcwwp"},"Children":[{"ID":"20230804213834-gqhi96j","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213834-gqhi96j"},"Children":[{"ID":"20230804213834-105zybu","Type":"NodeParagraph","Properties":{"id":"20230804213834-105zybu","updated":"20230804213856"},"Children":[{"Type":"NodeText","Data":"Normal：正常更新"}]}]},{"ID":"20230804213857-qmx32li","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213857-qmx32li"},"Children":[{"ID":"20230804213857-el4c67n","Type":"NodeParagraph","Properties":{"id":"20230804213857-el4c67n"},"Children":[{"Type":"NodeText","Data":"Animate Physics：物理更新"}]}]},{"ID":"20230804213839-krgj9kh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213839-krgj9kh"},"Children":[{"ID":"20230804213839-o7q1tdo","Type":"NodeParagraph","Properties":{"id":"20230804213839-o7q1tdo","updated":"20230804213841"},"Children":[{"Type":"NodeText","Data":"Unscaled "},{"Type":"NodeText","Data":"Time"},{"Type":"NodeText","Data":"：不受时间缩放影响"}]}]}]}]},{"ID":"20230804213829-oadkd5k","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213829-oadkd5k","updated":"20230804213945"},"Children":[{"ID":"20230804213829-zchbr9p","Type":"NodeParagraph","Properties":{"id":"20230804213829-zchbr9p","updated":"20230804213906"},"Children":[{"Type":"NodeText","Data":"Culling Mode：裁剪剔除模式"}]},{"ID":"20230804213918-p5wgtbr","Type":"NodeList","ListData":{},"Properties":{"id":"20230804213918-p5wgtbr","updated":"20230804213945"},"Children":[{"ID":"20230804213908-4uumed7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213908-4uumed7","updated":"20230804213939"},"Children":[{"ID":"20230804213908-vdjagzb","Type":"NodeParagraph","Properties":{"id":"20230804213908-vdjagzb","updated":"20230804213939"},"Children":[{"Type":"NodeText","Data":"Always Animate：始终播放动画，即使在屏幕外也不剔除"}]}]},{"ID":"20230804213925-kiul9g0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213925-kiul9g0","updated":"20230804213945"},"Children":[{"ID":"20230804213925-7u0d5gt","Type":"NodeParagraph","Properties":{"id":"20230804213925-7u0d5gt","updated":"20230804213945"},"Children":[{"Type":"NodeText","Data":"Cull Update Transforms：摄像机没有渲染该物体时，停止位置、IK的写入"}]}]},{"ID":"20230804213930-hlyl07c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230804213930-hlyl07c"},"Children":[{"ID":"20230804213930-de8zjb2","Type":"NodeParagraph","Properties":{"id":"20230804213930-de8zjb2"},"Children":[{"Type":"NodeText","Data":"Cull Completely：摄像机没有渲染物体时，整个动画被完全禁用"}]}]}]}]}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20230804230421-6zhu8bz","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230804230421-6zhu8bz","updated":"20250206103003"},"Children":[{"Type":"NodeText","Data":"本章代码关键字"}]},{"ID":"20230804230431-julv0q1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230804230431-julv0q1","updated":"20250206103003"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"Animator                                //动画状态机类\nanimator.SetFloat()                     //设置状态机的float类型条件\nanimator.SetInteger()                   //设置状态机的Bool类型条件\nanimator.SetBool()                      //设置状态机的Int类型条件\nanimator.SetTrigger()                   //设置状态机的Trigger类型条件\nanimator.GetFloat()                     //获取状态机的Float类型的值\nanimator.GetInteger()                   //获取状态机的Int类型的值\nanimator.GetBool()                      //获取状态机的Bool类型的值\nanimator.Play()                         //直接切换到某个动画\nanimator.runtimeAnimatorController      //动画状态机使用的状态机文件\nRuntimeAnimatorController               //状态机文件类\nanimator.speed\t\t\t\t\t\t\t//状态机播放速度\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230804213959-g1gofge","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230804213959-g1gofge","updated":"20230804224121"},"Children":[{"Type":"NodeText","Data":"Animator中的API"}]},{"ID":"20230804224121-nsqykry","Type":"NodeParagraph","Properties":{"id":"20230804224121-nsqykry","updated":"20240321175519"},"Children":[{"Type":"NodeText","Data":"我们用代码控制状态机切换主要使用的就是Animator提供给我们的API\n我们知道一共有四种切换条件 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"int"},{"Type":"NodeText","Data":"​ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"float"},{"Type":"NodeText","Data":"​ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"bool"},{"Type":"NodeText","Data":"​ "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"trigger"},{"Type":"NodeText","Data":"​\n所以对应的API也是和这四种类型有关系的"}]},{"ID":"20230804224132-e0jcwvi","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230804224132-e0jcwvi","updated":"20230804224300"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"animator = GetComponent\u003cAnimator\u003e();\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230804224302-kwb6cao","Type":"NodeHeading","HeadingLevel":3,"Properties":{"alias":"animator.SetInteger(),animator.SetBool(),animator.SetTrigger()","id":"20230804224302-kwb6cao","name":"animator.SetFloat()","updated":"20230804224346"},"Children":[{"Type":"NodeText","Data":"通过状态机条件切换动画"}]},{"ID":"20230804224339-7lc84fs","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230804224339-7lc84fs","updated":"20230804224358"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"animator.SetFloat(\"条件名\", 1.2f);\nanimator.SetInteger(\"条件名\", 5);\nanimator.SetBool(\"条件名\", true);\nanimator.SetTrigger(\"条件名\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230804225553-4y3f8sy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230804225553-4y3f8sy","updated":"20230804225603"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"if (Input.GetKeyDown(KeyCode.A))\n{\n    animator.SetBool(\"change\", true);\n}\nif (Input.GetKeyDown(KeyCode.S))\n{\n    animator.SetBool(\"change\", false);\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230804225542-thse3n1","Type":"NodeParagraph","Properties":{"id":"20230804225542-thse3n1","updated":"20230804225550"},"Children":[{"Type":"NodeText","Data":"   ···"}]},{"ID":"20230804225346-8rmm9ar","Type":"NodeHeading","HeadingLevel":3,"Properties":{"alias":"animator.GetInteger(),animator.GetBool()","id":"20230804225346-8rmm9ar","name":"animator.GetFloat()","updated":"20230804225547"},"Children":[{"Type":"NodeText","Data":"获取状态机条件对应的值"}]},{"ID":"20230804225359-dd2u4gk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230804225359-dd2u4gk","updated":"20230804225415"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"animator.GetFloat(\"条件名\");\nanimator.GetInteger(\"条件名\");\nanimator.GetBool(\"条件名\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230804225419-h16ksb5","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230804225419-h16ksb5","name":"animator.Play()","updated":"20230804225708"},"Children":[{"Type":"NodeText","Data":"直接切换动画"}]},{"ID":"20230804225705-4si0xcm","Type":"NodeParagraph","Properties":{"id":"20230804225705-4si0xcm"},"Children":[{"Type":"NodeText","Data":"除非特殊情况 不然一般不使用"}]},{"ID":"20230804225834-t4pvsxu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230804225834-t4pvsxu","updated":"20230804230226"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"animator.Play(\"状态名\");\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230804230405-j919se5","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230804230405-j919se5","name":"animator.runtimeAnimatorController","updated":"20250205142806"},"Children":[{"Type":"NodeText","Data":"动画状态机加载状态机文件"}]},{"ID":"20230819192937-dlj8cl4","Type":"NodeParagraph","Properties":{"id":"20230819192937-dlj8cl4","updated":"20250205142806"},"Children":[{"Type":"NodeText","Data":"如果动画要加载某个状态机文件，需要注意属性名为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"runtimeAnimatorController"},{"Type":"NodeText","Data":"​，使用"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"RuntimeAnimatorController"},{"Type":"NodeText","Data":"​类"}]},{"ID":"20230819192910-e03ar5y","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230819192910-e03ar5y","updated":"20230819192935"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"animator.runtimeAnimatorController = Resources.Load\u003cRuntimeAnimatorController\u003e(info.animator);\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20250205142800-1ih67th","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20250205142800-1ih67th","name":"animator.speed","updated":"20250205143119"},"Children":[{"Type":"NodeText","Data":"控制动画状态机暂停与播放速度"}]},{"ID":"20250205142841-3ue63yn","Type":"NodeParagraph","Properties":{"id":"20250205142841-3ue63yn","updated":"20250205143119"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"animator.speed"},{"Type":"NodeText","Data":"​ 可以控制动画状态机中动画播放的速度，当 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"animator.speed == 0"},{"Type":"NodeText","Data":"​ 时，动画播放暂停，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"animator.speed == 1"},{"Type":"NodeText","Data":"​ 时，动画正常播放"}]},{"ID":"20250205143030-f081k9g","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20250205143030-f081k9g","updated":"20250205143106"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"animator.speed = 0;\t\t// 暂停动画\nanimator.speed = 1;\t\t// 正常播放动画\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}