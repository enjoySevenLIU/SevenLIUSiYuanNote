{
	"ID": "20240428211727-5kbqc59",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20240428211727-5kbqc59",
		"title": "UH4L18——基本原理",
		"type": "doc",
		"updated": "20240501141646"
	},
	"Children": [
		{
			"ID": "20240428212404-os1rcyn",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20240428212404-os1rcyn",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "ILRuntime基本原理"
				}
			]
		},
		{
			"ID": "20240428212410-5fc4iwb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428212410-5fc4iwb",
				"updated": "20240428214854"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "ILRuntime借助"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "Mono.Cecil"
				},
				{
					"Type": "NodeText",
					"Data": "​库来读取DLL中的IL汇编码，然后通过内置的IL解释执行虚拟机来执行DLL中的代码"
				}
			]
		},
		{
			"ID": "20240428211727-2fwfxec",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20240428211727-2fwfxec",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "C#的运行机制"
				}
			]
		},
		{
			"ID": "20240428211807-xac69us",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428211807-xac69us",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "该知识点在 Unity进阶之C"
				},
				{
					"Type": "NodeBackslash",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeText",
							"Data": "#"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "知识补充 中详细讲解过，详见："
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "block-ref",
					"TextMarkBlockRefID": "20231028202105-150d6lr",
					"TextMarkBlockRefSubtype": "d",
					"TextMarkTextContent": "CS5L1——.NET相关知识"
				},
				{
					"Type": "NodeText",
					"Data": "\nC"
				},
				{
					"Type": "NodeBackslash",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeText",
							"Data": "#"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " 通过C"
				},
				{
					"Type": "NodeBackslash",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeText",
							"Data": "#"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "编译器 生成 对应的 CIL（通用中间语言）\n然后通过 CLR（公共语言运行时）将 CIL 解释翻译 为最终的机器码，运行在平台上"
				}
			]
		},
		{
			"ID": "20240428211807-ljet37c",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428211807-ljet37c",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "那么我们生成DLL文件，其中存储的就是我们的 CIL 中间语言，我们可以通过 反编译工具 ILSpy 来查看对应的 IL 中间代码"
				}
			]
		},
		{
			"ID": "20240501141300-yxtm4xo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240501141300-yxtm4xo",
				"updated": "20240501141300"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Properties": {
						"parent-style": "width: 848px;",
						"style": "width: 838px;"
					},
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "image"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/image-20240501141300-jnhc96y.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeKramdownSpanIAL",
					"Data": "{: style=\"width: 838px;\" parent-style=\"width: 848px;\"}"
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20240501141303-qlimxnt",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20240501141303-qlimxnt",
				"updated": "20240501141444"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20240501141305-vkom1d7",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20240501141305-vkom1d7",
						"updated": "20240501141444"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "注：上图不是ILSpy而是dySpy，就查看IL中间代码的能力是一致的，dySpy已停更"
						}
					]
				}
			]
		},
		{
			"ID": "20240428211807-gbujevm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428211807-gbujevm",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "ILSpy获取地址："
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://github.com/icsharpcode/ILSpy",
					"TextMarkTextContent": "icsharpcode/ILSpy (github.com)"
				}
			]
		},
		{
			"ID": "20240428211933-ewf63h8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428211933-ewf63h8",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "IL的汇编代码中有很多的指令信息，如果想要学习他们，可以前往微软官网查看具体的IL汇编指令的作用"
				}
			]
		},
		{
			"ID": "20240428212015-l2qalfc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428212015-l2qalfc",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://learn.microsoft.com/zh-cn/dotnet/api/system.reflection.emit.opcodes?view=net-8.0",
					"TextMarkTextContent": "OpCodes 类 (System.Reflection.Emit) | Microsoft Learn"
				}
			]
		},
		{
			"ID": "20240428211945-6tw013g",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20240428211945-6tw013g",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "ILRuntime实现热更新的基础——Mono.Cecil库"
				}
			]
		},
		{
			"ID": "20240428212106-9qkhru7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428212106-9qkhru7",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在第一节课"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "block-ref",
					"TextMarkBlockRefID": "20240423211408-ptd87xu",
					"TextMarkBlockRefSubtype": "s",
					"TextMarkTextContent": "搭建环境"
				},
				{
					"Type": "NodeText",
					"Data": "时，我们就提到过"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "code",
					"TextMarkTextContent": "Mono.Cecil"
				},
				{
					"Type": "NodeText",
					"Data": "​库，它是一个第三方库，主要作用有："
				}
			]
		},
		{
			"ID": "20240428212123-530pf2o",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20240428212123-530pf2o",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"ID": "20240428212123-61q8fio",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20240428212123-61q8fio",
						"updated": "20240428212123"
					},
					"Children": [
						{
							"ID": "20240428212123-933m2n7",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212123-933m2n7",
								"updated": "20240428212123"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "读取C#编译的DLL"
								}
							]
						}
					]
				},
				{
					"ID": "20240428212123-hgso7wr",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20240428212123-hgso7wr",
						"updated": "20240428212123"
					},
					"Children": [
						{
							"ID": "20240428212123-rqywtkn",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212123-rqywtkn",
								"updated": "20240428212123"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "可以读取到DLL中的类型和方法元信息"
								}
							]
						}
					]
				},
				{
					"ID": "20240428212123-vivp5qa",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20240428212123-vivp5qa",
						"updated": "20240428212123"
					},
					"Children": [
						{
							"ID": "20240428212123-1qqfkai",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212123-1qqfkai",
								"updated": "20240428212123"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "可以读取方法体中IL汇编指令"
								}
							]
						}
					]
				},
				{
					"ID": "20240428212123-hbcrbll",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20240428212123-hbcrbll",
						"updated": "20240428212123"
					},
					"Children": [
						{
							"ID": "20240428212123-g4j23le",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212123-g4j23le",
								"updated": "20240428212123"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "可以读取PDB调试符号表文件"
								}
							]
						}
					]
				},
				{
					"ID": "20240428212123-yrcqr79",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20240428212123-yrcqr79",
						"updated": "20240428212123"
					},
					"Children": [
						{
							"ID": "20240428212123-qol9mgp",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212123-qol9mgp",
								"updated": "20240428212123"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "可以修改DLL中的元信息和方法体内容并写回DLL"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20240428212115-99g3rim",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428212115-99g3rim",
				"updated": "20240428212410"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "由于它的这些功能，所以被广泛的应用于各种热更方案中，比如"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "block-ref",
					"TextMarkBlockRefID": "20240201182805-3wlp0ju",
					"TextMarkBlockRefSubtype": "s",
					"TextMarkTextContent": "xlua"
				},
				{
					"Type": "NodeText",
					"Data": "和"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "block-ref",
					"TextMarkBlockRefID": "20240227222440-72vmfse",
					"TextMarkBlockRefSubtype": "s",
					"TextMarkTextContent": "tolua"
				},
				{
					"Type": "NodeText",
					"Data": "，而ILRuntime也是基于它来完成我们的热更功能的"
				}
			]
		},
		{
			"ID": "20240428212106-r18q467",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240428212106-r18q467",
				"updated": "20240501141624"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "ILRuntime自己实现了："
				}
			]
		},
		{
			"ID": "20240428212110-6g51t31",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20240428212110-6g51t31",
				"updated": "20240501141646"
			},
			"Children": [
				{
					"ID": "20240428212110-20s5b3h",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20240428212110-20s5b3h",
						"updated": "20240501141628"
					},
					"Children": [
						{
							"ID": "20240428212110-tlv7k4v",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212110-tlv7k4v",
								"updated": "20240501141628"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "block-ref",
									"TextMarkBlockRefID": "20240428220512-ct825b2",
									"TextMarkBlockRefSubtype": "s",
									"TextMarkTextContent": "解释器"
								},
								{
									"Type": "NodeText",
									"Data": "：ILRuntime基于 "
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "code",
									"TextMarkTextContent": "Mono.Cecil"
								},
								{
									"Type": "NodeText",
									"Data": "​ 获取 DLL 文件中的 IL 代码，将他们基于自己的规则翻译并执行\nILRuntime实现的解释器相当于就是一个基于C#的解释执行引擎"
								}
							]
						}
					]
				},
				{
					"ID": "20240428212110-tlc7pyc",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20240428212110-tlc7pyc",
						"updated": "20240501141646"
					},
					"Children": [
						{
							"ID": "20240428212110-7xyii1h",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20240428212110-7xyii1h",
								"updated": "20240501141646"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "block-ref",
									"TextMarkBlockRefID": "20240428214159-1o5pb4k",
									"TextMarkBlockRefSubtype": "s",
									"TextMarkTextContent": "类型系统"
								},
								{
									"Type": "NodeText",
									"Data": "：用于表示原始工程和热更工程中的各种类型、方法、成员、实例对象等等信息\n相当于，ILRuntime帮助我们利用它内部的解释器，将我们实现的代码解释翻译为了自己的一套类型规则\n在真正执行代码时，都是基于ILRuntime自己的类型系统中的规则来执行的"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20240501140905-yimfm1n",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20240501140905-yimfm1n"
			}
		}
	]
}