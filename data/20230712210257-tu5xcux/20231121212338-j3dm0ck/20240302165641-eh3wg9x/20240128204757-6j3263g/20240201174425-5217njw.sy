{"ID":"20240201174425-5217njw","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240201174425-5217njw","title":"UH2S1L13——垃圾回收","type":"doc","updated":"20250109173749"},"Children":[{"ID":"20240201174903-hl9g1pg","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240201174903-hl9g1pg","name":"collectgarbage()","updated":"20240201174917"},"Children":[{"Type":"NodeText","Data":"Lua垃圾回收"}]},{"ID":"20240201174911-5xe6qpo","Type":"NodeParagraph","Properties":{"id":"20240201174911-5xe6qpo","updated":"20240201174957"},"Children":[{"Type":"NodeText","Data":"垃圾回收的关键字是"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"collectgarbage"},{"Type":"NodeText","Data":"​，通过传入特定的字符串使用"}]},{"ID":"20240201175733-1043rzv","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201175733-1043rzv","updated":"20240201175738"},"Children":[{"Type":"NodeText","Data":"本章代码关键字"}]},{"ID":"20240201175738-o85q8ls","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240201175738-o85q8ls","style":"line-height: 22px;","updated":"20240201175835"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bHVh"},{"Type":"NodeCodeBlockCode","Data":"collectgarbage()\t\t\t--这个函数是垃圾收集器的通用接口。 通过参数 opt 它提供了一组不同的功能。\ncollectgarbage(\"count\")\t\t--以K字节数为单位返回 Lua 使用的总内存数\ncollectgarbage(\"collect\")\t--做一次完整的垃圾收集循环\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240201174958-dic0wsv","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201174958-dic0wsv","updated":"20250109173749"},"Children":[{"Type":"NodeText","Data":"获取内存占用"}]},{"ID":"20240201175035-e06of3e","Type":"NodeParagraph","Properties":{"id":"20240201175035-e06of3e","updated":"20250109173749"},"Children":[{"Type":"NodeText","Data":"以 K 字节数为单位返回 Lua 使用的总内存数，用返回值 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"*1024"},{"Type":"NodeText","Data":"​，就可以得到具体的内存占用字节数"}]},{"ID":"20240201175016-wb4xy4a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240201175016-wb4xy4a","style":"line-height: 22px;","updated":"20240201175236"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bHVh"},{"Type":"NodeCodeBlockCode","Data":"test = {id = 1, name = \"123123\"}\nprint(collectgarbage(\"count\"))\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240201175124-q6k9ie1","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240201175124-q6k9ie1","updated":"20250109173748"},"Children":[{"Type":"NodeText","Data":"进行垃圾回收"}]},{"ID":"20240201175237-llc2qzi","Type":"NodeParagraph","Properties":{"id":"20240201175237-llc2qzi","updated":"20250109173748"},"Children":[{"Type":"NodeText","Data":"做一次完整的垃圾收集循环，将内存内未被变量引用的数据释放掉，类似于 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 的 GC"}]},{"ID":"20240201175553-1e060qq","Type":"NodeParagraph","Properties":{"id":"20240201175553-1e060qq","updated":"20250109173740"},"Children":[{"Type":"NodeText","Data":"lua 中，有自动定时进行GC的方法，但是在 Unity 中进行热更新开发，尽量不要使用自动垃圾回收"}]},{"ID":"20240201175306-4hfwgnz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240201175306-4hfwgnz","style":"line-height: 22px;","updated":"20240201175459"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bHVh"},{"Type":"NodeCodeBlockCode","Data":"test = {id = 1, name = \"123123\"}\nprint(collectgarbage(\"count\"))\ntest = nil\nprint(collectgarbage(\"count\"))\ncollectgarbage(\"collect\")\nprint(collectgarbage(\"count\"))"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240201175415-ssnuj5x","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240201175415-ssnuj5x","style":"line-height: 22px;","updated":"20240201175505"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"bHVh"},{"Type":"NodeCodeBlockCode","Data":"20.2822265625\n20.3115234375\n19.1484375"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}