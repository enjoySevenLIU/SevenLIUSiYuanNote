{"ID":"20240416175650-evwvijq","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240416175650-evwvijq","title":"UFL4——事件中心模块","type":"doc","updated":"20240416234338"},"Children":[{"ID":"20240416180333-z530tas","Type":"NodeBlockquote","Properties":{"id":"20240416180333-z530tas","updated":"20240416180403"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240416180333-l22t99f","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240416180333-l22t99f","updated":"20240416180333"},"Children":[{"Type":"NodeText","Data":"前置知识点"}]},{"ID":"20240416180346-nzciajr","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240416180346-nzciajr","updated":"20240416180403"},"Children":[{"ID":"20240416180359-afb8hrd","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240416180359-afb8hrd","updated":"20240416180403"},"Children":[{"ID":"20240416180359-c08zvts","Type":"NodeParagraph","Properties":{"id":"20240416180359-c08zvts","updated":"20240416180403"},"Children":[{"Type":"NodeText","Data":"C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"中"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Dictionary"},{"Type":"NodeText","Data":"​相关知识点（C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"四部曲之C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"进阶中）"}]}]},{"ID":"20240416180359-e8f8ubr","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240416180359-e8f8ubr","updated":"20240416180359"},"Children":[{"ID":"20240416180359-au1d0ls","Type":"NodeParagraph","Properties":{"id":"20240416180359-au1d0ls","updated":"20240416180359"},"Children":[{"Type":"NodeText","Data":"C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"中委托事件相关知识点（C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"四部曲之C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"进阶中）"}]}]},{"ID":"20240416180359-eyfessx","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240416180359-eyfessx","updated":"20240416180359"},"Children":[{"ID":"20240416180359-1p1szcg","Type":"NodeParagraph","Properties":{"id":"20240416180359-1p1szcg","updated":"20240416180359"},"Children":[{"Type":"NodeText","Data":"C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"中泛型相关知识点（C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"四部曲之C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"进阶中）"}]}]},{"ID":"20240416180359-x2dcgio","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240416180359-x2dcgio","updated":"20240416180359"},"Children":[{"ID":"20240416180359-j11aa0i","Type":"NodeParagraph","Properties":{"id":"20240416180359-j11aa0i","updated":"20240416180359"},"Children":[{"Type":"NodeText","Data":"C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"中里式替换原则（C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"四部曲之C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":"核心中）"}]}]},{"ID":"20240416180359-dlgkd5w","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NS4=","Num":5},"Properties":{"id":"20240416180359-dlgkd5w","updated":"20240416180359"},"Children":[{"ID":"20240416180359-vizgzzw","Type":"NodeParagraph","Properties":{"id":"20240416180359-vizgzzw","updated":"20240416180359"},"Children":[{"Type":"NodeText","Data":"观察者设计模式"}]}]}]}]},{"ID":"20240416230117-bqnhkif","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240416230117-bqnhkif","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心模块"}]},{"ID":"20240416203116-zyni2bo","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240416203116-zyni2bo","updated":"20240416230122"},"Children":[{"ID":"20240416203134-q3eszp6","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240416203134-q3eszp6","updated":"20240416203134"},"Children":[{"ID":"20240416203134-yi428fs","Type":"NodeParagraph","Properties":{"id":"20240416203134-yi428fs","updated":"20240416203134"},"Children":[{"Type":"NodeText","Data":"事件中心的主要作用\n"}]},{"ID":"20240416203139-mrlz2ph","Type":"NodeParagraph","Properties":{"id":"20240416203139-mrlz2ph","updated":"20240416203141"},"Children":[{"Type":"NodeText","Data":"解耦程序模块，降低程序耦合度，它可以降低游戏中不同模块的耦合度\n不需要直接引用或依赖于彼此的具体实现"}]}]},{"ID":"20240416203135-i9xvdgp","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240416203135-i9xvdgp","updated":"20240416203148"},"Children":[{"ID":"20240416203135-nsoiuir","Type":"NodeParagraph","Properties":{"id":"20240416203135-nsoiuir"},"Children":[{"Type":"NodeText","Data":"事件中心的基本原理\n"}]},{"ID":"20240416203144-oxhgphw","Type":"NodeParagraph","Properties":{"id":"20240416203144-oxhgphw","updated":"20240416203148"},"Children":[{"Type":"NodeText","Data":"利用字典和委托相关的知识点，再结合观察者设计模式的基本原理\n实现一个中心化的机制，使得多个系统、模块、对象之间可以进行松耦合的通信"}]}]}]},{"ID":"20240416175650-4nd9ny2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416175650-4nd9ny2","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"举例抛出问题"}]},{"ID":"20240416195041-yjg5kuw","Type":"NodeSuperBlock","Properties":{"id":"20240416195041-yjg5kuw","updated":"20240416230122"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"col"},{"ID":"20240416195039-hsuxbf3","Type":"NodeParagraph","Properties":{"id":"20240416195039-hsuxbf3","updated":"20240416195042"},"Children":[{"Type":"NodeText","Data":"在以前，没有事件中心的时候，\n面对一个对象被修改时其它对象要做自动更新的问题：\n例如一个怪物死亡，需要让其它对象例如玩家执行什么方法，\n我们可能就会让怪物关联这些对象，然后在死亡的方法里调用这些对象"}]},{"ID":"20240416180423-138y2aj","Type":"NodeParagraph","Properties":{"id":"20240416180423-138y2aj","updated":"20240416180423"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 558px;","style":"width: 548px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240416180423-yt17w9d.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 548px;\" parent-style=\"width: 558px;\"}"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeSuperBlockCloseMarker"}]},{"ID":"20240416201030-mkvkqud","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240416201030-mkvkqud","style":"line-height: 22px;","updated":"20240416230122"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"using UnityEngine;\n\npublic class Monster : MonoBehaviour\n{\n    void Start()\n    {\n        Dead();\n    }\n\n    void Dead()\n    {\n        Debug.Log(\"怪物死亡了\");\n        //其他对象在怪物死亡时要做的事情\n        //1.任务更新\n        GameObject.Find(\"Task\").GetComponent\u003cTask\u003e().TaskWaitMonsterDeadDo();\n        //2.玩家得奖励\n        GameObject.Find(\"Player\").GetComponent\u003cPlayer\u003e().PlayerWaitMonsterDeadDo();\n        //3.其他相关系统\n        GameObject.Find(\"Other\").GetComponent\u003cOther\u003e().OtherWaitMonsterDeadDo();\n        //n个其他相关处理..\n\t\t//...\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240416180432-exhpe55","Type":"NodeParagraph","Properties":{"id":"20240416180432-exhpe55","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"目前这种常规处理方式，我们发现了问题：系统、模块和对象之间耦合度较高\n目前只是怪物死亡的例子，就发现"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"对象和模块之间会出现彼此相互引用和依赖"},{"Type":"NodeText","Data":"\n那么当游戏复杂了，各个系统、模块、对象之间会存在错综复杂的关系，非常不利于我们进行开发"}]},{"ID":"20240416201459-p2ub1ob","Type":"NodeParagraph","Properties":{"id":"20240416201459-p2ub1ob","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"而且显然，怪物对象死亡后其他对象要做什么显然也不应该在怪物类里去找各个对象一个一个执行"}]},{"ID":"20240416195052-gg5jxs2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416195052-gg5jxs2","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心的主要作用"}]},{"ID":"20240416195545-xhav4be","Type":"NodeParagraph","Properties":{"id":"20240416195545-xhav4be","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心的主要作用是：解耦程序模块，降低程序耦合度，它可以降低游戏中不同模块的耦合度，不需要直接引用或依赖于彼此的具体实现"}]},{"ID":"20240416195617-ue9efzi","Type":"NodeParagraph","Properties":{"id":"20240416195617-ue9efzi","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心可以让需要监听某个事件的执行者"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"主动上传监听到事件后要执行的方法，等待事件的触发，而不需要关心谁触发这个事件"},{"Type":"NodeText","Data":"\n而事件的触发者只需要向事件中心触发事件，而"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"无需关心有哪些对象需要监听这个事件"}]},{"ID":"20240416200025-vwcggi9","Type":"NodeParagraph","Properties":{"id":"20240416200025-vwcggi9","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"由此，触发者不再需要主动关联很多对象，达到了解耦的目的"}]},{"ID":"20240416195940-xds1353","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416195940-xds1353","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心的基本原理"}]},{"ID":"20240416195742-7uve12b","Type":"NodeParagraph","Properties":{"id":"20240416195742-7uve12b","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心的基本原理：通过一个中心化的机制，使得多个系统、模块、对象之间可以进行松耦合的通信\n我们只需要利用字典和委托相关的知识点，再结合观察者设计模式的基本原理便可以制作出事件中心模块"}]},{"ID":"20240416202618-jokomyy","Type":"NodeParagraph","Properties":{"id":"20240416202618-jokomyy","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 829px;","style":"width: 819px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240416202618-q98vnm6.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 819px;\" parent-style=\"width: 829px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240416201749-9kmm0nr","Type":"NodeBlockquote","Properties":{"id":"20240416201749-9kmm0nr","updated":"20240416230122"},"Children":[{"ID":"20240416201814-hp5wa9e","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240416201814-hp5wa9e","updated":"20240416201823"},"Children":[{"Type":"NodeText","Data":"观察者设计模式"}]},{"Type":"NodeBlockquoteMarker","Data":"\u003e","Properties":{"updated":"20240416201823"}},{"ID":"20240416201810-ynn0hwn","Type":"NodeParagraph","Properties":{"id":"20240416201810-ynn0hwn","updated":"20240416201823"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.runoob.com/design-pattern/observer-pattern.html","TextMarkTextContent":"观察者模式 | 菜鸟教程 (runoob.com)"}]},{"ID":"20240416201810-tsrvju8","Type":"NodeParagraph","Properties":{"id":"20240416201810-tsrvju8","updated":"20240416202906"},"Children":[{"Type":"NodeText","Data":"观察者模式是一种行为型设计模式，它定义了一种一对多的依赖关系，当一个对象的状态发生改变时，其所有依赖者都会收到通知并自动更新"}]},{"ID":"20240416203001-xuwq4b4","Type":"NodeParagraph","Properties":{"id":"20240416203001-xuwq4b4","updated":"20240416203001"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 611px;","style":"width: 601px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240416203001-77nmz3w.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 601px;\" parent-style=\"width: 611px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240416201810-h2lap3d","Type":"NodeParagraph","Properties":{"id":"20240416201810-h2lap3d","updated":"20240416203011"},"Children":[{"Type":"NodeText","Data":"当对象间存在一对多关系时，则使用观察者模式（Observer Pattern）\n比如，当一个对象被修改时，则会自动通知依赖它的对象。观察者模式属于行为型模式。"}]},{"ID":"20240416201810-611dmpd","Type":"NodeParagraph","Properties":{"id":"20240416201810-611dmpd","updated":"20240416201823"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"意图："},{"Type":"NodeText","Data":"定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。"}]},{"ID":"20240416201810-r6s0wj1","Type":"NodeParagraph","Properties":{"id":"20240416201810-r6s0wj1","updated":"20240416201823"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"主要解决："},{"Type":"NodeText","Data":"一个对象状态改变给其他对象通知的问题，而且要考虑到易用和低耦合，保证高度的协作。"}]},{"ID":"20240416201810-2zbjxh2","Type":"NodeParagraph","Properties":{"id":"20240416201810-2zbjxh2","updated":"20240416201823"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"何时使用："},{"Type":"NodeText","Data":"一个对象（目标对象）的状态发生改变，所有的依赖对象（观察者对象）都将得到通知，进行广播通知。"}]},{"ID":"20240416201810-h4m8wqg","Type":"NodeParagraph","Properties":{"id":"20240416201810-h4m8wqg","updated":"20240416201823"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"优点："},{"Type":"NodeText","Data":"\n1、观察者和被观察者是抽象耦合的。\n2、建立一套触发机制。"}]},{"ID":"20240416201810-zpo5k3j","Type":"NodeParagraph","Properties":{"id":"20240416201810-zpo5k3j","updated":"20240416201823"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"缺点："},{"Type":"NodeText","Data":"\n1、如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者都通知到会花费很多时间。\n2、如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。\n3、观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。"}]}]},{"ID":"20240416201740-h3udu05","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416201740-h3udu05","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"具体实现"}]},{"ID":"20240416203215-ltdglk5","Type":"NodeParagraph","Properties":{"id":"20240416203215-ltdglk5","updated":"20240416230122"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240416203222-m1s2nce","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"事件中心具体实现"}]},{"ID":"20240416211024-0ombmbi","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416211024-0ombmbi","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心传递参数"}]},{"ID":"20240416211036-h252o6q","Type":"NodeParagraph","Properties":{"id":"20240416211036-h252o6q","updated":"20240416230122"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240416211056-srzlggs","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"事件中心传递参数"}]},{"ID":"20240416213555-s1aocww","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416213555-s1aocww","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心传递自定义参数"}]},{"ID":"20240416213619-jcvmfre","Type":"NodeParagraph","Properties":{"id":"20240416213619-jcvmfre","updated":"20240416230122"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240416213630-v1qjbb6","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"事件中心传递自定义参数"}]},{"ID":"20240416224319-ocg3x8v","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240416224319-ocg3x8v","updated":"20240416230122"},"Children":[{"Type":"NodeText","Data":"事件中心的事件名优化"}]},{"ID":"20240416224335-mq2o959","Type":"NodeParagraph","Properties":{"id":"20240416224335-mq2o959","updated":"20240416230122"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240416224345-7b0cqng","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"事件中心的事件名优化"}]},{"ID":"20240416234338-5x5a3s1","Type":"NodeParagraph","Properties":{"id":"20240416234338-5x5a3s1"}}]}