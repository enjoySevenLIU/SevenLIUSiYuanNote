{"ID":"20240402214400-xyw9yx4","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240402214400-xyw9yx4","title":"UM3L3——Android中调用Unity内容","type":"doc","updated":"20250303190054"},"Children":[{"ID":"20240402220111-l8a6se3","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240402220111-l8a6se3","updated":"20240402220118"},"Children":[{"Type":"NodeText","Data":"本章代码关键字"}]},{"ID":"20240402220118-l1dpi28","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240402220118-l1dpi28","style":"line-height: 22px;","updated":"20240402220354"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"UnityPlayer.UnitySendMessage()\t//在安卓内执行Unity内内容，传入场景上的对象，再传入要调用的脚本的方法，再传入字符串参数\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240402214400-fe5766c","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240402214400-fe5766c","updated":"20250303190039"},"Children":[{"Type":"NodeText","Data":"Android 调用 Unity 规则"}]},{"ID":"20240402214532-4oegoo0","Type":"NodeParagraph","Properties":{"id":"20240402214532-4oegoo0","updated":"20250303190017"},"Children":[{"Type":"NodeText","Data":"Android 调用 Unity 相对比较简单，在 Android 端使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnityPlayer.UnitySendMessage"},{"Type":"NodeText","Data":"​ API即可"}]},{"ID":"20240402214417-s2whyxk","Type":"NodeParagraph","Properties":{"id":"20240402214417-s2whyxk","updated":"20250303190039"},"Children":[{"Type":"NodeText","Data":"想要被 Android 端调用的 Unity 函数"}]},{"ID":"20240402214424-07i0vpi","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240402214424-07i0vpi","updated":"20250303190025"},"Children":[{"ID":"20240402214424-h2e9fl1","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240402214424-h2e9fl1","updated":"20250303190023"},"Children":[{"ID":"20240402214424-zq71pqc","Type":"NodeParagraph","Properties":{"id":"20240402214424-zq71pqc","updated":"20250303190023"},"Children":[{"Type":"NodeText","Data":"需要写在继承 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"MonoBehaviour"},{"Type":"NodeText","Data":"​ 的脚本中"}]}]},{"ID":"20240402214424-bglsotu","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240402214424-bglsotu","updated":"20250303190025"},"Children":[{"ID":"20240402214424-p8q74xl","Type":"NodeParagraph","Properties":{"id":"20240402214424-p8q74xl","updated":"20250303190025"},"Children":[{"Type":"NodeText","Data":"需要挂载在场景中处于激活状态的 GameObject 上"}]}]}]},{"ID":"20240402214428-vors2ax","Type":"NodeParagraph","Properties":{"id":"20240402214428-vors2ax","updated":"20250303190029"},"Children":[{"Type":"NodeText","Data":"交互时，在 Android 端调用API："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnityPlayer.UnitySendMessage(\u0026quot;对象名\u0026quot;, \u0026quot;函数名\u0026quot;, \u0026quot;参数信息\u0026quot;)"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240402214645-gi5lt9w","Type":"NodeParagraph","Properties":{"id":"20240402214645-gi5lt9w","style":"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color);","updated":"20250303190033"},"Children":[{"Type":"NodeText","Data":"注意：该API中的参数只能是 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"String"},{"Type":"NodeText","Data":"​ 类型或者为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"null"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240402214504-h1iag5e","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240402214504-h1iag5e","updated":"20250303190054"},"Children":[{"Type":"NodeText","Data":"测试交互"}]},{"ID":"20240402214516-kj3erbo","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240402214516-kj3erbo","updated":"20250303190054"},"Children":[{"ID":"20240402214518-gnse4gi","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240402214518-gnse4gi","updated":"20250303190043"},"Children":[{"ID":"20240402214518-txbalb6","Type":"NodeParagraph","Properties":{"id":"20240402214518-txbalb6","updated":"20250303190042"},"Children":[{"Type":"NodeText","Data":"在 Unity 端创建测试脚本，编写测试函数"}]},{"ID":"20240402215603-nw4xcn7","Type":"NodeParagraph","Properties":{"id":"20240402215603-nw4xcn7","updated":"20250303190043"},"Children":[{"Type":"NodeText","Data":"假设要调用这个类下的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TestAndroidCallUnity"},{"Type":"NodeText","Data":"​，让屏幕上的UI输出传入的字符串"}]},{"ID":"20240402215553-qqefnsz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240402215553-qqefnsz","style":"line-height: 22px;","updated":"20240402215600"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"using UnityEngine;\nusing UnityEngine.UI;\n\npublic class Lesson3 : MonoBehaviour\n{\n    public Text txtACU;\n\n    public void TestAndroidCallUnity(string str)\n    {\n        txtACU.text = str;\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240402214518-whgq9mj","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240402214518-whgq9mj","updated":"20240402214518"},"Children":[{"ID":"20240402214518-thcqmom","Type":"NodeParagraph","Properties":{"id":"20240402214518-thcqmom","updated":"20240402214518"},"Children":[{"Type":"NodeText","Data":"在场景上创建一个空物体，将脚本挂载上去"}]},{"ID":"20240402215750-w83kf6j","Type":"NodeParagraph","Properties":{"id":"20240402215750-w83kf6j","updated":"20240402215750"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 748px;","style":"width: 738px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240402215750-a79r1ne.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 738px;\" parent-style=\"width: 748px;\"}"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240402214518-3g0jfg4","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240402214518-3g0jfg4","updated":"20250303190047"},"Children":[{"ID":"20240402214518-rl8yaff","Type":"NodeParagraph","Properties":{"id":"20240402214518-rl8yaff","updated":"20250303190046"},"Children":[{"Type":"NodeText","Data":"在 Android 端书写测试代码"}]},{"ID":"20240402220001-2ezsdzs","Type":"NodeParagraph","Properties":{"id":"20240402220001-2ezsdzs","updated":"20250303190047"},"Children":[{"Type":"NodeText","Data":"在 Unity 执行安卓程序的某个方法时，该方法反过来调用Unity内的方法"}]},{"ID":"20240402215803-pi38h2y","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240402215803-pi38h2y","style":"line-height: 22px;","updated":"20240402215807"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"amF2YQ=="},{"Type":"NodeCodeBlockCode","Data":"package com.taikr.mytestgame;\n\n// import androidx.appcompat.app.AppCompatActivity;\n\nimport android.os.Bundle;\n\nimport com.unity3d.player.UnityPlayer;\nimport com.unity3d.player.UnityPlayerActivity;\n\npublic class MainActivity extends UnityPlayerActivity {\n    //用于测试的成员变量相关\n    public int testI;\n    public static int testStaticI = 20;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        // setContentView(R.layout.activity_main);\n    }\n\n    //用于测试的成员函数\n    public String TestFun() {\n        //在返回之前 先调用Unity当中的某个函数\n        UnityPlayer.UnitySendMessage(\"ACU\", \"TestAndroidCallUnity\", \"你好Unity\");\n        return \"String\";\n    }\n\n    //用于测试的静态成员函数\n    public static String TestStaticFun() {\n        return \"TestStaticFun\";\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240402214518-bn9158t","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240402214518-bn9158t","updated":"20250303190054"},"Children":[{"ID":"20240402214518-rj9ul0b","Type":"NodeParagraph","Properties":{"id":"20240402214518-rj9ul0b","updated":"20250303190052"},"Children":[{"Type":"NodeText","Data":"重新打包 aar 包，导入 Unity 中进行打包测试"}]},{"ID":"20240402215836-qopfras","Type":"NodeParagraph","Properties":{"id":"20240402215836-qopfras","updated":"20250303190054"},"Children":[{"Type":"NodeText","Data":"新打包的 arr 包需要重新执行删除特定文件的步骤，具体可看"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240402211839-djqfjan","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"打包注意事项"},{"Type":"NodeText","Data":"\n然后，打包 apk，安装到真机或者模拟器上运行，查看效果："}]},{"ID":"20240402220048-v4eo5e2","Type":"NodeParagraph","Properties":{"id":"20240402220048-v4eo5e2","updated":"20240402220048"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 657px;","style":"width: 647px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"Screenshot_20240402_215534_com.taikr.mytestgame"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/Screenshot_20240402_215534_com.taikr.mytestgame-20240402220048-3c4qund.jpg"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 647px;\" parent-style=\"width: 657px;\"}"},{"Type":"NodeText","Data":"​"}]}]}]}]}