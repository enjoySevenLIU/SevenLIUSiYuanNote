{"ID":"20240323201531-a2me1lh","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240323201531-a2me1lh","title":"CS5L14——unsafe","type":"doc","updated":"20250206191737"},"Children":[{"ID":"20240323201558-sy4ky2x","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240323201558-sy4ky2x","updated":"20250206191737"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"unsafe"}]},{"ID":"20240326221054-2zlbo42","Type":"NodeBlockquote","Properties":{"id":"20240326221054-2zlbo42","updated":"20250206191651"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240326221055-09orll8","Type":"NodeParagraph","Properties":{"id":"20240326221055-09orll8","updated":"20250206191651"},"Children":[{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240321152428-p3c1ha4","TextMarkBlockRefSubtype":"s","TextMarkTextContent":"Unity移动开发"},{"Type":"NodeText","Data":" 内涉及内容，这里将其补充到 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 知识补充内，它本身不属于 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 知识补充的课程"}]}]},{"ID":"20240323201615-yvxwfhf","Type":"NodeParagraph","Properties":{"id":"20240323201615-yvxwfhf","updated":"20250206191725"},"Children":[{"Type":"NodeText","Data":"默认情况下，C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 是不允许使用 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"指针"},{"Type":"NodeText","Data":" 的，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unsafe"},{"Type":"NodeText","Data":"​ 关键词用于在 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 表示不安全的上下文，\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果想要在 C# 中进行任何和指针相关的操作，就必须配合"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"code strong","TextMarkTextContent":"unsafe"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"关键词使用。"}]},{"ID":"20240323202339-69fk9rm","Type":"NodeBlockquote","Properties":{"id":"20240323202339-69fk9rm","updated":"20250206191613"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240323202341-sms9024","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240323202341-sms9024","updated":"20250206191613"},"Children":[{"Type":"NodeText","Data":"何为指针"}]},{"ID":"20240323202433-a7akbp0","Type":"NodeParagraph","Properties":{"id":"20240323202433-a7akbp0","updated":"20250206191613"},"Children":[{"Type":"NodeText","Data":"指针（Pointer，简称 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ptr"},{"Type":"NodeText","Data":"​）是计算机编程中一个重要的概念，它是一种特殊的数据类型，用于存储变量的内存地址。\n简单来说，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"指针指向了一个变量在计算机内存中的存储位置"},{"Type":"NodeText","Data":"。"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"指针就是地址，地址就是指针"}]},{"ID":"20240323202433-gvp24o4","Type":"NodeParagraph","Properties":{"id":"20240323202433-gvp24o4","updated":"20240326221227"},"Children":[{"Type":"NodeText","Data":"每个变量在内存中都有一个地址，在编程中，通过定义指针变量，我们可以存储一个变量的地址，\n"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"这就使得我们可以通过间接的方式操作和修改变量，而不需要访问原始的变量名。"}]}]},{"ID":"20240323201615-cya5xid","Type":"NodeParagraph","Properties":{"id":"20240323201615-cya5xid","updated":"20240326221100"},"Children":[{"Type":"NodeText","Data":"在公共语言运行时（CLR）中，不安全代码是指无法验证的代码。\nC"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 中的不安全代码不一定是危险的，只是 CLR 无法验证该代码的安全性。\n因此，CLR 将仅执行完全信任的程序集中的不安全代码。\n如果你使用不安全代码，你应该负责确保代码不会引发安全风险或指针错误"}]},{"ID":"20240323201703-qlz72o5","Type":"NodeParagraph","Properties":{"id":"20240323201703-qlz72o5","updated":"20240326221100"},"Children":[{"Type":"NodeText","Data":"关于CLR是什么，详情请见："},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20231028202105-150d6lr","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"CS5L1——.NET相关知识"}]},{"ID":"20240323202209-zoh3mf1","Type":"NodeBlockquote","Properties":{"id":"20240323202209-zoh3mf1","style":"background-color: var(--b3-card-warning-background); color: var(--b3-card-warning-color); --b3-parent-background: var(--b3-card-warning-background);","updated":"20250206191640"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20250206191640-xfv6f27","Type":"NodeParagraph","Properties":{"id":"20250206191640-xfv6f27","updated":"20250206191640"},"Children":[{"Type":"NodeText","Data":"注意："},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unsafe"},{"Type":"NodeText","Data":"​ 的使用虽然能让我们在 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 中使用指针，但是会存在安全风险和稳定性风险，如果没有特殊需求，请尽量避免在 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 中使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unsafe"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240323201615-5619zmo","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240323201615-5619zmo","updated":"20250206191737"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"unsafe 的基本使用"}]},{"ID":"20240323201918-k012jh9","Type":"NodeParagraph","Properties":{"id":"20240323201918-k012jh9","updated":"20250206191729"},"Children":[{"Type":"NodeText","Data":"如果想要在 Unity 中正常使用 C"},{"Type":"NodeBackslash","Data":"span","Children":[{"Type":"NodeText","Data":"#"}]},{"Type":"NodeText","Data":" 中的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unsafe"},{"Type":"NodeText","Data":"​ 关键词进行程序编写，\n我们必须在 Unity 的 Player Settings 中的 Other Settings 中将 Allow 'unsafe' Code 选项勾选上"}]},{"ID":"20240323202045-3n5ut5w","Type":"NodeParagraph","Properties":{"id":"20240323202045-3n5ut5w","updated":"20240326221100"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"width: 607px;","style":"width: 597px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240323202045-9nd79vu.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 597px;\" parent-style=\"width: 607px;\"}"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240323201930-v8gjby4","Type":"NodeParagraph","Properties":{"id":"20240323201930-v8gjby4","updated":"20250206191737"},"Children":[{"Type":"NodeText","Data":"勾选该选项后，我们就可以在 Unity 中使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"unsafe"},{"Type":"NodeText","Data":"​ 关键词了。"}]},{"ID":"20240323201929-f6xesrj","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240323201929-f6xesrj","updated":"20240326221100"},"Children":[{"Type":"NodeText","Data":"unsafe的基本用法"}]},{"ID":"20240323202130-3u36okr","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240323202130-3u36okr","updated":"20240326221100"},"Children":[{"ID":"20240323202130-bla02c6","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240323202130-bla02c6","updated":"20240323203005"},"Children":[{"ID":"20240323202130-z3a9eni","Type":"NodeParagraph","Properties":{"id":"20240323202130-z3a9eni","updated":"20240323202136"},"Children":[{"Type":"NodeText","Data":"用于修饰函数"}]},{"ID":"20240323202116-h0lxls9","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240323202116-h0lxls9","style":"line-height: 22px;","updated":"20240323203005"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"//unsafe 修饰函数后，函数参数可以使用指针\npublic unsafe void CopyInfo(byte* src, byte* dst, int count)\n{\n\t//函数内部也可以使用指针\n\tint i = 3;\n\tint* testInt = \u0026i;\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240323202141-dvicqa7","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240323202141-dvicqa7","updated":"20240323203003"},"Children":[{"ID":"20240323202141-xp51rd9","Type":"NodeParagraph","Properties":{"id":"20240323202141-xp51rd9","updated":"20240323202147"},"Children":[{"Type":"NodeText","Data":"用于修饰代码块"}]},{"ID":"20240323202439-axh1q8b","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240323202439-axh1q8b","style":"line-height: 22px;","updated":"20240323203003"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"public void TestFun()\n{\n\tunsafe\n\t{\n\t\tint i = 3;\n\t\tint* testInt = \u0026i;\n\t\tprint(\"值为：\" + i);\n\t\tprint(\"地址是：\" + (int)testInt);\n\t}\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240323202148-y1sgg2r","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240323202148-y1sgg2r","updated":"20240323202959"},"Children":[{"ID":"20240323202148-ue36bfa","Type":"NodeParagraph","Properties":{"id":"20240323202148-ue36bfa","updated":"20240323202156"},"Children":[{"Type":"NodeText","Data":"用于修饰成员变量"}]},{"ID":"20240323202444-xdr16gg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240323202444-xdr16gg","style":"line-height: 22px;","updated":"20240323202959"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"public class TestClass\n{\n\t//unsafe 修饰成员变量 可以声明指针成员\n\tpublic unsafe int* p;\n\n\t//在非unsafe的语句块中不能直接使用\n\tpublic void TestFun()\n\t{\n\t\tint i = 3;\n\t\t//p = \u0026i;\t\t\t//本句会报错\n\t}\n\n\t//还是需要在unsafe声明的语句块中使用\n\tpublic unsafe void TestFun()\n\t{\n\t\tint i = 3;\n\t\tp = \u0026i;\n\t}\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]},{"ID":"20240323202157-sxahict","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240323202157-sxahict","updated":"20240323203037"},"Children":[{"ID":"20240323202157-8tqo7hn","Type":"NodeParagraph","Properties":{"id":"20240323202157-8tqo7hn","updated":"20240323202202"},"Children":[{"Type":"NodeText","Data":"用于修饰类"}]},{"ID":"20240323202442-c8xdf06","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240323202442-c8xdf06","style":"line-height: 22px;","updated":"20240323203037"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YyM="},{"Type":"NodeCodeBlockCode","Data":"//通过unsafe修饰类，可以在类中随意使用指针\npublic unsafe class TestClass\n{\n\tpublic int* p;\n\tpublic byte* TestFun(byte* array)\n\t{\n\t\treturn null;\n\t}\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20240323202206-9op5t54","Type":"NodeParagraph","Properties":{"id":"20240323202206-9op5t54","updated":"20240326221100"}}]}