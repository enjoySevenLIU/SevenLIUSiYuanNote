const __vite__fileDeps=["./chunks/chunk.vendor_chatgpt.js","./chunks/chunk.vendor_keyv.js","./chunks/chunk.vendor_asn1-js.js","./chunks/chunk.vendor_bn-js.js","./chunks/chunk.vendor_vite-plugin-node-polyfills.js","./chunks/chunk.vendor_inherits.js","./chunks/chunk.vendor_minimalistic-assert.js","./chunks/chunk.vendor_vm-browserify.js","./chunks/chunk.vendor_crypto-js.js","./chunks/chunk.vendor_crypto-browserify.js","./chunks/chunk.vendor_randombytes.js","./chunks/chunk.vendor_safe-buffer.js","./chunks/chunk.vendor_create-hash.js","./chunks/chunk.vendor_md5-js.js","./chunks/chunk.vendor_hash-base.js","./chunks/chunk.vendor_readable-stream.js","./chunks/chunk.vendor_events.js","./chunks/chunk.vendor_util.js","./chunks/chunk.vendor_is-arguments.js","./chunks/chunk.vendor_has-tostringtag.js","./chunks/chunk.vendor_has-symbols.js","./chunks/chunk.vendor_call-bind.js","./chunks/chunk.vendor_get-intrinsic.js","./chunks/chunk.vendor_es-errors.js","./chunks/chunk.vendor_has-proto.js","./chunks/chunk.vendor_function-bind.js","./chunks/chunk.vendor_hasown.js","./chunks/chunk.vendor_set-function-length.js","./chunks/chunk.vendor_define-data-property.js","./chunks/chunk.vendor_es-define-property.js","./chunks/chunk.vendor_gopd.js","./chunks/chunk.vendor_has-property-descriptors.js","./chunks/chunk.vendor_is-generator-function.js","./chunks/chunk.vendor_which-typed-array.js","./chunks/chunk.vendor_for-each.js","./chunks/chunk.vendor_is-callable.js","./chunks/chunk.vendor_available-typed-arrays.js","./chunks/chunk.vendor_possible-typed-array-names.js","./chunks/chunk.vendor_is-typed-array.js","./chunks/chunk.vendor_util-deprecate.js","./chunks/chunk.vendor_string_decoder.js","./chunks/chunk.vendor_process-nextick-args.js","./chunks/chunk.vendor_isarray.js","./chunks/chunk.vendor_core-util-is.js","./chunks/chunk.vendor_ripemd160.js","./chunks/chunk.vendor_sha-js.js","./chunks/chunk.vendor_cipher-base.js","./chunks/chunk.vendor_stream-browserify.js","./chunks/chunk.vendor_create-hmac.js","./chunks/chunk.vendor_browserify-sign.js","./chunks/chunk.vendor_browserify-rsa.js","./chunks/chunk.vendor_elliptic.js","./chunks/chunk.vendor_minimalistic-crypto-utils.js","./chunks/chunk.vendor_brorand.js","./chunks/chunk.vendor_hash-js.js","./chunks/chunk.vendor_hmac-drbg.js","./chunks/chunk.vendor_parse-asn1.js","./chunks/chunk.vendor_evp_bytestokey.js","./chunks/chunk.vendor_browserify-aes.js","./chunks/chunk.vendor_buffer-xor.js","./chunks/chunk.vendor_pbkdf2.js","./chunks/chunk.vendor_browserify-cipher.js","./chunks/chunk.vendor_browserify-des.js","./chunks/chunk.vendor_des-js.js","./chunks/chunk.vendor_diffie-hellman.js","./chunks/chunk.vendor_miller-rabin.js","./chunks/chunk.vendor_create-ecdh.js","./chunks/chunk.vendor_public-encrypt.js","./chunks/chunk.vendor_randomfill.js","./chunks/chunk.vendor_json-buffer.js","./chunks/chunk.vendor_p-timeout.js","./chunks/chunk.vendor_quick-lru.js","./chunks/chunk.vendor_js-tiktoken.js","./chunks/chunk.vendor_base64-js.js","./chunks/chunk.vendor_eventsource-parser.js","./chunks/chunk.vendor_uuid.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
var Zi=Object.defineProperty;var Qi=(c,o,t)=>o in c?Zi(c,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[o]=t;var D=(c,o,t)=>(Qi(c,typeof o!="symbol"?o+"":o,t),t);import{J as F,K as w,L as O,bO as el,bP as tl,A as J,T as k,Y as K,u as m,W as Y,bQ as mt,bR as ht,_ as f,M as At,D as sl,Q as C,R as b,V as ol,bS as al,aJ as nl,X as R,bT as il,bU as ll,am as fn,bV as Po,bW as rl,q as yn,ax as le,a3 as re,G as $s,t as Je,aC as cl,v as Ye,Z as Ee,ao as xe,ae as bo,U as Jt,a$ as Ct,bX as bn,ap as qn,a7 as _n,bY as Ue,B as as,bZ as Vs,aK as pl,S as Yn,b_ as Vo,b$ as ul,f as Rn,c0 as dl,$ as gl,aX as ml}from"./chunks/chunk.vendor.js";import{u as hl,c as fl}from"./chunks/chunk.vendor_vue-i18n.js";import{I as yl,L as bl,A as _l,v as wl,R as vl,T as ue,P as ee,f as Oe,Z as Xn,H as _t,J as it,Q as Zn,a as wn,F as qt,B as Fe,b as gt,S as ns,O as Pl,z as ot,M as Et,_ as lt,D as Tl,X as kl,c as is}from"./chunks/chunk.vendor_zhi-blog-api.js";import{P as T,Q as Me,T as se,d as ae,B as Ut,H as ne,Z as Ja}from"./chunks/chunk.vendor_zhi-common.js";import{T as zt,d as St,w as Tt,u as Ht}from"./chunks/chunk.vendor_zhi-device.js";import{u as wt,a as qe,c as Sl,b as El}from"./chunks/chunk.vendor_vue-router.js";import{w as Cl}from"./chunks/chunk.vendor_zhi-lib-base.js";import{d as Al,c as Ul}from"./chunks/chunk.vendor_pinia.js";import{k as ut,X as bt,V as Qn,a as st}from"./chunks/chunk.vendor_zhi-siyuan-api.js";import{s as Il}from"./chunks/chunk.vendor_shorthash2.js";import{v as xl}from"./chunks/chunk.vendor_uuid.js";import{I as ei,E as ti,B as si,T as oi}from"./chunks/chunk.vendor_simple-xmlrpc.js";import{f as Ml}from"./chunks/chunk.vendor_cross-fetch.js";import{x as Dl}from"./chunks/chunk.vendor_xmlbuilder2.js";import{B as $o,a as vn}from"./chunks/chunk.vendor_vite-plugin-node-polyfills.js";import{S as Ol}from"./chunks/chunk.vendor_zhi-fetch-middleware.js";import{g as It}from"./chunks/chunk.vendor_js-base64.js";import{S as Vl,I as $l}from"./chunks/chunk.vendor_zhi-siyuan-picgo.js";import{E as Q,a as Nl,b as Pt,c as Dt,d as Ne,e as Se,f as Ns,g as Pn,h as To,i as Tn,j as kn,k as ko,l as Ls,m as Ce,n as Ie,o as So,p as Sn,q as rt,r as ct,s as Ll,t as Hl,u as Eo,v as Qe,w as ai,x as ni,y as Co,z as ii,A as Xt,B as En,C as Rl,D as Gl,F as li,G as ri,H as Bl,I as jl,J as Kl,K as zl,L as Wl,M as Fl}from"./chunks/chunk.vendor_element-plus.js";import{p as No}from"./chunks/chunk.vendor_path-browserify.js";import{l as we}from"./chunks/chunk.vendor_lodash-es.js";import{l as Lt}from"./chunks/chunk.vendor_cheerio.js";import{C as ci,U as Jl,B as ql}from"./chunks/chunk.vendor_crypto-js.js";import{D as pi}from"./chunks/chunk.vendor_zhi-notion-markdown.js";import{Z as Yl,Y as Xl}from"./chunks/chunk.vendor_zhi-github-middleware.js";import{D as Zl}from"./chunks/chunk.vendor_zhi-gitlab-middleware.js";import{k as Ql}from"./chunks/chunk.vendor_katex.js";import{c as er}from"./chunks/chunk.vendor_cookie-parse.js";import{m as Gn}from"./chunks/chunk.vendor_telegraph-md.js";import{i as tr}from"./chunks/chunk.vendor_iframe-resizer.js";import"./chunks/chunk.vendor_vue-demi.js";import"./chunks/chunk.vendor_asn1-js.js";import"./chunks/chunk.vendor_bn-js.js";import"./chunks/chunk.vendor_inherits.js";import"./chunks/chunk.vendor_minimalistic-assert.js";import"./chunks/chunk.vendor_vm-browserify.js";import"./chunks/chunk.vendor_async-validator.js";import"./chunks/chunk.vendor_dayjs.js";import"./chunks/chunk.vendor_normalize-wheel-es.js";import"./chunks/chunk.vendor_domutils.js";import"./chunks/chunk.vendor_dom-serializer.js";import"./chunks/chunk.vendor_domelementtype.js";import"./chunks/chunk.vendor_entities.js";import"./chunks/chunk.vendor_domhandler.js";import"./chunks/chunk.vendor_cheerio-select.js";import"./chunks/chunk.vendor_css-select.js";import"./chunks/chunk.vendor_boolbase.js";import"./chunks/chunk.vendor_css-what.js";import"./chunks/chunk.vendor_nth-check.js";import"./chunks/chunk.vendor_parse5.js";import"./chunks/chunk.vendor_parse5-htmlparser2-tree-adapter.js";import"./chunks/chunk.vendor_htmlparser2.js";import"./chunks/chunk.vendor_crypto-browserify.js";import"./chunks/chunk.vendor_randombytes.js";import"./chunks/chunk.vendor_safe-buffer.js";import"./chunks/chunk.vendor_create-hash.js";import"./chunks/chunk.vendor_md5-js.js";import"./chunks/chunk.vendor_hash-base.js";import"./chunks/chunk.vendor_readable-stream.js";import"./chunks/chunk.vendor_events.js";import"./chunks/chunk.vendor_util.js";import"./chunks/chunk.vendor_is-arguments.js";import"./chunks/chunk.vendor_has-tostringtag.js";import"./chunks/chunk.vendor_has-symbols.js";import"./chunks/chunk.vendor_call-bind.js";import"./chunks/chunk.vendor_get-intrinsic.js";import"./chunks/chunk.vendor_es-errors.js";import"./chunks/chunk.vendor_has-proto.js";import"./chunks/chunk.vendor_function-bind.js";import"./chunks/chunk.vendor_hasown.js";import"./chunks/chunk.vendor_set-function-length.js";import"./chunks/chunk.vendor_define-data-property.js";import"./chunks/chunk.vendor_es-define-property.js";import"./chunks/chunk.vendor_gopd.js";import"./chunks/chunk.vendor_has-property-descriptors.js";import"./chunks/chunk.vendor_is-generator-function.js";import"./chunks/chunk.vendor_which-typed-array.js";import"./chunks/chunk.vendor_for-each.js";import"./chunks/chunk.vendor_is-callable.js";import"./chunks/chunk.vendor_available-typed-arrays.js";import"./chunks/chunk.vendor_possible-typed-array-names.js";import"./chunks/chunk.vendor_is-typed-array.js";import"./chunks/chunk.vendor_util-deprecate.js";import"./chunks/chunk.vendor_string_decoder.js";import"./chunks/chunk.vendor_process-nextick-args.js";import"./chunks/chunk.vendor_isarray.js";import"./chunks/chunk.vendor_core-util-is.js";import"./chunks/chunk.vendor_ripemd160.js";import"./chunks/chunk.vendor_sha-js.js";import"./chunks/chunk.vendor_cipher-base.js";import"./chunks/chunk.vendor_stream-browserify.js";import"./chunks/chunk.vendor_create-hmac.js";import"./chunks/chunk.vendor_browserify-sign.js";import"./chunks/chunk.vendor_browserify-rsa.js";import"./chunks/chunk.vendor_elliptic.js";import"./chunks/chunk.vendor_minimalistic-crypto-utils.js";import"./chunks/chunk.vendor_brorand.js";import"./chunks/chunk.vendor_hash-js.js";import"./chunks/chunk.vendor_hmac-drbg.js";import"./chunks/chunk.vendor_parse-asn1.js";import"./chunks/chunk.vendor_evp_bytestokey.js";import"./chunks/chunk.vendor_browserify-aes.js";import"./chunks/chunk.vendor_buffer-xor.js";import"./chunks/chunk.vendor_pbkdf2.js";import"./chunks/chunk.vendor_browserify-cipher.js";import"./chunks/chunk.vendor_browserify-des.js";import"./chunks/chunk.vendor_des-js.js";import"./chunks/chunk.vendor_diffie-hellman.js";import"./chunks/chunk.vendor_miller-rabin.js";import"./chunks/chunk.vendor_create-ecdh.js";import"./chunks/chunk.vendor_public-encrypt.js";import"./chunks/chunk.vendor_randomfill.js";import"./chunks/chunk.vendor_commonmark.js";import"./chunks/chunk.vendor_mdurl.js";import"./chunks/chunk.vendor_string-prototype-repeat.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(e){if(e.ep)return;e.ep=!0;const a=t(e);fetch(e.href,a)}})();var ui={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const Rt=ui.DEV_MODE==="true",Cn=ui.APP_BASE,sr="https://terwer.space/about",De="dynamic-config",_o="[auto]",or=10,ar="https://api.terwer.space/api",Pe="https://api.terwer.space/api/middleware",W=c=>Cl(c,"picgo-plugin-app"),Z=()=>{const{messages:c,locale:o}=hl();return{t:s=>{var a;return((a=c.value)==null?void 0:a[o.value])[s]||s},locale:o}},nr={class:"header-default"},ir=F({__name:"DefaultHeader",setup(c){return Z(),(o,t)=>(w(),O("div",nr))}}),lr="siyuan-plugin-publisher",di="1.21.6",rr="Publish articles from Siyuan Notes to platforms such as Yuque, Notion, Cnblogs, WordPress, Typecho, Hexo, Zhihu and more",cr="terwer/siyuan-plugin-publisher",pr="https://github.com/terwer/siyuan-plugin-publisher",ur="terwer",dr="MIT",gr={makeLink:"python scripts/make_dev_link.py",serve:"python scripts/serve.py",dev:"python scripts/dev.py",test:"vitest",coverage:"vitest run --coverage",build:"python scripts/build.py",pluginBuild:"python scripts/plugin_build.py",siyuanBuild:"python scripts/siyuan_build.py",vercelBuild:"python3 scripts/vercel_build.py",nginxBuild:"python scripts/nginx_build.py",widgetBuild:"python scripts/widget_build.py",extBuild:"python scripts/ext_build.py",syncVersion:"python scripts/version.py",parseChangelog:"python scripts/parse_changelog.py",prepareRelease:"pnpm syncVersion && pnpm parseChangelog",package:"pnpm build && pnpm widgetBuild && pnpm extBuild && pnpm extBuild -t firefox && pnpm nginxBuild",syncWidgetRepo:"python scripts/sync_widget_repo.py"},mr={"@halo-dev/api-client":"^2.16.0","@terwer/esbuild-config-custom":"2.0.0","@terwer/eslint-config-custom":"^1.3.6","@types/crypto-js":"^4.2.2","@types/iframe-resizer":"^3.5.13","@types/katex":"^0.16.7","@types/minimist":"^1.2.5","@types/node":"^18.19.34","@vitejs/plugin-vue":"^5.0.5","@vitest/coverage-v8":"^1.6.0","@vue/test-utils":"^2.4.6","esbuild-plugin-copy":"^2.1.1","esbuild-style-plugin":"^1.6.3","fast-glob":"^3.3.2",jsdom:"^24.1.0",minimist:"^1.2.8","rollup-plugin-livereload":"^2.0.5",stylus:"^0.63.0",typescript:"^5.4.5","unplugin-auto-import":"^0.17.6","unplugin-vue-components":"^0.27.0",vercel:"^34.2.5",vite:"^5.2.12","vite-plugin-html":"^3.2.2","vite-plugin-node-polyfills":"^0.22.0",vitest:"^1.6.0","vue-tsc":"^2.0.19"},gi={"@element-plus/icons-vue":"^2.3.1","@iconify/json":"^2.2.216","@vueuse/components":"^10.10.0","@vueuse/core":"^10.10.0",chatgpt:"^5.2.5",cheerio:"1.0.0-rc.12","cookie-parse":"^0.4.0","cross-fetch":"^3.1.8","crypto-js":"^4.2.0","element-plus":"^2.7.4","gray-matter":"^4.0.3","iframe-resizer":"^4.4.2","js-base64":"^3.7.7","js-yaml":"^4.1.0",katex:"^0.16.10","lodash-es":"^4.17.21",pinia:"^2.1.7",shorthash2:"^1.0.3","simple-xmlrpc":"^1.4.2",siyuan:"^1.0.2","telegraph.md":"^0.0.1","unplugin-icons":"^0.19.0",uuid:"^9.0.1",vue:"^3.4.27","vue-i18n":"^9.13.1","vue-router":"^4.3.2",xmlbuilder2:"^3.1.1","zhi-blog-api":"^1.66.0","zhi-common":"^1.33.0","zhi-device":"^2.11.0","zhi-fetch-middleware":"^0.12.0","zhi-github-middleware":"^0.5.0","zhi-gitlab-middleware":"^0.10.0","zhi-lib-base":"^0.8.0","zhi-notion-markdown":"^0.1.4","zhi-siyuan-api":"^2.21.0","zhi-siyuan-picgo":"1.11.0","zhi-xmlrpc-middleware":"^0.6.21"},hr={name:lr,version:di,description:rr,repository:cr,homepage:pr,author:ur,license:dr,scripts:gr,devDependencies:mr,dependencies:gi};class U{static blogApi(o,t){if(!t)throw new Error("apiAdaptor cannot be null");if(!t.getUsersBlogs)throw this.logger.error("apiAdaptor must implements BlogApi",t),new Error(`apiAdaptor must implements BlogApi => ${this.getObjectName(t)}`);return new yl(t)}static webApi(o,t){if(!t)throw new Error("webAdaptor cannot be null");if(!t.getMetaData)throw this.logger.error("webAdaptor must implements WebApi",t),new Error(`webAdaptor must implements WebApi => ${this.getObjectName(t)}`);return new bl(t)}static getObjectName(o){try{return typeof o=="function"&&/^class\s/.test(o.toString())?o.name:typeof o=="function"?o.name||"anonymous function":typeof o=="object"&&Object.values(o.constructor).includes(o)?Object.keys(o.constructor)[Object.values(o.constructor).indexOf(o)]:typeof o!="object"?o:"{}"}catch(t){return console.error(t),"{}"}}static emptyOrDefault(o,t){return typeof o=="string"&&(o=o.trim()),T.isEmptyString(o)?t:o}static emptyBooleanOrDefault(o,t){return typeof o>"u"?t:o}}D(U,"logger",W("publisher-widget-utils"));const at=()=>({isInSiyuanMainWin:()=>zt.getDevice()===St.DeviceType_Siyuan_MainWin,isInSiyuanWidget:()=>zt.getDevice()===St.DeviceType_Siyuan_Widget,isInSiyuanBrowser:()=>zt.getDevice()===St.DeviceType_Siyuan_Browser,isInChromeExtension:()=>zt.getDevice()===St.DeviceType_Chrome_Extension,isInSiyuanOrSiyuanNewWin:()=>{const n=zt.getDevice();return n===St.DeviceType_Siyuan_MainWin||n===St.DeviceType_Siyuan_RendererWin||n===St.DeviceType_Siyuan_Widget},isInSiyuanWin:()=>{const n=zt.getDevice();return n===St.DeviceType_Siyuan_MainWin||n===St.DeviceType_Siyuan_RendererWin}}),Ao=c=>(mt("data-v-166e8134"),c=c(),ht(),c),fr={class:"footer"},yr={class:"text"},br=Ao(()=>k("span",{class:"text"},".",-1)),_r=Ao(()=>k("span",{class:"text"},".",-1)),wr=Ao(()=>k("span",{class:"text"},".",-1)),vr=Ao(()=>k("span",{class:"text"},".",-1)),Pr={key:0,class:"text"},Tr={key:2,class:"text"},kr=F({__name:"DefaultFooter",setup(c){const{t:o}=Z(),t=el(),s=tl(t),{isInChromeExtension:e}=at(),a=e(),n=J(hr.version),i=Me.nowYear(),l=wt(),u=()=>{window.open("https://github.com/terwer/siyuan-plugin-publisher")},r=async()=>{await l.push({path:"/"})},h=async()=>{await l.push({path:"/about",query:{showBack:"true"}})},y=()=>{l.push({path:"/test"})},p=()=>{const P=chrome.runtime.getURL("/index.html#/");window.open(P)},g=async()=>{await l.push({path:"/setting/publish",query:{showBack:"true"}})},_=async()=>{await l.push({path:"/setting/general",query:{showBack:"true"}})},d=async()=>{await l.push({path:"/test",query:{showBack:"true"}})};return(v,P)=>(w(),O("div",null,[k("div",fr,[k("div",null,[k("span",yr," ©2011-"+K(m(i)),1),k("span",{class:"text s-dark",onClick:P[0]||(P[0]=S=>u())}," siyuan-plugin-publisher "),k("span",{class:"text",onClick:y},"v"+K(n.value)+" ",1),k("span",{class:"text s-dark",onClick:P[1]||(P[1]=S=>h())},K(m(o)("syp.about")),1),br,k("span",{class:"text s-dark",onClick:r},K(m(o)("service.tab.manage")),1),_r,k("span",{class:"text s-dark",onClick:P[2]||(P[2]=S=>m(s)())},K(m(t)?m(o)("theme.mode.light"):m(o)("theme.mode.dark")),1),wr,k("span",{class:"text s-dark",onClick:g},K(m(o)("service.tab.publish.setting")),1),vr,k("span",{class:"text s-dark",onClick:_},K(m(o)("service.tab.change.local")),1),m(Rt)?(w(),O("span",Pr,".")):Y("",!0),m(Rt)?(w(),O("span",{key:1,class:"text s-dark",onClick:d}," 组件测试 ")):Y("",!0),m(a)?(w(),O("span",Tr,".")):Y("",!0),m(a)?(w(),O("span",{key:3,class:"text s-dark",onClick:P[3]||(P[3]=S=>p())},K(m(o)("blog.newwin.open")),1)):Y("",!0)])])]))}}),pe=(c,o)=>{const t=c.__vccOpts||c;for(const[s,e]of o)t[s]=e;return t},Sr=pe(kr,[["__scopeId","data-v-166e8134"]]),Er={id:"app-layout-default"},Cr={class:"default-main"},Ar=F({__name:"AppLayoutDefault",setup(c){return(o,t)=>(w(),O("div",Er,[f(ir),k("div",Cr,[At(o.$slots,"default",{},void 0,!0)]),f(Sr)]))}}),Ur=pe(Ar,[["__scopeId","data-v-0cf32ad2"]]),Ir=F({__name:"AppLayout",setup(c){const o=sl(Ur);return(t,s)=>(w(),C(al,null,{default:b(()=>[(w(),C(ol(o.value),null,{default:b(()=>[At(t.$slots,"default")]),_:3}))]),_:3}))}}),xr=F({__name:"App",setup(c){return(o,t)=>{const s=nl("router-view");return w(),C(Ir,null,{default:b(()=>[f(s)]),_:1})}}}),Mr={class:"loading-tips"},Dr={key:0},Or={key:1},Vr={key:2},$r={key:3},Nr={key:4},Lr={key:5},Hs=F({__name:"LoadingTimer",props:{loadingTime:Number},setup(c){const{t:o}=Z();return(t,s)=>(w(),O("div",Mr,[k("div",null,[R(K(m(o)("loading.cost"))+": "+K(c.loadingTime)+" ms ",1),c.loadingTime<200?(w(),O("span",Dr,"😍")):c.loadingTime<400?(w(),O("span",Or,"😄")):c.loadingTime<600?(w(),O("span",Vr,"😊")):c.loadingTime<800?(w(),O("span",$r,"🤔")):c.loadingTime<1e3?(w(),O("span",Nr,"😒")):(w(),O("span",Lr,"😭"))])]))}}),Hr={lang:"zh_CN",[De]:"{}"};class Rr{constructor(o){D(this,"logger");D(this,"fs");D(this,"path");D(this,"filePath");this.logger=W("json-storage");const t=Tt.siyuanWindow();this.fs=t.require("fs"),this.path=t.require("path");const s=t==null?void 0:t.siyuan.config.system.dataDir;this.filePath=this.path.join(s,o);const e=this.path.dirname(this.filePath);this.logger.info("store dir =>",e),this.fs.existsSync(e)||this.fs.mkdirSync(e),this.fs.existsSync(this.filePath)||this.writeFile({}),this.logger.info("ininted json local storage in =>",this.filePath)}getItem(o){return this.getStoredItems()[o]||null}setItem(o,t){const s=this.getStoredItems();s[o]=t,this.writeFile(s)}removeItem(o){const t=this.getStoredItems();delete t[o],this.writeFile(t)}getStoredItems(){return se.safeParse(this.readFile(),{})}readFile(){return this.fs.readFileSync(this.filePath,this.getFileOptions())}writeFile(o){return this.fs.writeFileSync(this.filePath,JSON.stringify(o),this.getFileOptions())}getFileOptions(){return{encoding:"utf8"}}}const Bn=W("use-common-local-storage"),An=(c,o,t,s={})=>{const e=Gr(c,s);return il(o,t,e,s)},Gr=(c,o={})=>{let t;const{isInSiyuanOrSiyuanNewWin:s}=at();if(s())t=new Rr(c),Bn.info("using JsonStorage for localStorage");else{const{window:e=ll}=o;t=e==null?void 0:e.localStorage,Bn.info("using window.localStorage for localStorage")}return t},Un=()=>{const c="storage/syp/siyuan-cfg.json",o="siyuan-cfg",{isInSiyuanOrSiyuanNewWin:t}=at(),s=()=>{const a="http://127.0.0.1:6806",n="",i=Pe;let l;if(t()){const h=Tt.siyuanWindow();l=h==null?void 0:h.location.origin}const u=new ut(l??a,n);u.middlewareUrl=i;const r=An(c,o,u,{serializer:Po.object});return l&&(r.value.apiUrl=l),r};return{getSiyuanSetting:s,getReadOnlySiyuanSetting:()=>{const a=s();return fn(a)}}};class Br extends _l{constructor(){super();D(this,"experimentalUseSiyuanNoteAIConfig");D(this,"experimentalAIEnabled");D(this,"experimentalAICode");D(this,"experimentalAIBaseUrl");D(this,"experimentalAIProxyUrl");D(this,"showDocQuickMenu");D(this,"showQuickMenu");D(this,"showSingleMenu");D(this,"showBatchMenu");D(this,"showAIMenu");D(this,"showExtendMenu");D(this,"showArticleManageMenu");this.experimentalUseSiyuanNoteAIConfig=!0,this.experimentalAIEnabled=!1,this.showDocQuickMenu=!0,this.showQuickMenu=!0,this.showSingleMenu=!0,this.showBatchMenu=!0,this.showAIMenu=!0,this.showExtendMenu=!0,this.showArticleManageMenu=!0}}const xt=()=>{const c="storage/syp/publish-preference-cfg.json",o="publish-preference-cfg",t=W("use-publish-pref"),s=()=>{var u,r,h;const a=new Br,n=An(c,o,a,{serializer:Po.object}),i=Tt.siyuanWindow(),l=(h=(r=(u=i==null?void 0:i.siyuan)==null?void 0:u.config)==null?void 0:r.ai)==null?void 0:h.openAI;return t.info("try load win.siyuan.config =>",l),l?(n.value.experimentalUseSiyuanNoteAIConfig=!0,n.value.experimentalAIProxyUrl=l.apiProxy,n.value.experimentalAICode=l.apiKey,n.value.experimentalAIBaseUrl=l.apiBaseURL,t.info("use siyuan-note ai config")):(n.value.experimentalUseSiyuanNoteAIConfig=!1,t.info("use custom ai config")),n.value.showDocQuickMenu=U.emptyBooleanOrDefault(n.value.showDocQuickMenu,!0),n.value.showQuickMenu=U.emptyBooleanOrDefault(n.value.showQuickMenu,!0),n.value.showSingleMenu=U.emptyBooleanOrDefault(n.value.showSingleMenu,!0),n.value.showBatchMenu=U.emptyBooleanOrDefault(n.value.showBatchMenu,!0),n.value.showAIMenu=U.emptyBooleanOrDefault(n.value.showAIMenu,!0),n.value.showExtendMenu=U.emptyBooleanOrDefault(n.value.showExtendMenu,!0),n};return{getPublishPreferenceSetting:s,getReadOnlyPublishPreferenceSetting:()=>{const a=s();return fn(a)}}};var Zs={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const Ge=()=>{const c=W("use-siyuan-api"),{getReadOnlySiyuanSetting:o}=Un(),{getReadOnlyPublishPreferenceSetting:t}=xt(),s=U.emptyOrDefault(Zs.VITE_SIYUAN_API_URL,""),e=U.emptyOrDefault(Zs.VITE_SIYUAN_AUTH_TOKEN,""),a=U.emptyOrDefault(Zs.VITE_SIYUAN_COOKIE,""),n=t(),i=o(),l=U.emptyOrDefault(i.value.apiUrl,s),u=U.emptyOrDefault(i.value.password,e),r=new ut(l,u);r.cookie=U.emptyOrDefault(i.value.cookie,a),r.preferenceConfig.fixTitle=n.value.fixTitle,r.preferenceConfig.keepTitle=n.value.keepTitle,r.preferenceConfig.removeFirstH1=n.value.removeFirstH1,r.preferenceConfig.removeMdWidgetTag=n.value.removeMdWidgetTag;const h=new bt(r),y=new Qn(r),{isInChromeExtension:p,isInSiyuanOrSiyuanNewWin:g}=at(),_=()=>{const v=Zs.VITE_DEFAULT_TYPE,P=v==="siyuan";return c.info("defaultType=>",v),c.info("storeViaSiyuanApi=>",String(P)),P},d=p()?!1:_()&&!g();return{blogApi:h,kernelApi:y,siyuanConfig:r,isStorageViaSiyuanApi:_,isUseSiyuanProxy:d}};class jr{constructor(o){D(this,"logger");D(this,"storageViaSiyuanApi");D(this,"kernelApi");D(this,"key");this.logger=W("common-storage");const{isStorageViaSiyuanApi:t,kernelApi:s}=Ge();if(this.storageViaSiyuanApi=t(),this.kernelApi=s,this.storageViaSiyuanApi)this.key=o;else{const e=o.split("/").pop()??"";this.key=e.slice(0,e.lastIndexOf("."))}}async getItem(o){this.logger.info(`Retrieving value for '${o}' from CommonStorage.`);let t;if(this.storageViaSiyuanApi)try{t=await this.kernelApi.getFile(o,"text")??""}catch(s){this.logger.error(`Failed to get value for key '${o}' from SiYuan Api LocalStorageAdaptor. Error:`,s)}else try{t=Tt.siyuanWindow().localStorage.getItem(o)??""}catch(s){this.logger.error(`Failed to get value for key '${o}' from Browser LocalStorageAdaptor. Error:`,s)}return T.isEmptyString(t)&&(t="{}"),t}async removeItem(o){this.logger.info(`Removing value for ${o} from CommonStorage.`)}async setItem(o,t){this.storageViaSiyuanApi?(await this.kernelApi.saveTextData(o,t),this.logger.debug(`Use SiYuan Api LocalStorageAdaptor to setItem - Key '${o}'`)):(Tt.siyuanWindow().localStorage.setItem(o,t),this.logger.debug(`Use Browser LocalStorageAdaptor to setItem - Key '${o}'`))}}const Kr=(c,o)=>{const t=W("common-storage-async"),s=new jr(c),e=rl(o),a=zr(e);t.debug(`It is detected that the serialization type is ${a}`);const n=Po[a];return{commonStore:{async get(){t.debug("Fetching data from common storage...");const l=await s.getItem(s.key)??"{}";let u=await n.read(l)??{};return ae.isEmptyObject(u)&&(t.info("Initial data not found in common storage. Setting initial value..."),await s.setItem(s.key,n.write(o)),t.debug("Initial value set:",o),u=o),u},async set(l){await s.setItem(s.key,n.write(l))}}}};function zr(c){return c==null?"any":c instanceof Set?"set":c instanceof Map?"map":c instanceof Date?"date":typeof c=="boolean"?"boolean":typeof c=="string"?"string":typeof c=="object"?"object":Number.isNaN(c)?"any":"number"}const me=Al("setting",()=>{const c=W("use-setting-store"),o="/data/storage/syp/sy-p-plus-cfg.json",t=Hr,{commonStore:s}=Kr(o,t),e=J(null),a=yn(async()=>{const r=await s.get();return c.debug("get data from setting=>",r),e.value=r,r});return{getSetting:async()=>{if(e.value===null){c.info("Setting not initialized. Initializing now...");const r=a.value;return c.info("Loaded setting from remote api"),r??{}}return c.info("Loaded setting from cache."),e.value??{}},updateSetting:async r=>{c.debug("update setting=>",r),await s.set(r),e.value={...e.value,...r}},checkKeyExists:r=>{const h=e.value;if(!h)return!1;for(const y in h)if(y===r)return!0;return!1},deleteKey:r=>{const h=e.value;if(h){for(const y in h)if(y===r){delete h[y];return}}}}}),Wr=()=>{const c=new Date().toISOString();return Il(c).toLowerCase()},Fr=()=>xl(),Jr=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=Math.random()*16|0;return(o==="x"?t:t&3|8).toString(16)}),Uo={newUuid:Fr,newID:Wr,randomUuid:Jr};class xs{constructor(o,t,s,e,a){D(this,"platformType");D(this,"subPlatformType");D(this,"platformKey");D(this,"platformName");D(this,"platformIcon");D(this,"isEnabled");D(this,"isAuth");D(this,"authMode");D(this,"authUrl");D(this,"logoutUrl");D(this,"domain");D(this,"cookieLimit");D(this,"isSys");this.platformType=o,this.platformKey=t,this.platformName=s,this.isAuth=!1,this.isEnabled=!1,this.authMode="api",t.toLowerCase().includes("Custom".toLowerCase())&&(this.authMode="web"),this.cookieLimit=!1,this.isSys=!1,this.subPlatformType=e,this.platformIcon=a}}var ge=(c=>(c.API="api",c.WEBSITE="web",c))(ge||{}),be=(c=>(c.Common="Common",c.Metaweblog="Metaweblog",c.Wordpress="Wordpress",c.Github="Github",c.Gitlab="Gitlab",c.Custom="Custom",c.System="System",c))(be||{}),N=(c=>(c.Common_Yuque="Yuque",c.Common_Notion="Notion",c.Common_Halo="Halo",c.Common_Telegraph="Telegraph",c.Github_Hexo="Hexo",c.Github_Hugo="Hugo",c.Github_Jekyll="Jekyll",c.Github_Vuepress="Vuepress",c.Github_Vuepress2="Vuepress2",c.Github_Vitepress="Vitepress",c.Gitlab_Hexo="Gitlabhexo",c.Gitlab_Hugo="Gitlabhugo",c.Gitlab_Jekyll="Gitlabjekyll",c.Gitlab_Vuepress="Gitlabvuepress",c.Gitlab_Vuepress2="Gitlabvuepress2",c.Gitlab_Vitepress="Gitlabvitepress",c.Metaweblog_Metaweblog="Metaweblog",c.Metaweblog_Cnblogs="Cnblogs",c.Metaweblog_Typecho="Typecho",c.Metaweblog_Jvue="Jvue",c.Wordpress_Wordpress="Wordpress",c.Wordpress_Wordpressdotcom="Wordpressdotcom",c.Custom_Zhihu="Zhihu",c.Custom_CSDN="Csdn",c.Custom_Wechat="Wechat",c.Custom_Jianshu="Jianshu",c.Custom_Juejin="Juejin",c.System_Siyuan="Siyuan",c.NONE="none",c))(N||{});function qr(c){const o=[];switch(c){case"Common":o.push("Yuque"),o.push("Notion"),o.push("Halo"),o.push("Telegraph");break;case"Github":o.push("Hexo"),o.push("Hugo"),o.push("Jekyll"),o.push("Vuepress"),o.push("Vuepress2"),o.push("Vitepress");break;case"Gitlab":o.push("Gitlabhexo"),o.push("Gitlabhugo"),o.push("Gitlabjekyll"),o.push("Gitlabvuepress"),o.push("Gitlabvuepress2"),o.push("Gitlabvitepress");break;case"Metaweblog":o.push("Metaweblog"),o.push("Cnblogs"),o.push("Typecho"),o.push("Jvue");break;case"Wordpress":o.push("Wordpress"),o.push("Wordpressdotcom");break;case"Custom":o.push("Zhihu"),o.push("Csdn"),o.push("Wechat"),o.push("Jianshu"),o.push("Juejin");break;case"System":o.push("Siyuan");break}return o}function dt(c){const o=c,t=[],s=[],e=[],a=[],n=[],i=[],l=[];return o.forEach(r=>{switch(r.platformType){case"Common":t.push(r);break;case"Github":s.push(r);break;case"Gitlab":e.push(r);break;case"Metaweblog":a.push(r);break;case"Wordpress":n.push(r);break;case"Custom":i.push(r);break;case"System":l.push(r);break}}),{totalCfg:o,commonCfg:t,githubCfg:s,gitlabCfg:e,metaweblogCfg:a,wordpressCfg:n,customCfg:i,systemCfg:l}}function ao(c){const o=c.split("-");let t="";if(o.length>0){const a=o[0].split("_");t=a.length>1?a[1]:a[0]}else throw new Error("Invalid platform key");const e=Object.values(N).find(a=>typeof a=="string"&&a.toLowerCase()===t.toLowerCase());if(e)return e;throw new Error("Invalid platform key")}function Ms(c,o){let t;const s=Uo.newID();return t=c.toLowerCase(),!T.isEmptyString(o)&&o!=="none"&&(t=[t,"_",T.upperFirst(o)].join("")),[t,"-",s].join("")}function mi(c,o){let t=!1;for(let s=0;s<c.length;s++)if(c[s].platformKey===o){t=!0;break}return t}function Io(c,o){for(let t=0;t<c.length;t++)if(c[t].platformKey===o)return c[t];return null}function Wt(c,o,t){const s=[...c];for(let e=0;e<s.length;e++)if(s[e].platformKey===o){s[e]=t;break}return s}function Yr(c,o){return c.filter(t=>t.platformKey!==o)}function Ae(c){return"custom-"+c+"-post-id"}function Ds(c){return"custom-"+c.replace(/_/g,"-")+"-yaml"}function jn(c){const o=/^custom-(.+?)-post-id$/,t=c.match(o);if(t&&t[1])return t[1];throw new Error("Invalid postidKey format")}const ke={iconEPPlus:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-ea893728=""><path d="M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"></path></svg>',iconIFEdit:'<svg t="1689998125340" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5430" width="16" height="16"><path d="M652.4 156.6125a112.5 112.5 0 1 1 155.925 161.15625L731.375 394.71875 572.3 235.5875l79.5375-79.5375 0.5625 0.5625zM333.63125 792.40625v0.1125H174.5v-159.1875l358.03125-357.975 159.075 159.13125-357.975 357.91875zM62 849.5h900v112.5H62v-112.5z" p-id="5431"></path></svg>',iconIFHexo:'<svg t="1684170255787" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7119" width="16" height="16"><path d="M512 0.298667L66.986667 258.389333V770.133333L512 1023.786667l445.013333-258.090667V253.952L512 0.298667z m204.714667 729.813333l-40.064 22.229333-40.064-22.229333V552.106667H387.413333v178.005333l-40.106666 22.229333-40.021334-22.229333V293.973333l40.064-22.229333 40.064 22.229333v178.005334h249.173334V293.973333l40.106666-22.229333 40.021334 22.229333v436.138667z" p-id="7120"></path></svg>',iconIFHexoGitlab:'<svg t="1693214758547" class="icon" viewBox="0 0 1137 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12137" width="16" height="16"><path d="M896.227556 577.991111c-21.048889 0-38.115556 16.952889-38.115556 38.058667v280.007111c0 28.103111-22.755556 50.801778-50.858667 50.801778H728.177778v-131.242667a127.317333 127.317333 0 0 0-127.146667-127.032889H538.168889a127.317333 127.317333 0 0 0-127.089778 127.032889v131.128889H331.776a50.801778 50.801778 0 0 1-50.801778-50.801778v-279.893333a38.115556 38.115556 0 1 0-76.288 0v280.007111a127.317333 127.317333 0 0 0 127.089778 127.032889h155.363556v-207.473778c0-28.046222 22.755556-50.801778 50.858666-50.801778h62.919111c28.103111 0 50.858667 22.755556 50.858667 50.801778v207.36h155.477333a127.317333 127.317333 0 0 0 127.146667-127.032889v-279.893333c0-21.048889-17.066667-38.115556-38.115556-38.115556z" p-id="12138"></path><path d="M1073.208889 413.411556a38.115556 38.115556 0 0 0-22.755556 72.817777 15.36 15.36 0 0 1 2.503111 28.16 15.530667 15.530667 0 0 1-21.845333-9.272889 41.528889 41.528889 0 0 0-4.039111-8.988444l-172.259556-398.677333-0.170666-0.398223a15.473778 15.473778 0 0 1 0.682666-11.662222 15.530667 15.530667 0 0 1 8.760889-7.907555 15.530667 15.530667 0 0 1 11.662223 0.625777 15.36 15.36 0 0 1 5.688888 22.983112 38.115556 38.115556 0 0 0 61.212445 45.511111 91.022222 91.022222 0 0 0 12.856889-84.878223 90.624 90.624 0 0 0-46.819556-52.224A91.192889 91.192889 0 0 0 838.656 5.688889a90.680889 90.680889 0 0 0-52.280889 46.762667 92.728889 92.728889 0 0 0-8.590222 30.890666H359.765333A91.932444 91.932444 0 0 0 298.894222 5.688889a91.192889 91.192889 0 0 0-70.087111 3.811555 91.704889 91.704889 0 0 0-33.962667 137.102223 38.115556 38.115556 0 1 0 61.212445-45.511111 15.36 15.36 0 1 1 26.794667-3.982223l-0.113778 0.341334L110.592 496.071111a44.487111 44.487111 0 0 0-4.039111 8.988445 15.303111 15.303111 0 0 1-10.24 10.296888 15.815111 15.815111 0 0 1-11.662222-1.024 15.36 15.36 0 0 1 2.56-28.216888 38.229333 38.229333 0 0 0 25.031111-47.786667 38.286222 38.286222 0 0 0-47.786667-24.974222 91.591111 91.591111 0 0 0-15.018667 168.448 90.680889 90.680889 0 0 0 69.802667 6.257777c23.893333-7.509333 43.349333-24.177778 54.442667-46.136888h790.414222a91.704889 91.704889 0 0 0 169.244444-13.824 91.818667 91.818667 0 0 0-60.131555-114.744889z m-866.474667 52.451555L339.057778 159.573333h459.434666l132.323556 306.289778H206.734222z" p-id="12139"></path></svg>',iconIFHugo:'<svg t="1684170339672" class="icon" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9235" width="16" height="16"><path d="M800.20014 389.6c-21.8 5.6-39.8 8.6-58.2 15.2-14.6 3.8-29.4 7.8-46.4 12.2l-1.2 0.2c-8.4 2.4-9.2 2.6-17-6.4-9.4-10.6-16.2-17.4-29.2-23.8-39.4-19.2-77.4-13.6-112.8 9.4-42.4 27.4-64.2 68-63.6 118.4 0.6 50 34.8 91 82.4 97.8 44 5.6 79.6-9.2 107.6-41 4.2-5.2 8-10.6 12.2-16.6 1.6-2 3-4.2 4.6-6.6h-120.2c-13 0-16.2-8-11.8-18.6 8-19.4 23-51.8 31.8-68 1.8-3.6 6.2-11.6 13.8-11.6h202.2c9-26.8 23.6-53.8 43.2-79.4 45.4-59.8 98.6-91 174.4-104 63.6-11.2 123.4-5 177.8 31.8 49.2 33.6 79.6 79.2 87.8 139 10.6 84.2-13.8 152.6-73.4 211.2-39.4 41.8-89.8 68-147.8 79.8-11.2 2-22.2 3-33 4-5.8 0.4-11.4 1-17 1.6-56.6-1.2-108.4-17.4-152-54.8-30.6-26.6-51.8-59.2-62.2-97-7.4 14.6-16 28.8-28 42.2-43.2 59.2-101.8 96-175.8 105.8-61.2 8.2-117.8-3.6-167.8-41-46-35-72.2-81-79-138.4-8.2-68 11.8-130.8 52.8-182.6 44.4-58 103-94.8 174.6-107.8 58.6-12.4 114.6-3.8 165.2 30.6 33 21.8 56.6 51.6 72.2 87.8 3.8 5.6 1.2 8.8-6.2 10.6z m-703.6 11.2c-2.5 0-3.12-1.2-1.88-3.2l13.1-16.8c1.24-1.8 4.36-3 6.86-3H337.20014c2.4 0 3 1.8 1.8 3.6l-10.6 16.2c-1.2 2-4.4 3.8-6.2 3.8l-225.6-0.6zM2.49214 458.2c-2.492 0-3.116-1.4-1.868-3.2l13.086-16.8c1.248-1.8 4.364-3.2 6.85-3.2H304.80014c2.4 0 3.6 2 3 3.8l-5 15c-0.6 2.4-3 3.8-5.6 3.8l-294.708 0.6z m148.948 53.6c-1.24 1.8-0.62 3.6 1.86 3.6l135.9 0.6c1.8 0 4.4-1.8 4.4-4.2l1.2-15c0-2.6-1.2-4.4-3.8-4.4H166.40014c-2.5 0-4.98 1.8-6.24 3.8l-8.72 15.6z m1002.96-36c-0.4-5.2-0.6-9.6-1.4-14-11.2-61.6-68-96.6-127.2-82.8-58 13-95.4 49.8-109 108.4-11.2 48.6 12.4 97.8 57.2 117.8 34.4 15 68.6 13.2 101.6-3.8 49.2-27.2 76-65.4 79.2-119-0.2-2.4-0.2-4.6-0.4-6.6z" p-id="9236"></path></svg>',iconIFJekyll:'<svg t="1694167709305" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4932" width="16" height="16"><path d="M667.4 180c-35.2 0-69.6 8.8-99.7 27.1-57.2 32.2-91.6 89.4-91.6 151.7v306.4c0 35.9-20.5 68.9-55 88.7-19.8 11-41.8 16.9-64.5 16.9-66 0-119.5-47.6-119.5-105.5 0-17.6 4.4-34.4 13.9-49.8 13.9-23.5 38.8-41.8 70.4-51.3 3.7-1.5 6.6-1.5 8.1-1.5 20.5 0 36.6-16.1 36.6-36.6s-16.1-36.6-36.6-36.6c-8.8 0-17.6 1.5-30.8 5.1-46.9 13.9-85.8 43.2-109.9 82.8-16.1 27.1-24.9 57.2-24.9 87.9 0 98.9 86.5 178.8 192.8 178.8 35.2 0 69.6-8.8 100.4-26.4 57.2-32.2 91.6-89.4 91.6-151.7V358.8c0-35.9 20.5-68.9 55-88.7 19.8-11 41.8-16.9 64.5-16.9 65.2 0 118.7 47.6 118.7 105.5 0 17.6-4.4 34.4-13.9 49.8-13.9 24.2-38.8 42.5-70.4 51.3-3.7 1.5-6.6 1.5-8.1 1.5-20.5 0-36.6 16.1-36.6 36.6s16.1 36.6 36.6 36.6c8.8 0 18.3-1.5 30.8-5.1 46.9-13.9 85.8-43.2 109.9-82.8 16.1-27.1 24.9-57.2 24.9-87.9 0-98.8-86.5-178.7-192.7-178.7z" p-id="4933"></path></svg>',iconIFVuepress:'<svg t="1694167910261" class="icon" viewBox="0 0 1120 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8613" width="16" height="16"><path d="M1055.594124 381.672727L897.339578 139.636364c-18.618182-37.236364-74.472727-55.854545-111.709091-55.854546H282.939578c-37.236364 0-93.090909 27.927273-111.709091 55.854546L12.975942 381.672727c-18.618182 37.236364-18.618182 83.781818 9.309091 111.709091l465.454545 493.381818c27.927273 27.927273 65.163636 18.618182 93.090909 0l465.454546-493.381818c27.927273-27.927273 37.236364-83.781818 9.309091-111.709091z m-242.036364-74.472727s0 9.309091 0 0L552.903215 726.109091H422.575942L376.030487 344.436364c0-18.618182-9.309091-27.927273-9.309091-37.236364-9.309091-9.309091-18.618182-9.309091-27.927272-9.309091l9.309091-18.618182H469.121396c9.309091 0 18.618182 0 27.927273 9.309091 9.309091 9.309091 9.309091 18.618182 9.309091 27.927273l27.927273 269.963636 139.636363-251.345454v-9.309091-9.309091c0-9.309091 0-9.309091-9.309091-18.618182-9.309091 0-9.309091-9.309091-18.618181-9.309091l9.309091-18.618182h139.636363c9.309091 0 18.618182 0 18.618182 9.309091s9.309091 18.618182 0 27.927273c9.309091 0 0 0 0 0z" p-id="8614"></path></svg>',iconIFVuepress2:'<svg t="1694167983538" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8866" width="16" height="16"><path d="M554.666667 384h234.666666L554.666667 149.333333V384M256 85.333333h341.333333l256 256v512a85.333333 85.333333 0 0 1-85.333333 85.333334H256a85.333333 85.333333 0 0 1-85.333333-85.333334V170.666667c0-47.36 37.973333-85.333333 85.333333-85.333334m384 682.666667v-85.333333H256v85.333333h384m128-170.666667v-85.333333H256v85.333333h512z" p-id="8867"></path><path d="M516.010667 555.946667l249.941333 431.36 249.941333-429.269334v-2.133333h-97.152l-151.338666 259.925333-150.613334-259.925333z" fill="#41B883" p-id="8868"></path><path d="M616.789333 555.946667l150.613334 259.925333 151.338666-259.968h-91.136L768 658.218667l-59.306667-102.314667z" p-id="8869"></path></svg>',iconIFVue:'<svg t="1684170497745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10726" width="16" height="16"><path d="M512 504L764.8 68.8h-134.4L512 275.2 393.6 70.4h-134.4L512 504zM819.2 70.4L512 600 204.8 68.8H0l512 886.4L1024 70.4H819.2z" p-id="10727"></path></svg>',iconIFNuxt:'<svg t="1689995630285" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2710" width="16" height="16"><path d="M841.557333 864.938667l0.981334-1.92a31.573333 31.573333 0 0 0 2.261333-4.992l0.085333-0.213334a49.493333 49.493333 0 0 0 2.304-25.898666l0.042667 0.298666a76.586667 76.586667 0 0 0-10.026667-26.581333l0.213334 0.341333-226.858667-399.061333-34.645333-60.586667-34.432 60.586667-226.730667 399.061333a78.933333 78.933333 0 0 0-8.704 25.770667l-0.042667 0.469333a53.632 53.632 0 0 0 3.413334 30.421334l-0.128-0.341334a34.517333 34.517333 0 0 0 2.133333 4.352l-0.085333-0.170666c6.826667 11.733333 21.333333 25.685333 53.333333 25.685333h422.314667c6.698667 0 39.466667-1.365333 54.613333-27.178667z m-265.685333-397.482667l207.317333 364.714667H368.64z m437.290667 338.517333L713.813333 278.613333c-3.072-5.546667-20.352-33.578667-50.432-33.578666-13.525333 0-32.938667 5.76-48.725333 33.493333l-38.698667 67.84 34.432 60.586667 53.333334-94.378667 296.149333 519.68h-112.64a50.645333 50.645333 0 0 1-2.474667 25.941333l0.128-0.341333a32.938667 32.938667 0 0 1-2.432 5.376l0.085334-0.170667-0.981334 1.92c-15.146667 25.813333-47.872 27.178667-54.272 27.178667h176.170667c6.485333 0 39.125333-1.365333 54.272-27.178667 6.698667-11.733333 11.52-31.445333-4.565333-58.965333zM311.637333 866.432a42.197333 42.197333 0 0 1-1.92-3.925333l-0.085333-0.256a52.394667 52.394667 0 0 1-3.584-30.378667l-0.042667 0.298667H64.042667L423.68 199.338667l118.058667 207.530666 34.218666-60.586666-102.912-181.290667c-2.858667-5.205333-20.266667-33.152-50.218666-33.152-13.525333 0-32.938667 5.845333-48.725334 33.578667L9.813333 805.930667c-3.072 5.546667-18.133333 34.645333-3.2 60.458666 6.826667 11.733333 21.333333 25.685333 53.333334 25.685334h305.109333c-31.786667 0-46.506667-13.738667-53.333333-25.685334z" p-id="2711"></path></svg>',iconIFYuque:'<svg t="1684169305378" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5780" width="16" height="16"><path d="M903.542857 350.4c-11.314286-45.028571 11.314286-116.8 83.885714-142.171429l-77.6-4.114285s-29.371429-102.857143-164.114285-112c-134.628571-9.257143-222.742857-3.428571-222.857143-3.428572 0.114286 0 99.885714 63.542857 59.885714 176.8-29.257143 60-75.2 109.257143-124.342857 165.371429-1.485714 1.485714-2.857143 2.971429-4 4.228571C291.885714 618.285714 36.571429 909.714286 36.571429 909.714286c281.028571 73.6 469.371429-7.2 580.8-104.114286 23.428571-0.228571 41.028571-0.342857 52.914285-0.342857 155.2 0 286.4-134.4 281.028572-283.885714-3.657143-102.742857-36.457143-125.942857-47.771429-170.971429z m-233.257143 381.714286c-12.114286 0-29.942857 0.114286-53.485714 0.342857l-26.971429 0.228571-20.342857 17.714286c-53.828571 46.857143-119.314286 81.714286-195.885714 100.114286-60 14.4-125.714286 18.514286-197.371429 10.971428 20.571429-23.428571 41.714286-47.542857 63.314286-72.114285 105.142857-119.542857 198.628571-225.714286 270.742857-306.857143l1.6-1.6 1.485715-1.714286c4.685714-5.257143 23.542857-26.628571 28.228571-32.114286 11.085714-12.685714 19.771429-22.742857 28-32.685714 35.085714-41.942857 59.657143-77.485714 78.857143-116.8l1.828571-3.771429 1.371429-3.885714c15.657143-44.342857 17.6-87.885714 7.085714-128.914286 25.714286 0.8 53.142857 2.171429 81.942857 4.114286 38.057143 2.628571 63.428571 14.742857 81.257143 33.371429 6.628571 6.857143 11.657143 14.285714 15.314286 21.371428 1.142857 2.285714 1.942857 4.114286 2.628571 5.714286l5.714286 20.228571c-17.942857 39.428571-22.742857 83.771429-13.028571 122.514286 3.428571 13.485714 7.885714 25.6 14.057142 39.314286 2.4 5.371429 10.857143 22.971429 12.571429 26.628571 11.771429 25.942857 17.6 49.142857 19.085714 89.942857 3.771429 108.114286-94.514286 207.885714-208 207.885715z" p-id="5781"></path></svg>',iconIFNotion:'<svg t="1691069780339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3978" width="16" height="16"><path d="M190.3619 179.479263c31.818329 25.847061 43.760866 23.885073 103.558852 19.875793l563.645073-33.822969c11.942537 0 2.00464-11.942537-1.961988-13.904525L761.940229 83.938971c-17.913805-13.904525-41.84153-29.856341-87.649688-25.889713L128.559273 97.886148c-19.875793 1.961988-23.885073 11.942537-15.951816 19.875793z m33.822969 131.367902v593.032243c0 31.860981 15.909165 43.803518 51.779427 41.798878l619.433779-35.827609c35.870262-1.961988 39.879542-23.885073 39.879541-49.774787V271.010276c0-25.847061-9.937896-39.794238-31.903633-37.83225l-647.328132 37.83225c-23.885073 2.00464-31.860981 13.947177-31.860982 39.794237z m611.500523 31.775678c3.966628 17.913805 0 35.82761-17.913805 37.874902l-29.856341 5.971268v437.779268c-25.932365 13.947177-49.817438 21.923085-69.735883 21.923085-31.903633 0-39.879542-9.980548-63.764615-39.794238l-195.21782-306.49667v296.516122L520.956902 810.386408s0 35.82761-49.817438 35.82761l-137.424474 7.933256c-3.966628-7.933256 0-27.851701 13.947177-31.818329l35.827609-9.937897V420.291982L333.800294 416.282702c-4.00928-17.913805 5.971268-43.760866 33.82297-45.765506l147.405022-9.937896 203.193729 310.463298v-274.678341l-51.822078-5.928616c-3.966628-21.923085 11.942537-37.83225 31.860981-39.794238zM82.751115 44.144733l567.697005-41.798878c69.693231-5.971268 87.649688-2.00464 131.453206 29.856342l181.227992 127.358622c29.856341 21.880433 39.83689 27.851701 39.83689 51.736774v698.553084c0 43.760866-15.909165 69.693231-71.65522 73.617207l-659.313321 39.83689c-41.798878 2.00464-61.759975-3.966628-83.683059-31.860982l-133.457846-173.166779c-23.885073-31.860981-33.82297-55.703403-33.82297-83.597756V113.752661c0-35.784958 15.951817-65.683951 61.717323-69.607928z" p-id="3979"></path></svg>',iconIFHalo:'<svg t="1695187534618" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5055" width="16" height="16"><path d="M540.672 470.09792c0-0.7424-0.03584-1.46944-0.11264-2.19136a20.9408 20.9408 0 0 1 11.58144-20.92032c1.54112-0.75776 2.98496-1.70496 4.3008-2.816l320.9216-314.17856a20.93056 20.93056 0 0 0-13.5936-36.89984H160.2304a21.00224 21.00224 0 0 0-15.2576 6.56384 20.9152 20.9152 0 0 0 0.84992 29.60384l288.82944 314.17344c2.2272 2.0992 4.88448 3.6864 7.7824 4.64896a20.94592 20.94592 0 0 1 14.336 20.92544c-0.0256 0.54272-0.0256 0.54272-0.03072 1.09056v426.89536l83.93216 20.9408V470.10304z m41.96864 481.73056c0 15.56992-16.41472 25.69728-30.36672 18.73408l-125.9008-41.89184a20.9408 20.9408 0 0 1-11.60192-18.73408V480.90624c-3.1744-2.05824-6.16448-4.4032-8.9344-7.0144L117.00736 159.71328c-25.27744-23.82848-26.41408-63.60064-2.54464-88.832A63.00672 63.00672 0 0 1 160.2304 51.2h703.5392C898.5344 51.2 926.72 79.3344 926.72 114.03264c0 18.432-8.11008 35.9424-22.17984 47.87712l-320.9216 314.17344c-0.32256 0.27648-0.65024 0.54784-0.97792 0.81408v474.9312z"  p-id="5056"></path></svg>',iconIFCnblogs:'<svg t="1684168925817" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4454" width="16" height="16"><path d="M851.404 172.596c-187.462-187.461-491.346-187.461-678.808 0-187.461 187.462-187.461 491.346 0 678.808 187.462 187.461 491.346 187.461 678.808 0 187.461-187.462 187.461-491.346 0-678.808zM387.33 728.087a47.084 47.084 0 1 1-66.633-66.502 47.084 47.084 0 0 1 66.633 66.502z m205.527 1.397a38.75 38.75 0 0 1-76.625-11.52h-0.044a6.545 6.545 0 0 0-0.044 0.305v-0.349c0.306-2.618 2.051-20.727-2.967-44.99a174.24 174.24 0 0 0-48.567-89.28 172.102 172.102 0 0 0-88.8-48.305 156.698 156.698 0 0 0-42.458-2.923 38.662 38.662 0 0 1-35.39-65.324 38.618 38.618 0 0 1 21.12-10.822v-0.218c4.452-0.742 111.142-16.45 200.335 72.742 89.018 89.018 74.182 196.145 73.44 200.727z m175.2 7.592a38.75 38.75 0 0 1-65.673 21.382 39.49 39.49 0 0 1-11.65-33.73c0.087-0.35 5.105-37.484-5.062-88.975-13.31-67.375-45.295-126.895-94.953-176.902-50.007-49.702-109.527-81.644-176.945-94.953-51.491-10.167-88.582-5.193-89.019-5.149h0.219-0.044a39.927 39.927 0 0 1-44.684-32.902 38.836 38.836 0 0 1 32.204-44.378c1.92-0.305 47.869-7.33 111.273 4.364a411.753 411.753 0 0 1 106.254 34.952 425.76 425.76 0 0 1 114.633 82.255l0.916 0.96 0.96 0.873a425.89 425.89 0 0 1 82.255 114.72c16.407 33.6 28.145 69.294 34.996 106.21 11.651 63.404 4.67 109.353 4.32 111.273z" p-id="4455"></path></svg>',iconIFTypecho:'<svg t="1684170671485" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12354" width="16" height="16"><path d="M942.933333 132.266667l-168.533333-10.666667v64l164.266667 10.666667c8.533333 0 12.8 4.266667 14.933333 6.4 2.133333 2.133333 6.4 8.533333 4.266667 14.933333l-46.933334 718.933333c0 10.666667-10.666667 19.2-21.333333 19.2h-2.133333l-115.2-8.533333c-4.266667 21.333333-23.466667 36.266667-46.933334 36.266667H362.666667l522.666666 34.133333h6.4c44.8 0 81.066667-34.133333 85.333334-78.933333L1024 219.733333c2.133333-44.8-34.133333-85.333333-81.066667-87.466666z" p-id="12355"></path><path d="M727.466667 74.666667c6.4 0 10.666667 4.266667 10.666666 10.666666v853.333334c0 6.4-4.266667 10.666667-10.666666 10.666666h-640c-6.4 0-10.666667-4.266667-10.666667-10.666666V85.333333c0-6.4 4.266667-10.666667 10.666667-10.666666h640m0-74.666667h-640c-46.933333 0-85.333333 38.4-85.333334 85.333333v853.333334c0 46.933333 38.4 85.333333 85.333334 85.333333h640c46.933333 0 85.333333-38.4 85.333333-85.333333V85.333333c0-46.933333-38.4-85.333333-85.333333-85.333333z" p-id="12356"></path><path d="M522.666667 518.4H177.066667c-21.333333 0-36.266667-17.066667-36.266667-36.266667 0-21.333333 17.066667-36.266667 36.266667-36.266666h345.6c21.333333 0 36.266667 17.066667 36.266666 36.266666 0 19.2-17.066667 36.266667-36.266666 36.266667z" p-id="12357"></path><path d="M424.533333 686.933333H177.066667c-21.333333 0-38.4 17.066667-38.4 38.4s17.066667 38.4 38.4 38.4h247.466666c21.333333 0 38.4-17.066667 38.4-38.4s-17.066667-38.4-38.4-38.4z" p-id="12358"></path></svg>',iconIFWordpress:'<svg t="1684168789622" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4159" width="16" height="16"><path d="M916.010667 291.2c35.84 65.578667 56.234667 140.8 56.234666 220.8 0 169.770667-91.989333 318.122667-228.821333 397.866667l140.586667-406.485334c26.24-65.706667 34.986667-118.229333 34.986666-164.864 0-17.28-1.109333-33.28-2.986666-47.36m-340.522667 4.48c27.605333-1.28 52.565333-4.48 52.565333-4.48 24.832-3.2 21.930667-39.68-2.858666-38.357333 0 0-74.88 5.76-122.88 5.76-45.397333 0-121.6-6.4-121.6-6.4-24.96-1.28-28.202667 36.48-3.2 37.76 0 0 23.04 2.602667 48 3.84l71.68 196.48-101.12 302.08L228.437333 294.4c27.690667-1.28 52.650667-4.266667 52.650667-4.266667 24.96-3.2 22.016-39.68-2.773333-38.229333 0 0-74.496 5.888-122.624 5.888-8.533333 0-18.688-0.341333-29.44-0.64C209.536 134.4 351.36 51.84 512 51.84c119.850667 0 228.906667 45.738667 310.869333 120.874667-1.962667-0.128-3.882667-0.384-6.016-0.384-45.226667 0-77.312 39.381333-77.312 81.664 0 37.973333 21.888 70.101333 45.226667 107.989333 17.536 30.72 37.973333 70.101333 37.973333 127.018667 0 39.04-15.104 85.077333-35.029333 148.437333l-45.866667 152.96-166.4-495.36 0.042667 0.597333zM512 972.117333c-45.184 0-88.789333-6.528-130.048-18.645333l138.112-401.322667 141.44 387.712c1.024 2.261333 2.133333 4.309333 3.328 6.357334-47.786667 16.768-99.2 25.984-152.832 25.984M51.669333 512c0-66.730667 14.336-130.133333 39.893334-187.306667L311.04 926.250667A460.544 460.544 0 0 1 51.669333 512M512 0C229.76 0 0 229.76 0 512s229.76 512 512 512 512-229.76 512-512S794.24 0 512 0" p-id="4160"></path></svg>',iconIFZhihu:'<svg t="1689993036802" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2449" width="16" height="16"><path d="M564.7 230.1V803h60l25.2 71.4L756.3 803h131.5V230.1H564.7z m247.7 497h-59.9l-75.1 50.4-17.8-50.4h-18V308.3h170.7v418.8zM526.1 486.9H393.3c2.1-44.9 4.3-104.3 6.6-172.9h130.9l-0.1-8.1c0-0.6-0.2-14.7-2.3-29.1-2.1-15-6.6-34.9-21-34.9H287.8c4.4-20.6 15.7-69.7 29.4-93.8l6.4-11.2-12.9-0.7c-0.8 0-19.6-0.9-41.4 10.6-35.7 19-51.7 56.4-58.7 84.4-18.4 73.1-44.6 123.9-55.7 145.6-3.3 6.4-5.3 10.2-6.2 12.8-1.8 4.9-0.8 9.8 2.8 13 10.5 9.5 38.2-2.9 38.5-3 0.6-0.3 1.3-0.6 2.2-1 13.9-6.3 55.1-25 69.8-84.5h56.7c0.7 32.2 3.1 138.4 2.9 172.9h-141l-2.1 1.5c-23.1 16.9-30.5 63.2-30.8 65.2l-1.4 9.2h167c-12.3 78.3-26.5 113.4-34 127.4-3.7 7-7.3 14-10.7 20.8-21.3 42.2-43.4 85.8-126.3 153.6-3.6 2.8-7 8-4.8 13.7 2.4 6.3 9.3 9.1 24.6 9.1 5.4 0 11.8-0.3 19.4-1 49.9-4.4 100.8-18 135.1-87.6 17-35.1 31.7-71.7 43.9-108.9L497 850l5-12c0.8-1.9 19-46.3 5.1-95.9l-0.5-1.8-108.1-123-22 16.6c6.4-26.1 10.6-49.9 12.5-71.1h158.7v-8c0-40.1-18.5-63.9-19.2-64.9l-2.4-3z" p-id="2450"></path></svg>',iconIFCSDN:'<svg t="1690721786570" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3120" width="16" height="16"><path d="M512 0c282.784 0 512 229.216 512 512s-229.216 512-512 512S0 794.784 0 512 229.216 0 512 0z m189.952 752l11.2-108.224c-31.904 9.536-100.928 16.128-147.712 16.128-134.464 0-205.728-47.296-195.328-146.304 11.584-110.688 113.152-145.696 232.64-145.696 54.784 0 122.432 8.8 151.296 18.336L768 272.704C724.544 262.24 678.272 256 599.584 256c-203.2 0-388.704 94.88-406.4 263.488C178.336 660.96 303.584 768 535.616 768c80.672 0 138.464-6.432 166.336-16z" p-id="3121"></path></svg>',iconIFJianshu:'<svg t="1690723639888" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5035" width="16" height="16"><path d="M654.791 38.495h-286.53c-95.005 0-142.412 0-193.612 16.118-55.94 20.48-99.935 64.474-120.225 120.226-16.308 51.2-16.308 98.607-16.308 193.611v286.53c0 95.005 0 142.602 16.118 193.613 20.29 55.75 64.285 99.745 120.036 120.035 51.2 16.119 98.607 16.119 193.611 16.119h286.53c95.005 0 142.413 0 193.613-16.119 55.75-20.29 99.745-64.284 120.225-120.035 16.118-51.2 16.118-98.608 16.118-193.612V368.45c0-95.005 0-142.412-16.118-193.612-20.29-55.752-64.285-99.746-120.225-120.226-50.821-16.118-98.228-16.118-193.233-16.118z m0 0" p-id="5036"></path><path d="M235.52 456.818h70.732v370.346H235.52V456.818z m40.012-112.45c17.825 32.995 29.203 65.8 34.512 98.796h77.18c-10.62-42.097-23.894-74.903-39.823-98.797h-71.87z m0 0" fill="#a0cfff" p-id="5037"></path><path d="M427.804 278.566h85.144v-46.649H358.59c1.706-3.603 4.361-10.05 7.964-19.153 1.707-7.395 3.603-12.705 5.31-16.497H292.03c-12.326 49.303-40.77 85.902-85.144 109.795v46.65c58.595-14.602 100.124-39.254 124.966-73.956H358.4c8.913 23.703 14.222 46.648 15.929 68.645h74.524c-5.12-25.79-12.326-48.734-21.049-68.835z m-34.702 148.1h320.664v301.701c1.707 27.497-10.62 40.202-37.167 38.306h-43.995v54.803h63.906c62.009 1.896 92.16-26.549 90.453-85.144V371.864h-393.86v54.803z m0 0" fill="#a0cfff" p-id="5038"></path><path d="M643.224 476.16H382.483v277.049H563.39c56.699 1.896 83.437-25.6 79.834-82.3V476.16z m-188.871 49.304h117.001v63.146H454.353v-63.146z m82.488 178.252h-82.488v-68.457h117.001v32.996c1.707 25.41-9.671 37.357-34.513 35.46zM645.88 229.262c0-1.896 0.948-4.55 2.654-8.154l7.965-24.652h-79.834c-12.516 51.2-39.823 89.695-82.49 115.295v43.805c54.993-14.602 96.712-40.202 124.967-76.8h37.167c8.913 23.703 14.222 46.648 15.929 68.645h71.87c-1.707-18.204-8.913-41.15-21.239-68.645h93.108v-49.304H645.88z m0 0" fill="#a0cfff" p-id="5039"></path></svg>',iconIFJuejin:'<svg t="1690725319716" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6174" width="16" height="16"><path d="M465.189 161.792c-22.967 18.14-44.325 35.109-47.397 37.742l-5.851 4.68 10.971 8.632c5.998 4.827 11.85 9.508 13.02 10.532 1.17 1.024 17.993 14.336 37.156 29.696l34.962 27.795 5.267-3.95c2.925-2.194 23.259-18.432 45.348-35.986 21.943-17.555 41.253-32.768 42.716-33.646 1.609-1.024 2.779-2.194 2.779-2.78 0-0.438-9.655-8.63-21.504-17.846-11.995-9.363-22.674-17.847-23.845-18.871-15.945-13.02-49.737-39.059-50.76-39.059-0.586 0.147-19.896 14.922-42.862 33.061z m233.325 180.37C507.465 493.275 508.928 492.105 505.417 489.911c-3.072-1.902-11.556-8.485-64.073-50.03-9.07-7.168-18.578-14.775-21.358-16.823-2.78-2.194-8.777-6.875-13.312-10.532-4.68-3.657-10.679-8.339-13.312-10.533-13.165-10.24-71.095-56.027-102.107-80.457-5.852-4.681-11.41-8.485-12.142-8.485-0.731 0-10.971 7.754-22.674 17.116-11.703 9.508-22.674 18.286-24.284 19.456-1.755 1.17-5.12 3.95-7.46 6.144-2.34 2.34-4.828 4.096-5.413 4.096-3.072 0-0.731 3.072 6.437 8.777 4.096 3.218 8.777 6.875 10.094 8.046 1.316 1.024 10.24 8.045 19.748 15.506s23.26 18.286 30.428 23.99c19.31 15.215 31.89 25.308 127.853 101.084 47.836 37.742 88.796 69.779 90.844 71.095 3.657 2.487 3.95 2.487 7.46-0.292a1041.42 1041.42 0 0 0 16.092-12.727c6.875-5.413 14.775-11.703 17.554-13.897 30.135-23.699 80.018-63.05 81.774-64.512 1.17-1.024 12.434-9.802 24.868-19.603s37.888-29.696 56.32-44.324c18.579-14.629 46.227-36.425 61.733-48.567 15.506-12.142 27.794-22.528 27.502-23.26-0.878-1.17-57.637-47.104-59.978-48.274-0.731-0.439-18.578 12.727-39.497 29.257z" p-id="6175"></path><path d="M57.93 489.326c-15.215 12.288-28.527 23.405-29.697 24.576-2.34 2.194-5.412-0.44 80.018 66.852 33.207 26.185 32.622 25.747 57.637 45.495 10.386 8.192 36.279 28.672 57.783 45.495 38.18 30.135 44.91 35.401 52.663 41.545 2.048 1.756 22.967 18.14 46.372 36.572 23.26 18.432 74.167 58.514 112.933 89.088 38.912 30.573 71.095 55.734 71.826 56.027 0.732 0.293 7.46-4.389 14.921-10.386 21.797-16.97 90.259-70.949 101.523-79.872 5.705-4.535 12.873-10.24 15.945-12.58 3.072-2.488 6.436-5.12 7.314-5.852 0.878-0.878 11.85-9.509 24.283-19.31 20.773-16.091 59.1-46.226 64.366-50.615 1.17-1.024 5.12-4.096 8.777-6.875 3.657-2.78 7.9-6.29 9.509-7.607 1.609-1.317 14.775-11.703 29.257-23.113 29.11-22.82 42.277-33.207 88.503-69.632 17.262-13.605 32.475-25.454 33.646-26.478 2.486-2.048 31.451-24.869 44.617-35.255 4.827-3.657 9.07-7.168 9.508-7.607 0.44-0.585 5.998-4.827 12.435-9.8 6.436-4.828 13.165-10.24 15.067-11.85l3.365-2.926-9.948-7.753c-5.412-4.388-10.24-8.192-10.679-8.63-1.17-1.317-22.381-18.433-30.135-24.284-3.95-3.072-7.314-5.998-7.606-6.73-1.317-3.071-6.73 0.147-29.258 17.994-13.458 10.532-25.746 20.187-27.355 21.504-1.61 1.463-10.533 8.338-19.749 15.652-9.216 7.168-17.115 13.459-17.554 13.898-0.439 0.438-6.583 5.412-13.897 10.971-7.168 5.559-15.214 11.703-17.7 13.75-4.974 4.097-5.413 4.39-20.334 16.239-5.56 4.388-11.264 8.777-12.435 9.8-1.17 1.025-20.333 16.092-42.422 33.354-22.09 17.408-41.546 32.768-43.155 34.084-1.609 1.463-14.482 11.557-28.525 22.528s-40.814 32.037-59.539 46.812c-18.578 14.775-42.276 33.353-52.516 41.399s-23.26 18.285-28.965 22.82l-10.386 8.339-4.389-3.072c-2.34-1.756-4.68-3.511-5.12-3.95-0.439-0.439-4.973-4.096-10.24-8.046-11.849-9.216-14.482-11.264-16.676-13.166-0.878-0.877-4.243-3.51-7.46-5.851-3.22-2.487-6.145-4.681-6.584-5.12-0.439-0.439-6.875-5.705-14.482-11.703-7.607-5.851-14.921-11.556-16.091-12.58-1.317-1.17-17.116-13.605-35.255-27.795-17.993-14.19-35.109-27.648-38.035-29.842-5.705-4.681-33.499-26.624-125.074-98.743-34.523-27.209-72.704-57.344-84.846-66.852-49.737-39.498-55.15-43.594-56.905-43.447-0.877 0-14.043 10.24-29.257 22.528z" p-id="6176"></path></svg>',iconIFFlowus:'<svg t="1695385585153" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9273" width="16" height="16"><path d="M357.717333 907.733333c-93.952 56.661333-174.805333 72.533333-223.829333 31.445334-45.269333-37.973333-47.616-105.984-19.584-192.512a42.666667 42.666667 0 0 1 81.194667 26.325333c-18.389333 56.746667-17.194667 92.074667-6.741334 100.821333 13.909333 11.690667 64.981333-0.768 136.576-46.762666 82.218667-52.864 177.365333-140.074667 265.386667-244.992 88.277333-105.173333 157.269333-212.821333 194.602667-301.44 32.554667-77.184 35.712-128.256 21.76-139.946667-3.413333-2.858667-10.368-4.48-22.698667-3.157333a42.666667 42.666667 0 1 1-9.002667-84.906667c33.664-3.541333 63.530667 3.413333 86.528 22.656 47.829333 40.149333 47.786667 118.357333 11.264 216.192C915.797333 353.493333 938.666667 430.549333 938.666667 512c0 235.648-191.018667 426.666667-426.666667 426.666667a426.026667 426.026667 0 0 1-142.08-24.234667 42.624 42.624 0 0 1-12.202667-6.698667z m86.997334-61.013333A341.333333 341.333333 0 0 0 853.333333 512c0-44.373333-8.448-86.741333-24.362666-124.288-41.898667 78.122667-100.992 163.541333-172.885334 249.173333-69.973333 83.413333-142.464 155.136-211.370666 209.834667z m222.933333-733.141333a42.666667 42.666667 0 0 1-29.696 80.042666A362.026667 362.026667 0 0 0 512 170.666667a341.333333 341.333333 0 0 0-321.706667 455.68 42.666667 42.666667 0 0 1-80.426666 28.586666A423.68 423.68 0 0 1 85.333333 512C85.333333 276.352 276.352 85.333333 512 85.333333c53.248 0 105.770667 9.813333 155.648 28.245334z" p-id="9274"></path></svg>',iconIFWechat:'<svg t="1690726490823" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7276" width="16" height="16"><path d="M996.427776 623.853568c0-139.354112-138.063872-251.815936-291.87072-251.815936-162.281472 0-290.656256 112.461824-290.656256 251.815936 0 139.352064 128.374784 251.807744 290.656256 251.807744 35.119104 0 69.031936-11.001856 104.148992-18.331648l92.043264 52.559872-24.2176-88.014848c67.821568-50.122752 119.896064-119.791616 119.896064-198.02112z m-386.338816-45.24032c-16.95744 0-33.906688-15.890432-33.906688-31.77472 0-19.562496 16.95744-35.446784 33.906688-35.446784 25.438208 0 43.599872 15.890432 43.599872 35.446784 0.002048 15.884288-18.161664 31.77472-43.599872 31.77472z m190.144512 0c-18.167808 0-33.910784-15.890432-33.910784-31.77472 0-19.562496 15.745024-35.446784 33.910784-35.446784 24.219648 0 42.387456 15.890432 42.387456 35.446784 0 15.884288-18.169856 31.77472-42.387456 31.77472z"  p-id="7277"></path><path d="M683.97056 352.48128c9.68704 0 20.588544 1.216512 32.700416 3.672064-29.063168-141.809664-178.03264-242.044928-345.155584-242.044928-188.925952 0-343.943168 127.127552-343.943168 293.373952 0 94.130176 50.868224 171.145216 136.855552 232.25344l-35.131392 105.132032 122.318848-62.347264c42.385408 12.232704 75.087872 19.562496 119.90016 19.562496 9.68704 0 20.594688 0 30.27968-1.216512-6.053888-24.45312-9.684992-47.681536-9.684992-73.34912 0-150.355968 127.156224-275.03616 291.86048-275.03616z m-185.2928-91.686912c26.64448 0 43.599872 15.890432 43.599872 42.78272 0 25.675776-16.955392 42.784768-43.599872 42.784768-25.432064 0-49.657856-17.1008-49.657856-42.784768 0-26.894336 24.225792-42.78272 49.657856-42.78272z m-239.794176 85.573632c-25.432064 0-52.076544-17.115136-52.076544-42.79296 0-26.894336 26.64448-42.78272 52.076544-42.78272 24.223744 0 43.599872 15.890432 43.599872 42.78272 0 25.677824-19.376128 42.79296-43.599872 42.79296z"  p-id="7278"></path></svg>',iconIFSiyuan:'<svg t="1690817357506" class="icon" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1557" width="16" height="16"><path d="M1.706667 0h1024v1024H1.706667z" fill="#2E2C2F" p-id="1558"></path><path d="M307.862187 555.677013l38.34368 13.202774c-13.19936 47.77472-22.00064 70.40512-38.971734 106.23488-13.830827 28.91264-22.00064 42.115413-42.745173 69.771946l-35.82976-25.775786c22.00064-24.512853 30.17216-37.08416 43.373227-62.85824 17.600853-33.312427 25.14432-54.683307 35.82976-100.575574z m-13.201067-103.673173v-153.378133c0-27.02848-0.628053-44.00128-2.515627-60.972374 16.34304 2.51392 34.573653 3.141973 59.088214 3.141974H668.0064c24.512853 0 42.743467-0.628053 59.086507-3.141974-1.88416 16.34304-2.51392 32.058027-2.51392 60.972374v153.378133c0 26.400427 0.62976 42.115413 2.51392 58.4192-18.230613-2.471253-37.085867-3.10272-59.086507-3.10272H350.605653c-21.998933 0-40.855893 1.256107-58.458453 3.10272 1.885867-16.93184 2.51392-33.90464 2.51392-58.4192z m230.029653 20.744533h161.542827v-83.60448h-161.542827v83.60448z m0-117.548373h161.542827v-79.83104h-161.542827v79.83104z m-191.684266 117.548373h154.632533v-83.60448h-154.632533v83.60448z m0-117.548373h154.632533v-79.83104h-154.632533v79.83104z m144.576853 196.082347l29.540693-20.744534c36.462933 34.573653 58.422613 59.712853 90.478934 104.3456l-32.05632 25.14432c-27.0336-45.88544-48.402773-72.915627-87.963307-108.745386z m-43.999573 57.828693v89.260373c0 23.888213 10.68032 27.026773 91.106986 27.026774 72.91392 0 95.5392-3.13856 104.97024-15.085227 6.28736-8.797867 9.42592-28.286293 11.32032-72.287573 13.824 8.173227 23.253333 11.94496 38.966614 15.714986-6.28736 61.60384-11.93984 81.716907-27.656534 92.407467-16.34304 11.941547-52.169387 16.341333-135.14752 16.341333-104.9344 0-123.16672-8.173227-123.16672-55.942826v-97.4336c0-32.684373-0.626347-42.745173-3.76832-57.8304h47.14496c-3.145387 16.96768-3.770027 27.656533-3.770026 57.828693z m261.4528-57.828693c42.743467 52.800853 71.02976 96.802133 103.71584 162.174293l-35.82976 24.517973c-30.173867-72.28928-53.430613-111.261013-98.689707-167.835306l30.803627-18.85696z" fill="#FFFFFF" p-id="1559"></path></svg>',iconOTYes:'<svg viewBox="64 64 896 896" focusable="false" class="" data-icon="check-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="#52c41a"></path><path d="M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z" fill="#f6ffed"></path><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" fill="#52c41a"></path></svg>',iconOTNo:'<svg t="1690801094533" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3185" width="16" height="16"><path d="M512 0a512 512 0 1 1 0 1024A512 512 0 0 1 512 0z m0 93.12a418.88 418.88 0 1 0 0 837.76 418.88 418.88 0 0 0 0-837.76zM676.544 281.6L742.4 347.52 577.792 512l164.608 164.544L676.48 742.4 512 577.792 347.456 742.4 281.6 676.48 446.208 512 281.6 347.456 347.52 281.6 512 446.208 676.544 281.6z" fill="none" p-id="3186"></path></svg>',iconTelegraph:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="currentColor" d="M0 0v24h24V0zm6 6h12v3h-4.5v9h-3V9H6z"/></svg>',iconOTRemove:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#888888" d="M16.066 8.995a.75.75 0 1 0-1.06-1.061L12 10.939L8.995 7.934a.75.75 0 1 0-1.06 1.06L10.938 12l-3.005 3.005a.75.75 0 0 0 1.06 1.06L12 13.06l3.005 3.006a.75.75 0 0 0 1.06-1.06L13.062 12z"/></svg>',iconOTJVue:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 128 128"><path fill="#1697f6" d="M65.3 34.414L40.84 76.79L64 116.926l30.672-53.13l30.66-53.128H79Zm0 0"/><path fill="#aeddff" d="m33.34 63.797l1.605 2.793l22.88-39.649l9.402-16.273H2.668Zm0 0"/><path fill="#1867c0" d="M79 10.668C90.594 48.82 64 116.926 64 116.926L40.84 76.789Zm0 0"/><path fill="#7bc6ff" d="M67.227 10.668c-48.844 0-32.282 55.922-32.282 55.922Zm0 0"/></svg>',iconOTWordpressdotcom:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 256 256"><g fill="none"><rect width="256" height="256" fill="#0073AA" rx="60"/><path fill="#fff" d="M42.214 127.994c0 33.955 19.733 63.299 48.347 77.205L49.641 93.083a85.46 85.46 0 0 0-7.427 34.911m143.694-4.329c0-10.601-3.808-17.943-7.074-23.658c-4.349-7.066-8.425-13.05-8.425-20.116c0-7.886 5.981-15.226 14.405-15.226c.381 0 .741.047 1.112.068c-15.262-13.982-35.595-22.519-57.929-22.519c-29.968 0-56.335 15.376-71.673 38.666c2.012.06 3.909.103 5.52.103c8.973 0 22.862-1.09 22.862-1.09c4.624-.272 5.17 6.52.55 7.067c0 0-4.647.547-9.818.818l31.238 92.918l18.773-56.303l-13.365-36.618c-4.619-.271-8.995-.818-8.995-.818c-4.623-.271-4.081-7.339.542-7.066c0 0 14.166 1.088 22.595 1.088c8.972 0 22.862-1.088 22.862-1.088c4.628-.273 5.171 6.519.55 7.066c0 0-4.657.547-9.818.818l31.001 92.214l8.556-28.592c3.709-11.866 6.531-20.388 6.531-27.732"/><path fill="#fff" d="m129.503 135.498l-25.738 74.79a85.779 85.779 0 0 0 24.233 3.495a85.682 85.682 0 0 0 28.486-4.863a7.476 7.476 0 0 1-.61-1.182zm73.766-48.66a65.8 65.8 0 0 1 .578 8.82c0 8.705-1.626 18.491-6.523 30.727l-26.203 75.759c25.503-14.872 42.657-42.501 42.657-74.148c.001-14.915-3.808-28.94-10.509-41.158"/><path fill="#fff" d="M127.998 28C72.86 28 28 72.857 28 127.994c0 55.144 44.86 99.999 99.998 99.999c55.135 0 100.002-44.855 100.002-99.999C227.998 72.857 183.133 28 127.998 28m0 195.41c-52.61 0-95.413-42.804-95.413-95.416c0-52.609 42.802-95.409 95.413-95.409c52.607 0 95.407 42.8 95.407 95.409c0 52.612-42.8 95.416-95.407 95.416"/></g></svg>'},Xr=c=>[{type:be.Common,title:c("setting.platform.universal"),img:"./images/universal.webp",description:c("setting.platform.universal.desc")},{type:be.Github,title:c("setting.platform.github"),img:"./images/github.png",description:c("setting.platform.github.desc")},{type:be.Gitlab,title:c("setting.platform.gitlab"),img:"./images/gitlab.jpg",description:c("setting.platform.gitlab.desc")},{type:be.Metaweblog,title:c("setting.platform.metaweblog"),img:"./images/xmlrpc.png",description:c("setting.platform.metaweblog.desc")},{type:be.Wordpress,title:c("setting.platform.wordpress"),img:"./images/wordpress-logo.svg",description:c("setting.platform.wordpress.desc")},{type:be.Custom,title:c("setting.platform.custom"),img:"./images/http.png",description:c("setting.platform.custom.desc")}],Ke={commonCfg:[{platformType:be.Common,subPlatformType:N.Common_Yuque,platformKey:"common_Yuque",platformName:"语雀",platformIcon:ke.iconIFYuque,authMode:ge.API,isEnabled:!1},{platformType:be.Common,subPlatformType:N.Common_Notion,platformKey:"common_Notion",platformName:"Notion",platformIcon:ke.iconIFNotion,authMode:ge.API,isEnabled:!1},{platformType:be.Common,subPlatformType:N.Common_Halo,platformKey:"common_Halo",platformName:"Halo",platformIcon:ke.iconIFHalo,authMode:ge.API,isEnabled:!1},{platformType:be.Common,subPlatformType:N.Common_Telegraph,platformKey:"common_Telegraph",platformName:"Telegraph",platformIcon:ke.iconTelegraph,authMode:ge.API,isEnabled:!1}],githubCfg:[{platformType:be.Github,subPlatformType:N.Github_Hexo,platformKey:"github_Hexo",platformName:"Hexo",platformIcon:ke.iconIFHexo,authMode:ge.API,isEnabled:!1},{platformType:be.Github,subPlatformType:N.Github_Hugo,platformKey:"github_Hugo",platformName:"Hugo",platformIcon:ke.iconIFHugo,authMode:ge.API,isEnabled:!1},{platformType:be.Github,subPlatformType:N.Github_Jekyll,platformKey:"github_Jekyll",platformName:"Jekyll",platformIcon:ke.iconIFJekyll,authMode:ge.API,isEnabled:!1},{platformType:be.Github,subPlatformType:N.Github_Vuepress,platformKey:"github_Vuepress",platformName:"Vuepress",platformIcon:ke.iconIFVuepress,authMode:ge.API,isEnabled:!1},{platformType:be.Github,subPlatformType:N.Github_Vuepress2,platformKey:"github_Vuepress2",platformName:"Vuepress2",platformIcon:ke.iconIFVuepress2,authMode:ge.API,isEnabled:!1},{platformType:be.Github,subPlatformType:N.Github_Vitepress,platformKey:"github_Vitepress",platformName:"Vitepress",platformIcon:ke.iconIFVue,authMode:ge.API,isEnabled:!1}],gitlabCfg:[{platformType:be.Gitlab,subPlatformType:N.Gitlab_Hexo,platformKey:"gitlab_Gitlabhexo",platformName:"Gitlabhexo",platformIcon:ke.iconIFHexo,authMode:ge.API,isEnabled:!1},{platformType:be.Gitlab,subPlatformType:N.Gitlab_Hugo,platformKey:"gitlab_Gitlabhugo",platformName:"Gitlabhugo",platformIcon:ke.iconIFHugo,authMode:ge.API,isEnabled:!1},{platformType:be.Gitlab,subPlatformType:N.Gitlab_Jekyll,platformKey:"gitlab_Gitlabjekyll",platformName:"Gitlabjekyll",platformIcon:ke.iconIFJekyll,authMode:ge.API,isEnabled:!1},{platformType:be.Gitlab,subPlatformType:N.Gitlab_Vuepress,platformKey:"gitlab_Gitlabvuepress",platformName:"Gitlabvuepress",platformIcon:ke.iconIFVuepress,authMode:ge.API,isEnabled:!1},{platformType:be.Gitlab,subPlatformType:N.Gitlab_Vuepress2,platformKey:"gitlab_Gitlabvuepress2",platformName:"Gitlabvuepress2",platformIcon:ke.iconIFVuepress2,authMode:ge.API,isEnabled:!1},{platformType:be.Gitlab,subPlatformType:N.Gitlab_Vitepress,platformKey:"gitlab_Gitlabvitepress",platformName:"Gitlabvitepress",platformIcon:ke.iconIFVue,authMode:ge.API,isEnabled:!1}],metaweblogCfg:[{platformType:be.Metaweblog,subPlatformType:N.Metaweblog_Cnblogs,platformKey:"metaweblog_Cnblogs",platformName:"博客园",platformIcon:ke.iconIFCnblogs,authMode:ge.API,isEnabled:!1},{platformType:be.Metaweblog,subPlatformType:N.Metaweblog_Typecho,platformKey:"metaweblog_Typecho",platformName:"Typecho",platformIcon:ke.iconIFTypecho,authMode:ge.API,isEnabled:!1},{platformType:be.Metaweblog,subPlatformType:N.Metaweblog_Jvue,platformKey:"metaweblog_Jvue",platformName:"Jvue",platformIcon:ke.iconOTJVue,authMode:ge.API,isEnabled:!1}],wordpressCfg:[{platformType:be.Wordpress,subPlatformType:N.Wordpress_Wordpress,platformKey:"wordpress_Wordpress",platformName:"Wordpress",platformIcon:ke.iconIFWordpress,authMode:ge.API,isEnabled:!1},{platformType:be.Wordpress,subPlatformType:N.Wordpress_Wordpressdotcom,platformKey:"wordpress_Wordpressdotcom",platformName:"Wordpress.com",platformIcon:ke.iconOTWordpressdotcom,authMode:ge.API,isEnabled:!1}],customCfg:[{platformType:be.Custom,subPlatformType:N.Custom_Zhihu,platformKey:"custom_Zhihu",platformName:"知乎",platformIcon:ke.iconIFZhihu,authMode:ge.WEBSITE,authUrl:"https://www.zhihu.com/signin",domain:"zhihu.com",isEnabled:!1},{platformType:be.Custom,subPlatformType:N.Custom_CSDN,platformKey:"custom_Csdn",platformName:"CSDN",platformIcon:ke.iconIFCSDN,authMode:ge.WEBSITE,authUrl:"https://passport.csdn.net/login",domain:"csdn.net",isEnabled:!1},{platformType:be.Custom,subPlatformType:N.Custom_Wechat,platformKey:"custom_Wechat",platformName:"微信公众号",platformIcon:ke.iconIFWechat,authMode:ge.WEBSITE,authUrl:"https://mp.weixin.qq.com/",domain:"qq.com",cookieLimit:!0,isEnabled:!1},{platformType:be.Custom,subPlatformType:N.Custom_Jianshu,platformKey:"custom_Jianshu",platformName:"简书",platformIcon:ke.iconIFJianshu,authMode:ge.WEBSITE,authUrl:"https://www.jianshu.com/sign_in",domain:"jianshu.com",isEnabled:!1},{platformType:be.Custom,subPlatformType:N.Custom_Juejin,platformKey:"custom_Juejin",platformName:"掘金",platformIcon:ke.iconIFJuejin,authMode:ge.WEBSITE,authUrl:"https://juejin.cn/login",domain:"juejin.cn",isEnabled:!1}],systemCfg:[{platformType:be.System,subPlatformType:N.System_Siyuan,platformKey:"system_Siyuan",platformName:"思源笔记",platformIcon:ke.iconIFSiyuan,authMode:ge.API,isEnabled:!0,isSys:!0}]};var tt=(c=>(c.METHOD_ADD="add",c.METHOD_EDIT="edit",c))(tt||{});class fe{constructor(){D(this,"logger");D(this,"deviceType");D(this,"win");D(this,"moduleBase");D(this,"fetch");D(this,"xmlbuilder2");D(this,"simpleXmlrpc");var o,t,s,e;this.logger=W("app-instance"),this.deviceType=zt.getDevice(),this.fetch=Ml,this.xmlbuilder2={create:Dl.create},this.simpleXmlrpc={SimpleXmlRpcClient:ei,Serializer:ti,Deserializer:si,XmlrpcUtil:oi},this.win=Tt.siyuanWindow(),this.moduleBase=`${(e=(s=(t=(o=this.win)==null?void 0:o.siyuan)==null?void 0:t.config)==null?void 0:s.system)==null?void 0:e.workspaceDir}/data${Cn}`}}class Zt extends wl{}class Qt extends Zt{}class ls extends vl{constructor(t,s,e,a,n){super();D(this,"placeholder",{});this.home=t,this.apiUrl=s,this.username=e,this.password=a,this.tokenSettingUrl=void 0,this.apiStatus=!1,this.blogid="",this.blogName="",this.posidKey="",this.previewUrl="",this.pageType=ue.Markdown,this.middlewareUrl=n,this.usernameEnabled=!1,this.allowPreviewUrlChange=!0,this.showTokenTip=!1,this.yamlLinkEnabled=!0,this.placeholder=new Zt}}class Rs extends ls{constructor(t,s,e,a,n){super(t,s,e,a,n);D(this,"home","");D(this,"apiUrl","");D(this,"username","");D(this,"password","");D(this,"apiStatus",!1);D(this,"blogid","");D(this,"blogName","");D(this,"posidKey","");D(this,"previewUrl","");D(this,"pageType",ue.Markdown);D(this,"placeholder",{});D(this,"middlewareUrl","");this.home=t,this.apiUrl=s,this.username=e,this.password=a,this.apiStatus=!1,this.blogid="",this.blogName="",this.posidKey="",this.previewUrl="",this.pageType=ue.Html,this.middlewareUrl=n,this.placeholder=new Qt,this.usernameEnabled=!0,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class Zr extends Rs{constructor(o,t,s,e){super("https://www.cnblogs.com/",o,t,s,e),this.tokenSettingUrl="https://i.cnblogs.com/settings",this.previewUrl="/[userid]/p/[postid].html",this.pageType=ue.Markdown,this.usernameEnabled=!0,this.passwordType=Oe.PasswordType_Token,this.showTokenTip=!0,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class wo{}D(wo,"METHOD_GET_USERS_BLOGS","blogger.getUsersBlogs"),D(wo,"METHOD_DELETE_POST","blogger.deletePost");class We{}D(We,"METHOD_GET_USERS_BLOGS","metaWeblog.getUsersBlogs"),D(We,"METHOD_NEW_POST","metaWeblog.newPost"),D(We,"METHOD_EDIT_POST","metaWeblog.editPost"),D(We,"METHOD_DELETE_POST","metaWeblog.deletePost"),D(We,"METHOD_GET_RECENT_POSTS","metaWeblog.getRecentPosts"),D(We,"METHOD_GET_POST","metaWeblog.getPost"),D(We,"METHOD_GET_CATEGORIES","metaWeblog.getCategories"),D(We,"METHOD_NEW_MEDIA_OBJECT","metaWeblog.newMediaObject");const xo=(c,o)=>{const t=W("use-proxy"),{kernelApi:s,isUseSiyuanProxy:e}=Ge(),a=new fe,n="";c=c??Pe,o=o??"";const i=new Ol(a,n,c,Rt),l=new ti(a),u=async(p,g=[],_=void 0,d="GET",v="application/json",P=!1,S="text",E="text")=>{if(e||!e&&P)return t.info("Using Siyuan forwardProxy"),await y(p,g,_,d,v,S,E);{t.info("Using middleware proxy fetch");const M=g.length>0?g[0]:{},x={method:d,headers:{...M,"Content-Type":v},body:_};t.info("commonFetchClient url in proxyFetch =>",p),t.info("commonFetchClient fetchOptions in proxyFetch =>",x);const z=await i.fetchCall(p,x,P);return t.debug("Result of proxyFetch in commonFetchClient =>",z),z}},r=async(p,g,_,d=!1)=>{const v=l.serializeMethodCall(g,_);let P=await u(p,[],v,"POST","text/xml",d,"base64");P=oi.removeXmlHeader(P);const E=await new si().deserializeMethodResponse(P);return t.debug("xmlrpc fetch result, resJson =>",E),E},h=async(p,g=[],_=void 0,d="GET")=>{const v=`${o.endsWith("/")?o:o+"/"}${p}`,P=g.length>0?g[0]:{},S=["Origin","Referer","Cookie"],E=ae.getProperty(P,"x-cors-headers");let M=se.safeParse(E,{});for(const[$,q]of Object.entries(P)){const G=$.toLowerCase();S.map(H=>H.toLowerCase()).includes(G)&&(t.warn(`corsFetch header ${$} is not allowed`),M[$]=q,delete P[$])}P["x-cors-headers"]=JSON.stringify(M);const x={method:d,headers:P,body:_};t.debug("corsFetch url =>",v),t.debug("corsFetch options =>",x);const z=await fetch(v,x),L={},j=se.safeParse(z.headers.get("cors-received-headers"),{});for(const[$,q]of Object.entries(j))if($==="cors-received-headers"){const G=j["cors-received-headers"];for(const[H,X]of Object.entries(G))L[H]=X;delete j[$]}else L[$]=q;t.debug("corsFetch corsRespHeaders =>",L);const I=await z.text();t.debug("corsFetch resText =>",I);const A=se.safeParse(I,{});return A["cors-received-headers"]=JSON.stringify(L),t.debug("corsFetch resJson =>",A),A},y=async(p,g=[],_=void 0,d="GET",v="application/json",P="text",S="text")=>{let E=_;const M=`${n}${p}`,x=g.length>0?g[0]:{};let z=v,L,j=new ArrayBuffer(0);if(d!=="GET"){const $=new Request("",{method:d,body:E});console.log("generate temp myRequest =>",$),j=await $.arrayBuffer(),($.headers.get("Content-Type")??v).includes("multipart/form-data")&&(z=$.headers.get("Content-Type"))}P==="text"?L=$o.from(j).toString("utf8"):P==="base64"?L=$o.from(j).toString("base64"):P==="hex"?L=$o.from(j).toString("hex"):L=j;const I=[x];t.debug("siyuan forwardProxy url =>",M),t.debug("siyuan forwardProxy fetchOptions =>",{headers:g,payload:L,method:d,contentType:v});const A=await s.forwardProxy(M,I,L,d,z,P,S,3e4);if(t.debug("proxyFetch result =>",A),!(A.status>=200&&A.status<300)){const $=se.safeParse(A==null?void 0:A.body,{});throw T.isEmptyString($==null?void 0:$.msg)?new Error(T.decodeUnicodeToChinese(T.isEmptyString(A==null?void 0:A.body)?`请求异常：${A.status}`:A==null?void 0:A.body)):new Error($==null?void 0:$.msg)}if(S==="text")if(v==="application/json"){const $=A==null?void 0:A.body;return se.safeParse($,{})}else return v==="text/html"||v==="text/xml"?A==null?void 0:A.body:(t.info("SiYuan proxy directly response fetchResult for content type:",v),A);else return A};return{isUseSiyuanProxy:e,proxyFetch:u,proxyXmlrpc:r,corsFetch:h}};class Mo{static getFormData(o){const t=o.win;let s=t.FormData,e=t.Blob;if(t.require){const a=t.require(`${o.moduleBase}libs/node-fetch-cjs/dist/index.js`);s=a.FormData,e=a.Blob}return{FormData:s,Blob:e}}static getFormDataFetch(o){return o.win.require(`${o.moduleBase}libs/zhi-formdata-fetch/index.cjs`)}}class rs extends Xn{constructor(t,s){super();D(this,"appInstance");D(this,"logger");D(this,"cfg");D(this,"baseExtendApi");D(this,"isUseSiyuanProxy");D(this,"proxyFetch");D(this,"corsFetch");this.appInstance=t,this.cfg=s,this.logger=W("base-web-api"),this.baseExtendApi=new bi(this,s);const{isUseSiyuanProxy:e,proxyFetch:a,corsFetch:n}=xo(s.middlewareUrl,s.corsAnywhereUrl);this.isUseSiyuanProxy=e,this.proxyFetch=a,this.corsFetch=n}async checkAuth(){return!0}getPostPreviewUrl(t){return this.getPreviewUrl(t)}async getCategories(t){return this.baseExtendApi.getCategories(t)}async getTags(){return this.baseExtendApi.getTags()}updateCfg(t){this.cfg=t}async buildCookie(t){return t.map(s=>`${s.name}=${s.value}`).join(";")}getYamlAdaptor(){return null}async preEditPost(t,s,e){return await this.baseExtendApi.preEditPost(t,s,e)}async newPost(t,s){try{const e=await this.addPost(t);if(e.status!=="success")throw new Error("网页授权发布文章异常");return e.post_id}catch(e){throw e}}async newMediaObject(t,s){this.logger.debug("newMediaObject on baseWebApi =>",t);const e=await this.uploadFile(t);return{attachment_id:e==null?void 0:e.id,date_created_gmt:new Date,parent:0,link:e==null?void 0:e.url,title:t.name,caption:"",description:"",metadata:{width:0,height:0,file:"",filesize:0,sizes:[]},type:t.type,thumbnail:"",id:e==null?void 0:e.article_id,file:t.name,url:e.url}}async webFetch(t,s=[],e={},a="GET",n="application/json",i=!1,l="text",u="text"){const r=s.length>0?s[0]:{};if(this.isUseSiyuanProxy||!this.isUseSiyuanProxy&&i||!i){this.logger.info("Using legency web fetch"),delete r["x-cors-headers"];const h=[r];return await this.proxyFetch(t,h,e,a,n,i,l,u)}else{this.logger.info("Using cors web fetch");const h=[r];return this.corsFetch(t,h,e,a)}}async webFormFetch(t,s,e,a=!1){if(this.isUseSiyuanProxy||!this.isUseSiyuanProxy&&a||!a){this.logger.info("Using legency web formFetch");const{isInSiyuanOrSiyuanNewWin:n}=at();if(!n()||a){const i=await this.webFetch(t,s,e,"POST",void 0,a,"base64","base64"),l=It.fromBase64(i.body),u=se.safeParse(l,{});return this.logger.debug("apiForm doFetch success, resJson=>",u),u}else{const i=Mo.getFormDataFetch(this.appInstance),l=s.length>0?s[0]:{};this.logger.debug("before zhi-formdata-fetch, header =>",l),this.logger.debug("before zhi-formdata-fetch, url =>",t);const u=await i(this.appInstance.moduleBase,t,l,e);return this.logger.debug("apiForm doFetch success, resText =>",u),se.safeParse(u,{})}}else return this.logger.info("Using cors-anywhere web formFetch"),this.corsFetch(t,s,e,"POST")}}class Os{static mdToHtml(o){if(typeof window>"u")return this.logger.warn("不是浏览器环境，不渲染"),o;const t=window.Lute;if(!t)return this.logger.warn("未找到Lute，不渲染"),o;this.logger.info("found Lute =>",t),this.logger.info("使用Lute渲染Markdown");const s=t.New(),e={renderInlineMathCloseMarker:(n,i)=>i?["$",t.WalkContinue]:["",t.WalkContinue],renderInlineMathContent:(n,i)=>i?[n.TokensStr(),t.WalkContinue]:["",t.WalkContinue],renderInlineMathOpenMarker:(n,i)=>i?["$",t.WalkContinue]:["",t.WalkContinue],renderInlineMath:(n,i)=>["",t.WalkContinue],renderMathBlockCloseMarker:(n,i)=>i?["$$",t.WalkContinue]:["",t.WalkContinue],renderMathBlockContent:(n,i)=>i?[n.TokensStr(),t.WalkContinue]:["",t.WalkContinue],renderMathBlockOpenMarker:(n,i)=>i?["$$",t.WalkContinue]:["",t.WalkContinue],renderMathBlock:(n,i)=>["",t.WalkContinue]};s.SetJSRenderers({renderers:{Md2HTML:e}});const a=s.MarkdownStr("",o);return this.logger.debug("md to html =>",{html:a}),a}}D(Os,"logger",W("lute-util"));var Qr={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const ec=W("siyuan-util"),{isInSiyuanWidget:tc,isInSiyuanBrowser:sc}=at(),qa=async(c,o,t)=>{try{const s=await c.getFile(o,t);return t==="text"?!T.isEmptyString(s):s!==null}catch{return!1}},hi=()=>{if(window.frameElement==null||window.frameElement.parentElement==null||window.frameElement.parentElement.parentElement==null)return"";const c=window.frameElement.parentElement.parentElement;if(!c)return"";const o=c.getAttribute("data-node-id");return o||""},oc=()=>{let c;const o=window;return o&&o.terwer&&o.terwer.pageId&&(c=o.terwer.pageId),c},fi=async(c,o)=>{if(!T.isEmptyString(c))return ec.debug("显示指定pageId=>",c),c;if(tc()){const e=hi();if(!T.isEmptyString(e)){const{kernelApi:a}=Ge();return(await a.getBlockByID(e)).root_id}}if(sc()){const e=oc();if(!T.isEmptyString(e))return e}if(Ht.isInBrowser){const e=Ht.getQueryParam("id");if(!T.isEmptyString(e))return e}const s=Qr.VITE_SIYUAN_DEV_PAGE_ID;return T.isEmptyString(s)?"":s};let Lo=!1;const yi=async(c,o)=>new Promise((t,s)=>{o.cfgUpdating?(Lo=!0,c.pushMsg({msg:"检测到旧配置，正在迁移配置，请勿进行任何操作...",timeout:1e3}),console.warn("检测到旧配置，正在迁移配置，请勿进行任何操作..."),setTimeout(yi,1e3)):(Lo&&(c.pushMsg({msg:"PicGo 图床历史配置迁移完成",timeout:7e3}),console.log("PicGo 图床历史配置迁移完成"),Lo=!1),console.log("picgo instance is ready"),t(o))}),Do=()=>{const c=W("use-picgo-bridge"),{siyuanConfig:o,kernelApi:t,blogApi:s}=Ge(),e=new Vl(o,Rt),a=async(u,r)=>{await yi(t,e);let h=r;const y="文档可能已经成功发布，但是图片上传失败或者当前场景不支持图片上传，详细信息=>";try{const p=await t.getBlockAttrs(u),g={pageId:u,meta:p};T.isEmptyString(h)&&(h=(await s.getPost(u)).markdown);const _=await e.uploadPostImagesToBed(g.pageId,g.meta,h);_.hasImages?_.flag?h=_.mdContent:(c.warn(y+_.errmsg),Q.warning(y+_.errmsg)):c.info(y+_.errmsg)}catch(p){c.error(y,p),Q.error("文档可能已经成功发布，但是图片上传失败或者当前场景不支持图片上传，详细信息=>"+p)}return h},n=async(u,r)=>{const h=new $l;let y=[];c.debug("getImageItemsFromMd=>",{md:r});const p=h.parseImagesToArray(r);y=[...new Set([...y,...p])],c.debug("retImgs=>",y);const g=await t.getBlockAttrs(u),_=o.apiUrl??"",d=await e.doConvertImagesToImagesItemArray(g,y,_);return c.debug("imageItemArray=>",d),d},i=async u=>{let r=_t.None;return T.isEmptyString(u.picbedService)?(await l()&&u.picgoPicbedSupported?r=_t.PicGo:u.bundledPicbedSupported?r=_t.Bundled:r=_t.None,c.info("使用默认的图床服务")):(r=u.picbedService,c.info("使用自定义图床服务")),r},l=async()=>{const{kernelApi:u}=Ge();return await qa(u,"/data/plugins/siyuan-plugin-picgo/plugin.json","text")};return{handlePicgo:a,getImageItemsFromMd:n,getPicbedServiceType:i,checkPicgoInstalled:l}},Gs=async c=>new Promise((o,t)=>{const s=new FileReader;s.onload=e=>{const a=vn.from(e.target.result);o(a)},s.onerror=t,s.readAsArrayBuffer(c)}),ac=c=>{const o=c.match(/^data:(.*?);base64,/);return o&&o[1]?o[1]:""},In=async c=>{const o=await ic(c);return nc(c,o)},nc=(c,o)=>{const t=o.split(";base64,").pop()||"",s=c.substring(c.lastIndexOf("/")+1),e=ac(o);return{imageName:s,mimeType:e,imageBase64:t}},xn=c=>{const o=It.toUint8Array(c);return vn.from(o)};function ic(c){return new Promise((o,t)=>{(async()=>{let s=null;try{s=await(await window.fetch(c)).blob()}catch(e){return t(e)}if(s!=null){const e=new FileReader;e.readAsDataURL(s),e.onloadend=function(){const a=e.result;o(a)},e.onerror=function(a){t(a)}}})()})}const lc=c=>{const o=new Uint8Array(c);return vn.from(o)};class rc{constructor(){D(this,"metadata")}}class cc{constructor(){D(this,"tags");D(this,"categories");D(this,"templates");this.tags=[],this.categories=[],this.templates=[]}}const Ya=()=>{const c="storage/syp/platform-metadata.json",o="platform-metadata",t=()=>{const n=new rc;return An(c,o,n,{serializer:Po.object})},s=()=>{const n=t();return fn(n)};return{getPlatformMetadata:n=>{const i=[],l=[],u=[],h=s().value;if(h.metadata&&h.metadata.hasOwnProperty(n)){const y=h.metadata[n];i.push(...y.tags),l.push(...y.categories),u.push(...y.templates)}return{tags:i,categories:l,templates:u}},updatePlatformMetadata:(n,i,l,u)=>{if(i.length===0&&l.length===0&&u.length===0)return;const r=t(),h=r.value;h.metadata=h.metadata??{},h.metadata.hasOwnProperty(n)||(h.metadata[n]=new cc);const y=h.metadata[n];y.tags=y.tags.filter(p=>p.trim()!==""),y.categories=y.categories.filter(p=>p.trim()!==""),y.templates=y.templates.filter(p=>p.trim()!==""),i.length>0&&(y.tags=Array.from(new Set([...y.tags,...i.filter(p=>p.trim()!=="")]))),l.length>0&&(y.categories=Array.from(new Set([...y.categories,...l.filter(p=>p.trim()!=="")]))),u.length>0&&(y.templates=Array.from(new Set([...y.templates,...u.filter(p=>p.trim()!=="")]))),h.metadata[n]=y,r.value=h}}};class pc{static replaceSignToAnother(o,t,s,e){const a=t.replace(/\*/g,"\\*"),n=[],i=[],l=[],u=[],r=o.replace(new RegExp("```[\\s\\S]*?```|`.*?`|\\$\\$[\\s\\S]*?\\$\\$|\\$.*?\\$","g"),g=>{if(g.startsWith("```"))return n.push(g),`__PUBLISHER_PLACEHOLDER_CODEBLOCK${n.length-1}`;if(g.startsWith("`"))return i.push(g),`__PUBLISHER_PLACEHOLDER_INLINECODE${i.length-1}`;if(g.startsWith("$$"))return l.push(g),`__PUBLISHER_PLACEHOLDER_FORMULA${l.length-1}`;if(g.startsWith("$"))return u.push(g),`__PUBLISHER_PLACEHOLDER_INLINEFORMULA${u.length-1}`}),h=new RegExp(`(?<!\`)(?<!\`\`\`[\\s\\S])(?<!\\$[\\s\\S])(?<!\\$$[\\s\\S])${a}(.*?[^${a}])${a}(?![\\s\\S]*?\`)(?![\\s\\S]*?\`\`\`)(?![\\s\\S]*?\\$)(?![\\s\\S]*?\\$$)`,"g");return r.replace(h,(g,_)=>`${s}${_}${e}`).replace(/(__PUBLISHER_PLACEHOLDER_CODEBLOCK(\d+))|(__PUBLISHER_PLACEHOLDER_INLINECODE(\d+))|(__PUBLISHER_PLACEHOLDER_FORMULA(\d+))|(__PUBLISHER_PLACEHOLDER_INLINEFORMULA(\d+))/g,(g,_,d,v,P,S,E,M,x)=>{if(_)return n[parseInt(d,10)];if(v)return i[parseInt(P,10)];if(S)return l[parseInt(E,10)];if(M)return u[parseInt(x,10)]})}}class bi extends Xn{constructor(t,s){super();D(this,"logger");D(this,"api");D(this,"cfg");D(this,"picgoBridge");D(this,"isSiyuanOrSiyuanNewWin");D(this,"kernelApi");this.logger=W("base-extend-api"),this.api=t,this.cfg=s,this.picgoBridge=Do();const{isInSiyuanOrSiyuanNewWin:e}=at();this.isSiyuanOrSiyuanNewWin=e();const{kernelApi:a}=Ge();this.kernelApi=a}async preEditPost(t,s,e){return t=await this.handleFilename(t,s,e),t=await this.handleDesc(t,s,e),t=await this.handleCategories(t,s,e),t=await this.handlePictures(t,s,e),t=await this.handleMd(t,s,e),t=await this.handleYaml(t,s,e),t=await this.handleOther(t,s,e),t}async getCategories(t){const s=[],{getPlatformMetadata:e}=Ya(),a=jn(this.cfg.posidKey),{categories:n}=e(a);return n.forEach(i=>{const l=new it;l.categoryId=i,l.categoryName=i,s.push(l)}),s}async getTags(){const t=[],{getPlatformMetadata:s}=Ya(),e=jn(this.cfg.posidKey),{tags:a}=s(e);return a.forEach(n=>{const i=new Zn;i.tagId=n,i.tagName=n,t.push(i)}),t}async handleFilename(t,s,e){var u;const a=e==null?void 0:e.cfg,n=we.cloneDeep(t);if(a!=null&&a.mdFilenameRule){(u=a==null?void 0:a.mdFilenameRule)!=null&&u.includes("[filename]")&&(a.useMdFilename=!0);const y=Me.formatIsoToZhDate(n.dateCreated.toISOString(),!0).split(" ")[0].split("-"),p=y[0],g=y[1],_=y[2];this.logger.debug("created numarr=>",y);let d=a.mdFilenameRule;a.useMdFilename?d=d.replace(/\[filename]/g,n.originalTitle):d=d.replace(/\[slug]/g,n.wp_slug),d=d.replace(/\[yyyy]/g,p).replace(/\[MM]/g,g).replace(/\[mm]/g,g).replace(/\[dd]/g,_),n.mdFilename=d}const{getReadOnlyPublishPreferenceSetting:i}=xt();return i().value.fixTitle&&(n.title=Ut.removeTitleNumber(n.title).replace(/\.md/g,"")),this.logger.debug("处理MD文件名完成，post",{post:le(n)}),n}async handleDesc(t,s,e){const a=we.cloneDeep(t);return a.mt_excerpt=a.shortDesc,a.mt_text_more=a.shortDesc,a}async handleCategories(t,s,e){var h;const a=e==null?void 0:e.cfg,n=we.cloneDeep(t),i=((h=n.cate_slugs)==null?void 0:h[0])??a.blogid,l=[];i!=null&&i.toString().includes(_o)&&(a.usePathCategory=!0);const u=No.dirname(n.link);if(a.usePathCategory){const y=No.join(i.replace(_o,""),u);n.cate_slugs=[y];const p=u.split("/");if(p.length>1)for(let g=1;g<p.length;g++){const _=p[g];if(T.isEmptyString(_))continue;const d=Ut.removeTitleNumber(_);l.push(d)}}this.logger.info("目录路径转换的分类 =>",l);const r=[...new Set([...l??[],...(n==null?void 0:n.categories)??[]])].filter(y=>y.trim()!=="");return n.categories=r,this.logger.info("最终的分类 =>",n.categories),this.logger.debug("目录路径转换完成，post",{post:le(n)}),n}async handleMd(t,s,e){const a=e==null?void 0:e.cfg,n=e==null?void 0:e.setting,i=we.cloneDeep(t);let l=i.markdown;l=ne.extractMarkdown(l),l=pc.replaceSignToAnother(l,"=="," **","** ");const{getReadOnlyPublishPreferenceSetting:u}=xt(),r=u(),h=/\[(.+?)]\(siyuan:\/\/blocks\/(\d+-\w+)\)/g;return l=await this.replaceOuterLinks(l,h,{pref:r,cfg:a,setting:n}),i.markdown=l,this.logger.debug("markdown处理完毕，post",{post:le(i)}),i}async handleOther(t,s,e){const a=e==null?void 0:e.cfg,n=we.cloneDeep(t),i=ne.extractMarkdown(n.markdown);return n.html=Os.mdToHtml(i),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}async handleYaml(t,s,e){const a=e==null?void 0:e.cfg,n=we.cloneDeep(t);this.logger.debug("开始处理yaml，post",{post:le(n)});const i=this.api.getYamlAdaptor();switch(n.yamlType){case qt.Yaml_custom_auto:{const l=i.convertToYaml(n,void 0,a);n.yaml=l.formatter,n.markdown=l.mdFullContent,n.html=l.htmlContent,this.logger.info("rehandled yaml using YamlConverterAdaptor");break}case qt.Yaml_custom_hand:{const l=n.yaml;if(this.checkPropertiesStartsWith(l,"siyuan://")||n.editMode!==Fe.EditMode_source){const u=new gt,r=await ne.yaml2ObjAsync(n.yaml);u.yamlObj=r;const h=i.convertToYaml(n,u,a);n.yaml=h.formatter,n.markdown=h.mdFullContent,n.html=h.htmlContent,this.logger.info("assign latest custom yaml to md")}else this.logger.info("assert yaml is saved by source mode, ignore");break}default:{const l=wn.toYamlObj(n),u=ne.obj2Yaml(l),r=ne.extractMarkdown(n.markdown);n.yaml=u,n.markdown=r,n.html=Os.mdToHtml(r),this.logger.info("yaml adaptor not found, using default");break}}return this.logger.debug("yaml处理之后，post",{post:le(n)}),n}async handlePictures(t,s,e){const a=e==null?void 0:e.cfg;e==null||e.dynCfg;const n=we.cloneDeep(t);switch(this.logger.debug("图片处理之前, post =>",{post:le(n)}),a.picbedService){case _t.PicGo:{this.logger.info("使用 PicGO上传图片"),this.logger.debug("开始图片处理, post =>",{post:le(n)}),n.markdown=await this.picgoBridge.handlePicgo(s,n.markdown),this.logger.debug("图片处理完毕, post.markdown =>",{md:n.markdown});break}case _t.Bundled:{this.logger.info("使用平台上传图片");const l=await this.picgoBridge.getImageItemsFromMd(s,n.markdown);if(l.length===0)return this.logger.info("未找到图片，不处理"),n;this.logger.info(`找到${l.length}张图片，开始上传`);const u={};try{for(const y of l){const p=y.url,g=await this.readFileToBase64(p),_=xn(g.imageBase64),d=new ns(y.name,g.mimeType,_);this.logger.debug("before upload, mediaObject =>",d);const v=await this.api.newMediaObject(d);this.logger.debug("attachResult =>",v),v&&v.url&&(u[y.originUrl]=v.url);const P=`使用平台自带的图片上传能力，已成功上传图片 ${y.name}`;await this.kernelApi.pushMsg({msg:P,timeout:3e3})}}catch(y){const p="文章可能已经发布成功，但是平台图片上传失败。请打开「开发者工具」查看错误日志";this.logger.error(p,y),await this.kernelApi.pushMsg({msg:p,timeout:7e3})}this.logger.info("平台图片全部上传完成，将开始进行连接替换，urlMap =>",u);const r=new RegExp(Object.keys(u).map(y=>`\\b${y}\\b`).join("|"),"g"),h=y=>u[y]||y;n.markdown=n.markdown.replace(r,h);break}default:{await this.kernelApi.pushMsg({msg:"未指定上传图片服务，不处理图片",timeout:7e3}),this.logger.warn("未指定上传图片服务，不处理图片");break}}return n.html=Os.mdToHtml(n.markdown),this.logger.info("图片预处理全部完成"),this.logger.debug("图片处理之后，post",{post:le(n)}),n}async readFileToBase64(t){let s;if(this.isSiyuanOrSiyuanNewWin)this.logger.info("Inside Siyuan notes, use the built-in request to obtain base64"),s=await In(t);else{this.logger.info("Outside the browser, use an image proxy");let e;if(this.api instanceof Gt)e=await this.api.apiFetch(t,[],void 0,"GET",void 0,!0,"base64","base64");else if(this.api instanceof rs)e=await this.api.webFetch(t,[],void 0,"GET",void 0,!0,"base64","base64");else throw new Error("proxyFetch is not valid");this.logger.debug("readFileToBase64 proxyFetch response =>",e);const a=e.body;s={imageName:t.substring(t.lastIndexOf("/")+1),mimeType:e.contentType,imageBase64:a}}return this.logger.debug("readFileToBase64 proxyFetch base64Info =>",{base64Info:s}),s}async replaceOuterLinks(t,s,e){var h;const{pref:a,cfg:n,setting:i}=e,l=this,u=Array.from(t.matchAll(s));let r=t;for(const y of u){const[p,g,_]=y;let d=g;a.value.fixTitle&&(d=Ut.removeTitleNumber(d));let v;const P=ae.getProperty(i,_,{}),S=n.posidKey;if(P.hasOwnProperty(S)){let E;const M=P[S];if(E=await l.api.getPostPreviewUrl(M),(h=n==null?void 0:n.mdFilenameRule)!=null&&h.includes("[filename]")){const x=P[st.Custom_slug],z=No.basename(M).replace(/\.md/g,"");E=E.replace(z,x)}!E.startsWith("http")&&!E.startsWith("/")&&(E=`/${E}`),v=E}else throw v=`siyuan://blocks/${_}`,this.logger.error("引用的文档尚未发布，您可以删除此外链再发布，或者先发布外链文章 =>",_),new Error(`引用的文档 ${_} 尚未发布，您可以删除此外链再发布，或者先发布外链文章`);r=r.replace(p,`[${d}](${v})`)}return r}checkPropertiesStartsWith(t,s){if(ae.isEmptyObject(t))return!1;for(const e in t)if(t.hasOwnProperty(e)&&!T.isEmptyString(t[e])&&t[e].startsWith(s))return!0;return!1}}class Gt extends Pl{constructor(t,s){super();D(this,"appInstance");D(this,"logger");D(this,"cfg");D(this,"baseExtendApi");D(this,"isUseSiyuanProxy");D(this,"proxyFetch");D(this,"corsFetch");this.appInstance=t,this.cfg=s,this.logger=W("base-blog-api"),this.baseExtendApi=new bi(this,s);const{isUseSiyuanProxy:e,proxyFetch:a,corsFetch:n}=xo(s.middlewareUrl,s.corsAnywhereUrl);this.isUseSiyuanProxy=e,this.proxyFetch=a,this.corsFetch=n}async checkAuth(){return!0}getYamlAdaptor(){return null}getPostPreviewUrl(t){return this.getPreviewUrl(t)}async preEditPost(t,s,e){return await this.baseExtendApi.preEditPost(t,s,e)}async getCategories(t){return this.baseExtendApi.getCategories(t)}async getTags(){return this.baseExtendApi.getTags()}async apiFetch(t,s=[],e=void 0,a="GET",n="application/json",i=!1,l="text",u="text"){const r=s.length>0?s[0]:{};if(this.isUseSiyuanProxy||!this.isUseSiyuanProxy&&i||!i){this.logger.info("Using legency api fetch"),delete r["x-cors-headers"];const h=[{...r}];return this.proxyFetch(t,h,e,a,n,i,l,u)}else{this.logger.info("Using cors api fetch");const h=[{...r}];return this.corsFetch(t,h,e,a)}}async apiFormFetch(t,s,e,a=!1){if(this.isUseSiyuanProxy||!this.isUseSiyuanProxy&&a||!a){this.logger.info("Using legency api formFetch");const{isInSiyuanOrSiyuanNewWin:n}=at();if(!n()||a){const i=await this.apiFetch(t,s,e,"POST",void 0,a,"base64","base64"),l=It.fromBase64(i.body),u=se.safeParse(l,{});return this.logger.debug("apiForm doFetch success, resJson=>",u),u}else{const i=Mo.getFormDataFetch(this.appInstance),l=s.length>0?s[0]:{};this.logger.debug("before zhi-formdata-fetch, headers =>",s),this.logger.debug("before zhi-formdata-fetch, url =>",t);const u=await i(this.appInstance.moduleBase,t,l,e);return this.logger.debug("apiForm doFetch success, resText =>",u),se.safeParse(u,{})}}else return this.logger.info("Using cors-anywhere api formFetch"),this.corsFetch(t,s,e,"POST")}}class cs extends Gt{constructor(t,s){super(t,s);D(this,"proxyXmlrpc");this.cfg.blogid="metaweblog",this.logger=W("metaweblog-api-adaptor");const{proxyXmlrpc:e}=xo(s.middlewareUrl);this.proxyXmlrpc=e}async checkAuth(){return!0}async getUsersBlogs(){let t=[];return t=await this.metaweblogCall(We.METHOD_GET_USERS_BLOGS,[this.cfg.blogid,this.cfg.username,this.cfg.password]),this.logger.debug("getUsersBlogs=>",t),t}async getRecentPostsCount(t){return 0}async getRecentPosts(t){const s=[],e=await this.metaweblogCall(We.METHOD_GET_RECENT_POSTS,[this.cfg.blogid,this.cfg.username,this.cfg.password,t]);for(let a=0;a<e.length;a++){const n=e[a],i=new ot;i.postid=n.postid,i.title=n.title,i.mt_keywords=n.mt_keywords,i.permalink=n.permalink,i.description=n.description,i.wp_slug=n.wp_slug,i.dateCreated=n.dateCreated,i.categories=n.categories,s.push(i)}return s}async getPost(t){return await this.metaweblogCall(We.METHOD_GET_POST,[t,this.cfg.username,this.cfg.password])}async newPost(t,s){s=s??!0;const e=t.post_status;t.post_status=s===!1?Et.PostStatusEnum_Draft:Et.PostStatusEnum_Publish,e!==t.post_status&&(t.post_status=e);const a=this.createPostStruct(t);this.logger.debug("postStruct=>",a);let n=await this.metaweblogCall(We.METHOD_NEW_POST,[this.cfg.blogid,this.cfg.username,this.cfg.password,a,s]);return n=n+"",n=n.replace(/"/g,""),this.logger.debug("ret=>",n),n}async editPost(t,s,e){e=e??!0;const a=s.post_status;s.post_status=e===!1?Et.PostStatusEnum_Draft:Et.PostStatusEnum_Publish,a!==s.post_status&&(s.post_status=a);const n=this.createPostStruct(s);this.logger.debug("postStruct=>",n);const i=await this.metaweblogCall(We.METHOD_EDIT_POST,[t,this.cfg.username,this.cfg.password,n,e]);return this.logger.debug("ret=>",i),i}async deletePost(t){const s=await this.metaweblogCall(We.METHOD_DELETE_POST,[this.cfg.blogid,t,this.cfg.username,this.cfg.password,!1]);return this.logger.debug("ret=>",s),s}async getPreviewUrl(t){return this.cfg.previewUrl.replace(/\[postid\]/g,t)}async getCategories(){const t=[];try{const e=await this.metaweblogCall(We.METHOD_GET_CATEGORIES,[this.cfg.blogid,this.cfg.username,this.cfg.password]);this.logger.debug("获取的分类信息，dataArr=>",e),e.forEach(a=>{const n=new it;n.categoryId=a.categoryId,n.categoryName=a.categoryName,n.description=a.description,n.categoryDescription=a.categoryDescription,n.htmlUrl=a.htmlUrl,n.parentId=a.parentId,n.rssUrl=a.rssUrl,t.push(n)})}catch(s){this.logger.error("分类获取失败",s)}return t}async newMediaObject(t,s){let e;try{e=await this.metaweblogCall(We.METHOD_NEW_MEDIA_OBJECT,[this.cfg.blogid,this.cfg.username,this.cfg.password,t]),this.logger.debug("上传媒体完成, ret =>",e)}catch(a){this.logger.error("媒体上传失败",a)}return e}async metaweblogCall(t,s){return await this.proxyXmlrpc(this.cfg.apiUrl,t,s)}createPostStruct(t){const s={};return T.isEmptyString(t.title)||Object.assign(s,{title:t.title}),T.isEmptyString(t.mt_keywords)||Object.assign(s,{mt_keywords:t.mt_keywords}),T.isEmptyString(t.mt_excerpt)||Object.assign(s,{mt_excerpt:t.mt_excerpt}),T.isEmptyString(t.mt_text_more)||Object.assign(s,{mt_text_more:t.mt_text_more}),T.isEmptyString(t.description)||Object.assign(s,{description:t.description}),T.isEmptyString(t.wp_slug)||Object.assign(s,{wp_slug:t.wp_slug}),Object.assign(s,{categories:t.categories||[]}),Object.assign(s,{post_status:t.post_status??Et.PostStatusEnum_Publish}),T.isEmptyString(t.wp_password)||Object.assign(s,{wp_password:t.wp_password}),s}}class uc extends cs{constructor(t,s){super(t,s);D(this,"MD_CATEGORY","[Markdown]");this.logger=W("cnblogs-api-adaptor"),this.cfg.blogid="cnblogs"}async getUsersBlogs(){let t=[];return t=await this.metaweblogCall(wo.METHOD_GET_USERS_BLOGS,[this.cfg.blogid,this.cfg.username,this.cfg.password]),this.logger.debug("getUsersBlogs=>",t),t}async newPost(t,s){return t=this.assignMdCategory(t),super.newPost(t,s)}async editPost(t,s,e){return s=this.assignMdCategory(s),super.editPost(t,s,e)}async deletePost(t){const s=await this.metaweblogCall(wo.METHOD_DELETE_POST,[this.cfg.blogid,t,this.cfg.username,this.cfg.password,!1]);return this.logger.debug("ret=>",s),s}async getCategories(){const t=[];try{const e=await this.metaweblogCall(We.METHOD_GET_CATEGORIES,[this.cfg.blogid,this.cfg.username,this.cfg.password]);this.logger.debug("博客园获取的分类信息，dataArr=>",e),e.forEach(a=>{const n=new it;a.title!==this.MD_CATEGORY&&(n.categoryId=a.categoryid,n.categoryName=a.title,n.description=a.description,n.categoryDescription=a.categoryDescription,n.htmlUrl=a.htmlUrl,n.parentId=a.parentId,n.rssUrl=a.rssUrl,t.push(n))})}catch(s){this.logger.error("博客园分类获取失败",s)}return t}async getPreviewUrl(t){var a;const s=this.cfg.apiUrl?((a=this.cfg.apiUrl.match(/[^/]+$/))==null?void 0:a[0])??"":"";return this.cfg.previewUrl.replace(/\[userid]/g,s).replace(/\[postid]/g,t)}assignMdCategory(t){const s=t.categories??[];return s.some(e=>e.toLowerCase()===this.MD_CATEGORY.toLowerCase())||s.push(this.MD_CATEGORY),t}}var Qs={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const Xa=async(c,o)=>{const t=W("use-cnblogs-api");t.info("Start using Cnblogs API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(Qs.VITE_CNBLOGS_API_URL,"https://rpc.cnblogs.com/metaweblog/[your-blog-name]"),u=U.emptyOrDefault(Qs.VITE_CNBLOGS_USERNAME,""),r=U.emptyOrDefault(Qs.VITE_CNBLOGS_AUTH_TOKEN,""),h=U.emptyOrDefault(Qs.VITE_MIDDLEWARE_URL,Pe);e=new Zr(l,u,r,h),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new uc(s,e);return t.info("Cnblogs API created successfully."),{cfg:e,blogApi:a}};class Mn{static parseHomeAndUrl(o){this.logger.debug(`Parsing Home address: ${o}`);let t="";return o.endsWith("/xmlrpc.php")?(t=o,o=o.replace("/xmlrpc.php","")):(o=o.replace(/\/$/,""),t=`${o}/xmlrpc.php`),this.logger.debug(`Parse result: home=${o}, apiUrl=${t}`),{home:o,apiUrl:t}}}D(Mn,"logger",W("wordpress-utils"));class _i extends Rs{constructor(o,t,s,e){super(o,"",t,s,e);const{home:a,apiUrl:n}=Mn.parseHomeAndUrl(o);this.home=a,this.apiUrl=n,this.previewUrl="/?p=[postid]",this.pageType=ue.Html,this.usernameEnabled=!0,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class dc extends cs{constructor(o,t){super(o,t),this.logger=W("wordpress-api-adaptor"),this.cfg.blogid="wordpress"}}var eo={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const Za=async(c,o)=>{const t=W("use-wordpress-api");t.info("Start using Wordpress API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(eo.VITE_WORDPRESS_API_URL,"http://your-wordpress-home.com"),u=U.emptyOrDefault(eo.VITE_WORDPRESS_USERNAME,""),r=U.emptyOrDefault(eo.VITE_WORDPRESS_AUTH_TOKEN,""),h=U.emptyOrDefault(eo.VITE_MIDDLEWARE_URL,Pe);e=new _i(l,u,r,h),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new dc(s,e);return t.info("Wordpress API created successfully.",e),{cfg:e,blogApi:a}};class Dn{static parseHomeAndUrl(o){this.logger.debug(`Parsing Home address: ${o}`);let t="";return o.endsWith("/index.php/action/xmlrpc")?(t=o,o=o.replace("/index.php/action/xmlrpc","")):(o=o.replace(/\/$/,""),t=`${o}/index.php/action/xmlrpc`),this.logger.debug(`Parse result: home=${o}, apiUrl=${t}`),{home:o,apiUrl:t}}}D(Dn,"logger",W("typecho-utils"));class gc extends Rs{constructor(o,t,s,e){super(o,"",t,s,e);const{home:a,apiUrl:n}=Dn.parseHomeAndUrl(o);this.home=a,this.apiUrl=n,this.previewUrl="/index.php/archives/[postid]",this.pageType=ue.Html,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class mc extends cs{constructor(o,t){super(o,t),this.logger=W("typecho-api-adaptor"),this.cfg.blogid="typecho"}}var to={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const Qa=async(c,o)=>{const t=W("use-typecho-api");t.info("Start using Typecho API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(to.VITE_TYPECHO_API_URL,"http://your-typecho-home.com/"),u=U.emptyOrDefault(to.VITE_TYPECHO_USERNAME,""),r=U.emptyOrDefault(to.VITE_TYPECHO_AUTH_TOKEN,""),h=U.emptyOrDefault(to.VITE_MIDDLEWARE_URL,Pe);e=new gc(l,u,r,h),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new mc(s,e);return t.info("Typecho API created successfully.",e),{cfg:e,blogApi:a}};class hc extends ls{constructor(o,t,s){super("https://www.yuque.com/","https://www.yuque.com/api/v2",o,t,s),this.tokenSettingUrl="https://www.yuque.com/settings/tokens",this.showTokenTip=!0,this.previewUrl="/[notebook]/[postid]",this.pageType=ue.Markdown,this.usernameEnabled=!0,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="知识库",this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于语雀平台的限制，暂时不支持编辑所属知识库。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的知识库发布"}}class fc extends Gt{constructor(o,t){super(o,t),this.logger=W("yuque-api-adaptor")}async getUsersBlogs(){const o=[];return(await this.getRepos()).forEach(s=>{const e=new lt;e.blogid=s.namespace,e.blogName=s.name,e.url=s.namespace,o.push(e)}),o}async newPost(o,t){var e;const s=((e=o.cate_slugs)==null?void 0:e[0])??this.cfg.blogid;return await this.addDoc(o.title,o.wp_slug,o.description,s)}async editPost(o,t,s){const e=this.getYuquePostidKey(o);return await this.updateDoc(e.docId,t.title,t.wp_slug,t.description,e.docRepo)}async deletePost(o){const t=this.getYuquePostidKey(o);return await this.delDoc(t.docId,t.docRepo)}async getPost(o,t){const s=this.getYuquePostidKey(o),e=await this.getDoc(s.docId,s.docRepo);this.logger.debug("yuqueDoc=>",e);const a=new ot;a.title=e.title,a.description=e.body;const n=e.book,i=[];return i.push(n.namespace),a.cate_slugs=i,a}async getCategories(){const o=[],t=await this.getRepos();return t&&t.length>0&&t.forEach(s=>{if(s.type==="Book"){const e=new it;e.categoryId=`${this.cfg.username}/${s.slug}`,e.categoryName=s.name,e.description=s.name,e.categoryDescription=s.name,o.push(e)}}),o}async getPreviewUrl(o){const t=this.cfg.previewUrl??"",s=this.getYuquePostidKey(o),e=s.docId,a=s.docRepo??this.cfg.blogid??"";return t.replace("[postid]",e).replace("[notebook]",a)}async getRepos(){const o="/users/"+this.cfg.username+"/repos",t=await this.yuqueRequest(o,{},"GET");return this.logger.debug("yuque repos=>",t),t}async addDoc(o,t,s,e){let a="/repos/"+this.cfg.blogid+"/docs";e&&(a="/repos/"+e+"/docs",this.logger.warn("yuque addDoc with repo",e));const n={title:o,slug:t,format:"markdown",body:s},i=await this.yuqueRequest(a,n,"POST");if(this.logger.debug("yuqueRequest addDoc=>",i),!i)throw new Error("请求语雀API异常");return e?`${i.id}_${e}`:`${i.id}`}async updateDoc(o,t,s,e,a){let n="/repos/"+this.cfg.blogid+"/docs/"+o;a&&(n="/repos/"+a+"/docs/"+o,this.logger.warn("yuque updateDoc with repo",a));const i={title:t,slug:s,body:e,_force_asl:1};if(!await this.yuqueRequest(n,i,"PUT"))throw new Error("请求语雀API异常");return!0}getYuquePostidKey(o){let t,s;if(o.indexOf("_")>0){const e=o.split("_");t=e[0],s=e[1]}else t=o;return{docId:t,docRepo:s}}async delDoc(o,t){let s="/repos/"+this.cfg.blogid+"/docs/"+o;if(t&&(s="/repos/"+t+"/docs/"+o,this.logger.warn("yuque delDoc with repo",t)),!await this.yuqueRequest(s,{},"DELETE"))throw new Error("请求语雀API异常");return!0}async getDoc(o,t){let s="/repos/"+this.cfg.blogid+"/docs/"+o;t&&(s="/repos/"+t+"/docs/"+o,this.logger.warn("yuque getDoc with repo",t));const e=await this.yuqueRequest(s,{},"GET");if(!e)throw new Error("请求语雀API异常");return e}async yuqueRequest(o,t,s="POST"){const e="application/json",a={"Content-Type":e,"X-Auth-Token":this.cfg.password},n=`${this.cfg.apiUrl}${o}`;this.logger.debug("向语雀请求数据，apiUrl =>",n),this.logger.debug("向语雀请求数据，params =>",t);const i=ae.isEmptyObject(t)?"":JSON.stringify(t),l=await this.apiFetch(n,[a],i,s,e);if(this.logger.debug("向语雀请求数据，resJson =>",l),(l==null?void 0:l.status)===401)throw new Error(l==null?void 0:l.message);return l.data?l.data:null}}var Ho={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const en=async(c,o)=>{const t=W("use-yuque-api");t.info("Start using Yuque API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(Ho.VITE_YUQUE_USERNAME,""),u=U.emptyOrDefault(Ho.VITE_YUQUE_AUTH_TOKEN,""),r=U.emptyOrDefault(Ho.VITE_MIDDLEWARE_URL,Pe);e=new hc(l,u,r),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceType=ee.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于语雀平台的限制，暂时不支持编辑所属知识库。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的知识库发布",e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!1;const a=new fc(s,e);return t.info("Yuque API created successfully.",e),{cfg:e,blogApi:a}},yc=(c,o,t)=>new OSS({endpoint:c,accessKeyId:t.access_id,accessKeySecret:t.access_key,stsToken:t.access_token,cname:!0,bucket:o});class Kn{static processZHTable(o){const t=Lt(o),s=t("table thead").html();return t("table thead").remove(),t("table tbody tr:first-child").before(s),t("table").attr("data-draft-node","block").attr("data-draft-type","table").attr("data-size","normal").attr("data-row-style","normal"),t.html()}static processZHMath(o){const t=Lt(o,{xmlMode:!0,decodeEntities:!1}),s=/\$\$([^\$]+)\$\$|\$([^\$]+)\$/g;return t("*:not(pre)").each((a,n)=>{const l=(t(n).html()??"").replace(s,(u,r,h)=>{const y=r||h;return`<img eeimg="1" src="//www.zhihu.com/equation?tex=${encodeURIComponent(y)}" 
            alt="${y}" />`});t(n).html(l)}),t.html()}}class bc extends rs{async getMetaData(){const o=await this.zhihuFetch("https://www.zhihu.com/api/v4/me?include=account_status%2Cis_bind_phone%2Cis_force_renamed%2Cemail%2Crenamed_fullname"),t=!!o.uid;return this.logger.info(`get zhihu metadata finished, flag => ${t}`),{flag:t,uid:o.uid,title:o.name,avatar:o.avatar_url,supportTypes:["html"],type:"zhihu",displayName:"知乎",home:"https://www.zhihu.com/settings/account",icon:"https://static.zhihu.com/static/favicon.ico"}}async getUsersBlogs(){var l,u;let o=[];const t=`https://www.zhihu.com/people/${this.cfg.username}/columns`,s=await this.zhihuFetch(t,void 0,"GET",{},"text/html");this.logger.debug("get zhihu columns dom =>",{res:s});const a=Lt(s)("#js-initialData").html(),n=se.safeParse(a,{});this.logger.debug("get column initJson=>",n);const i=((u=(l=n==null?void 0:n.initialState)==null?void 0:l.entities)==null?void 0:u.columns)??{};return this.logger.debug("get columns=>",i),Object.keys(i).map(r=>{const h=new lt,y=i[r];h.blogid=y.id,h.blogName=y.title,h.url=y.url,o.push(h)}),this.logger.debug("getUsersBlogs=>",o),o}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.html;this.logger.info("准备处理知乎正文"),this.logger.debug("html =>",{html:i});let l=i;return l=Kn.processZHTable(l),l=Kn.processZHMath(l),n.html=l,this.logger.info("知乎正文处理完毕"),this.logger.debug("updatedHtml =>",{updatedHtml:l}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}async addPost(o){var l;const t=JSON.stringify({title:o.title,content:o.description}),s=await this.zhihuFetch("https://zhuanlan.zhihu.com/api/articles/drafts",t,"POST");if(this.logger.debug("save zhihu draft res=>",s),!s.id)throw new Error("知乎文章发布失败");const e=s.id.toString(),a=JSON.stringify({column:null,commentPermission:"anyone",disclaimer_type:"none",disclaimer_status:"close",table_of_contents_enabled:!1,commercial_report_info:{commercial_types:[]},commercial_zhitask_bind_info:null}),n=await this.zhihuFetch(`https://zhuanlan.zhihu.com/api/articles/${s.id}/publish`,a,"PUT");this.logger.debug("publish zhihu article pubRes=>",n);const i=((l=o.cate_slugs)==null?void 0:l[0])??this.cfg.blogid;return await this.addPostToColumn(i,e),{status:"success",post_id:e}}async editPost(o,t,s){var l;const e=JSON.stringify({title:t.title,content:t.description,table_of_contents:!1,delta_time:10}),a=await this.zhihuFetch(`https://zhuanlan.zhihu.com/api/articles/${o}/draft`,e,"PATCH");if(this.logger.debug("updated zhihu draft =>",a),(l=a==null?void 0:a.error)!=null&&l.message)throw new Error(`知乎文章更新失败：[${a.error.name}] `+a.error.message);const n=JSON.stringify({disclaimer_type:"none",disclaimer_status:"close",table_of_contents_enabled:!1,commercial_report_info:{commercial_types:[]},commercial_zhitask_bind_info:null}),i=await this.zhihuFetch(`https://zhuanlan.zhihu.com/api/articles/${o}/publish`,n,"PUT");return this.logger.debug("edit zhihu pubRes=>",i),!0}async getPreviewUrl(o){return`https://zhuanlan.zhihu.com/p/${o}`}async deletePost(o){let t=!1;try{const s=await this.zhihuFetch(`https://www.zhihu.com/api/v4/articles/${o}`,void 0,"DELETE");if(this.logger.debug("delete zhihu article res=>",s),s.success)t=!0;else throw new Error(s.error.message)}catch(s){throw this.logger.error("知乎文章删除失败",s),s}return t}async getCategories(){var l,u;const o=[],t=`https://www.zhihu.com/people/${this.cfg.username}/columns`,s=await this.zhihuFetch(t,void 0,"GET",{},"text/html");this.logger.debug("get zhihu columns dom =>",{res:s});const a=Lt(s)("#js-initialData").html(),n=se.safeParse(a,{});this.logger.debug("get column initJson=>",n);const i=((u=(l=n==null?void 0:n.initialState)==null?void 0:l.entities)==null?void 0:u.columns)??{};return this.logger.debug("get columns=>",i),Object.keys(i).map(r=>{const h=new it,y=i[r];h.categoryId=y.id,h.categoryName=y.title,h.description=y.url,h.categoryDescription=y.url,o.push(h)}),o}async uploadFile(o){const t=new Blob([o.bits],{type:o.type}),s=o.name;if(this.logger.debug(`zhihu start uploadFile ${s}=>`,t),t instanceof Blob){const e=await t.arrayBuffer(),a=lc(e),n=ci.MD5(a.toString("utf8")).toString(),i=JSON.stringify({image_hash:n,source:"article"});this.logger.debug("zhihu uploadFile, params =>",i);const l=await this.zhihuFormFetch("https://api.zhihu.com/images",i,{});this.logger.debug("zhihu uploadFile, fileResp =>",l);const u=l.upload_file;if(l.upload_file.state==1){const r=await this.untilImageDone(u.image_id);this.logger.debug("imgDetail",r),u.object_key=r.original_hash}else{const r=l.upload_token;try{const h=yc("https://zhihu-pics-upload.zhimg.com","zhihu-pics",r),y=await h.put(u.object_key,new Blob([a]));this.logger.debug("zhihu uploadFile finished",{client:h,finalUrl:y})}catch(h){throw this.logger.error("知乎图片上传失败 =>",h),new Error("知乎图片上传失败, 错误原因 =>"+h)}}return t.type==="image/gif"&&(u.object_key=u.object_key+".gif"),{id:u.object_key,object_key:u.object_key,url:"https://pic4.zhimg.com/"+u.object_key}}return{}}async zhihuFetch(o,t,s="GET",e={},a="application/json"){const n=new Map;n.set("Cookie",this.cfg.password);const i={...Object.fromEntries(n),...e},l=t,u=o;this.logger.debug("向 Zhihu 请求数据，apiUrl =>",u),this.logger.debug("向 Zhihu 请求数据，headers =>",e),this.logger.debug("向 Zhihu 请求数据，body =>",l);const r=await this.webFetch(u,[i],l,s,a,!0,"base64");return this.logger.debug("向 Zhihu 请求数据，resJson =>",r),r??null}async zhihuFormFetch(o,t,s={}){const e=o,a=new Map;a.set("Cookie",this.cfg.password);const n={...Object.fromEntries(a),...s},i={method:"POST",headers:n,body:t};this.logger.debug("向知乎发送表单数据，apiUrl =>",e),this.logger.debug("向知乎发送表单数据，options =>",i);const l=await this.webFormFetch(e,[n],t,!0);if(l.error)throw new Error("知乎表单提交错误。详细错误 =>"+l.error);return this.logger.debug("向知乎发送表单数据，resJson =>",l),l}async addPostToColumn(o,t){if(T.isEmptyString(o)||T.isEmptyString(t)){this.logger.info("文章或者专栏为空，不收录");return}try{const s={type:"article",id:t};await this.zhihuFetch(`https://www.zhihu.com/api/v4/columns/${o}/items`,s,"POST")}catch(s){this.logger.error("文章收录到专栏失败",s)}this.logger.info("文章收录到专栏成功")}async untilImageDone(o){const t=this;return new Promise(function(s,e){function a(){t.logger.debug("untilImageDone start processing...",o),(async()=>{const n=await t.zhihuFetch(`https://api.zhihu.com/images/${o}`,void 0,"GET");t.logger.debug("imgDetail",n),n.status!="processing"?(t.logger.info("image upload all done"),s(n)):(t.logger.debug("go next",a),setTimeout(a,300))})()}a()})}}class ps extends Tl{}class Bs extends kl{constructor(t,s,e,a,n){super(a,n);D(this,"placeholder",{});this.home=t,this.apiUrl=s,this.username=e,this.password=a,this.apiStatus=!1,this.blogid="",this.blogName="",this.posidKey="",this.previewUrl="",this.pageType=ue.Markdown,this.middlewareUrl=n,this.usernameEnabled=!1,this.allowPreviewUrlChange=!0,this.showTokenTip=!1,this.yamlLinkEnabled=!0,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!1,this.placeholder=new ps}}class _c extends Bs{constructor(t,s,e){super("https://zhuanlan.zhihu.com","https://zhuanlan.zhihu.com/api",t,s,e);D(this,"logoutUrl");this.logoutUrl="https://www.zhihu.com/logout",this.previewUrl="/p/[postid]",this.pageType=ue.Html,this.passwordType=Oe.PasswordType_Cookie,this.usernameEnabled=!0,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="专栏",this.knowledgeSpaceType=ee.CategoryType_Single,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于知乎平台的限制，暂时不支持编辑所属专栏。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的专栏发布"}}class wi extends ps{}var Ro={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const tn=async(c,o)=>{const t=W("use-zhihu-web");t.info("Start using Zhihu WebAuth...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Ro.VITE_MIDDLEWARE_URL,Pe),r=U.emptyOrDefault(Ro.VITE_ZHIHU_AUTH_TOKEN,"");e=new _c("",r,u),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=U.emptyOrDefault(Ro.VITE_MIDDLEWARE_URL,Pe);T.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceType=ee.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder||(e.placeholder=new wi),e.placeholder.knowledgeSpaceReadonlyModeTip="由于知乎平台的限制，暂时不支持编辑所属专栏。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的专栏发布",e.logoutUrl="https://www.zhihu.com/logout",e.picgoPicbedSupported=!1,e.bundledPicbedSupported=!0;const a=new bc(s,e);return{cfg:e,webApi:a}};var wc={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const sn=async(c,o)=>{const t=W("use-metaweblog-api");t.info("Start using Metaweblog API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l="",u="",r="",h=U.emptyOrDefault(wc.VITE_MIDDLEWARE_URL,Pe);e=new Rs("",l,u,r,h),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new cs(s,e);return t.info("Metaweblog API created successfully."),{cfg:e,blogApi:a}};class vc extends ls{constructor(o,t){super("https://www.notion.so/","https://api.notion.com/v1","",o,t),this.tokenSettingUrl="https://www.notion.so/my-integrations",this.showTokenTip=!0,this.previewUrl="/[postid]",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="根页面",this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于Notion平台的限制，暂时不支持编辑所属父页面。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的根页面发布",this.cateSearchEnabled=!0}}class Pc extends Gt{constructor(o,t){super(o,t),this.logger=W("notion-api-adaptor")}async getUsersBlogs(o){const t=[];return(await this.getPages(o)).forEach(e=>{var i,l;const a=new lt;a.blogid=e.id;const n=((l=(i=e==null?void 0:e.properties)==null?void 0:i.title)==null?void 0:l.title)??[];a.blogName=n.map(u=>u.plain_text).join(""),a.url=e.public_url,t.push(a)}),this.logger.debug("get usersBlogs result=>",t),t}async newPost(o,t){var e;const s=((e=o.cate_slugs)==null?void 0:e[0])??this.cfg.blogid;return await this.createPage(o.title,o.description,s)}async editPost(o,t,s){await this.deletePost(o);const e=await this.newPost(t),{getSetting:a,updateSetting:n}=me(),i=await a(),l=this.cfg.posidKey,u=t.originalId,r=ae.getProperty(i,u,{});return r[l]=e,i[u]=r,await n(i),!0}async deletePost(o){const t=this.getNotionPostidKey(o);return await this.deletePage(t.pageId)}async getPost(o,t){var u,r,h;const s=this.getNotionPostidKey(o),e=await this.getPage(s.pageId);this.logger.debug("notionPage=>",e),this.logger.debug("postid=>",o);const a=new ot,n=((r=(u=e==null?void 0:e.properties)==null?void 0:u.title)==null?void 0:r.title)??[];a.title=n.map(y=>y.plain_text).join(""),a.description="暂不支持Notion正文";const i=(h=e==null?void 0:e.parent)==null?void 0:h.page_id,l=[];return l.push(i),a.cate_slugs=l,a}async getCategories(o){const t=[],s=await this.getPages(o);return s&&s.length>0&&s.forEach(e=>{var i,l;const a=new it;a.categoryId=e.id;const n=((l=(i=e==null?void 0:e.properties)==null?void 0:i.title)==null?void 0:l.title)??[];a.categoryName=n.map(u=>u.plain_text).join(""),a.description=a.categoryName,a.categoryDescription=a.categoryName,a.htmlUrl=e.public_url,t.push(a)}),t}async getPreviewUrl(o){const t=this.cfg.previewUrl??"",e=this.getNotionPostidKey(o).endUrl;return t.replace("[postid]",e)}async getPages(o){const t={page_size:10,query:o??"",filter:{value:"page",property:"object"}},e=(await this.notionRequest("/search",t,"POST")).results;if(this.logger.debug("notion pages=>",e),e.length===0)throw new Error("no shared page linked to your connection, you must have at least one page as root page, see more at: https://stackoverflow.com/a/75537092/4037224");return e}async createPage(o,t,s){const e=s??this.cfg.blogid,a=pi.markdownToNotion(t),n={parent:{page_id:e},properties:{title:[{text:{content:o}}]},children:a};this.logger.debug("before createPage =>",{markdownText:t,notionObject:a});const i=await this.notionRequest("/pages",n,"POST");if(i.object!=="page")throw new Error("Notion create page error");const u=i.url.split("/").slice(-1)[0];return`${i.id}_${u}`}async deletePage(o){this.logger.debug("before deletePage, pageId=>",o);const t=`/pages/${o}`,s={archived:!0},e=await this.notionRequest(t,s,"PATCH");if(e.object!=="page")throw new Error("Notion delete page error");return e.archived}async updatePage(o,t,s){throw new Error("Notion是基于块的API，暂时不支持更新，如需更新，请删除之后重新发布")}async getPage(o){this.logger.debug("before getPage, pageId=>",o);const t=`/pages/${o}`,s=await this.notionRequest(t,{},"GET");if(s.object!=="page")throw new Error("Notion get page error");return s}getNotionPostidKey(o){let t,s;if(o.indexOf("_")>0){const e=o.split("_");t=e[0],s=e[1]}else t=o;return{pageId:t,endUrl:s}}async notionRequest(o,t,s="POST"){const e="application/json",a={"Content-Type":e,Authorization:`Bearer ${this.cfg.password}`,"Notion-Version":"2022-06-28"},n=`${this.cfg.apiUrl}${o}`;this.logger.debug("向Notion请求数据，apiUrl =>",n),this.logger.debug("向Notion请求数据，params =>",t);const i=ae.isEmptyObject(t)?void 0:JSON.stringify(t),l=await this.apiFetch(n,[a],i,s,e,!0,"base64","text");if(this.logger.debug("向Notion请求数据，resJson =>",l),(l==null?void 0:l.status)===400||(l==null?void 0:l.status)===401||(l==null?void 0:l.status)===404||(l==null?void 0:l.status)===429)throw new Error(l==null?void 0:l.message);return l}}var zn={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const on=async(c,o)=>{const t=W("use-notion-api");t.info("Start using Notion API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(zn.VITE_NOTION_AUTH_TOKEN,""),u=U.emptyOrDefault(zn.VITE_MIDDLEWARE_URL,Pe);e=new vc(l,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceType=ee.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于Notion平台的限制，暂时不支持编辑所属父页面。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的根页面发布",e.cateSearchEnabled=!0,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!1;const a=new Pc(s,e);return t.info("Notion API created successfully.",e),{cfg:e,blogApi:a}};class es extends ls{constructor(t,s,e,a,n){super("https://github.com","https://api.github.com",t,s,n);D(this,"githubRepo");D(this,"githubBranch");D(this,"defaultPath");D(this,"defaultMsg");D(this,"author");D(this,"email");D(this,"site");D(this,"mdFilenameRule");D(this,"previewPostUrl","");D(this,"previewUrl","");this.username=t,this.usernameEnabled=!0,this.password=s,this.passwordType=Oe.PasswordType_Token,this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.knowledgeSpaceEnabled=!1,this.githubRepo=e,this.githubBranch=a,this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.defaultPath="/",this.defaultMsg="auto published by siyuan-plugin-publisher",this.author="terwer",this.email="youweics@163.com",this.site=T.pathJoin(this.home,"/"+this.username),this.mdFilenameRule="[filename].md",this.middlewareUrl=n}}class vi extends es{constructor(o,t,s,e,a){super(o,t,s,e,a),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="source/_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Hexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class us extends Gt{constructor(t,s){super(t,s);D(this,"githubClient");this.logger=W("common-github-api-adaptor");const e=new Yl(s.username,s.githubRepo,s.password);e.defaultBranch=s.githubBranch,e.defaultPath=s.defaultPath,e.defaultMsg=s.defaultMsg,e.author=s.author,e.email=s.email,e.previewMdUrl=s.previewUrl,e.previewUrl=s.previewPostUrl,e.baseUrl=s.home,e.mdFilenameRule=s.mdFilenameRule,this.githubClient=new Xl(e)}async checkAuth(){var s;let t;try{const e="test.md";await this.safeDeletePost(e);const a=await this.githubClient.publishGithubPage(e,"Hello, World!");await this.safeDeletePost(e),t=!T.isEmptyString((s=a==null?void 0:a.content)==null?void 0:s.path)}catch(e){this.logger.info("checkAuth error =>",e),t=!1}return this.logger.info(`checkAuth finished => ${t}`),t}async getUsersBlogs(){const t=[],s=await this.githubClient.getGithubPageTreeNode("");if(this.logger.debug("getGithubPageTreeNode =>",s),s&&s.length>0){const e=new lt,a=this.cfg;e.blogid=a.defaultPath,e.blogName=a.defaultPath,e.url=T.pathJoin(T.pathJoin(a.home,a.username),a.githubRepo),t.push(e)}return this.logger.debug("result result =>",t),t}async newPost(t,s){var u,r,h;this.logger.debug("start newPost =>",{post:le(t)});const e=this.cfg,a=((u=t.cate_slugs)==null?void 0:u[0])??e.blogid,n=t.mdFilename??"auto-"+Uo.newID()+".md",i=T.pathJoin(a,n);this.logger.info("将要最终发送到以下目录 =>",i);let l;try{const y=await this.githubClient.publishGithubPage(i,t.description);if(!((r=y==null?void 0:y.content)!=null&&r.path))throw new Error("Github 调用API异常");l=y}catch{try{await this.deletePost(i)}catch(g){this.logger.warn("尝试删除失败，忽略",g)}const p=await this.githubClient.publishGithubPage(i,t.description);if(!((h=p==null?void 0:p.content)!=null&&h.path))throw new Error("重发依旧失败，Github 调用API异常");l=p}return l.content.path}async getPost(t,s){this.logger.debug("start getPost =>",{postid:t});const e=await this.githubClient.getGithubPage(t);if(this.logger.debug("getPost finished =>",e),!e)throw new Error("Github 调用API异常");let a=new ot;a.postid=e.path,a.mdFilename=e.name,a.markdown=It.fromBase64(e.content),a.description=a.markdown;const n=this.getYamlAdaptor();if(n!==null){const u=await ne.yaml2ObjAsync(a.description),r=new gt;r.yamlObj=u,this.logger.debug("extract frontFormatter, yamlFormatObj =>",r),a=n.convertToAttr(a,r,this.cfg),this.logger.debug("handled yamlObj using YamlConverterAdaptor =>",u)}const i=[],l=e.path.replace(e.name,"").replace(/\/$/,"");return i.push(l),a.cate_slugs=i,a}async editPost(t,s,e){var n;this.logger.debug("start editPost =>",{postid:t,post:le(s)});const a=await this.githubClient.updateGithubPage(s.postid,s.description);if(!((n=a==null?void 0:a.content)!=null&&n.path))throw new Error("Github 调用API异常");return!0}async deletePost(t){var e;const s=await this.githubClient.deleteGithubPage(t);if(!((e=s==null?void 0:s.commit)!=null&&e.sha))throw new Error("Github 调用API异常");return!0}async getCategoryTreeNodes(t){return await this.githubClient.getGithubPageTreeNode(t)}async getPreviewUrl(t){const s=this.cfg;let e;return e=s.previewUrl.replace("[user]",s.username).replace("[repo]",s.githubRepo).replace("[branch]",s.githubBranch).replace("[docpath]",t),e}async getPostPreviewUrl(t){let s;const e=t.substring(t.lastIndexOf("/")+1).replace(".md","");return s=this.cfg.previewPostUrl.replace("[postid]",e),s}async newMediaObject(t){const s=this.cfg;try{const e=t.bits,a=It.fromUint8Array(e),n=this.cfg.imageStorePath??"images",i=T.pathJoin(n,t.name),l=await this.githubClient.publishGithubPage(i,a,"base64"),u=t.name,r=t.name;let h=T.pathJoin("https://raw.githubusercontent.com",this.cfg.username);h=T.pathJoin(h,s.githubRepo),h=T.pathJoin(h,s.githubBranch),h=T.pathJoin(h,encodeURI(n)),h=T.pathJoin(h,encodeURIComponent(t.name));const y=h;return this.logger.debug("github publishGithubPage res =>",l),{attachment_id:u,date_created_gmt:new Date,parent:0,link:y,title:t.name,caption:"",description:"",metadata:{width:0,height:0,file:"",filesize:0,sizes:[]},type:t.type,thumbnail:"",id:r,file:t.name,url:y}}catch(e){throw this.logger.error("Error uploading image to github:",e),e}}async safeDeletePost(t){try{await this.githubClient.deleteGithubPage(t)}catch{}return!0}}class On extends is{constructor(){super(...arguments);D(this,"logger",W("hexo-yaml-converter-adaptor"))}convertToYaml(t,s,e){var n,i;if(this.logger.debug("您正在使用 Hexo Yaml Converter",{post:le(t)}),s||(s=new gt),s.yamlObj.title=t.title,s.yamlObj.date=Me.formatIsoToZh(t.dateCreated.toISOString(),!0),t.dateUpdated||(t.dateUpdated=new Date),s.yamlObj.updated=Me.formatIsoToZh(t.dateUpdated.toISOString(),!0),T.isEmptyString(t.shortDesc)||(s.yamlObj.excerpt=t.shortDesc),!T.isEmptyString(t.mt_keywords)){const l=t.mt_keywords.split(",");s.yamlObj.tags=l}if(((n=t.categories)==null?void 0:n.length)>0&&(s.yamlObj.categories=t.categories),e.yamlLinkEnabled){let l="/post/"+t.wp_slug+".html";if(e instanceof es){const u=e;if(!T.isEmptyString(e.previewPostUrl)){l=u.previewPostUrl.replace("[postid]",t.wp_slug);const y=Me.formatIsoToZh(t.dateCreated.toISOString(),!0).split(" ")[0].split("-");this.logger.debug("created numarr=>",y);const p=y[0],g=y[1],_=y[2];l=l.replace(/\[yyyy]/g,p),l=l.replace(/\[MM]/g,g),l=l.replace(/\[mm]/g,g),l=l.replace(/\[dd]/g,_),((i=s.yamlObj.categories)==null?void 0:i.length)>0?l=l.replace(/\[cats]/,s.yamlObj.categories.join("/")):l=l.replace(/\/\[cats]/,"")}}s.yamlObj.permalink=l}s.yamlObj.comments=!0,s.yamlObj.toc=!0;let a=ne.obj2Yaml(s.yamlObj);return this.logger.debug("yaml=>",a),s.formatter=a,s.mdContent=t.markdown,s.mdFullContent=ne.addYamlToMd(s.formatter,s.mdContent),s.htmlContent=t.html,this.logger.info("生成默认的YAML"),s}convertToAttr(t,s,e){var a,n,i,l,u,r,h,y,p,g;return this.logger.debug("开始转换YAML到Post",s),(a=s.yamlObj)!=null&&a.title&&(t.title=(n=s.yamlObj)==null?void 0:n.title),(i=s.yamlObj)!=null&&i.date&&(t.dateCreated=Me.convertStringToDate((l=s.yamlObj)==null?void 0:l.date)),(u=s.yamlObj)!=null&&u.updated&&(t.dateUpdated=Me.convertStringToDate((r=s.yamlObj)==null?void 0:r.updated)),t.shortDesc=(h=s.yamlObj)==null?void 0:h.excerpt,t.mt_keywords=(p=(y=s.yamlObj)==null?void 0:y.tags)==null?void 0:p.join(","),t.categories=(g=s.yamlObj)==null?void 0:g.categories,t.yaml=ne.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Tc extends us{getYamlAdaptor(){return new On}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Hexo 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Hexo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var bs={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const no=async(c,o)=>{const t=W("use-hexo-api");t.info("Start using Hexo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(bs.VITE_GITHUB_USERNAME,""),r=U.emptyOrDefault(bs.VITE_GITHUB_AUTH_TOKEN,""),h=U.emptyOrDefault(bs.VITE_GITHUB_REPO,""),y=U.emptyOrDefault(bs.VITE_GITHUB_BRANCH,"main"),p=U.emptyOrDefault(bs.VITE_MIDDLEWARE_URL,Pe);e=new vi(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Hexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new On,n=new Tc(s,e);return t.info("Hexo API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class kc extends vi{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="source/_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Githubhexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Pi extends On{}class Sc{constructor(o,t){D(this,"logger");D(this,"appInstance");D(this,"cfg");this.logger=W("gitlab-fetch-client-proxy"),this.appInstance=o,this.cfg=t}async fetchCall(o,t,s){try{const e=T.pathJoin(this.cfg.apiUrl,o);this.logger.debug("gitlab fetch adaptor start"),this.logger.debug("apiUrl=>",e),this.logger.debug("fetchOptions=>",t);const a=await this.appInstance.fetch(e,t);if(this.logger.debug("gitlab fetch adaptor end，resp=>",a),a.ok)return this.safeParseBodyJson(a);throw`gitlab fetch adaptor 请求错误，code ${a.status}, detail => ${a.statusText}`}catch(e){throw this.logger.error(e),new Error("请求处理异常 => "+e.toString())}}async safeParseBodyJson(o){const t=await o.text();return se.safeParse(t,{})}}class ds extends Gt{constructor(t,s){super(t,s);D(this,"gitlabClient");D(this,"gitlabCfg");this.logger=W("common-gitlab-api-adaptor"),this.gitlabCfg=s;const e=new Sc(t,s);this.gitlabClient=new Zl(t,s.apiUrl,s.password,s.username,s.githubRepo,s.githubBranch,s.defaultMsg,s.email,s.author,e,s.middlewareUrl,Rt)}async checkAuth(){let t;try{const s="test.md";await this.safeDeletePost(s);const e=await this.gitlabClient.createRepositoryFile(s,"Hello, World!");await this.safeDeletePost(s),t=!T.isEmptyString(e==null?void 0:e.file_path)}catch(s){this.logger.info("checkAuth error =>",s),t=!1}return this.logger.info(`checkAuth finished => ${t}`),t}async getUsersBlogs(){const t=[],s=await this.gitlabClient.getRepositoryTree("");if(this.logger.debug("getRepositoryTree =>",s),s&&s.length>0){const e=new lt,a=this.cfg;e.blogid=a.defaultPath,e.blogName=a.defaultPath,e.url=T.pathJoin(T.pathJoin(a.home,a.username),a.githubRepo),t.push(e)}return this.logger.debug("result result =>",t),t}async newPost(t,s){var u;this.logger.debug("start newPost =>",{post:le(t)});const e=this.cfg,a=((u=t.cate_slugs)==null?void 0:u[0])??e.blogid,n=t.mdFilename??"auto-"+Uo.newID()+".md",i=T.pathJoin(a,n);this.logger.info("将要最终发送到以下目录 =>",i);let l;try{const r=await this.gitlabClient.createRepositoryFile(i,t.description);if(this.logger.debug("gitlab newPost finished =>",r),!(r!=null&&r.file_path))throw new Error("Gitlab 调用API异常 =>"+(r==null?void 0:r.message));l=r}catch{try{await this.deletePost(i)}catch(y){this.logger.warn("尝试删除失败，忽略",y)}const h=await this.gitlabClient.createRepositoryFile(i,t.description);if(!(h!=null&&h.file_path))throw new Error("重发依旧失败，Gitlab 调用API异常 =>"+(h==null?void 0:h.message));l=h}return l.file_path}async getPost(t,s){this.logger.debug("start getPost =>",{postid:t});const e=await this.gitlabClient.getRepositoryFile(t);if(this.logger.debug("gitlab getPost finished =>",e),!e)throw new Error("Gitlab 调用API异常");let a=new ot;a.postid=e.file_path,a.mdFilename=e.file_name,a.markdown=It.fromBase64(e.content),a.description=a.markdown;const n=this.getYamlAdaptor();if(n!==null){const u=await ne.yaml2ObjAsync(a.description),r=new gt;r.yamlObj=u,this.logger.debug("extract frontFormatter, yamlFormatObj =>",r),a=n.convertToAttr(a,r,this.cfg),this.logger.debug("handled yamlObj using YamlConverterAdaptor =>",u)}const i=[],l=e.file_path.replace(e.file_name,"").replace(/\/$/,"");return i.push(l),a.cate_slugs=i,a}async editPost(t,s,e){this.logger.debug("start editPost =>",{postid:t,post:le(s)});const a=await this.gitlabClient.updateRepositoryFile(s.postid,s.description);if(this.logger.debug("gitlab editPost finished =>",a),!(a!=null&&a.file_path))throw new Error("Gitlab 调用API异常");return!0}async deletePost(t){try{const s=await this.gitlabClient.deleteRepositoryFile(t);this.logger.debug("gitlab deletePost finished =>",s)}catch(s){throw new Error("Gitlab 调用API异常 =>"+s)}return!0}async getCategoryTreeNodes(t){return await this.gitlabClient.getRepositoryTree(t)}async getPreviewUrl(t){const s=this.cfg;let e;return e=s.previewUrl.replace("[user]",s.username).replace("[repo]",s.githubRepo).replace("[branch]",s.githubBranch).replace("[docpath]",t),e}async getPostPreviewUrl(t){let s;const e=t.substring(t.lastIndexOf("/")+1).replace(".md","");return s=this.cfg.previewPostUrl.replace("[postid]",e),s}async newMediaObject(t){try{const s=t.bits,e=It.fromUint8Array(s),a=T.pathJoin(this.cfg.imageStorePath??"images",t.name),n=await this.gitlabClient.createRepositoryFile(a,e,"base64");if(this.logger.debug("gitlab createRepositoryFile res =>",n),T.isEmptyString(n.file_path))throw new Error("Gitlab 调用API异常");const i=t.name,l=t.name;let u=T.pathJoin(this.cfg.home,this.cfg.username);u=T.pathJoin(u,this.gitlabCfg.githubRepo),u=T.pathJoin(u,"-/raw"),u=T.pathJoin(u,n.branch),u=T.pathJoin(u,n.file_path);const r=u;return{attachment_id:i,date_created_gmt:new Date,parent:0,link:r,title:t.name,caption:"",description:"",metadata:{width:0,height:0,file:"",filesize:0,sizes:[]},type:t.type,thumbnail:"",id:l,file:t.name,url:r}}catch(s){throw this.logger.error("Error uploading image to gitlab:",s),s}}async safeDeletePost(t){try{await this.gitlabClient.deleteRepositoryFile(t)}catch{}return!0}}class Ec extends ds{getYamlAdaptor(){return new Pi}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Gitlabhexo 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Gitlabhexo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var _s={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const io=async(c,o)=>{const t=W("use-gitlab-hexo-api");t.info("Start using Gitlabhexo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(_s.VITE_GITLAB_USERNAME,""),r=U.emptyOrDefault(_s.VITE_GITLAB_AUTH_TOKEN,""),h=U.emptyOrDefault(_s.VITE_GITLAB_REPO,""),y=U.emptyOrDefault(_s.VITE_GITLAB_BRANCH,"main"),p=U.emptyOrDefault(_s.VITE_MIDDLEWARE_URL,Pe);e=new kc(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabhexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Pi,n=new Ec(s,e);return t.info("Gitlabhexo API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Cc extends Bs{constructor(t,s,e){super("https://blog.csdn.net","https://bizapi.csdn.net",t,s,e);D(this,"logoutUrl");this.logoutUrl="https://passport.csdn.net/account/logout",this.previewUrl="/[userid]/article/details/[postid]",this.pageType=ue.Markdown,this.usernameEnabled=!1,this.passwordType=Oe.PasswordType_Cookie,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class an{static renderToString(o){return this.logger.debug("准备处理 Katex =>",{mathExpression:o}),Ql.renderToString(o)}}D(an,"logger",W("katex-utils"));const Ft=class Ft{static generateXCaNonce(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){const t=16*Math.random()|0;return(o==="x"?t:3&t|8).toString(16)})}static generateXCaSignature(o,t,s,e,a){const n=new URL(o),i=Jl.parse(Ft.APP_SECRET);let l;if(t==="GET"){const h=n.pathname+n.search;l=`GET
${s}

${a}

x-ca-key:${Ft.X_CA_KEY}
x-ca-nonce:${e}
${h}`}else{const h=n.pathname;l=`POST
${s}

${a}

x-ca-key:${Ft.X_CA_KEY}
x-ca-nonce:${e}
${h}`}const u=ci.HmacSHA256(l,i);return ql.stringify(u)}static processCsdnMath(o){const t=Lt(o,{xmlMode:!0,decodeEntities:!1}),s=/\$\$([^$]+)\$\$/g;t("*:not(pre)").each((a,n)=>{const l=t(n).html().replace(s,(u,r)=>`<span class="katex--display">${an.renderToString(r)}</span>`);t(n).html(l)});const e=/\$([^$]+)\$/g;return t("*:not(pre)").each((a,n)=>{const l=t(n).html().replace(e,(u,r)=>`<span class="katex--inline">${an.renderToString(r)}</span>`);t(n).html(l)}),t.html()}static async processPrismjs(o,t){const s=`${ar}/prismjs`,e="application/json",a={"Content-Type":e},n=JSON.stringify({html:t}),i=await o.webFetch(s,[a],n,"POST",e,!1);return console.log("processPrismjs res=>",i),i.html}};D(Ft,"X_CA_KEY","203803574"),D(Ft,"APP_SECRET","9znpamsyl2c7cdrr9sas0le9vbc3r6ba");let Nt=Ft;class Ac{static readCookie(o,t){const s=t.split(";");for(const e of s){const[a,n]=e.split("=");if(a.trim()===o)return decodeURIComponent(n)??""}return""}}class Uc extends rs{async getMetaData(){const o=await this.csdnFetch("https://bizapi.csdn.net/blog-console-api/v1/user/info"),t=!!o.data.username;return this.logger.info(`get csdn metadata finished, flag => ${t}`),{flag:t,uid:o.data.username,title:o.data.username,avatar:o.data.avatar,type:"csdn",displayName:"CSDN",supportTypes:["markdown","html"],home:"https://mp.csdn.net/",icon:"https://g.csdnimg.cn/static/logo/favicon32.ico"}}async getUsersBlogs(){var s;let o=[];const t=await this.csdnFetch("https://bizapi.csdn.net/blog/phoenix/console/v1/column/list?type=all");if(this.logger.debug("get csdn columns =>",t),(t==null?void 0:t.code)===200){const e=(s=t==null?void 0:t.data)==null?void 0:s.list,a=(e==null?void 0:e.column)??[],n=(e==null?void 0:e.pay_column)??[];a.forEach(i=>{const l=new lt;l.blogid=i.id,l.blogName=i.edit_title,l.url=i.column_url,o.push(l)}),n.forEach(i=>{const l=new lt;l.blogid=i.id,l.blogName=i.edit_title,l.url=i.column_url,o.push(l)})}return this.logger.debug("getUsersBlogs=>",o),o}async getCategories(){var s;const o=[],t=await this.csdnFetch("https://bizapi.csdn.net/blog/phoenix/console/v1/column/list?type=all");if(this.logger.debug("get csdn columns =>",t),(t==null?void 0:t.code)===200){const e=(s=t==null?void 0:t.data)==null?void 0:s.list,a=(e==null?void 0:e.column)??[],n=(e==null?void 0:e.pay_column)??[];a.forEach(i=>{const l=new it;l.categoryId=i.id,l.categoryName=i.edit_title,l.description=i.column_url,l.categoryDescription=i.desc,o.push(l)}),n.forEach(i=>{const l=new it;l.categoryId=i.id,l.categoryName=i.edit_title,l.description=i.column_url,l.categoryDescription=i.desc,o.push(l)})}return o}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.html;this.logger.info("准备处理CSDN正文"),this.logger.debug("html =>",{html:i});let l=i;return l=Nt.processCsdnMath(l),n.html=l,this.logger.info("CSDN正文处理完毕"),this.logger.debug("updatedHtml =>",{updatedHtml:l}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}async addPost(o){let t=o.html;t=await Nt.processPrismjs(this,t);const s=JSON.stringify({title:o.title,markdowncontent:o.markdown,content:t,readType:"public",level:0,tags:o.mt_keywords,status:0,categories:o.categories.join(","),type:"original",original_link:"",authorized_status:!1,Description:o.shortDesc,not_auto_saved:"1",source:"pc_mdeditor",cover_images:[],cover_type:1,is_new:1,vote_id:0,resource_id:"",pubStatus:"publish"}),e=await this.csdnFetch("https://bizapi.csdn.net/blog-console-api/v3/mdeditor/saveArticle",[],s,"POST");if(this.logger.debug("save csdn post res=>",e),(e==null?void 0:e.code)!==200)throw new Error("CSDN文章发布失败，可能是等级不够导致，如过等级不够，请去掉文章标签");return{status:"success",post_id:e.data.id.toString()}}async editPost(o,t,s){let e=t.html;e=await Nt.processPrismjs(this,e);const a=JSON.stringify({id:o,title:t.title,markdowncontent:t.markdown,content:e,readType:"public",level:"1",tags:t.mt_keywords,status:0,categories:t.categories.join(","),type:"original",original_link:"",authorized_status:!1,Description:t.shortDesc,resource_url:"",not_auto_saved:"1",source:"pc_mdeditor",cover_images:[],cover_type:1,is_new:1,vote_id:0,resource_id:"",pubStatus:"publish"}),n=await this.csdnFetch("https://bizapi.csdn.net/blog-console-api/v3/mdeditor/saveArticle",[],a,"POST");if(this.logger.debug("save csdn post res=>",n),(n==null?void 0:n.code)!==200)throw new Error("CSDN文章更新失败，可能是等级不够导致，如果等级不够，请去掉文章标签");return this.logger.debug("edit csdn post res=>",n),!0}async getPost(o){const t=await this.csdnFetch(`https://bizapi.csdn.net/blog-console-api/v3/editor/getArticle?id=${o}`);this.logger.debug("get csdn post =>",t);const s=new ot;if((t==null?void 0:t.code)===200){const e=t==null?void 0:t.data;s.postid=e.article_id,s.title=e.title,s.mt_keywords=(e==null?void 0:e.tags)??"",s.categories=(e==null?void 0:e.categories.split(","))??[]}return s}async deletePost(o){let t=!1;try{const s=JSON.stringify({articleId:o,deep:!1}),e=await this.csdnFetch("https://bizapi.csdn.net/blog/phoenix/console/v1/article/del",[],s,"POST");if(this.logger.debug("delete csdn article res=>",e),(e==null?void 0:e.code)!==200)throw new Error(e==null?void 0:e.message);t=!0}catch(s){throw this.logger.error("CSDN文章删除失败",s),s}return t}async getPreviewUrl(o){const t=this.cfg.password,s=Ac.readCookie("UserName",t);return this.cfg.previewUrl.replace(/\[userid\]/g,s).replace(/\[postid\]/g,o)}async uploadFile(o){const{FormData:t,Blob:s}=Mo.getFormData(this.appInstance),e=new s([o.bits],{type:o.type}),a=o.name;if(this.logger.debug(`csdn start uploadFile ${a}=>`,e),e instanceof s){const n=await this.requestUpload(a);if(this.logger.debug("csdn image uploadData =>",n),!n)throw new Error("CSDN图片信息获取失败 =>"+a);const i=n.host,l=new t;l.append("key",n.filePath),l.append("policy",n.policy),l.append("OSSAccessKeyId",n.accessId),l.append("success_action_status","200"),l.append("signature",n.signature),l.append("callback",n.callbackUrl),l.append("file",e),this.logger.debug("csdn image upload strat...");const u={},r=await this.csdnFormFetch(i,l,u);if(r.code!==200)throw new Error("CSDN图片上传失败 =>"+a);return{id:r.data.targetObjectKey,object_key:r.data.targetObjectKeyy,url:r.data.imageUrl}}return{}}async requestUpload(o){const t="https://imgservice.csdn.net/direct/v1.0/image/upload?watermark=&type=blog&rtype=markdown",s=o.split(".").pop();if(!this.validateFileExt(s))return null;var e=await this.csdnFetch(t,{"x-image-app":"direct_blog","x-image-suffix":s,"x-image-dir":"direct"});return e.code!==200?(this.logger.error("图片可能已经上传，信息如下",e),null):e.data}validateFileExt(o){switch(o.toLowerCase()){case"jpg":case"png":case"jpeg":case"gif":return!0;default:return!1}}async csdnFetch(o,t={},s=void 0,e="GET",a="application/json"){const n="*/*",i=Nt.X_CA_KEY,l=Nt.generateXCaNonce(),u=Nt.generateXCaSignature(o,e,n,l,a),r=new Map;r.set("accept",n),r.set("content-type",a),r.set("x-ca-key",i),r.set("x-ca-nonce",l),r.set("x-ca-signature",u),r.set("x-ca-signature-headers","x-ca-key,x-ca-nonce"),r.set("Cookie",this.cfg.password);const h={...Object.fromEntries(r),...t},y={method:e,headers:h,body:s};return this.logger.debug("csdn url =>",o),this.logger.debug("csdn requestOptions =>",y),await this.webFetch(o,[h],s,e,a,!0,"base64")}async csdnFormFetch(o,t,s={}){const e=o,a={method:"POST",headers:s,body:t};this.logger.debug("向 CSDN 发送表单数据，apiUrl =>",e),this.logger.debug("向 CSDN 发送表单数据，options =>",a);const n=await this.webFormFetch(e,[s],t,!1);if(n.error)throw new Error("CSDN 表单提交错误。详细错误 =>"+n.error);return this.logger.debug("向 CSDN 发送表单数据，resJson =>",n),n}}var Go={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const nn=async(c,o)=>{const t=W("use-csdn-web");t.info("Start using Csdn WebAuth...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Go.VITE_MIDDLEWARE_URL,Pe),r=U.emptyOrDefault(Go.VITE_CSDN_AUTH_TOKEN,"");e=new Cc("",r,u),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=U.emptyOrDefault(Go.VITE_MIDDLEWARE_URL,Pe);T.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!1,e.bundledPicbedSupported=!0,e.logoutUrl="https://passport.csdn.net/account/logout",e.picgoPicbedSupported=!1,e.bundledPicbedSupported=!0;const a=new Uc(s,e);return{cfg:e,webApi:a}};class Ic extends Bs{constructor(o,t,s){super("https://mp.weixin.qq.com","https://mp.weixin.qq.com/cgi-bin/appmsg",o,t,s),this.previewUrl="/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=77&appmsgid=[postid]&token=[token]&lang=zh_CN",this.pageType=ue.Html,this.passwordType=Oe.PasswordType_Cookie,this.usernameEnabled=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!1}}class xc extends rs{async getMetaData(){const o=await this.weChatFetch("https://mp.weixin.qq.com/",void 0,"GET",{},"text/html");this.logger.debug("WechatWebAdaptor res=>",{res:o});const t=Lt(o),s=t("script")[0],e=t(s).text();this.logger.debug("scriptElement =>",{scriptText:e});const a=e.substring(e.indexOf("window.wx.commonData")),n=new Function("window.wx = {}; window.handlerNickname = function(){};"+a+"; return window.wx;")();this.logger.debug(a,n);const i=Object.assign({},n.commonData);if(delete window.wx,!i.data.t)throw new Error("微信公众号未登录或者登录过期，请更新cookie");const l={flag:!T.isEmptyString(i.data.t),uid:i.data.user_name,title:i.data.nick_name,token:i.data.t,commonData:i,avatar:t(".weui-desktop-account__thumb").eq(0).attr("src"),type:"weixin",supportTypes:["html"],home:"https://mp.weixin.qq.com",icon:"https://mp.weixin.qq.com/favicon.ico"};return this.logger.info(`get wechat metadata finished, flag => ${l}`),l}async getUsersBlogs(){let o=[];const t=await this.weChatFetch("https://mp.weixin.qq.com/",void 0,"GET",{},"text/html");this.logger.debug("WechatWebAdaptor res=>",{res:t});const s=Lt(t),e=s("script")[0],a=s(e).text();this.logger.debug("scriptElement =>",{scriptText:a});const n=a.substring(a.indexOf("window.wx.commonData")),i=new Function("window.wx = {}; window.handlerNickname = function(){};"+n+"; return window.wx;")();this.logger.debug(n,i);const l=Object.assign({},i.commonData);if(delete window.wx,!l.data.t)throw new Error("微信公众号未登录或者登录过期，请更新cookie");this.logger.info("get wechat commonData =>",l);const u=new lt;return u.blogid=l.data.user_name,u.blogName=l.data.nick_name,o.push(u),this.logger.debug("getUsersBlogs=>",o),o}async addPost(o){this.logger.debug("addPost get metadata =>",{cfg:le(this.cfg.metadata)});const t="https://mp.weixin.qq.com/cgi-bin/operate_appmsg?t=ajax-response&sub=create&type=77&token="+this.cfg.metadata.token+"&lang=zh_CN",s=Ut.parseHtml(o.shortDesc??"",119,!0),e={token:this.cfg.metadata.token,lang:"zh_CN",f:"json",ajax:"1",random:Math.random(),AppMsgId:"",count:"1",data_seq:null,operate_from:"Chrome",isnew:"0",autosave_log:"true",articlenum:"1",pre_timesend_set:"0",is_finder_video0:"0",finder_draft_id0:"0",applyori0:"0",ad_video_transition0:"",can_reward0:"0",pay_gifts_count0:"0",reward_reply_id0:"",related_video0:"",is_video_recommend0:"-1",title0:o.title,author0:"",writerid0:"0",fileid0:"",digest0:s,auto_gen_digest0:"1",content0:o.html,sourceurl0:"",last_choose_cover_from0:"0",need_open_comment0:"1",only_fans_can_comment0:"0",only_fans_days_can_comment0:"0",reply_flag0:"5",not_pay_can_comment0:"0",open_fansmsg0:"0",cdn_url0:"",cdn_235_1_url0:"",cdn_16_9_url0:"",cdn_3_4_url0:"",cdn_1_1_url0:"",cdn_finder_url0:"",cdn_video_url0:"",cdn_url_back0:"",crop_list0:"",app_cover_auto0:"0",music_id0:"",video_id0:"",voteid0:"",voteismlt0:"",supervoteid0:"",cardid0:"",cardquantity0:"",cardlimit0:"",vid_type0:"",show_cover_pic0:"0",shortvideofileid0:"",copyright_type0:"0",is_cartoon_copyright0:"0",copyright_img_list0:'{"max_width":578,"img_list":[]}',releasefirst0:"",platform0:"",reprint_permit_type0:"",allow_fast_reprint0:"0",allow_reprint0:"",allow_reprint_modify0:"",original_article_type0:"",ori_white_list0:"",video_ori_status0:"",hit_nickname0:"",free_content0:"",fee0:"0",ad_id0:"",guide_words0:"",is_share_copyright0:"0",share_copyright_url0:"",source_article_type0:"",reprint_recommend_title0:"",reprint_recommend_content0:"",share_page_type0:"0",share_imageinfo0:'{"list":[]}',share_video_id0:"",dot0:"{}",share_voice_id0:"",share_finder_audio_username0:"",share_finder_audio_exportid0:"",mmlistenitem_json_buf0:"",insert_ad_mode0:"",categories_list0:"[]",is_pay_subscribe0:"0",pay_fee0:"",pay_preview_percent0:"",pay_desc0:"",pay_album_info0:"",appmsg_album_info0:'{"appmsg_album_infos":[]}',can_insert_ad0:"1",audio_info0:'{"audio_infos":[]}',danmu_pub_type0_0:"0",is_set_sync_to_finder0:"0",sync_to_finder_cover0:"",sync_to_finder_cover_source0:"",import_to_finder0:"0",import_from_finder_export_id0:"",style_type0:"3",sticker_info0:'{"is_stickers":0,"common_stickers_num":0,"union_stickers_num":0,"sticker_id_list":[],"has_invalid_sticker":0}',new_pic_process0:"0",disable_recommend0:"0",req:'{"idx_infos":[{"save_old":0,"cps_info":{"cps_import":0}}]}',is_auto_type_setting:"3",save_type:"1",isneedsave:"0"},a=new FormData;for(const i in e)a.append(i,e[i]??"");const n=await this.wechatFormFetch(t,a);if(!n.appMsgId){const i=n.base_resp;throw new Error("同步到微信公众号失败，错误内容："+(i&&i.errmsg?i.errmsg:i.ret))}return{status:"success",post_id:n.appMsgId.toString()}}async editPost(o,t,s){this.logger.debug("editPost get metadata =>",{cfg:le(this.cfg.metadata)});let e=!1;const a="https://mp.weixin.qq.com/cgi-bin/operate_appmsg?t=ajax-response&sub=update&type=77&token="+this.cfg.metadata.token+"&lang=zh_CN",n=Ut.parseHtml(t.shortDesc??"",119,!0),i=o,l={token:this.cfg.metadata.token,lang:"zh_CN",f:"json",ajax:"1",random:Math.random(),AppMsgId:i,count:"1",data_seq:null,operate_from:"Chrome",isnew:"0",autosave_log:"true",articlenum:"1",pre_timesend_set:"0",is_finder_video0:"0",finder_draft_id0:"0",applyori0:"0",ad_video_transition0:"",can_reward0:"0",pay_gifts_count0:"0",reward_reply_id0:"",related_video0:"",is_video_recommend0:"-1",title0:t.title,author0:"",writerid0:"0",fileid0:"",digest0:n,auto_gen_digest0:"1",content0:t.html,sourceurl0:"",last_choose_cover_from0:"0",need_open_comment0:"1",only_fans_can_comment0:"0",reply_flag0:"5",not_pay_can_comment0:"0",open_fansmsg0:"0",cdn_url0:"",cdn_235_1_url0:"",cdn_16_9_url0:"",cdn_3_4_url0:"",cdn_1_1_url0:"",cdn_finder_url0:"",cdn_video_url0:"",cdn_url_back0:"",crop_list0:"",app_cover_auto0:"0",music_id0:"",voteid0:"",voteismlt0:"",supervoteid0:"",cardid0:"",cardquantity0:"",cardlimit0:"",vid_type0:"",show_cover_pic0:"0",shortvideofileid0:"",copyright_type0:"0",is_cartoon_copyright0:"0",copyright_img_list0:'{"max_width":578,"img_list":[]}',releasefirst0:"",platform0:"",reprint_permit_type0:"",allow_fast_reprint0:"0",allow_reprint0:"",allow_reprint_modify0:"",original_article_type0:"",ori_white_list0:"",video_ori_status0:"",hit_nickname0:"",free_content0:"",fee0:"0",ad_id0:"",guide_words0:"",is_share_copyright0:"0",share_copyright_url0:"",source_article_type0:"",reprint_recommend_title0:"",reprint_recommend_content0:"",share_page_type0:"0",share_imageinfo0:'{"list":[]}',share_video_id0:"",dot0:"{}",share_voice_id0:"",share_finder_audio_username0:"",share_finder_audio_exportid0:"",mmlistenitem_json_buf0:"",insert_ad_mode0:"",categories_list0:"[]",is_pay_subscribe0:"0",pay_fee0:"",pay_preview_percent0:"",pay_desc0:"",pay_album_info0:"",appmsg_album_info0:'{"appmsg_album_infos":[]}',can_insert_ad0:"1",audio_info0:'{"audio_infos":[]}',danmu_pub_type0_0:"0",is_set_sync_to_finder0:"0",sync_to_finder_cover0:"",sync_to_finder_cover_source0:"",import_to_finder0:"0",import_from_finder_export_id0:"",style_type0:"3",sticker_info0:'{"is_stickers":0,"common_stickers_num":0,"union_stickers_num":0,"sticker_id_list":[],"has_invalid_sticker":0}',new_pic_process0:"0",disable_recommend0:"0",req:'{"idx_infos":[{"save_old":0,"cps_info":{"cps_import":0}}]}',is_auto_type_setting:"3",save_type:"1",isneedsave:"0"},u=new FormData;for(const h in l)u.append(h,l[h]??"");const r=await this.wechatFormFetch(a,u);if(!r.appMsgId){const h=r.base_resp;throw new Error("同步到微信公众号失败，错误内容："+(h&&h.errmsg?h.errmsg:h.ret))}return e=!0,e}async getPost(o){const t=this.cfg.metadata.token,s=`https://mp.weixin.qq.com/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=77&appmsgid=${o}&token=${t}&lang=zh_CN`,e=await this.webFetch(s,[],{},"GET","text/html");this.logger.debug("get wechat post finished, res=>",e);const a=new ot,l=(Lt(e)("html").html()||"").match(/infos\s*=\s*({.*?}},)/);if(l&&l[1]){const u=l[1].replace(/,$/,"");this.logger.debug(`matched infoJSON ${typeof u} =>`,u);try{const r=se.safeParse(u,{});if(!ae.isEmptyObject(r)){this.logger.debug("found infos =>",r);const h=r.item.find(y=>y.app_id.toString()===o);this.logger.debug("curItem =>",h),a.title=h.title,a.shortDesc=h.digest}}catch(r){this.logger.error("微信公众号JSON解析错误",r)}}else this.logger.error("微信公众号未找到infos = {}},");return a}async deletePost(o){let t=!1;const s="https://mp.weixin.qq.com/cgi-bin/operate_appmsg?sub=del&t=ajax-response",e={token:this.cfg.metadata.token,lang:"zh_CN",f:"json",ajax:"1",AppMsgId:o},a=new FormData;for(const i in e)a.append(i,e[i]??"");const n=await this.wechatFormFetch(s,a);if(!n.appMsgId){const i=n.base_resp;throw new Error("微信公众号文章删除失败，错误内容："+(i&&i.errmsg?i.errmsg:i.ret))}return this.logger.debug("delete wechat article res=>",n),t=!0,t}async getPreviewUrl(o){const t=this.cfg.metadata.token;return`https://mp.weixin.qq.com/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=77&appmsgid=${o}&token=${t}&lang=zh_CN`}async uploadFile(o){const t=new Blob([o.bits],{type:o.type}),s=o.name;if(this.logger.debug(`wechat start uploadFile ${s}=>`,t),t instanceof Blob){const e=this.cfg.metadata.commonData.data.user_name,a=this.cfg.metadata.commonData.data.ticket,n=this.cfg.metadata.commonData.data.time,i=this.cfg.metadata.commonData.data.t,l=new Date().getTime(),u=`https://mp.weixin.qq.com/cgi-bin/filetransfer?action=upload_material&f=json&scene=8&writetype=doublewrite&groupid=1&ticket_id=${e}&ticket=${a}&svr_time=${n}&token=${i}&lang=zh_CN&seq=${l}&t=`+Math.random(),r=await Gs(t),h=new Blob([r],{type:t.type}),y=new FormData;y.append("type",t.type),y.append("id",new Date().getTime()),y.append("name",s),y.append("lastModifiedDate",new Date().toString()),y.append("size",t.size),y.append("file",h,s);const p=await this.wechatFormFetch(u,y);if(p.base_resp.err_msg!="ok")throw this.logger.error(`微信公众号图片上传失败, ${s} =>`,p.base_resp.err_msg),new Error("upload failed =>"+p.base_resp.err_msg);const g=p.cdn_url;return{id:p.content,object_key:p.content,url:g}}return{}}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.html;this.logger.info("准备处理微信公众号正文"),this.logger.debug("html =>",{html:i});let l=i;return n.html=l,this.logger.info("微信公众号正文处理完毕"),this.logger.debug("updatedHtml =>",{updatedHtml:l}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}async weChatFetch(o,t,s="GET",e={},a="application/json"){const n=new Map;n.set("Cookie",this.cfg.password);const i={...Object.fromEntries(n),...e},l=t,u=o;this.logger.debug("向微信公众号请求数据，apiUrl =>",u),this.logger.debug("向微信公众号请求数据，headers =>",e),this.logger.debug("向微信公众号请求数据，body =>",l);const r=await this.webFetch(u,[i],l,s,a,!0,"base64","text");return this.logger.debug("向微信公众号请求数据，resJson =>",r),r??null}async wechatFormFetch(o,t){const s={Cookie:this.cfg.password,Referer:"https://mp.weixin.qq.com/cgi-bin/appmsg"};return await this.webFormFetch(o,[s],t,!0)}}var Bo={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const ln=async(c,o)=>{const t=W("use-wechat-web");t.info("Start using Wechat WebAuth...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Bo.VITE_MIDDLEWARE_URL,Pe),r=U.emptyOrDefault(Bo.VITE_WECHAT_AUTH_TOKEN,"");e=new Ic("",r,u),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=U.emptyOrDefault(Bo.VITE_MIDDLEWARE_URL,Pe);T.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!1,e.bundledPicbedSupported=!0;const a=new xc(s,e);return{cfg:e,webApi:a}};class Mc extends Bs{constructor(t,s,e){super("https://www.jianshu.com","https://www.jianshu.com",t,s,e);D(this,"logoutUrl");this.logoutUrl="https://www.jianshu.com/shakespeare/sign_out",this.previewUrl="/p/[postid]",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Cookie,this.usernameEnabled=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="笔记本",this.knowledgeSpaceType=ee.CategoryType_Single,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于简书平台的限制，暂时不支持编辑所属笔记本。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的笔记本发布"}}class Dc extends rs{async getMetaData(){const o=await this.jianshuFetch("https://www.jianshu.com/settings/basic.json"),t=o.data.avatar,s=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf(".")),e=!!s;return this.logger.info(`get jianshu metadata finished, flag => ${e}`),{flag:e,uid:s,title:o.data.nickname,avatar:t,type:"jianshu",displayName:"简书",supportTypes:["html"],home:"https://www.jianshu.com/settings/basic",icon:"https://www.jianshu.com/favicon.ico"}}async getUsersBlogs(){const o=[],t={accept:"application/json"},s=await this.jianshuFetch("https://www.jianshu.com/author/notebooks",void 0,"GET",t);return this.logger.info("get jianshu notebooks",s),s&&s.length>0&&s.forEach(e=>{const a=new lt;a.blogid=e.id,a.blogName=e.name,o.push(a)}),this.logger.debug("getUsersBlogs=>",o),o}async getCategories(){const o=[],t={accept:"application/json"},s=await this.jianshuFetch("https://www.jianshu.com/author/notebooks",void 0,"GET",t);return this.logger.info("get jianshu notebooks",s),s&&s.length>0&&s.forEach(e=>{const a=new it;a.categoryId=e.id,a.categoryName=e.name,o.push(a)}),o}async addPost(o){var u,r;this.logger.debug("start add post =>",{post:o});const t=((r=(u=o.cate_slugs)==null?void 0:u[0])==null?void 0:r.toString())??this.cfg.blogid.toString(),s={accept:"application/json"},e=JSON.stringify({notebook_id:t,title:o.title,at_bottom:!1}),a=await this.jianshuFetch("https://www.jianshu.com/author/notes",e,"POST",s);this.logger.debug("jianshu addPost initRes =>",a);const n=a.id,i=a.slug;return await this.updateJianshuArticle(n,o.title,o.description,1),this.logger.info(`文章发布成功，开始组装简书的ID组合,pageId=${n},notebookId=${t},endUrl=${i}`),{status:"success",post_id:[n,t,i].join("_")}}async getPreviewUrl(o){const t=this.cfg.previewUrl??"",e=this.getJianshuPostidKey(o).endUrl;return t.replace("[postid]",e)}async deletePost(o){const s=this.getJianshuPostidKey(o).pageId,e={accept:"application/json"},a=await this.jianshuFetch(`https://www.jianshu.com/author/notes/${s}/soft_destroy`,JSON.stringify({}),"POST",e);return this.logger.debug("jianshu delete post res =>",a),!0}async editPost(o,t,s){let e=!1;try{const n=this.getJianshuPostidKey(o).pageId,i={accept:"application/json"},l=await this.jianshuFetch(`https://www.jianshu.com/author/notes/${n}/note_logs`,void 0,"GET",i);this.logger.debug("jianshu get post version res =>",l);const u=l.length+1;this.logger.debug("jianshu update post with new version =>",u),await this.updateJianshuArticle(n,t.title,t.description,u),e=!0}catch(a){this.logger.error("简书文章更新失败",a)}return e}async uploadFile(o){const t=new Blob([o.bits],{type:o.type}),s=o.name;if(this.logger.debug(`jianshu start uploadFile ${s}=>`,t),t instanceof Blob){const e="https://upload.qiniup.com/",a=await Gs(t),n=new Blob([a],{type:t.type}),i=await this.jianshuFetch("https://www.jianshu.com/upload_images/token.json?filename="+s);this.logger.debug("jianshu get picture token res =>",i);const l=new FormData;l.append("token",i.token),l.append("key",i.key),l.append("x:protocol","https"),l.append("file",n,s);const u=await this.jianshuFormFetch(e,l);if(this.logger.debug("jianshu upload success, resJson =>",u),!u.url)throw new Error("简书图片上传失败 =>"+s);const r=u.url;return{id:i.key,object_key:i.key,url:r}}return{}}getJianshuPostidKey(o){let t,s,e;if(o.indexOf("_")>0){const a=o.split("_");t=a[0],s=a[1],e=a[2]}else t=o;return{pageId:t,notebookId:s,endUrl:e}}async updateJianshuArticle(o,t,s,e=1){const a={accept:"application/json"},n=JSON.stringify({id:o,autosave_control:e,title:t,content:s}),i=await this.jianshuFetch(`https://www.jianshu.com/author/notes/${o}`,n,"PUT",a);this.logger.debug("jianshu savePost saveRes =>",i);try{const l={accept:"application/json"},u=JSON.stringify({}),r=await this.jianshuFetch(`https://www.jianshu.com/author/notes/${o}/publicize`,u,"POST",l);this.logger.debug("jianshu publishPost pubRes =>",r)}catch(l){Q.warning("简书文章发布失败，内容已存入草稿 =>"+l),this.logger.error("简书文章发布失败",l)}}async jianshuFetch(o,t,s="GET",e={},a="application/json"){const n=new Map;n.set("Cookie",this.cfg.password);const i={...Object.fromEntries(n),...e},l=t,u=o;this.logger.debug("向简书网站请求数据，apiUrl =>",u),this.logger.debug("向简书网站请求数据，headers =>",e),this.logger.debug("向简书网站请求数据，body =>",l);const r=await this.webFetch(u,[i],l,s,a,!0,"base64");return this.logger.debug("向简书网站请求数据，resJson =>",r),r??null}async jianshuFormFetch(o,t){const s={};return await this.webFormFetch(o,[s],t,!0)}}var jo={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const rn=async(c,o)=>{const t=W("use-jianshu-web");t.info("Start using Jianshu WebAuth...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(jo.VITE_MIDDLEWARE_URL,Pe),r=U.emptyOrDefault(jo.VITE_JIANSHU_AUTH_TOKEN,"");e=new Mc("",r,u),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=U.emptyOrDefault(jo.VITE_MIDDLEWARE_URL,Pe);T.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="笔记本",e.knowledgeSpaceType=ee.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于简书平台的限制，暂时不支持编辑所属笔记本。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的笔记本发布",e.logoutUrl="https://www.jianshu.com/shakespeare/sign_out",e.picgoPicbedSupported=!1,e.bundledPicbedSupported=!0;const a=new Dc(s,e);return{cfg:e,webApi:a}};class Oc extends Bs{constructor(t,s,e){super("https://juejin.cn","https://api.juejin.cn",t,s,e);D(this,"logoutUrl");this.logoutUrl="https://juejin.cn/passport/web/logout",this.previewUrl="/post/[postid]",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Cookie,this.usernameEnabled=!1,this.tagEnabled=!1,this.tagSlugEnabled=!0,this.cateEnabled=!1,this.categoryType=ee.CategoryType_Single,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="分类",this.knowledgeSpaceType=ee.CategoryType_Single,this.allowKnowledgeSpaceChange=!0}}class Vc extends rs{async getMetaData(){var s;const o=await this.juejinFetch("https://api.juejin.cn/user_api/v1/user/get",void 0,"GET"),t=!!((s=o.data)!=null&&s.user_id);if(!t)throw new Error(`掘金平台校验失败，详细错误：code: ${o==null?void 0:o.err_no}，msg: ${o==null?void 0:o.err_msg}`);return this.logger.info(`get juejin metadata finished, flag => ${t}`),{flag:t,uid:o.data.user_id,title:o.data.user_name,avatar:o.data.avatar_large,type:"juejin",displayName:"掘金",raw:o.data,supportTypes:["markdown","html"],home:"https://juejin.cn/editor/drafts",icon:"https://juejin.cn/favicon.ico"}}async getUsersBlogs(){let o=[];const t={accept:"application/json"},s=await this.juejinFetch("https://api.juejin.cn/tag_api/v1/query_category_list",void 0,"POST",t);return this.logger.info("get juejin categories",s.data),s.data&&s.data.length>0&&s.data.forEach(a=>{const n=new lt;n.blogid=a.category_id,n.blogName=a.category.category_name,n.url=a.category.icon,o.push(n)}),this.logger.debug("getUsersBlogs=>",o),o}async addPost(o){var h;let t=((h=o.cate_slugs)==null?void 0:h[0])??this.cfg.blogid;T.isEmptyString(t)&&(t="6809637769959178254",this.logger.error("掘金平台未选择分类，将使用默认分类：后端"));let s=o.tags_slugs??"";T.isEmptyString(s)&&(s="6809640482725954000",this.logger.error("掘金平台未选择标签，将使用默认标签：程序员"));const e="由于掘金平台的摘要有强制字数要求，这里需要给一下默认文字作为摘要。这里是掘金平台的默认摘要，您可以稍后自行修改。";if((T.isEmptyString(o.shortDesc)||o.shortDesc.length<e.length)&&(o.shortDesc=e,this.logger.error("掘金平台未设置摘要或者摘要字数，将使用默认摘要")),o.shortDesc.length<50){for(;o.shortDesc.length<50;)o.shortDesc+=o.shortDesc;o.shortDesc=o.shortDesc.slice(0,100)}else o.shortDesc.length>100&&(o.shortDesc=o.shortDesc.slice(0,100));const a="https://api.juejin.cn/content_api/v1/article_draft/create",n=JSON.stringify({category_id:t,tag_ids:s.split(","),link_url:"",cover_image:"",title:o.title,brief_content:o.shortDesc,edit_type:10,html_content:"deprecated",mark_content:o.description,theme_ids:[]}),i=await this.juejinFetch(a,n,"POST",{});if(this.logger.debug("juejin add post =>",i),i.err_no!==0)throw new Error("掘金文章草稿保存错误 =>"+i.err_msg);const l=i.data.id.toString();return{status:"success",post_id:[await this.publishPost(l),l].join("_")}}async editPost(o,t,s){var h;const e=((h=t.cate_slugs)==null?void 0:h[0])??this.cfg.blogid;if(T.isEmptyString(e))throw new Error("掘金平台必须选择一个分类");const a=t.tags_slugs??"";if(T.isEmptyString(a))throw new Error("掘金平台必须选择一个标签");const i=this.getJuejinPostidKey(o).draftId,l="https://api.juejin.cn/content_api/v1/article_draft/update",u=JSON.stringify({id:i,category_id:e,tag_ids:a.split(","),link_url:"",cover_image:"",title:t.title,brief_content:t.shortDesc,edit_type:10,html_content:"deprecated",mark_content:t.markdown,theme_ids:[]}),r=await this.juejinFetch(l,u,"POST",{});if(this.logger.debug("juejin update post =>",r),r.err_no!==0)throw new Error("掘金文章更新错误 =>"+r.err_msg);return await this.publishPost(i),!0}async getPreviewUrl(o){const s=this.getJuejinPostidKey(o).pageId;return this.cfg.previewUrl.replace("[postid]",s)}async deletePost(o){const t="https://api.juejin.cn/content_api/v1/article/delete",e=this.getJuejinPostidKey(o).pageId,a=JSON.stringify({article_id:e}),n=await this.juejinFetch(t,a,"POST",{});if(this.logger.debug("juejin delete post res =>",n),n.err_no!==0)throw new Error("掘金文章删除失败 =>"+n.err_msg);return!0}async getPost(o,t){const e=this.getJuejinPostidKey(o).pageId,a="https://api.juejin.cn/content_api/v1/article/detail",n=JSON.stringify({article_id:e}),i=await this.juejinFetch(a,n,"POST",{});if(this.logger.debug("juejin get post res =>",i),i.err_no!==0)throw new Error("掘金文章获取失败 =>"+i.err_msg);const l=new ot,u=i.data.tags??[],r=[];u.forEach(p=>{r.push(p.tag_id)}),l.tags_slugs=r.join(",");const h=i.data.category.category_id,y=[];return y.push(h),l.cate_slugs=y,l}async getCategories(){const o=[],t={accept:"application/json"},s=await this.juejinFetch("https://api.juejin.cn/tag_api/v1/query_category_list",void 0,"POST",t);return this.logger.info("get juejin categories",s.data),s.data&&s.data.length>0&&s.data.forEach(e=>{const a=new it;a.categoryId=e.category_id,a.categoryName=e.category.category_name,o.push(a)}),o}async getTags(){const o=[],t={accept:"application/json"},s=JSON.stringify({cursor:"0",key_word:"",limit:10,sort_type:1}),e=await this.juejinFetch("https://api.juejin.cn/tag_api/v1/query_tag_list",s,"POST",t);return this.logger.info("get juejin categories",e.data),e.data&&e.data.length>0&&e.data.forEach(a=>{const n=new Zn;n.tagId=a.tag_id,n.tagName=a.tag.tag_name,o.push(n)}),o}getJuejinPostidKey(o){let t,s;if(o.indexOf("_")>0){const e=o.split("_");t=e[0],s=e[1]}else t=o;return{pageId:t,draftId:s}}async publishPost(o){const t="https://api.juejin.cn/content_api/v1/article/publish",s=JSON.stringify({draft_id:o,sync_to_org:!1,column_ids:[],theme_ids:[]}),e=await this.juejinFetch(t,s,"POST",{});if(this.logger.debug("juejin publish post res =>",e),e.err_no!==0)throw new Error("掘金文章发布失败 =>"+((e==null?void 0:e.err_msg)??e));return e.data.article_id.toString()}async juejinFetch(o,t,s="GET",e={},a="application/json"){const n=new Map;n.set("Cookie",this.cfg.password);const i={...Object.fromEntries(n),...e},l=t,u=o;this.logger.debug("向掘金请求数据，apiUrl =>",u),this.logger.debug("向掘金请求数据，headers =>",e),this.logger.debug("向掘金请求数据，body =>",l);const r=await this.webFetch(u,[i],l,s,a,!0,"base64");return this.logger.debug("向掘金请求数据，resJson =>",r),r??null}}var Ko={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const cn=async(c,o)=>{const t=W("use-juejin-web");t.info("Start using Juejin WebAuth...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Ko.VITE_MIDDLEWARE_URL,Pe),r=U.emptyOrDefault(Ko.VITE_JUEJIN_AUTH_TOKEN,"");e=new Oc("",r,u),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=U.emptyOrDefault(Ko.VITE_MIDDLEWARE_URL,Pe);T.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!1,e.tagSlugEnabled=!0,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="分类",e.knowledgeSpaceType=ee.CategoryType_Single,e.allowKnowledgeSpaceChange=!0,e.logoutUrl="https://juejin.cn/passport/web/logout",e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!1;const a=new Vc(s,e);return{cfg:e,webApi:a}};class Ti extends es{constructor(o,t,s,e,a){super(o,t,s,e,a),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="content/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Hugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Vn extends is{constructor(){super(...arguments);D(this,"logger",W("hugo-yaml-converter-adaptor"))}convertToYaml(t,s,e){var u;this.logger.debug("您正在使用 Hugo Yaml Converter",{post:le(t)}),s||(s=new gt),s.yamlObj.title=t.title,s.yamlObj.slug=t.wp_slug,e.yamlLinkEnabled&&(s.yamlObj.url="/post/"+t.wp_slug+".html");let a="+00:00";const n=new Date().getTimezoneOffset()/-60,i=n>0?"+":"-";if(n.toString().length<2?a=`${i}0${n}:00`:a=`${i}${n}:00`,s.yamlObj.date=Me.formatIsoToZh(t.dateCreated.toISOString(),!0)+a,t.dateUpdated||(t.dateUpdated=new Date),s.yamlObj.lastmod=Me.formatIsoToZh(t.dateUpdated.toISOString(),!0)+a,s.yamlObj.toc=!0,!T.isEmptyString(t.mt_keywords)){const r=t.mt_keywords.split(",");s.yamlObj.tags=r}((u=t.categories)==null?void 0:u.length)>0&&(s.yamlObj.categories=t.categories),T.isEmptyString(t.mt_keywords)||(s.yamlObj.keywords=t.mt_keywords),T.isEmptyString(t.shortDesc)||(s.yamlObj.description=t.shortDesc),s.yamlObj.isCJKLanguage=!0;let l=ne.obj2Yaml(s.yamlObj);return this.logger.debug("yaml=>",l),s.formatter=l,s.mdContent=t.markdown,s.mdFullContent=ne.addYamlToMd(s.formatter,s.mdContent),s.htmlContent=t.html,this.logger.info("生成默认的YAML"),s}convertToAttr(t,s,e){var a,n,i,l,u,r,h,y,p,g;return this.logger.debug("开始转换YAML到Post",s),(a=s.yamlObj)!=null&&a.title&&(t.title=(n=s.yamlObj)==null?void 0:n.title),(i=s.yamlObj)!=null&&i.date&&(t.dateCreated=Me.convertStringToDate((l=s.yamlObj)==null?void 0:l.date)),(u=s.yamlObj)!=null&&u.lastmod&&(t.dateUpdated=Me.convertStringToDate((r=s.yamlObj)==null?void 0:r.lastmod)),t.shortDesc=(h=s.yamlObj)==null?void 0:h.description,t.mt_keywords=(p=(y=s.yamlObj)==null?void 0:y.tags)==null?void 0:p.join(","),t.categories=(g=s.yamlObj)==null?void 0:g.categories,t.yaml=ne.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class $c extends us{getYamlAdaptor(){return new Vn}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Hugo 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Hugo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var ws={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const lo=async(c,o)=>{const t=W("use-hugo-api");t.info("Start using Hexo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(ws.VITE_GITHUB_USERNAME,""),r=U.emptyOrDefault(ws.VITE_GITHUB_AUTH_TOKEN,""),h=U.emptyOrDefault(ws.VITE_GITHUB_REPO,""),y=U.emptyOrDefault(ws.VITE_GITHUB_BRANCH,"main"),p=U.emptyOrDefault(ws.VITE_MIDDLEWARE_URL,Pe);e=new Ti(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Hugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Vn,n=new $c(s,e);return t.info("Hugo API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Nc extends Ti{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="content/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Githubhugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class ki extends Vn{}class Lc extends ds{getYamlAdaptor(){return new ki}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Gitlabhugo 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Gitlabhugo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var vs={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const ro=async(c,o)=>{const t=W("use-gitlab-hugo-api");t.info("Start using Gitlabhugo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(vs.VITE_GITLAB_USERNAME,""),r=U.emptyOrDefault(vs.VITE_GITLAB_AUTH_TOKEN,""),h=U.emptyOrDefault(vs.VITE_GITLAB_REPO,""),y=U.emptyOrDefault(vs.VITE_GITLAB_BRANCH,"main"),p=U.emptyOrDefault(vs.VITE_MIDDLEWARE_URL,Pe);e=new Nc(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabhugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new ki,n=new Lc(s,e);return t.info("Gitlbhugo API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Si extends es{constructor(o,t,s,e,a){super(o,t,s,e,a),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Jekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class $n extends is{constructor(){super(...arguments);D(this,"logger",W("hexo-yaml-converter-adaptor"))}convertToYaml(t,s,e){var l;this.logger.debug("您正在使用 Jekyll Yaml Converter",{post:le(t)}),s||(s=new gt),s.yamlObj.layout="post",s.yamlObj.title=t.title,s.yamlObj.date=Me.formatIsoToZh(t.dateCreated.toISOString(),!0);let a="/post/"+t.wp_slug+".html";const n=e;if(n.yamlLinkEnabled&&!T.isEmptyString(n.previewPostUrl)&&(a=n.previewPostUrl.replace("[postid]",t.wp_slug)),this.logger.debug("link=>",a),s.yamlObj.permalink=a,T.isEmptyString(t.shortDesc)||(s.yamlObj.tagline=t.shortDesc),!T.isEmptyString(t.mt_keywords)){const u=t.mt_keywords.split(",");s.yamlObj.tags=u}((l=t.categories)==null?void 0:l.length)>0&&(s.yamlObj.categories=t.categories),s.yamlObj.published=!0;let i=ne.obj2Yaml(s.yamlObj);return this.logger.debug("yaml=>",i),s.formatter=i,s.mdContent=t.markdown,s.mdFullContent=ne.addYamlToMd(s.formatter,s.mdContent),s.htmlContent=t.html,this.logger.info("生成默认的YAML"),s}convertToAttr(t,s,e){var a,n,i,l,u,r,h,y;return this.logger.debug("开始转换YAML到Post",s),(a=s.yamlObj)!=null&&a.title&&(t.title=(n=s.yamlObj)==null?void 0:n.title),(i=s.yamlObj)!=null&&i.date&&(t.dateCreated=Me.convertStringToDate((l=s.yamlObj)==null?void 0:l.date)),t.shortDesc=(u=s.yamlObj)==null?void 0:u.tagline,t.mt_keywords=(h=(r=s.yamlObj)==null?void 0:r.tags)==null?void 0:h.join(","),t.categories=(y=s.yamlObj)==null?void 0:y.categories,t.yaml=ne.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Hc extends us{getYamlAdaptor(){return new $n}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Jekyll 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Jekyll 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var Ps={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const co=async(c,o)=>{const t=W("use-jekyll-api");t.info("Start using Hexo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Ps.VITE_GITHUB_USERNAME,""),r=U.emptyOrDefault(Ps.VITE_GITHUB_AUTH_TOKEN,""),h=U.emptyOrDefault(Ps.VITE_GITHUB_REPO,""),y=U.emptyOrDefault(Ps.VITE_GITHUB_BRANCH,"main"),p=U.emptyOrDefault(Ps.VITE_MIDDLEWARE_URL,Pe);e=new Si(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Jekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new $n,n=new Hc(s,e);return t.info("Jekyll API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Rc extends Si{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabjekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Ei extends $n{}class Gc extends ds{getYamlAdaptor(){return new Ei}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Gitlabjekyll 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Gitlabjekyll 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var Ts={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const po=async(c,o)=>{const t=W("use-gitlab-hugo-api");t.info("Start using Gitlabhugo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Ts.VITE_GITLAB_USERNAME,""),r=U.emptyOrDefault(Ts.VITE_GITLAB_AUTH_TOKEN,""),h=U.emptyOrDefault(Ts.VITE_GITLAB_REPO,""),y=U.emptyOrDefault(Ts.VITE_GITLAB_BRANCH,"main"),p=U.emptyOrDefault(Ts.VITE_MIDDLEWARE_URL,Pe);e=new Rc(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabjekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Ei,n=new Gc(s,e);return t.info("Gitlabjekyll API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Ci extends es{constructor(o,t,s,e,a){super(o,t,s,e,a),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[filename].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Nn extends is{constructor(){super(...arguments);D(this,"logger",W("vuepress-yaml-converter-adaptor"))}convertToYaml(t,s,e){var l,u;if(this.logger.debug("您正在使用 Vuepress Yaml Converter",{post:le(t)}),s||(s=new gt),s.yamlObj.title=t.title,s.yamlObj.date=Me.formatIsoToZh(t.dateCreated.toISOString(),!0),s.yamlObj.meta=[],T.isEmptyString(t.mt_keywords)||s.yamlObj.meta.push({name:"keywords",content:t.mt_keywords.split(",").join(" ")||""}),T.isEmptyString(t.shortDesc)||s.yamlObj.meta.push({name:"description",content:t.shortDesc}),!T.isEmptyString(t.mt_keywords)){const r=t.mt_keywords.split(",");s.yamlObj.tags=r}if(((l=t.categories)==null?void 0:l.length)>0&&(s.yamlObj.categories=t.categories),e.yamlLinkEnabled){let r="/post/"+t.wp_slug+".html";s.yamlObj.permalink=r}const a=e;let n=a.site;T.isEmptyString(a.site)&&(n=T.pathJoin(a.home,"/"+a.username)),s.yamlObj.author={name:a.author??"terwer",link:n},(u=t==null?void 0:t.title)!=null&&u.includes("[日记]")&&(s.yamlObj.article=!1);let i=ne.obj2Yaml(s.yamlObj);return this.logger.debug("yaml=>",i),s.formatter=i,s.mdContent=t.markdown,s.mdFullContent=ne.addYamlToMd(s.formatter,s.mdContent),s.htmlContent=t.html,this.logger.info("生成默认的YAML"),s}convertToAttr(t,s,e){var n,i,l,u,r,h,y;this.logger.debug("开始转换YAML到Post",s),(n=s.yamlObj)!=null&&n.title&&(t.title=(i=s.yamlObj)==null?void 0:i.title),(l=s.yamlObj)!=null&&l.date&&(t.dateCreated=Me.convertStringToDate((u=s.yamlObj)==null?void 0:u.date));const a=s.yamlObj.meta;for(let p=0;p<a.length;p++){const g=a[p];if(g.name==="description"&&!T.isEmptyString(g.content)){t.shortDesc=g.content;break}}return t.mt_keywords=(h=(r=s.yamlObj)==null?void 0:r.tags)==null?void 0:h.join(","),t.categories=(y=s.yamlObj)==null?void 0:y.categories,t.yaml=ne.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Bc extends us{getYamlAdaptor(){return new Nn}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Vuepress 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);const r=n.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(u)||(u=`${r}

<!-- more -->

${u}`),n.markdown=`${l}
${u}`,this.logger.info("Vuepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var ks={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const uo=async(c,o)=>{const t=W("use-vuepress-api");t.info("Start using Vuepress API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(ks.VITE_GITHUB_USERNAME,""),r=U.emptyOrDefault(ks.VITE_GITHUB_AUTH_TOKEN,""),h=U.emptyOrDefault(ks.VITE_GITHUB_REPO,""),y=U.emptyOrDefault(ks.VITE_GITHUB_BRANCH,"main"),p=U.emptyOrDefault(ks.VITE_MIDDLEWARE_URL,Pe);e=new Ci(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[filename].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Nn,n=new Bc(s,e);return t.info("Vuepress API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class jc extends Ci{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[filename].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Ai extends Nn{}class Kc extends ds{getYamlAdaptor(){return new Ai}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Gitlabvuepress 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);const r=n.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(u)||(u=`${r}

<!-- more -->

${u}`),n.markdown=`${l}
${u}`,this.logger.info("Gitlabvuepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var Ss={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const go=async(c,o)=>{const t=W("use-gitlab-hexo-api");t.info("Start using Gitlabvuepress API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Ss.VITE_GITLAB_USERNAME,""),r=U.emptyOrDefault(Ss.VITE_GITLAB_AUTH_TOKEN,""),h=U.emptyOrDefault(Ss.VITE_GITLAB_REPO,""),y=U.emptyOrDefault(Ss.VITE_GITLAB_BRANCH,"main"),p=U.emptyOrDefault(Ss.VITE_MIDDLEWARE_URL,Pe);e=new jc(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[filename].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Ai,n=new Kc(s,e);return t.info("Gitlabvuepress API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Ui extends es{constructor(o,t,s,e,a){super(o,t,s,e,a),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="src/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Ln extends is{constructor(){super(...arguments);D(this,"logger",W("vuepress2-yaml-converter-adaptor"))}convertToYaml(t,s,e){var n;if(this.logger.debug("您正在使用 Vuepress2 Yaml Converter",{post:le(t)}),s||(s=new gt),s.yamlObj.title=t.title,s.yamlObj.short_title="",s.yamlObj.date=t.dateCreated,T.isEmptyString(t.shortDesc)||(s.yamlObj.description=t.shortDesc),!T.isEmptyString(t.mt_keywords)){const i=t.mt_keywords.split(",");s.yamlObj.tag=i}((n=t.categories)==null?void 0:n.length)>0&&(s.yamlObj.category=t.categories),s.yamlObj.article=!0,s.yamlObj.timeline=!1,s.yamlObj.isOriginal=!0;const a=ne.obj2Yaml(s.yamlObj);return s.formatter=this.removeTZ(a),s.mdContent=t.markdown,s.mdFullContent=ne.addYamlToMd(s.formatter,s.mdContent),s.htmlContent=t.html,this.logger.info("生成默认的YAML"),s}convertToAttr(t,s,e){var n,i,l,u,r,h,y,p;this.logger.debug("开始转换YAML到Post",s),(n=s.yamlObj)!=null&&n.title&&(t.title=(i=s.yamlObj)==null?void 0:i.title),(l=s.yamlObj)!=null&&l.date&&(t.dateCreated=(u=s.yamlObj)==null?void 0:u.date),t.shortDesc=(r=s.yamlObj)==null?void 0:r.description,t.mt_keywords=(y=(h=s.yamlObj)==null?void 0:h.tag)==null?void 0:y.join(","),t.categories=(p=s.yamlObj)==null?void 0:p.category;const a=ne.obj2Yaml(s.yamlObj);return t.yaml=this.removeTZ(a),this.logger.debug("转换完成，post =>",t),t}removeTZ(t){return t.replace(/---([\s\S]*?)---/g,function(s,e){return s.replace(/T/g," ").replace(/\.\d{3}Z/g,"")})}}class zc extends us{getYamlAdaptor(){return new Ln}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Vuepress2 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);const r=n.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(u)||(u=`${r}

<!-- more -->

${u}`),n.markdown=`${l}
${u}`,this.logger.info("Vuepress2 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var Es={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const mo=async(c,o)=>{const t=W("use-vuepress2-api");t.info("Start using Vuepress2 API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Es.VITE_GITHUB_USERNAME,""),r=U.emptyOrDefault(Es.VITE_GITHUB_AUTH_TOKEN,""),h=U.emptyOrDefault(Es.VITE_GITHUB_REPO,""),y=U.emptyOrDefault(Es.VITE_GITHUB_BRANCH,"main"),p=U.emptyOrDefault(Es.VITE_MIDDLEWARE_URL,Pe);e=new Ui(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Ln,n=new zc(s,e);return t.info("Vuepress2 API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Ii extends es{constructor(o,t,s,e,a){super(o,t,s,e,a),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Vitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Hn extends is{constructor(){super(...arguments);D(this,"logger",W("vitepress-yaml-converter-adaptor"))}convertToYaml(t,s,e){var n;this.logger.debug("您正在使用 Vitepress Yaml Converter",{post:le(t)}),s||(s=new gt),s.yamlObj.title=t.title,T.isEmptyString(t.shortDesc)||(s.yamlObj.description=t.shortDesc),s.yamlObj.date=Me.formatIsoToZh(t.dateCreated.toISOString(),!0),s.yamlObj.head=[],T.isEmptyString(t.mt_keywords)||s.yamlObj.head.push({name:"keywords",content:t.mt_keywords.split(",").join(" ")}),T.isEmptyString(t.shortDesc)||s.yamlObj.head.push({name:"description",content:t.shortDesc}),((n=t.categories)==null?void 0:n.length)>0&&(s.yamlObj.categories=t.categories),s.yamlObj.outline="deep",s.yamlObj.sidebar=!1,s.yamlObj.prev=!1,s.yamlObj.next=!1;let a=ne.obj2Yaml(s.yamlObj);return this.logger.debug("yaml=>",a),s.formatter=a,s.mdContent=t.markdown,s.mdFullContent=ne.addYamlToMd(s.formatter,s.mdContent),s.htmlContent=t.html,this.logger.info("生成默认的YAML"),s}convertToAttr(t,s,e){var n,i,l,u,r,h,y,p;this.logger.debug("开始转换YAML到Post",s),(n=s.yamlObj)!=null&&n.title&&(t.title=(i=s.yamlObj)==null?void 0:i.title),(l=s.yamlObj)!=null&&l.date&&(t.dateCreated=Me.convertStringToDate((u=s.yamlObj)==null?void 0:u.date)),(r=s.yamlObj)!=null&&r.description&&(t.shortDesc=s.yamlObj.description);const a=(h=s.yamlObj)==null?void 0:h.head;if(a&&a.length==4)for(let g=0;g<a.length;g++){const _=a[g];if((_==null?void 0:_.name)==="keywords"&&!T.isEmptyString(_.content)){t.mt_keywords=(y=_.content)==null?void 0:y.split(" ");break}}return t.categories=(p=s.yamlObj)==null?void 0:p.categories,t.yaml=ne.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Wc extends us{getYamlAdaptor(){return new Hn}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Vitepress 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Vitepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var Cs={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const ho=async(c,o)=>{const t=W("use-vitepress-api");t.info("Start using Vitepress API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Cs.VITE_GITHUB_USERNAME,""),r=U.emptyOrDefault(Cs.VITE_GITHUB_AUTH_TOKEN,""),h=U.emptyOrDefault(Cs.VITE_GITHUB_REPO,""),y=U.emptyOrDefault(Cs.VITE_GITHUB_BRANCH,"main"),p=U.emptyOrDefault(Cs.VITE_MIDDLEWARE_URL,Pe);e=new Ii(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Vitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Hn,n=new Wc(s,e);return t.info("Vitepress API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Fc extends Ui{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="src/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class xi extends Ln{}class Jc extends ds{getYamlAdaptor(){return new xi}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Gitlabvuepress2 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);const r=n.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(u)||(u=`${r}

<!-- more -->

${u}`),n.markdown=`${l}
${u}`,this.logger.info("Gitlabvuepress2 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var As={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const fo=async(c,o)=>{const t=W("use-gitlab-hexo-api");t.info("Start using Gitlabvuepress2 API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(As.VITE_GITLAB_USERNAME,""),r=U.emptyOrDefault(As.VITE_GITLAB_AUTH_TOKEN,""),h=U.emptyOrDefault(As.VITE_GITLAB_REPO,""),y=U.emptyOrDefault(As.VITE_GITLAB_BRANCH,"main"),p=U.emptyOrDefault(As.VITE_MIDDLEWARE_URL,Pe);e=new Fc(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new xi,n=new Jc(s,e);return t.info("Gitlabvuepress2 API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class qc extends Ii{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ue.Markdown,this.passwordType=Oe.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=ee.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=ee.CategoryType_Tree_Single}}class Mi extends Hn{}class Yc extends ds{getYamlAdaptor(){return new Mi}async preEditPost(o,t,s){const e=await super.preEditPost(o,t,s),a=s==null?void 0:s.cfg,n=we.cloneDeep(e),i=n.markdown;this.logger.info("准备处理 Gitlabvitepress 正文"),this.logger.debug("md =>",{md:i});const l=ne.extractFrontmatter(i,!0);let u=ne.extractMarkdown(i);return n.markdown=`${l}
${u}`,this.logger.info("Gitlabvitepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:u}),(a==null?void 0:a.pageType)==ue.Markdown?n.description=n.markdown:n.description=n.html,n}}var Us={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const yo=async(c,o)=>{const t=W("use-gitlab-vitepress-api");t.info("Start using Gitlabvitepress API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:i}=me(),l=await i();if(e=se.safeParse(l[c],{}),ae.isEmptyObject(e)){const u=U.emptyOrDefault(Us.VITE_GITLAB_USERNAME,""),r=U.emptyOrDefault(Us.VITE_GITLAB_AUTH_TOKEN,""),h=U.emptyOrDefault(Us.VITE_GITLAB_REPO,""),y=U.emptyOrDefault(Us.VITE_GITLAB_BRANCH,"main"),p=U.emptyOrDefault(Us.VITE_MIDDLEWARE_URL,Pe);e=new qc(u,r,h,y,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.mdFilenameRule="[slug].md",e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=ee.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=ee.CategoryType_Tree_Single,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Mi,n=new Yc(s,e);return t.info("Gitlabvitepress API created successfully.",e),{cfg:e,yamlAdaptor:a,blogApi:n}};class Xc extends ls{constructor(o,t,s){super("","",o,t,s),this.home="[your-halo-home]",this.apiUrl="[your-halo-api-url]",this.previewUrl="/archives/{slug}",this.pageType=ue.Html,this.usernameEnabled=!0,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class Zc{constructor(o,t,s){D(this,"slug");D(this,"name");D(this,"year");D(this,"month");D(this,"day");this.slug=o,this.name=t;const n=Me.formatIsoToZhDate(s.toISOString(),!0).split(" ")[0].split("-");this.year=n[0],this.month=n[1],this.day=n[2]}}class Qc extends Gt{constructor(o,t){super(o,t),this.logger=W("halo-api-adaptor")}async getUsersBlogs(){const o=[];return(await this.getHaloCategories()).forEach(s=>{const e=new lt;e.blogid=s.spec.slug,e.blogName=s.spec.displayName,e.url=s.status.permalink,o.push(e)}),this.logger.debug("get halo categories =>",o),o}async newPost(o,t){var n;const s={post:{spec:{title:"",slug:"",template:"",cover:"",deleted:!1,publish:!1,publishTime:void 0,pinned:!1,allowComment:!0,visible:"PUBLIC",priority:0,excerpt:{autoGenerate:!0,raw:""},categories:[],tags:[],htmlMetas:[]},apiVersion:"content.halo.run/v1alpha1",kind:"Post",metadata:{name:"",annotations:{}}},content:{raw:"",content:"",rawType:"HTML"}};s.content.raw=o.html,s.content.content=o.description,T.isEmptyString(o.shortDesc)?s.post.spec.excerpt.autoGenerate=!0:(s.post.spec.excerpt.autoGenerate=!1,s.post.spec.excerpt.raw=o.shortDesc),s.post.metadata.name=Uo.randomUuid(),s.post.spec.title=o.title,s.post.spec.slug=o.wp_slug;try{if(o.categories&&o.categories.length>0){const i=await this.getCategoryNames(o.categories);s.post.spec.categories=i}if(!T.isEmptyString(o.mt_keywords)){const i=o.mt_keywords.split(","),l=await this.getTagNames(i);s.post.spec.tags=l}}catch(i){throw i}s.post.spec.publishTime=o.dateCreated.toISOString();const e=await this.haloFetch("/apis/api.console.halo.run/v1alpha1/posts",s,"POST");if(this.logger.debug("halo newPost res =>",e),!((n=e==null?void 0:e.metadata)!=null&&n.name))throw new Error("Halo 文章发布失败");this.logger.debug("halo 文章草稿完成"),await this.haloFetch(`/apis/api.console.halo.run/v1alpha1/posts/${s.post.metadata.name}/publish`,{},"PUT"),this.logger.debug("halo 文章发布完成");const a=new Zc(e.spec.slug,e.metadata.name,o.dateCreated);return this.logger.debug("postidMeta =>",a),JSON.stringify(a)}async editPost(o,t,s){let e=!1;try{const n=this.getHaloPostidKey(o).name;let i=await this.getHaloPost(n);if(this.logger.debug("get latest halo post =>",{name:n,haloPost:i}),!i.post)throw new Error("获取文章信息失败，如果文章删除，请强制删除解除关联");if(i.content.raw=t.html,i.content.content=t.description,T.isEmptyString(t.shortDesc)?i.post.spec.excerpt.autoGenerate=!0:(i.post.spec.excerpt.autoGenerate=!1,i.post.spec.excerpt.raw=t.shortDesc),i.post.metadata.name=n,i.post.spec.title=t.title,i.post.spec.slug=t.wp_slug,t.categories&&t.categories.length>0){const l=await this.getCategoryNames(t.categories);i.post.spec.categories=l}if(!T.isEmptyString(t.mt_keywords)){const l=t.mt_keywords.split(","),u=await this.getTagNames(l);i.post.spec.tags=u}i.post.spec.publishTime=t.dateCreated.toISOString(),await this.haloFetch(`/apis/content.halo.run/v1alpha1/posts/${n}`,i.post,"PUT"),await this.haloFetch(`/apis/api.console.halo.run/v1alpha1/posts/${n}/content`,i.content,"PUT"),await this.haloFetch(`/apis/api.console.halo.run/v1alpha1/posts/${i.post.metadata.name}/publish`,{},"PUT"),this.logger.debug("halo 文章发布完成")}catch(a){this.logger.error("Halo文章更新失败",a)}return e}async getPost(o,t){const e=this.getHaloPostidKey(o).name,a=await this.getHaloPost(e);this.logger.debug("getPost haloPost =>",{name:e,haloPost:a});const n=new ot;return n.title=a.post.spec.title,n.wp_slug=a.post.spec.slug,n.shortDesc=a.post.spec.excerpt.raw,n.tags_slugs=a.post.spec.tags.join(","),n.cate_slugs=a.post.spec.categories,n}async getPreviewUrl(o){const t=this.getHaloPostidKey(o);return this.cfg.previewUrl.replace("{slug}",t.slug).replace("{name}",t.name).replace("{year}",t.year).replace("{month}",t.month).replace("{day}",t.day)}async deletePost(o){var a;const s=`/apis/api.console.halo.run/v1alpha1/posts/${this.getHaloPostidKey(o).name}/recycle`,e=await this.haloFetch(s,{},"PUT");if(this.logger.debug("halo deletePost res =>",e),!((a=e==null?void 0:e.metadata)!=null&&a.name))throw new Error("Halo 文章删除失败");return!0}async getCategories(){const o=[],t=await this.getHaloCategories();return t&&t.length>0&&(t.forEach(s=>{const e=new it;e.categoryId=s.spec.slug,e.categoryName=s.spec.displayName,e.description=s.spec.displayName,e.categoryDescription=s.spec.description,o.push(e)}),this.logger.debug("get halo categories =>",o)),o}async newMediaObject(o,t){var i,l,u;let s;try{const r=o.bits;this.logger.debug("newMediaObject on halo =>",o);const{FormData:h,Blob:y}=Mo.getFormData(this.appInstance),p=`${this.cfg.apiUrl}/apis/api.console.halo.run/v1alpha1/attachments/upload`,g=new y([r],{type:o.type}),_=new h;if(_.append("file",g,o.name),_.append("policyName","default-policy"),_.append("groupName",""),_.append("file",g,o.name),s=await this.haloFormFetch(p,_),this.logger.debug("halo upload success, res =>",s),!s.metadata)throw new Error("Halo图片上传失败 =>"+o.name)}catch(r){throw this.logger.error("Error uploading image to halo:",r),new Error("Error uploading image to halo:"+r.toString())}const e=(i=s==null?void 0:s.spec)==null?void 0:i.displayName,a=(l=s==null?void 0:s.metadata)==null?void 0:l.name,n=this.cfg.home+(((u=s==null?void 0:s.metadata)==null?void 0:u.annotations["storage.halo.run/uri"])??"");return{attachment_id:e,date_created_gmt:new Date,parent:0,link:n,title:o.name,caption:"",description:"",metadata:{width:0,height:0,file:"",filesize:0,sizes:[]},type:o.type,thumbnail:"",id:a,file:o.name,url:n}}getHaloPostidKey(o){return se.safeParse(o,{})}async getHaloPost(o){try{const t=await this.haloFetch(`/apis/content.halo.run/v1alpha1/posts/${o}`,{},"GET"),s=await this.haloFetch(`/apis/api.console.halo.run/v1alpha1/posts/${o}/head-content`,{},"GET");return Promise.resolve({post:t,content:s})}catch{return Promise.resolve(void 0)}}async getCategoryNames(o){const t=await this.getHaloCategories(),s=o.filter(n=>!t.find(i=>i.spec.displayName===n)),e=await Promise.all(s.map(async(n,i)=>{const l=await Ja.getPageSlug(n,!0);return await this.haloFetch("/apis/content.halo.run/v1alpha1/categories",{spec:{displayName:n,slug:l,description:"",cover:"",template:"",priority:t.length+i,children:[]},apiVersion:"content.halo.run/v1alpha1",kind:"Category",metadata:{name:"",generateName:"category-"}},"POST")})),a=o.map(n=>{const i=t.find(l=>l.spec.displayName===n);return i?i.metadata.name:void 0}).filter(Boolean);return this.logger.debug("newCategories =>",e),[...a,...e.map(n=>n.metadata.name)]}async getHaloCategories(){const o=await this.haloFetch("/apis/content.halo.run/v1alpha1/categories",{},"GET");return Promise.resolve(o.items)}async getTagNames(o){const t=await this.getHaloTags(),s=o.filter(n=>!t.find(i=>i.spec.displayName===n)),e=await Promise.all(s.map(async n=>{const i=await Ja.getPageSlug(n,!0);return await this.haloFetch("/apis/content.halo.run/v1alpha1/tags",{spec:{displayName:n,slug:i,color:"#ffffff",cover:""},apiVersion:"content.halo.run/v1alpha1",kind:"Tag",metadata:{name:"",generateName:"tag-"}},"POST")})),a=o.map(n=>{const i=t.find(l=>l.spec.displayName===n);return i?i.metadata.name:void 0}).filter(Boolean);return this.logger.debug("newTags =>",e),[...a,...e.map(n=>n.metadata.name)]}async getHaloTags(){const o=await this.haloFetch("/apis/content.halo.run/v1alpha1/tags",{},"GET");return Promise.resolve(o.items)}async haloFetch(o,t,s="POST",e={}){const a="application/json",n="Basic "+It.btoa(this.cfg.username+":"+this.cfg.password),i={"Content-Type":a,Authorization:n,...e},l=`${this.cfg.apiUrl}${o}`;this.logger.debug("向 Halo 请求数据，apiUrl =>",l);const u=ae.isEmptyObject(t)?"":JSON.stringify(t);this.logger.debug("向 Halo 请求数据，body =>",u);const r=await this.apiFetch(l,[i],u,s,a,!1,"base64","text");return this.logger.debug("向 Halo 请求数据，resJson =>",r),r??null}async haloFormFetch(o,t){const e={Authorization:"Basic "+It.btoa(this.cfg.username+":"+this.cfg.password)};return await this.apiFormFetch(o,[e],t)}}var zo={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const pn=async(c,o)=>{const t=W("use-halo-api");t.info("Start using Halo API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(zo.VITE_YUQUE_USERNAME,""),u=U.emptyOrDefault(zo.VITE_YUQUE_AUTH_TOKEN,""),r=U.emptyOrDefault(zo.VITE_MIDDLEWARE_URL,Pe);e=new Xc(l,u,r),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.usernameEnabled=!0,e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new Qc(s,e);return t.info("Halo API created successfully.",e),{cfg:e,blogApi:a}};var Yt=(c=>(c.ANONYMOUS="anonymous",c.LOGIN_USER="user",c))(Yt||{});class ep extends ls{constructor(t,s,e){super(t,"https://edit.telegra.ph","",s,e);D(this,"postType");D(this,"accessToken");D(this,"saveHash");D(this,"forceReAuth");this.postType="anonymous",this.previewUrl="/[postid]",this.allowPreviewUrlChange=!1,this.forceReAuth=!1}}class un{static addCookieArray(o,t,s=!1){let e=!1;return t.forEach(a=>{const[n]=a.split("="),i=this.parseCookie(a),l=o.findIndex(u=>u.startsWith(`${n}=`));if(l!==-1){const u=this.parseCookie(o[l]);(!T.isEmptyString(i.expires)&&!T.isEmptyString(u.expires)&&new Date(i.expires).getTime()>new Date(u.expires).getTime()||s)&&(o[l]=a,e=!0)}else o.push(a),e=!0}),{isUpdated:e,cookieArray:we.uniq(o)}}static getCookie(o,t){return o.find(s=>s.startsWith(`${t}=`))}static getCookieObject(o,t){const s=this.getCookie(o,t);return this.parseCookie(s)}static parseCookie(o){let t={};try{t=er.parse(o),this.logger.debug("cookieObj",t)}catch(s){this.logger.warn("Failed to parse cookie =>"+s)}return t}}D(un,"logger",W("cookie-utils"));class tp extends Gt{constructor(){super(...arguments);D(this,"TPH_TOKEN_KEY","tph_token");D(this,"TPH_UUID_KEY","tph_uuid")}async getUsersBlogs(){const t=this.cfg,s=[];if(t.postType===Yt.LOGIN_USER){if(T.isEmptyString(t.password)||T.isEmptyString(t.accessToken)||T.isEmptyString(t.saveHash))throw new Error("登录模式必须手动填写 uuid 、 Access Token 和 save hash，请从浏览器开发者工具获取");const e=new lt;e.blogid=t.saveHash,e.blogName="telegra.ph",e.url=t.apiUrl}else{const e="text/plain";let a={};a.origin="https://telegra.ph",a.referer="https://telegra.ph/",a["Content-Type"]=e;const n={"x-cors-headers":JSON.stringify(a)};for(const[y,p]of Object.entries(a))n[y]=p;let i,l=await this.telegraphFetch("/check","page_id=0","POST",n,e);if(this.logger.debug("checkJson =>",l),l["cors-received-headers"]){if(l.error)throw new Error("telegra.ph request error =>"+l.error);i=se.safeParse(l["cors-received-headers"],{})["Set-Cookie-Array"]}else if(l.status==200){i=l.headers["Set-Cookie"];const y=se.safeParse(l.body,{});l={...l,...y}}else throw new Error(`telegra.ph request error ${l.status}=>`+l.body);const u=new lt;u.blogid=l.save_hash,u.blogName="telegra.ph",u.url=t.apiUrl;const{isUpdated:r,cookieArray:h}=un.addCookieArray((t==null?void 0:t.corsCookieArray)??[],i,t.forceReAuth);if(this.logger.info(`是否需要刷新：${r}，是否强制刷新：${t.forceReAuth}`),r){const y=un.getCookieObject(i,this.TPH_UUID_KEY);u.metadataMap={username:l.author_name,password:y[this.TPH_UUID_KEY],saveHash:l.save_hash,corsCookieArray:h}}else this.logger.warn("Cookie 还在有效期，可等待 Cookie 过期之后再进行操作",h);s.push(u)}return this.logger.debug("get telegraph cfg =>",s),s}async newPost(t,s){const e=this.cfg;let a={},n;const i=`${this.TPH_UUID_KEY}=${e.password}`;if(e.postType==Yt.ANONYMOUS){if(T.isEmptyString(e.password))throw new Error(`Cookie ${this.TPH_UUID_KEY} 获取失败，无法新建文章`);n=i,this.logger.warn("当前为匿名发布")}else{if(T.isEmptyString(e.password)||T.isEmptyString(e.accessToken))throw new Error(`Cookie ${this.TPH_UUID_KEY},${this.TPH_TOKEN_KEY} 获取失败，无法新建文章`);const _=`${this.TPH_TOKEN_KEY}=${e.accessToken}`;n=[i,_].join(";")}a.Cookie=n??"",a.origin="https://telegra.ph",a.referer="https://telegra.ph/";const l={"x-cors-headers":JSON.stringify(a)};for(const[_,d]of Object.entries(a))l[_]=d;const u=new FormData,r=Gn(t.description),h=new Blob([JSON.stringify(r)],{type:"text/plain"});u.append("Data",h,"content.html"),u.append("title",t.title),u.append("author",e.username),u.append("save_hash",e.saveHash),u.append("page_id","0");const y=await this.telegraphFormFetch("/save",u,l);if(y.error)throw new Error("telegra.ph 发布错误，注意：切换设备（包括从PC到浏览器环境）需要重新验证，并且获取新token。详细错误 =>"+y.error);this.logger.debug("telegraph newPost resJson =>",y);const p={update_cookie:n,page_id:y.page_id,path:y.path,save_hash:e.saveHash};return JSON.stringify(p)}async editPost(t,s,e){const a=this.cfg,n=se.safeParse(t,{});let i={};if(T.isEmptyString(n.update_cookie))throw new Error("Cookie 获取失败，无法更新文章");i.Cookie=n.update_cookie,i.origin="https://telegra.ph",i.referer="https://telegra.ph/";const l={"x-cors-headers":JSON.stringify(i)};for(const[p,g]of Object.entries(i))l[p]=g;const u=new FormData,r=Gn(s.description),h=new Blob([JSON.stringify(r)],{type:"text/plain"});u.append("Data",h,"content.html"),u.append("title",s.title),u.append("author",a.username),u.append("save_hash",n.save_hash),u.append("page_id",n.page_id);const y=await this.telegraphFormFetch("/save",u,l);if(y.error)throw new Error("telegra.ph 更新失败，注意：切换设备（包括从PC到浏览器环境）需要重新验证，并且获取新token。详细错误 =>"+y.error);return this.logger.debug("telegraph editPost resJson =>",y),!0}async deletePost(t){throw new Error("telegra.ph 暂不支持删除文章功能")}async getPost(t,s){const e=new ot;return e.postid=t,e}async getPreviewUrl(t){const s=se.safeParse(t,{}),a=(this.cfg.previewUrl??"").replace("[postid]",(s==null?void 0:s.path)??"");if(!T.isEmptyString(this.cfg.corsAnywhereUrl)){const n=T.pathJoin(this.cfg.corsAnywhereUrl,this.cfg.home??"");return T.pathJoin(`${n}`,a)}return a}async telegraphFetch(t,s,e="GET",a={},n="application/json"){const i=s,l=`${this.cfg.apiUrl}${t}`;this.logger.debug("向 Telegraph 请求数据，apiUrl =>",l),this.logger.debug("向 Telegraph 请求数据，headers =>",a),this.logger.debug("向 Telegraph 请求数据，body =>",i);const u=await this.apiFetch(l,[a],i,e,n,!0);return this.logger.debug("向 Telegraph 请求数据，resJson =>",u),u??null}async telegraphFormFetch(t,s,e={}){const a=`${this.cfg.apiUrl}${t}`,n={method:"POST",headers:e,body:s};this.logger.debug("向 Telegraph 发送表单数据，apiUrl =>",a),this.logger.debug("向 Telegraph 发送表单数据，options =>",n);const i=await this.apiFormFetch(a,[e],s,!0);if(i.error)throw new Error("telegra.ph 发布错误，注意：切换设备（包括从PC到浏览器环境）需要重新验证，并且获取新token。详细错误 =>"+i.error);return this.logger.debug("向 Telegraph 发送表单数据，resJson =>",i),i}}var Wo={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const dn=async(c,o)=>{const t=W("use-telegraph-api");t.info("Start using Telegraph API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(Wo.VITE_TELEGRAPH_URL,"https://telegra.ph"),u=U.emptyOrDefault(Wo.VITE_MIDDLEWARE_URL,Pe),r=U.emptyOrDefault(Wo.VITE_TELEGRAPH_TOKEN,"");e=new ep(l,r,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.usernameEnabled=!0,e.cateEnabled=!1,e.tagEnabled=!1,e.postType=e.postType??Yt.ANONYMOUS,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!1;const a=new tp(s,e);return t.info("Telegraph API created successfully.",e),{cfg:e,blogApi:a}};class sp extends Rs{constructor(o,t,s,e,a){super(o,t,s,e,a),this.home=o,this.apiUrl=t,this.previewUrl="/post/[postid].html",this.pageType=ue.Markdown,this.showTokenTip=!1,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=ee.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class op extends cs{constructor(o,t){super(o,t),this.logger=W("typecho-api-adaptor"),this.cfg.blogid="jvue"}}var Is={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const gn=async(c,o)=>{const t=W("use-jvue-api");t.info("Start using Jvue API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(Is.VITE_JVUE_HOME,""),u=U.emptyOrDefault(Is.VITE_JVUE_API_URL,""),r=U.emptyOrDefault(Is.VITE_JVUE_USERNAME,""),h=U.emptyOrDefault(Is.VITE_JVUE_PASSWORD,""),y=U.emptyOrDefault(Is.VITE_MIDDLEWARE_URL,Pe);e=new sp(l,u,r,h,y),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new op(s,e);return t.info("Jvue API created successfully.",e),{cfg:e,blogApi:a}};class vo{}D(vo,"METHOD_GET_USERS_BLOGS","blogger.getUsersBlogs"),D(vo,"METHOD_DELETE_POST","blogger.deletePost");class ap extends cs{constructor(o,t){super(o,t),this.logger=W("wordpress-dot-com-api-adaptor"),this.cfg.blogid="wordpress-dot-com"}async getUsersBlogs(){let o=[];return o=await this.metaweblogCall(vo.METHOD_GET_USERS_BLOGS,[this.cfg.blogid,this.cfg.username,this.cfg.password]),this.logger.debug("getUsersBlogs=>",o),o}async deletePost(o){const t=await this.metaweblogCall(vo.METHOD_DELETE_POST,[this.cfg.blogid,o,this.cfg.username,this.cfg.password,!1]);return this.logger.debug("ret=>",t),t}async metaweblogCall(o,t){return await this.proxyXmlrpc(this.cfg.apiUrl,o,t,!0)}}var so={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const mn=async(c,o)=>{const t=W("use-wordpress-dot-com-api");t.info("Start using Wordpress.com API...");const s=new fe;let e;if(o)t.info("Initialize with the latest newCfg passed in..."),e=o;else{const{getSetting:n}=me(),i=await n();if(e=se.safeParse(i[c],{}),ae.isEmptyObject(e)){const l=U.emptyOrDefault(so.VITE_WORDPRESS_API_URL,"https://[username].wordpress.com"),u=U.emptyOrDefault(so.VITE_WORDPRESS_USERNAME,""),r=U.emptyOrDefault(so.VITE_WORDPRESS_AUTH_TOKEN,""),h=U.emptyOrDefault(so.VITE_MIDDLEWARE_URL,Pe);e=new _i(l,u,r,h),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");T.isEmptyString(e.posidKey)&&(e.posidKey=Ae(c))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=ee.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1,e.picgoPicbedSupported=!0,e.bundledPicbedSupported=!0;const a=new ap(s,e);return t.info("Wordpress.com API created successfully.",e),{cfg:e,blogApi:a}};class _e{static async getCfg(o,t){let s=null;switch(ao(o)){case N.Common_Yuque:{const{cfg:a}=await en(o,t);s=a;break}case N.Common_Notion:{const{cfg:a}=await on(o,t);s=a;break}case N.Common_Halo:{const{cfg:a}=await pn(o,t);s=a;break}case N.Common_Telegraph:{const{cfg:a}=await dn(o,t);s=a;break}case N.Github_Hexo:{const{cfg:a}=await no(o,t);s=a;break}case N.Github_Hugo:{const{cfg:a}=await lo(o,t);s=a;break}case N.Github_Jekyll:{const{cfg:a}=await co(o,t);s=a;break}case N.Github_Vuepress:{const{cfg:a}=await uo(o,t);s=a;break}case N.Github_Vuepress2:{const{cfg:a}=await mo(o,t);s=a;break}case N.Github_Vitepress:{const{cfg:a}=await ho(o,t);s=a;break}case N.Gitlab_Hexo:{const{cfg:a}=await io(o,t);s=a;break}case N.Gitlab_Hugo:{const{cfg:a}=await ro(o,t);s=a;break}case N.Gitlab_Jekyll:{const{cfg:a}=await po(o,t);s=a;break}case N.Gitlab_Vuepress:{const{cfg:a}=await go(o,t);s=a;break}case N.Gitlab_Vuepress2:{const{cfg:a}=await fo(o,t);s=a;break}case N.Gitlab_Vitepress:{const{cfg:a}=await yo(o,t);s=a;break}case N.Metaweblog_Metaweblog:{const{cfg:a}=await sn(o,t);s=a;break}case N.Metaweblog_Cnblogs:{const{cfg:a}=await Xa(o,t);s=a;break}case N.Metaweblog_Typecho:{const{cfg:a}=await Qa(o,t);s=a;break}case N.Metaweblog_Jvue:{const{cfg:a}=await gn(o,t);s=a;break}case N.Wordpress_Wordpress:{const{cfg:a}=await Za(o,t);s=a;break}case N.Wordpress_Wordpressdotcom:{const{cfg:a}=await mn(o,t);s=a;break}case N.Custom_Zhihu:{const{cfg:a}=await tn(o);s=a;break}case N.Custom_CSDN:{const{cfg:a}=await nn(o);s=a;break}case N.Custom_Wechat:{const{cfg:a}=await ln(o);s=a;break}case N.Custom_Jianshu:{const{cfg:a}=await rn(o);s=a;break}case N.Custom_Juejin:{const{cfg:a}=await cn(o);s=a;break}case N.System_Siyuan:{const{siyuanConfig:a}=Ge();s=a;break}default:{s={};break}}return this.logger.debug(`get conf from key ${o}=>`,s),s}static async getAdaptor(o,t){let s=null;switch(ao(o)){case N.Common_Yuque:{const{blogApi:a}=await en(o,t);s=a;break}case N.Common_Notion:{const{blogApi:a}=await on(o,t);s=a;break}case N.Common_Halo:{const{blogApi:a}=await pn(o,t);s=a;break}case N.Common_Telegraph:{const{blogApi:a}=await dn(o,t);s=a;break}case N.Github_Hexo:{const{blogApi:a}=await no(o,t);s=a;break}case N.Github_Hugo:{const{blogApi:a}=await lo(o,t);s=a;break}case N.Github_Jekyll:{const{blogApi:a}=await co(o,t);s=a;break}case N.Github_Vuepress:{const{blogApi:a}=await uo(o,t);s=a;break}case N.Github_Vuepress2:{const{blogApi:a}=await mo(o,t);s=a;break}case N.Github_Vitepress:{const{blogApi:a}=await ho(o,t);s=a;break}case N.Gitlab_Hexo:{const{blogApi:a}=await io(o,t);s=a;break}case N.Gitlab_Hugo:{const{blogApi:a}=await ro(o,t);s=a;break}case N.Gitlab_Jekyll:{const{blogApi:a}=await po(o,t);s=a;break}case N.Gitlab_Vuepress:{const{blogApi:a}=await go(o,t);s=a;break}case N.Gitlab_Vuepress2:{const{blogApi:a}=await fo(o,t);s=a;break}case N.Gitlab_Vitepress:{const{blogApi:a}=await yo(o,t);s=a;break}case N.Metaweblog_Metaweblog:{const{blogApi:a}=await sn(o,t);s=a;break}case N.Metaweblog_Cnblogs:{const{blogApi:a}=await Xa(o,t);s=a;break}case N.Metaweblog_Typecho:{const{blogApi:a}=await Qa(o,t);s=a;break}case N.Metaweblog_Jvue:{const{blogApi:a}=await gn(o,t);s=a;break}case N.Wordpress_Wordpress:{const{blogApi:a}=await Za(o,t);s=a;break}case N.Wordpress_Wordpressdotcom:{const{blogApi:a}=await mn(o,t);s=a;break}case N.Custom_Zhihu:{const{webApi:a}=await tn(o,t);s=a;break}case N.Custom_CSDN:{const{webApi:a}=await nn(o,t);s=a;break}case N.Custom_Wechat:{const{webApi:a}=await ln(o,t);s=a;break}case N.Custom_Jianshu:{const{webApi:a}=await rn(o,t);s=a;break}case N.Custom_Juejin:{const{webApi:a}=await cn(o,t);s=a;break}case N.System_Siyuan:{const{blogApi:a}=Ge();s=a;break}}return this.logger.debug(`get blogAdaptor from key ${o}`),s}static async getYamlAdaptor(o,t){let s=null;switch(ao(o)){case N.Github_Hexo:{const{yamlAdaptor:a}=await no(o,t);s=a;break}case N.Github_Hugo:{const{yamlAdaptor:a}=await lo(o,t);s=a;break}case N.Github_Jekyll:{const{yamlAdaptor:a}=await co(o,t);s=a;break}case N.Github_Vuepress:{const{yamlAdaptor:a}=await uo(o,t);s=a;break}case N.Github_Vuepress2:{const{yamlAdaptor:a}=await mo(o,t);s=a;break}case N.Github_Vitepress:{const{yamlAdaptor:a}=await ho(o,t);s=a;break}case N.Gitlab_Hexo:{const{yamlAdaptor:a}=await io(o,t);s=a;break}case N.Gitlab_Hugo:{const{yamlAdaptor:a}=await ro(o,t);s=a;break}case N.Gitlab_Jekyll:{const{yamlAdaptor:a}=await po(o,t);s=a;break}case N.Gitlab_Vuepress:{const{yamlAdaptor:a}=await go(o,t);s=a;break}case N.Gitlab_Vuepress2:{const{yamlAdaptor:a}=await fo(o,t);s=a;break}case N.Gitlab_Vitepress:{const{yamlAdaptor:a}=await yo(o,t);s=a;break}}return this.logger.debug(`get yamlAdaptor from key ${o}=>`,s),s}}D(_e,"logger",W("adaptors"));const js=()=>{const{getSetting:c}=me(),o=new fe;return{getPublishCfg:async e=>{const a=await c(),n=se.safeParse(a[De],{}),i=(n==null?void 0:n.totalCfg)||[];if(e){const l=se.safeParse(a[e],{}),u=await _e.getCfg(e,l),r=Io(i,e);return{setting:a,dynamicConfigArray:i,cfg:u,dynCfg:r}}else return{setting:a,dynamicConfigArray:i,cfg:void 0,dynCfg:void 0}},getPublishApi:async(e,a)=>{const n=await _e.getAdaptor(e,a);return U.blogApi(o,n)}}},Ks=()=>{const c=W("use-publish"),{t:o}=Z(),{updateSetting:t}=me(),{kernelApi:s,blogApi:e}=Ge(),{getPublishApi:a}=js(),{updatePlatformMetadata:n}=Ya(),i=re({isPublishLoading:!1,publishProcessStatus:!1,isAdd:!0,errMsg:""}),l=async(p,g,_,d)=>{var M;const v=_.setting,P=_.cfg;_.dynCfg;let S,E;try{const x=Ke.systemCfg.some(I=>I.platformKey===p);if(c.info(`isSys=>${x}`),x)S=g;else{const I=P.posidKey;if(T.isEmptyString(I))throw new Error("配置错误，posidKey不能为空，请检查配置");const A=ae.getProperty(v,g,{});S=ae.getProperty(A,I)}i.isAdd=T.isEmptyString(S);const z=we.cloneDeep(d);c.debug("准备开始发布处理, doc =>",{post:le(d)}),z.postid=S;const L=await a(p,P);c.info(`开始文章预处理, isAdd =>${i.isAdd}`),c.debug("post=>",le(z));const j=await L.preEditPost(z,g,_);if(c.info(`文章全部预处理完毕，id=${g},key=${p}`),c.debug("最终结果 =>",{finalPost:le(j)}),i.isAdd){c.info("文章未发布，准备发布");const I=await L.newPost(j);S=I;const A=P.posidKey,$=ae.getProperty(v,g,{});$[A]=S,$[st.Custom_slug]=j.wp_slug,v[g]=$,await t(v),c.info("new post=>",I),c.info("文章发布成功")}else{c.info("文章已发布，准备更新");const I=await L.editPost(S,j),A=ae.getProperty(v,g,{});A.hasOwnProperty(st.Custom_slug)?j.wp_slug=A[st.Custom_slug]:(c.info("检测到未生成过别名，准备更新别名"),A[st.Custom_slug]=j.wp_slug,v[g]=A,await t(v)),c.info("edit post=>",I),c.info("文章更新成功")}if(c.info("发布完成，准备处理文章属性、元数据"),x)c.info("内置平台，忽略保存属性");else{const I=Ds(p);await s.setSingleBlockAttr(g,I,j.yaml);const A=we.cloneDeep(j),$=((M=A.mt_keywords)==null?void 0:M.split(","))??[],q=(A==null?void 0:A.categories)??[];n(p,$,q,[])}c.info("文章属性处理完成"),E=await h(L,g,P),i.publishProcessStatus=!0}catch(x){i.errMsg=o("main.opt.failure")+"=>"+x,await s.pushErrMsg({msg:i.errMsg,timeout:7e3}),i.publishProcessStatus=!1}return{key:p,status:i.publishProcessStatus,name:P==null?void 0:P.blogName,previewUrl:E,errMsg:i.errMsg}},u=async(p,g,_)=>{const d=_.setting,v=_.cfg;_.dynCfg;try{const P=v.posidKey;if(T.isEmptyString(P))throw new Error("配置错误，posidKey不能为空，请检查配置");const S=ae.getProperty(d,g,{}),E=ae.getProperty(S,P);if(T.isEmptyString(E))throw new Error("未找到postid，无法删除，请手动在平台删除");const M=await a(p,v);if(i.publishProcessStatus=await M.deletePost(E),i.publishProcessStatus){const z={...ae.getProperty(d,g,{})};z.hasOwnProperty(P)&&delete z[P],z.hasOwnProperty(st.Custom_slug)&&delete z[st.Custom_slug],d[g]=z,await t(d),c.info(`[${p}] [${g}] 文章发布信息已移除`);const L=Ds(p);await s.setSingleBlockAttr(g,L,""),c.info(`[${p}] [${g}] 属性已移除`)}}catch(P){i.errMsg=o("main.opt.failure")+"=>"+P,await s.pushErrMsg({msg:i.errMsg,timeout:7e3})}return{key:p,status:i.publishProcessStatus,errMsg:i.errMsg}},r=async(p,g,_)=>{try{const d=_.setting,v=_.cfg,P=_.dynCfg,S=v.posidKey;if(T.isEmptyString(S))throw new Error("配置错误，posidKey不能为空，请检查配置");if(!T.isEmptyString(S)){const M={...ae.getProperty(d,g,{})};M.hasOwnProperty(S)&&delete M[S],d[g]=M,await t(d);const x=Ds(p);await s.setSingleBlockAttr(g,x,""),c.info(`[${p}] [${g}] 属性已移除`),await s.pushMsg({msg:o("main.opt.ok"),timeout:2e3}),c.info(`[${p}] [${g}] 文章发布信息已强制移除`),Q.success(`[${p}] [${g}] 文章发布信息已强制移除`)}}catch(d){Q.error(o("main.opt.failure")+"=>"+d),c.error(o("main.opt.failure")+"=>",d),await s.pushErrMsg({msg:o("main.opt.failure")+"=>"+d,timeout:7e3})}},h=async(p,g,_)=>{const{getSetting:d}=me(),v=await d(),P=_.posidKey,E=ae.getProperty(v,g,{})[P];let M=await p.getPreviewUrl(E);return/^[a-z]+:\/\//.test(M)?M:T.pathJoin((_==null?void 0:_.home)??"",M)},y={assignInitSlug:async(p,g,_)=>{const d=_.setting,v=ae.getProperty(d,g,{}),P=we.cloneDeep(p),S=ae.getProperty(v,st.Custom_slug,P.wp_slug);if(!T.isEmptyString(S))P.wp_slug=S,c.info("Using existing siyuan note slug");else{const E=await Ja.getPageSlug(P.title,!0);P.wp_slug=`${E}`,c.info("Generated new slug")}return P.post_status=Et.PostStatusEnum_Publish,P},assignInitAttrs:async(p,g,_)=>{_.setting;const d=_.cfg,P=_.dynCfg.platformKey,S=Ke.systemCfg.some(x=>x.platformKey===P),E=await y.assignInitSlug(p,g,_);let M=we.cloneDeep(E);if(!S){const x=Ds(P),z=await s.getSingleBlockAttr(g,x),L=ne.extractFrontmatter(z).trim(),j=await _e.getYamlAdaptor(P,d);if(j!==null)if(T.isEmptyString(L)){const I=j.convertToYaml(M,void 0,d);c.info("YAML未保存，使用适配器生成默认的yamlFormatObj",{yamlFormatObj:le(I)}),M=j.convertToAttr(M,I,d),M.yamlType=qt.Yaml_custom_auto,c.debug("使用适配器初始化转换yamlObj到post完成 =>",{post:le(M)})}else{const I=new gt,A=await ne.yaml2ObjAsync(z);I.yamlObj=A,M=j.convertToAttr(M,I,d),M.yamlType=qt.Yaml_custom_hand,c.info("有适配器且YAML已保存，始终保持最新的 YAML",{post:le(M)})}else if(M.yamlType=qt.YAML_default,T.isEmptyString(L))c.info("未保存过YAML，未找到适配器，默认不处理",{post:le(M)});else{const I=await ne.yaml2ObjAsync(z);M.yaml=z,wn.fromYaml(M,I),c.info("读取已经存在的YAML，无适配器，使用fromYaml生成默认的yamlObj",{post:le(M)})}}return M},doInitSinglePage:async(p,g,_=tt.METHOD_ADD,d)=>{const v=d.setting,P=d.cfg;d.dynCfg;const S=P.posidKey;if(T.isEmptyString(S))throw new Error("配置错误，posidKey不能为空，请检查配置");const E=ae.getProperty(v,g,{}),M=ae.getProperty(E,S),x=await a(p,P);let z="",L={};const j=await e.getPost(g);if(_===tt.METHOD_ADD)c.info("Add, using siyuan post"),L=we.cloneDeep(j),L.mt_keywords=(L==null?void 0:L.mt_keywords)??"",L.categories=(L==null?void 0:L.categories)??[];else{if(c.info("Reading post from remote platform"),T.isEmptyString(M))throw new Error("未找到postid，将无法进行更新");const I=await x.getPost(M);L=we.cloneDeep(I),c.debug("get init platformPost ok =>",L),L.title=I.title,L.originalId=j.originalId,L.link=j.link,L.markdown=j.markdown,L.html=j.html,L.description=j.description,z=await h(x,g,P)}return c.debug("doInitPage finished mergedPost =>",le(L)),{mergedPost:L,postPreviewUrl:z}},doOverideBatchPost:(p,g)=>{const _=we.cloneDeep(g);return _.title=p.title,_.originalId=p.originalId,_.link=p.link,_.shortDesc=p.shortDesc,_.mt_excerpt=p.mt_excerpt,_.mt_keywords=p.mt_keywords,_.categories=p.categories,_},doMergeBatchPost:(p,g)=>{var E,M;const _=we.cloneDeep(g);_.originalId=p.originalId,_.link=p.link,T.isEmptyString(_.shortDesc)&&(_.shortDesc=_.mt_excerpt),T.isEmptyString(_.mt_excerpt)&&(_.mt_excerpt=_.shortDesc);const d=((E=p==null?void 0:p.mt_keywords)==null?void 0:E.split(","))??[],v=((M=g==null?void 0:g.mt_keywords)==null?void 0:M.split(","))??[],P=[...new Set([...d.map(x=>x.trim()),...v.map(x=>x.trim())])].filter(x=>x.trim()!=="");_.mt_keywords=P.join(",");const S=[...new Set([...((p==null?void 0:p.categories)??[]).map(x=>x.trim()),...((g==null?void 0:g.categories)??[]).map(x=>x.trim())])].filter(x=>x.trim()!=="");return _.categories=S,_}};return{singleFormData:i,doSinglePublish:l,doSingleDelete:u,doForceSingleDelete:r,initPublishMethods:y,getPostPreviewUrl:h}},zs=c=>{const o=J(0),t=J(0),s=()=>{o.value=new Date().getTime()},e=()=>{const a=new Date().getTime();t.value=a-o.value};return $s(()=>{s()}),Je(c,a=>{c.value?e():s()}),{loadingTime:t}};class Mt{static subPlatformName(o,t){return T.isEmptyString(o)?"":o.includes("_")?T.upperFirst(T.getByLength(o.split("_")[1],t??9)):this.shortPlatformName(o,t??9)}static shortPlatformName(o,t){return T.isEmptyString(o)?"":T.upperFirst(T.getByLength(o.replace("Gitlab",""),t??9))}static longPlatformName(o,t){if(T.isEmptyString(o))return"";const s=T.upperFirst(T.getByLength(o.replace("Gitlab",""),t??9));return o.includes("Gitlab")?`Gitlab-${s}`:s}}const np={id:"page-body"},ip={key:0,class:"page-head"},lp={class:"flex items-center"},rp={class:"text-large font-600 mr-3"},cp={class:"page-content-box"},pp=F({__name:"BackPage",props:{title:{type:String,default:""},hasBackEmit:{type:Boolean,default:!1}},emits:["backEmit"],setup(c,{emit:o}){const t=W("back-page");Z();const s=wt();qe();const{query:e}=qe(),a=c,n=J(e.showBack==="true"),i=o,l=()=>{i&&a.hasBackEmit?(t.info("using backEmit do back"),i("backEmit")):(t.warn("no backEmit, using router handle back"),s.back())};return(u,r)=>{const h=Nl;return w(),O("div",np,[n.value?(w(),O("div",ip,[f(h,{icon:m(cl),title:"返回",onClick:l},{content:b(()=>[k("div",lp,[k("span",rp,K(a.title),1)])]),_:1},8,["icon"])])):Y("",!0),k("div",cp,[At(u.$slots,"default",{},void 0,!0)])])}}}),Ve=pe(pp,[["__scopeId","data-v-cf41ea16"]]),up=c=>(mt("data-v-c809d0aa"),c=c(),ht(),c),dp={id:"quick-publish-box"},gp={class:"publish-tips"},mp={key:0,class:"is-loading info-tips"},hp=up(()=>k("i",{class:"el-icon is-loading"},[k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[k("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})])],-1)),fp={key:1,class:"success-tips"},yp=["title"],bp=["title"],_p=["href"],wp={key:2,class:"fail-tips"},vp=["title"],Pp=["title"],Tp=F({__name:"QuickPublish",setup(c){const o=W("quick-publish-worker"),t=qe(),{singleFormData:s,doSinglePublish:e,initPublishMethods:a}=Ks(),{blogApi:n}=Ge(),{getPublishCfg:i}=js(),{t:l}=Z(),u=Ke.systemCfg.map(v=>v.platformKey),r=re(t.params),h=r.key,y=r.id,p=re({processResult:{}}),g=J(!1),{loadingTime:_}=zs(g),d=v=>{var S;const P=Tt.siyuanWindow();(S=P==null?void 0:P.syp)!=null&&S.alert?P.syp.alert(v):Pt.alert(v)};return Ye(async()=>{s.isPublishLoading=!0,setTimeout(async()=>{try{const v=await i(h);let P=await n.getPost(y);P=await a.assignInitAttrs(P,y,v),o.debug("quick publish inited siyuanPost =>",le(P)),o.info("保存到系统平台开始");for(const S of u){const E=await i(S);await e(S,y,E,P)}o.info("保存到系统平台结束"),o.info("单个快速发布开始"),p.processResult=await e(h,y,v,P),o.info("单个快速发布结束"),g.value=!0}catch(v){o.error(l("main.opt.failure")+"=>",v),Q.error(l("main.opt.failure")+"=>"+v)}finally{s.isPublishLoading=!1}},200)}),(v,P)=>{const S=Hs;return w(),C(Ve,{title:"极速发布 - "+m(h)},{default:b(()=>[k("div",dp,[k("div",gp,[m(s).isPublishLoading?(w(),O("div",mp,[hp,R(" 发布中，请稍后... ")])):m(s).publishProcessStatus?(w(),O("div",fp,[R(K(m(s).isAdd?"发布到":"更新文章到")+" ",1),k("span",{title:p.processResult.key}," ["+K(m(Mt).subPlatformName(p.processResult.key,6))+"] ",9,yp),m(T).isEmptyString(p.processResult.name)?Y("",!0):(w(),O("span",{key:0,title:p.processResult.name},K(`[${m(T).getByLength(p.processResult.name,8)}]`),9,bp)),R(" 成功， "),k("a",{href:p.processResult.previewUrl,target:"_blank"},"查看文章",8,_p),f(S,{"loading-time":m(_),style:{padding:"0 10px 0 10px",display:"inline-block"}},null,8,["loading-time"])])):(w(),O("div",wp,[R(K(m(s).isAdd?"发布到":"更新文章到")+" ",1),k("span",{title:p.processResult.key}," ["+K(m(Mt).subPlatformName(p.processResult.key,6))+"] ",9,vp),m(T).isEmptyString(p.processResult.name)?Y("",!0):(w(),O("span",{key:0,title:p.processResult.name},K(`[${m(T).getByLength(p.processResult.name,8)}]`),9,Pp)),R(" 失败！ "),k("a",{href:"javascript:;",onClick:P[0]||(P[0]=E=>d(p.processResult.errMsg))},"详细错误"),f(S,{"loading-time":m(_),style:{padding:"0 10px 0 10px",display:"inline-block"}},null,8,["loading-time"])]))])])]),_:1},8,["title"])}}}),kp=pe(Tp,[["__scopeId","data-v-c809d0aa"]]),Sp={key:1},Ep={class:"platform-title"},Cp={class:"platform-desc"},Ap={class:"one-key-preview"},Up={class:"icon-list"},Ip={class:"el-icon"},xp=["innerHTML"],Mp=F({__name:"SinglePublishSelectPlatform",props:{id:{type:String,default:""}},setup(c){const o=W("single-publish-select-platform"),t=new fe,{getPostPreviewUrl:s}=Ks(),{kernelApi:e}=Ge(),{getReadOnlyPublishPreferenceSetting:a}=xt(),n=c,{t:i}=Z(),l=wt(),{getSetting:u}=me(),r=re({isInit:!1,enabledConfigArray:[],postInfo:{},postMeta:{},unpublishCount:0}),h=J(""),y=(S,E)=>{S.stopPropagation();const M=p(E)?"edit":"add",x=`/publish/singlePublish/doPublish/${E}/${n.id}`;o.info("will go to =>",x);const z={path:x,query:{showBack:"true",method:M}};l.push(z)},p=S=>{const E=Ae(S),M=ae.getProperty(r.postMeta,E);return!T.isEmptyString(M)},g=async(S,E)=>{if(S.stopPropagation(),!p(E)){r.unpublishCount++;return}const x=await _e.getCfg(E),z=await _e.getAdaptor(E,x),L=U.blogApi(t,z),j=await s(L,n.id,x);window.open(j)},_=async S=>{Pt.confirm("将在默认浏览器打开所有已发布平台的文章预览页面，是否继续？","温馨提示",{type:"error",icon:Ct(bn),confirmButtonText:i("main.opt.ok"),cancelButtonText:i("main.opt.cancel")}).then(async()=>{for(const E of r.enabledConfigArray)await g(S,E.platformKey);(r.enabledConfigArray.length===0||r.unpublishCount===r.enabledConfigArray.length)&&(r.unpublishCount=0,Q.error("文章未发布过，请至少发布到一个平台！"))}).catch(()=>{})},d=async()=>{const S=await u(),E=se.safeParse(S[De],{}),M=(E==null?void 0:E.totalCfg)||[];if(r.enabledConfigArray=M.filter(z=>z.isEnabled&&z.isAuth),r.postMeta=ae.getProperty(S,n.id,{}),r.postInfo=await e.getBlockByID(n.id),a().value.fixTitle){const z=Ut.removeTitleNumber(r.postInfo.content).replace(/\.md/g,"");h.value=z}else h.value=r.postInfo.content},v=J(!1),{loadingTime:P}=zs(v);return $s(async()=>{await d(),r.isInit=!0,v.value=!0}),(S,E)=>{const M=Hs,x=Dt,z=Ne,L=Se,j=Ns,I=Pn,A=To,$=Tn,q=kn,G=Ve;return w(),O(Ee,null,[f(M,{"loading-time":m(P),style:{padding:"0 24px"}},null,8,["loading-time"]),r.isInit?(w(),O("div",Sp,[f(G,{title:"单个文章发布"},{default:b(()=>[k("div",Ep,K(h.value),1),k("div",Cp,[k("p",null,[f(z,{class:"desc-tip",type:"warning",title:"点击图标进入对应平台的发布页面，如果文章已发布，可点击 [预览] 直接在浏览器打开预览页面。"})])]),k("div",Ap,[f(L,{type:"primary",size:"small",onClick:_},{default:b(()=>[R("一键预览")]),_:1})]),f(q,{gutter:20,class:"row-box"},{default:b(()=>[(w(!0),O(Ee,null,xe(r.enabledConfigArray,H=>(w(),C($,{span:8,sm:12,xs:12,md:12,lg:8,xl:8,title:H.platformName,class:"platform-select-card"},{default:b(()=>[f(A,{class:"card-item"},{default:b(()=>[k("div",Up,[f(I,{type:p(H.platformKey)?"success":"danger",value:p(H.platformKey)?"预览":"未发布",onClick:bo(X=>g(X,H.platformKey),["stop"]),class:Jt(p(H.platformKey)?"item published-item":"item")},{default:b(()=>[f(j,{class:"define-item",onClick:bo(X=>y(X,H.platformKey),["stop"])},{default:b(()=>[k("i",Ip,[k("span",{innerHTML:H==null?void 0:H.platformIcon},null,8,xp)]),R(" "+K(m(Mt).longPlatformName(H==null?void 0:H.platformName,11)),1)]),_:2},1032,["onClick"])]),_:2},1032,["type","value","onClick","class"])])]),_:2},1024)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})])):(w(),C(x,{key:0,class:"placeholder platform-skt",rows:12,animated:""}))],64)}}}),Dp=pe(Mp,[["__scopeId","data-v-a8d342a5"]]),ss=W("widget-utils"),Fo=(c,o,t)=>{const{isInSiyuanWidget:s}=at();s()?Op(c,void 0,void 0,!1,!1,!t,o,t):window.open(c)},Op=(c,o,t,s=!1,e=!1,a=!0,n,i=void 0)=>{try{if(T.isEmptyString(c)){ss.error("Url cannot be empty");return}const{isInSiyuanWidget:l}=at();if(!Ht.isElectron()&&!l){ss.info("BrowserWindow can ony be available in siyuan Electron environment");return}ss.info(T.f("Opening a new BrowserWindow from url => {0}",c));const u=t??Tt.siyuanWindow(),{app:r,BrowserWindow:h,getCurrentWindow:y}=u.require("@electron/remote"),p=u.require("@electron/remote").require("@electron/remote/main"),g=y(),_=new h({parent:g,width:900,height:750,show:a,resizable:!0,modal:e,icon:Tt.browserJoinPath(Tt.siyuanWindow().siyuan.config.system.appDir,"stage","icon-large.png"),titleBarOverlay:{color:"#cccccca5",symbolColor:"black"},webPreferences:{nativeWindowOpen:!0,nodeIntegration:!0,webviewTag:!0,webSecurity:!1,contextIsolation:!1}});_.webContents.userAgent=`SiYuan/${r.getVersion()} https://b3log.org/siyuan Electron`,p.enable(_.webContents),s&&_.webContents.openDevTools(),_.on("close",d=>{ss.info("窗口关闭事件触发")}),_.loadURL(c),i&&((()=>{const v=_.webContents.session,P=n.domain;v.cookies.get({domain:P}).then(async S=>{ss.info(`读取cookie事件触发，准备读取 ${P} 下的所有 Cookie`),await i(n,S)}).catch(S=>{console.error(`读取 Cookie 失败：${S}`)})})(),_.hide(),_.close())}catch(l){ss.error("Open browser window failed",l)}},Vp=c=>{const o=c.querySelector("div.protyle:not(.fn__none)"),t=o==null?void 0:o.querySelector("div.protyle-title");return t==null?void 0:t.getAttribute("data-node-id")},Ws=()=>{const c=window.parent.document;return Vp(c)},$p=F({__name:"SinglePublish",setup(c){const{query:o}=qe(),t=o.id??Ws();return(s,e)=>(w(),C(Dp,{id:m(t)},null,8,["id"]))}}),Np=F({__name:"PublishStatus",props:{modelValue:{type:Object,default:{}}},emits:["emitSyncPublishStatus"],setup(c,{emit:o}){var i,l;const{t}=Z(),s=c,e=re({status:(i=s.modelValue)==null?void 0:i.post_status,password:(l=s.modelValue)==null?void 0:l.wp_password}),a=o,n=()=>{const u=e.status,r=e.password;a("emitSyncPublishStatus",u,r)};return(u,r)=>{const h=ko,y=Ls,p=Ce,g=Ie;return w(),O("div",null,[f(p,{label:m(t)("publisher.post.status")},{default:b(()=>[f(y,{modelValue:e.status,"onUpdate:modelValue":r[0]||(r[0]=_=>e.status=_),class:"ml-4",onChange:n},{default:b(()=>[f(h,{value:m(Et).PostStatusEnum_Publish,size:"large"},{default:b(()=>[R(K(m(t)("publisher.post.status.pubish")),1)]),_:1},8,["value"]),f(h,{value:m(Et).PostStatusEnum_Draft,size:"large"},{default:b(()=>[R(K(m(t)("publisher.post.status.draft")),1)]),_:1},8,["value"]),f(h,{value:m(Et).PostStatusEnum_Private,size:"large"},{default:b(()=>[R(K(m(t)("publisher.post.status.private")),1)]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),f(p,{label:m(t)("publisher.post.password")},{default:b(()=>[f(g,{type:"password",modelValue:e.password,"onUpdate:modelValue":r[1]||(r[1]=_=>e.password=_),placeholder:m(t)("publisher.post.password.tip"),onInput:n},null,8,["modelValue","placeholder"])]),_:1},8,["label"])])}}}),Lp={key:0,class:"multi-categories"},Hp=F({__name:"MultiCategories",props:{categoryConfig:{type:Object,default:{}},categories:{type:Array,default:[]}},emits:["emitSyncMultiCates"],setup(c,{emit:o}){const t=W("multi-categories"),{t:s}=Z(),e=c,a=re({categoryConfig:e.categoryConfig,categories:e.categories,useRemoteData:!T.isEmptyString(e.categoryConfig.apiType),cate:{categorySelected:[],categoryList:[]}}),n=o,i=(y,p,g,_)=>{},l=(y,p)=>{t.debug("checked item=>",{data:le(y),status:le(p)});const g=[];p.checkedKeys.forEach(d=>{g.push(d.toString())}),a.categories=g,t.debug(" formData.categories=>",{categories:le(a.categories)}),n("emitSyncMultiCates",g)},u=y=>{const p=y;t.debug("准备删除 =>",p);const g=a.categories.filter(_=>_!==p);a.categories=g,t.debug("formData.categories=>",{categories:le(a.categories)}),n("emitSyncMultiCates",g)},r=y=>{const p=y;t.debug("选中项已改变 =>",p),n("emitSyncMultiCates",p)},h=async()=>{if(a.categoryConfig.cateEnabled){let y=[];if(t.debug(`useRemoteData => ${a.useRemoteData}`),a.useRemoteData){const p=a.categoryConfig.cfg;if(y=await(await _e.getAdaptor(a.categoryConfig.apiType,p)).getCategories(),y.length===0&&(y=a.categories.map(_=>{const d=new it;return d.categoryId=_,d.categoryName=_,d})),t.debug("getCategories for multi categories",y),y.length>0){a.cate.categoryList=y.map(d=>({value:d.categoryName,label:d.categoryName})),t.debug("get multi categoryList =>",{categoryList:le(a.cate.categoryList)});const _=a.categories;a.cate.categorySelected=_,n("emitSyncMultiCates",_),t.debug("muti cates is syncing =>",{cates:le(_)})}}else{const p=a.categories??[];y=p.map(g=>{const _=new it;return _.categoryId=g,_.categoryName=g,_.categoryDescription=g,_}),y.length>0&&(a.cate.categoryList=y.map(g=>({value:g.categoryId,label:g.categoryName})),a.cate.categorySelected=p),t.debug("读取已有分类 =>",{cates:le(p)})}}};return Ye(async()=>{await h()}),(y,p)=>{const g=So,_=Ce;return a.categoryConfig.cateEnabled?(w(),O("div",Lp,[f(_,{label:m(s)("main.cat")},{default:b(()=>[f(g,{style:{width:"100%"},modelValue:a.cate.categorySelected,"onUpdate:modelValue":p[0]||(p[0]=d=>a.cate.categorySelected=d),data:a.cate.categoryList,filterable:"","allow-create":"",multiple:"","check-on-click-node":!0,"render-after-expand":!1,"show-checkbox":"",placeholder:m(s)("main.cat.select"),"empty-text":m(s)("main.cat.empty"),"no-data-text":m(s)("main.cat.empty"),disabled:a.categoryConfig.readonlyMode,onNodeClick:i,onCheck:l,onRemoveTag:u,onChange:r},null,8,["modelValue","data","placeholder","empty-text","no-data-text","disabled"])]),_:1},8,["label"])])):Y("",!0)}}}),Rp=pe(Hp,[["__scopeId","data-v-067d018f"]]),Gp={title:"自动提取标题",description:"从文章内容中生成有意义的标题",key:"title",content:"请为这篇文章生成简洁且完整概括的标题，只处理文本，尽量返回中文标题。标题长度不超过100个中文字符或255个英文字符。输出为 JSON 格式，键名为 title，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Bp={title:"自动提取摘要",description:"从文章内容生成文章摘要",key:"desc",content:"请为这篇文章生成简明扼要的摘要，只处理文本，尽量返回中文摘要。摘要长度不超过255个中文字符或512个英文字符。输出为 JSON 格式，键名为 desc，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},jp={title:"自动提取标签",description:"为文章添加标签",key:"tags",content:"请为这篇文章生成标签，只处理文本，尽量返回中文标签。单个标签不超过6个字符，多个标签用英文逗号分隔，最多返回5个标签。如果单个标签是英文，英文字母必须全部小写并且每个单词之间用-拼接。标签名称不能重复，不能包含任何除英文字母、-以及汉字以外的字符。输出为 JSON 格式，键名为 tags，指令放在数组内，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Kp={title:"自动提取分类",description:"对文章内容进行分类",key:"categories",content:"请为这篇文章文章内容进行分类，只处理文本，尽量返回中文分类。每个分类名称不超过6个字符，最多返回3个分类。如果分类是英文，需要使用驼峰命名并且首字母大写。输出为 JSON 格式，键名为 categories，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Fs={titlePrompt:Gp,shortDescPrompt:Bp,tagPrompt:jp,categoryPrompt:Kp},zp="modulepreload",Wp=function(c,o){return new URL(c,o).href},Wn={},Fp=function(o,t,s){let e=Promise.resolve();if(t&&t.length>0){const a=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),i=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));e=Promise.all(t.map(l=>{if(l=Wp(l,s),l in Wn)return;Wn[l]=!0;const u=l.endsWith(".css"),r=u?'[rel="stylesheet"]':"";if(!!s)for(let p=a.length-1;p>=0;p--){const g=a[p];if(g.href===l&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${r}`))return;const y=document.createElement("link");if(y.rel=u?"stylesheet":zp,u||(y.as="script",y.crossOrigin=""),y.href=l,i&&y.setAttribute("nonce",i),document.head.appendChild(y),u)return new Promise((p,g)=>{y.addEventListener("load",p),y.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${l}`)))})}))}return e.then(()=>o()).catch(a=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=a,window.dispatchEvent(n),!n.defaultPrevented)throw a})};var hn=(c=>(c[c.MAX_INPUT_TOKEN_LENGTH=3e3]="MAX_INPUT_TOKEN_LENGTH",c))(hn||{}),oo={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const Ot=()=>{const c=W("use-chatgpt"),{getReadOnlyPublishPreferenceSetting:o}=xt(),t=o();let s;const e=async()=>{if(s===void 0){const{ChatGPTAPI:i,ChatGPTUnofficialProxyAPI:l}=await Fp(()=>import("./chunks/chunk.vendor_chatgpt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75]),import.meta.url);try{T.isEmptyString(t.value.experimentalAIProxyUrl)?s=new i({apiKey:U.emptyOrDefault(oo.OPENAI_ACCESS_TOKEN,t.value.experimentalAICode),apiBaseUrl:U.emptyOrDefault(oo.OPENAI_BASE_URL,t.value.experimentalAIBaseUrl),debug:Rt,fetch:self.fetch.bind(self)}):s=new l({accessToken:U.emptyOrDefault(oo.OPENAI_API_KEY,t.value.experimentalAICode),apiReverseProxyUrl:U.emptyOrDefault(oo.OPENAI_PROXY_URL,t.value.experimentalAIProxyUrl),debug:Rt,fetch:self.fetch.bind(self)})}catch(u){throw c.error("Failed to initialize ChatGPT API:",u),u}}return s};return{getChatInput:(i,l)=>{const u=i.substring(0,hn.MAX_INPUT_TOKEN_LENGTH),r=Ut.parseHtml(l,hn.MAX_INPUT_TOKEN_LENGTH,!0);return U.emptyOrDefault(u,r)},chat:async(i,l)=>{try{const u=await e();c.debug("chat q =>",{q:i,opts:l});const r=await u.sendMessage(i,l);return c.debug("chat res =>",r),r.text}catch(u){c.error("Chat encountered an error:",u)}}}},Jp=c=>(mt("data-v-b43988e6"),c=c(),ht(),c),qp={class:"category-box"},Yp={key:0},Xp={key:1},Zp={key:2},Qp=Jp(()=>k("div",{class:"form-item-bottom"},null,-1)),eu=F({__name:"PublishCategories",props:{useAi:{type:Boolean,default:!1},categoryType:{type:String,default:ee.CategoryType_None},categoryConfig:{type:Object,default:{}},categories:{type:Array,default:[]},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncCates"],setup(c,{emit:o}){const t=W("publish-categories"),{t:s}=Z(),e=c,a=re({useAi:e.useAi,categoryType:e.categoryType,categoryConfig:e.categoryConfig,categories:e.categories,isLoading:!1,recommCates:[],md:e.md,html:e.html});Je(()=>e.useAi,u=>{a.useAi=u}),Je(()=>e.html,u=>{a.html=u});const n=o,i=u=>{t.debug("sync single cates =>",{cates:le(u)}),a.categories=u,n("emitSyncCates",u)},l=async()=>{try{a.isLoading=!0;const u=Fs.categoryPrompt.content,{chat:r,getChatInput:h}=Ot(),y=await r(u,{name:"categories",systemMessage:h(a==null?void 0:a.md,a.html)});if(T.isEmptyString(y)){Q.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const p=se.safeParse(y,{});if(!(p!=null&&p.categories)||(p==null?void 0:p.categories.length)==0)throw new Error("文档信息量太少，未能抽取有效信息");a.recommCates=p.categories,t.info("使用AI智能生成的分类结果 =>",{inputWord:u,chatText:y})}catch(u){t.error(s("main.opt.failure")+"=>",u),Q.error(s("main.opt.failure")+"=>"+u)}finally{a.isLoading=!1}};return(u,r)=>{const h=Rp,y=Sn,p=Ce,g=Se,_=Ne;return w(),O("div",qp,[a.categoryType===m(ee).CategoryType_Multi?(w(),O("div",Yp,[f(h,{"category-config":a.categoryConfig,"onUpdate:categoryConfig":r[0]||(r[0]=d=>a.categoryConfig=d),categories:a.categories,"onUpdate:categories":r[1]||(r[1]=d=>a.categories=d),onEmitSyncMultiCates:i},null,8,["category-config","categories"])])):(w(),O("div",Xp)),a.useAi&&a.categoryConfig.cateEnabled?(w(),O("div",Zp,[a.recommCates.length>0?(w(),C(p,{key:0,class:"recomm-show"},{default:b(()=>[R(" 推荐的分类： "),(w(!0),O(Ee,null,xe(a.recommCates,d=>(w(),C(y,{class:"ml-2 recomm-cate",type:"success"},{default:b(()=>[R(K(d),1)]),_:2},1024))),256))]),_:1})):Y("",!0),f(p,{class:"cat-action"},{default:b(()=>[f(g,{size:"small",loading:a.isLoading,type:"primary",onClick:l},{default:b(()=>[R(K(a.isLoading?m(s)("main.opt.loading"):m(s)("main.auto.fetch.cate")),1)]),_:1},8,["loading"])]),_:1}),f(p,null,{default:b(()=>[f(_,{closable:!1,title:m(s)("category.ai.hand"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1}),Qp])):Y("",!0)])}}}),tu=pe(eu,[["__scopeId","data-v-b43988e6"]]),su={class:"form-tags"},ou=F({__name:"PublishTags",props:{useAi:{type:Boolean,default:!1},pageId:{type:String,default:""},tags:{type:String,default:""},tagConfig:{type:Object,default:{}},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncTags"],setup(c,{emit:o}){const t=W("publish-tags"),{t:s}=Z(),e=c,a=J(),n=re({isTagLoading:!1,useAi:e.useAi,pageId:e.pageId,tagConfig:e.tagConfig,tag:{inputValue:"",dynamicTags:T.isEmptyString(e.tags)?[]:e.tags.split(","),platformTags:[],inputVisible:!1,selectVisible:!0},md:e.md,html:e.html});Je(()=>e.useAi,r=>{n.useAi=r}),Je(()=>e.html,r=>{n.html=r});const i=o,l={handleTagClose:r=>{n.tag.dynamicTags.splice(n.tag.dynamicTags.indexOf(r),1),i("emitSyncTags",n.tag.dynamicTags)},tagShowInput:()=>{n.tag.inputVisible=!0,_n(()=>{a.value.input.focus()})},tagShowSelect:()=>{n.tag.selectVisible=!n.tag.selectVisible},handleTagInputConfirm:()=>{n.tag.inputValue&&(n.tag.dynamicTags.includes(n.tag.inputValue)||n.tag.dynamicTags.push(n.tag.inputValue),n.tag.platformTags.includes(n.tag.inputValue)||n.tag.platformTags.push({value:n.tag.inputValue,label:n.tag.inputValue}),i("emitSyncTags",n.tag.dynamicTags)),n.tag.inputVisible=!1,n.tag.inputValue=""},fetchTag:async()=>{try{n.isTagLoading=!0;const r=Fs.tagPrompt.content,{chat:h,getChatInput:y}=Ot(),p=await h(r,{name:"tags",systemMessage:y(n==null?void 0:n.md,n.html)});if(T.isEmptyString(p)){Q.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const g=se.safeParse(p,{});if(!(g!=null&&g.tags)||(g==null?void 0:g.tags.length)==0)throw new Error("文档信息量太少，未能抽取有效信息");for(let _=0;_<g.tags.length;_++)n.tag.dynamicTags.includes(g.tags[_])||n.tag.dynamicTags.push(g.tags[_]);t.info("使用AI智能生成的标签结果 =>",{inputWord:r,chatText:p}),i("emitSyncTags",n.tag.dynamicTags),Q.success("使用人工智能智能提取标签成功")}catch(r){t.error(s("main.opt.failure")+"=>",r),Q.error(s("main.opt.failure")+"=>"+r)}finally{n.isTagLoading=!1}},onPlatformTagChange:r=>{const h=r;t.debug("选中项已改变 =>",h),i("emitSyncTags",n.tag.dynamicTags)}},u=async()=>{var r,h,y,p;if((r=n==null?void 0:n.tagConfig)!=null&&r.cfg&&((h=n==null?void 0:n.tagConfig)!=null&&h.apiType)){const g=(y=n==null?void 0:n.tagConfig)==null?void 0:y.cfg,d=await(await _e.getAdaptor((p=n==null?void 0:n.tagConfig)==null?void 0:p.apiType,g)).getTags();n.tag.platformTags=d.map(v=>({value:v.tagName,label:v.tagName})),t.debug("getTags for platforms",n.tag.platformTags)}else t.warn("tagConfig not found, ignore tags")};return Ye(async()=>{await u()}),(r,h)=>{const y=Sn,p=Ie,g=Se,_=Ce,d=So;return w(),O("div",su,[f(_,{label:m(s)("main.tag")},{default:b(()=>[(w(!0),O(Ee,null,xe(n.tag.dynamicTags,v=>(w(),C(y,{key:v,"disable-transitions":!1,class:"mx-1 pub-tag",closable:"",onClose:P=>l.handleTagClose(v)},{default:b(()=>[R(K(v),1)]),_:2},1032,["onClose"]))),128)),n.tag.inputVisible?(w(),C(p,{key:0,ref_key:"tagRefInput",ref:a,modelValue:n.tag.inputValue,"onUpdate:modelValue":h[0]||(h[0]=v=>n.tag.inputValue=v),class:"ml-1 w-20 pub-tag-input",size:"small",onBlur:l.handleTagInputConfirm,onKeyup:qn(l.handleTagInputConfirm,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(w(),C(g,{key:1,class:"button-new-tag ml-1 el-tag",size:"small",onClick:l.tagShowInput},{default:b(()=>[R(K(m(s)("main.tag.new")),1)]),_:1},8,["onClick"])),n.tag.platformTags.length>0?(w(),C(g,{key:2,class:"button-new-tag ml-1 el-tag",size:"small",onClick:l.tagShowSelect},{default:b(()=>[R(K(n.tag.selectVisible?m(s)("main.tag.close"):m(s)("main.tag.select")),1)]),_:1},8,["onClick"])):Y("",!0)]),_:1},8,["label"]),n.tag.platformTags.length>0&&n.tag.selectVisible?(w(),C(_,{key:0},{default:b(()=>[f(d,{modelValue:n.tag.dynamicTags,"onUpdate:modelValue":h[1]||(h[1]=v=>n.tag.dynamicTags=v),style:{width:"100%"},data:n.tag.platformTags,multiple:"","check-on-click-node":!0,"render-after-expand":!1,"show-checkbox":"",placeholder:m(s)("main.tag.select"),"empty-text":m(s)("main.tag.empty"),"no-data-text":m(s)("main.tag.empty"),onNodeClick:l.onPlatformTagChange,onCheck:l.onPlatformTagChange,onChange:l.onPlatformTagChange},null,8,["modelValue","data","placeholder","empty-text","no-data-text","onNodeClick","onCheck","onChange"])]),_:1})):Y("",!0),n.useAi?(w(),C(_,{key:1},{default:b(()=>[f(g,{size:"small",loading:n.isTagLoading,type:"primary",onClick:l.fetchTag},{default:b(()=>[R(K(n.isTagLoading?m(s)("main.opt.loading"):m(s)("main.auto.fetch.tag")),1)]),_:1},8,["loading","onClick"])]),_:1})):Y("",!0)])}}}),Di=pe(ou,[["__scopeId","data-v-e05259e4"]]),au={class:"form-desc"},Oi=F({__name:"PublishDescription",props:{useAi:{type:Boolean,default:!1},pageId:{type:String,default:""},desc:{type:String,default:""},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncDesc"],setup(c,{emit:o}){const t=W("publish-description"),{t:s}=Z(),e=c,a=re({isDescLoading:!1,useAi:e.useAi,pageId:e.pageId,desc:e.desc,md:e.md,html:e.html});Je(()=>e.useAi,u=>{a.useAi=u}),Je(()=>e.html,u=>{a.html=u});const n=o,i=async()=>{a.isDescLoading=!0;try{const u=Fs.shortDescPrompt.content,{chat:r,getChatInput:h}=Ot(),y=await r(u,{name:"desc",systemMessage:h(a==null?void 0:a.md,a.html)});if(T.isEmptyString(y)){Q.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const p=se.safeParse(y,{});if(T.isEmptyString(p==null?void 0:p.desc))throw new Error("文档信息量太少，未能抽取有效信息");a.desc=p.desc,t.info("使用AI智能生成的摘要结果 =>",{inputWord:u,chatText:y}),n("emitSyncDesc",a.desc),Q.success("使用人工智能提取摘要成功")}catch(u){t.error(s("main.opt.failure")+"=>",u),Q.error(s("main.opt.failure")+"=>"+u)}finally{a.isDescLoading=!1}},l=()=>{n("emitSyncDesc",a.desc)};return(u,r)=>{const h=Ie,y=Ce,p=Se;return w(),O("div",au,[f(y,{label:m(s)("main.desc")},{default:b(()=>[f(h,{modelValue:a.desc,"onUpdate:modelValue":r[0]||(r[0]=g=>a.desc=g),autosize:{minRows:3,maxRows:16},type:"textarea",placeholder:"请输入文章摘要",onInput:l},null,8,["modelValue"])]),_:1},8,["label"]),a.useAi?(w(),C(y,{key:0},{default:b(()=>[f(p,{size:"small",loading:a.isDescLoading,type:"primary",onClick:i},{default:b(()=>[R(K(a.isDescLoading?m(s)("main.opt.loading"):m(s)("main.auto.fetch.desc")),1)]),_:1},8,["loading"])]),_:1})):Y("",!0)])}}}),nu=c=>(mt("data-v-33e4b926"),c=c(),ht(),c),iu={key:1,class:"single-tag-slug"},lu=nu(()=>k("div",{class:"form-item-bottom"},null,-1)),ru=F({__name:"SingleTagSlug",props:{cfg:{type:Object,default:{}},apiType:{type:String,default:""},tagSlugs:{type:String,default:""}},emits:["emitSyncTagSlugs"],setup(c,{emit:o}){const t=W("single-tag-slugs");Z();const s=c,e=re({cfg:s.cfg,apiType:s.apiType,tagSlugs:T.isEmptyString(s.tagSlugs)?[]:s.tagSlugs.split(","),tag:{tagSelected:"",tagList:[]},isInit:!1}),a=o,n=l=>{const u=l;t.debug("value=>",u),t.debug("label=>",u);const r=[];r.push(u),e.tagSlugs=r,t.debug("cateSlugs=>",e.tagSlugs),a("emitSyncTagSlugs",r)},i=async()=>{var h;let l=[];const u=e.cfg;l=await(await _e.getAdaptor(e.apiType,u)).getTags(),t.debug("getTags for single slug tag",l),l.length>0&&(e.tag.tagList=l.map(y=>({value:y.tagId,label:y.tagName})),e.tag.tagSelected=((h=e.tagSlugs)==null?void 0:h[0])??"",t.debug("读取已有别名标签 =>",{tagSlugs:le(e.tagSlugs)}))};return Ye(async()=>{try{await i()}catch(l){t.error("别名标签加载失败",l)}finally{e.isInit=!0}}),(l,u)=>{const r=Dt,h=rt,y=ct,p=Ce;return e.isInit?(w(),O("div",iu,[f(p,{label:"标签"},{default:b(()=>[f(y,{modelValue:e.tag.tagSelected,"onUpdate:modelValue":u[0]||(u[0]=g=>e.tag.tagSelected=g),placeholder:"请选择","no-data-text":"暂无数据",class:"m-2",size:"default",onChange:n},{default:b(()=>[(w(!0),O(Ee,null,xe(e.tag.tagList,g=>(w(),C(h,{key:g.value,label:g.label,value:g.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),lu])):(w(),C(r,{key:0,class:"placeholder",rows:1,animated:""}))}}}),cu=pe(ru,[["__scopeId","data-v-33e4b926"]]);var Ze=(c=>(c[c.YAML=0]="YAML",c[c.MD_CONTENT=1]="MD_CONTENT",c[c.YAML_MD_CONTENT=2]="YAML_MD_CONTENT",c[c.HTML_CONTENT=3]="HTML_CONTENT",c))(Ze||{});const pu={key:1,class:"source-mode"},uu={class:"source-opt"},du={key:2,id:"yaml-edit-content"},gu={key:3,id:"yaml-detail-content"},mu={id:"yaml-read-mode-tip"},hu=F({__name:"SourceMode",props:{modelValue:{type:Object,default:{}},pageId:{type:String,default:""},apiType:{type:String,default:""},cfg:{type:Object,default:{}}},emits:["emitSyncPost","edmtSyncToSiyuan"],async setup(c,{emit:o}){let t,s;const e=W("source-mode"),{t:a}=Z(),{handlePicgo:n}=Do(),i=c,l=re({isLoading:!1,stype:Ze.MD_CONTENT,contentReadonlyMode:!0,readonlyMode:T.isEmptyString(i.apiType),syncStatus:"info",syncMessage:"未修改",pageId:i.pageId,apiType:i.apiType,cfg:i.cfg,yamlAdaptor:{},yamlFormatObj:{},siyuanPost:i.modelValue,yamlContent:"",isSaved:!0}),u=o,r=P=>{switch(l.stype=P,P){case Ze.YAML:l.contentReadonlyMode=!1,_(l.yamlFormatObj.formatter);break;case Ze.MD_CONTENT:l.contentReadonlyMode=!0,_(l.yamlFormatObj.mdContent);break;case Ze.YAML_MD_CONTENT:l.contentReadonlyMode=!0,_(l.yamlFormatObj.mdFullContent);break;case Ze.HTML_CONTENT:l.contentReadonlyMode=!0,_(l.yamlFormatObj.htmlContent);break}},h=P=>{if(P.preventDefault(),P.target.select(),Ht.isInBrowser)try{Ht.copyToClipboardInBrowser(l.yamlContent),Q.success(a("main.copy.success"))}catch(E){e.error(a("main.copy.failure"),E),Q.error(a("main.copy.failure")+"=>"+E)}},y=P=>{e.debug("仅在常规发布使用"),l.isSaved=!1,l.syncStatus="info",l.syncMessage="已修改"},p=()=>{l.yamlFormatObj.formatter=l.yamlContent,l.yamlFormatObj.mdFullContent=ne.addYamlToMd(l.yamlFormatObj.formatter,l.yamlFormatObj.mdContent),e.debug("val =>",l.yamlContent);try{const P=ne.yaml2Obj(l.yamlFormatObj.formatter);l.yamlFormatObj.yamlObj=P,l.siyuanPost=l.yamlAdaptor.convertToAttr(l.siyuanPost,l.yamlFormatObj,l.cfg),e.debug("准备emit =>",{post:le(l.siyuanPost)}),u("emitSyncPost",l.siyuanPost),u("edmtSyncToSiyuan"),l.syncStatus="success",l.syncMessage="YAML已解析成功并同步。同步时间 =>"+Me.formatIsoToZh(new Date().toISOString(),!0),l.isSaved=!0}catch(P){l.syncStatus="error",l.syncMessage="YAML解析失败，YAML将不可用，错误如下 =>"+P,e.error("YAML解析失败",P)}},g=P=>{P.preventDefault()},_=async P=>{l.yamlContent=P},d=async P=>{let S=new gt;switch(P.yamlType){case qt.Yaml_custom_auto:{const E=l.apiType;S=l.yamlAdaptor.convertToYaml(P,void 0,l.cfg),e.debug("常规发布，自动生成对应平台的YAML, =>",E);break}case qt.Yaml_custom_hand:{const E=new gt,M=await ne.yaml2ObjAsync(P.yaml);E.yamlObj=M,S=l.yamlAdaptor.convertToYaml(P,E,l.cfg),e.debug("常规发布，修改过YAML");break}default:{const E=wn.toYamlObj(l.siyuanPost);S.formatter=ne.obj2Yaml(E),S.mdContent=P.markdown,S.mdFullContent=ne.addYamlToMd(S.formatter,S.mdContent),S.htmlContent=P.html,e.debug("未找到YAML适配器，将生成公共的YAML");break}}l.yamlFormatObj=S,r(l.stype),e.info("编辑模式到 YAML 的同步已完成")},v=async()=>{l.isLoading=!0;try{const P=l.siyuanPost,S=l.pageId,E=await n(S,P.markdown);P.markdown=E,l.yamlAdaptor=l.readonlyMode?null:await _e.getYamlAdaptor(l.apiType,l.cfg),l.readonlyMode=l.yamlAdaptor===null,l.readonlyMode||(l.stype=Ze.YAML),await d(P),e.debug(`init Page in source mode, readonlyMode: ${l.readonlyMode} =>`,{siyuanPost:le(l.siyuanPost)})}catch(P){Q.error(P.message),e.error(a("main.opt.failure")+"=>",P)}finally{l.isLoading=!1}};return[t,s]=Ue(()=>v()),await t,s(),(P,S)=>{const E=Dt,M=Ce,x=Ne,z=Ie;return l.isLoading?(w(),C(E,{key:0,class:"placeholder",rows:5,animated:""})):(w(),O("div",pu,[l.isSaved?Y("",!0):(w(),C(M,{key:0,class:"un-saved-tip"},{default:b(()=>[R(" 检测到有未保存的更改，是否保存？"),k("a",{onClick:p},"马上保存")]),_:1})),l.readonlyMode?Y("",!0):(w(),C(M,{key:1},{default:b(()=>[f(x,{closable:!1,title:l.syncMessage,class:"top-yaml-tip",type:l.syncStatus},null,8,["title","type"])]),_:1})),k("div",uu,[f(M,null,{default:b(()=>[k("a",{class:Jt({current:l.stype===m(Ze).YAML}),onClick:S[0]||(S[0]=L=>r(m(Ze).YAML))},K(m(a)("yaml.show.type.yaml")),3),k("a",{class:Jt({current:l.stype===m(Ze).MD_CONTENT,middle:!0}),onClick:S[1]||(S[1]=L=>r(m(Ze).MD_CONTENT))},K(m(a)("yaml.show.type.md")),3),k("a",{class:Jt({current:l.stype===m(Ze).YAML_MD_CONTENT,middle:!0}),onClick:S[2]||(S[2]=L=>r(m(Ze).YAML_MD_CONTENT))},K(m(a)("yaml.show.type.yamlmd")),3),k("a",{class:Jt({current:l.stype===m(Ze).HTML_CONTENT}),onClick:S[3]||(S[3]=L=>r(m(Ze).HTML_CONTENT))},K(m(a)("yaml.show.type.html")),3)]),_:1})]),!l.contentReadonlyMode&&!l.readonlyMode?(w(),O("div",du,[f(M,null,{default:b(()=>[f(z,{modelValue:l.yamlContent,"onUpdate:modelValue":S[4]||(S[4]=L=>l.yamlContent=L),autosize:{minRows:4,maxRows:16},type:"textarea",onInput:y},null,8,["modelValue"])]),_:1})])):(w(),O("div",gu,[f(M,null,{default:b(()=>[f(z,{id:"yaml-detail-preview",modelValue:l.yamlContent,"onUpdate:modelValue":S[5]||(S[5]=L=>l.yamlContent=L),autosize:{minRows:4,maxRows:16},readonly:"",type:"textarea",class:"readonly-textarea",onClick:h,onContextmenu:g},null,8,["modelValue"])]),_:1})])),k("div",mu,[f(M,null,{default:b(()=>[l.readonlyMode?(w(),C(x,{key:0,class:"top-yaml-tip",closable:!1,title:m(a)("main.read.mode.tip1"),type:"error"},null,8,["title"])):Y("",!0)]),_:1})])]))}}}),Vi=pe(hu,[["__scopeId","data-v-89f0f328"]]),fu={class:"form-edit-mode"},$i=F({__name:"EditModeSelect",props:{editType:{type:Number,default:Fe.EditMode_simple}},emits:["emitSyncEditMode"],setup(c,{emit:o}){const{t}=Z(),s=c,e=re({etype:s.editType});Je(()=>s.editType,i=>{e.etype=i});const a=o,n=i=>{e.etype=i,a("emitSyncEditMode",i)};return(i,l)=>{const u=Se,r=Ll,h=Ce;return w(),O("div",fu,[f(h,{label:m(t)("main.publish.editmode")},{default:b(()=>[f(r,null,{default:b(()=>[f(u,{type:e.etype===m(Fe).EditMode_simple?"primary":"default",onClick:l[0]||(l[0]=y=>n(m(Fe).EditMode_simple))},{default:b(()=>[R(K(m(t)("main.publish.editmode.simple")),1)]),_:1},8,["type"]),f(u,{type:e.etype===m(Fe).EditMode_complex?"primary":"default",onClick:l[1]||(l[1]=y=>n(m(Fe).EditMode_complex))},{default:b(()=>[R(K(m(t)("main.publish.editmode.complex")),1)]),_:1},8,["type"]),f(u,{type:e.etype===m(Fe).EditMode_source?"primary":"default",onClick:l[2]||(l[2]=y=>n(m(Fe).EditMode_source))},{default:b(()=>[R(K(m(t)("main.publish.editmode.source")),1)]),_:1},8,["type"])]),_:1})]),_:1},8,["label"])])}}}),yu={class:"form-publish-time"},Ni=F({__name:"PublishTime",props:{modelValue:{type:Object,default:{}}},emits:["emitSyncPublishTime"],setup(c,{emit:o}){var i,l,u;const{t}=Z(),s=c,e=re({dateCreatedString:Me.formatIsoToZh((l=(i=s.modelValue)==null?void 0:i.dateCreated)==null?void 0:l.toISOString(),!0),dateUpdatedString:Me.formatIsoToZh((((u=s.modelValue)==null?void 0:u.dateUpdated)??new Date).toISOString(),!0)}),a=o,n=()=>{const r=Me.convertStringToDate(e.dateCreatedString),h=Me.convertStringToDate(e.dateUpdatedString);a("emitSyncPublishTime",r,h)};return(r,h)=>{const y=Hl,p=Ce;return w(),O("div",yu,[f(p,{label:m(t)("main.create.time")},{default:b(()=>[f(y,{modelValue:e.dateCreatedString,"onUpdate:modelValue":h[0]||(h[0]=g=>e.dateCreatedString=g),placeholder:m(t)("main.create.time.placeholder"),format:"YYYY-MM-DD HH:mm:ss",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",onChange:n},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),f(p,{label:m(t)("main.update.time")},{default:b(()=>[f(y,{modelValue:e.dateUpdatedString,"onUpdate:modelValue":h[1]||(h[1]=g=>e.dateUpdatedString=g),placeholder:m(t)("main.update.time.placeholder"),format:"YYYY-MM-DD HH:mm:ss",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",onChange:n},null,8,["modelValue","placeholder"])]),_:1},8,["label"])])}}}),bu=c=>(mt("data-v-15baacab"),c=c(),ht(),c),_u={key:0,class:"tree-single-cateslugs"},wu=bu(()=>k("div",{class:"form-item-bottom"},null,-1)),vu=F({__name:"TreeSingleKnowledgeSpace",props:{knowledgeSpaceConfig:{type:Object,default:{}},cateSlugs:{type:Array,default:[]}},emits:["emitSyncTreeSingleCateSlugs"],setup(c,{emit:o}){const t=W("tree-single-cateslugs"),{t:s}=Z(),e=c,a=re({knowledgeSpaceConfig:e.knowledgeSpaceConfig,cateSlugs:e.cateSlugs,path:{customPath:"",cacheData:[],customProps:{label:"label",children:"children",isLeaf:"isLeaf"}}}),n=o,i=async(u,r)=>{if(u.isLeaf)return r([]);const h=a.knowledgeSpaceConfig.cfg,y=await _e.getAdaptor(a.knowledgeSpaceConfig.apiType,h);let p,g=u.data.value||"";g===""&&a.path.customPath!==""?p="":(g===""&&(g=""),p=g);const _=await y.getCategoryTreeNodes(p);r(_)},l=u=>{if(t.debug("onSelectChange=>",u),u.isLeaf){Q.error("您当前选择的是页面，请注意，页面必须发布在目录下");return}const r=u.value,h=[];h.push(r),n("emitSyncTreeSingleCateSlugs",h)};return Ye(()=>{var r,h,y;const u=((r=a.cateSlugs)==null?void 0:r[0])??((y=(h=a.knowledgeSpaceConfig)==null?void 0:h.cfg)==null?void 0:y.blogid);a.path.customPath=u,a.path.customPath.includes(_o)&&(a.knowledgeSpaceConfig.readonlyMode=!0,a.knowledgeSpaceConfig.cfg.placeholder.knowledgeSpaceReadonlyModeTip="当前为自动映射目录模式，将根据笔记层级自动生成目录😄"),t.debug("init tree data, cateSlugs =>",{cateSlugs:le(a.cateSlugs)})}),(u,r)=>{const h=So,y=Ce,p=Ne;return a.knowledgeSpaceConfig.cateEnabled?(w(),O("div",_u,[f(y,{label:m(s)("main.publish.github.choose.path")},{default:b(()=>[f(h,{modelValue:a.path.customPath,"onUpdate:modelValue":r[0]||(r[0]=g=>a.path.customPath=g),lazy:"",load:i,props:a.path.customProps,"check-strictly":!0,"empty-text":m(s)("main.data.empty"),"no-data-text":m(s)("main.data.empty"),placeholder:m(s)("main.opt.select"),disabled:a.knowledgeSpaceConfig.readonlyMode,onNodeClick:l},null,8,["modelValue","props","empty-text","no-data-text","placeholder","disabled"])]),_:1},8,["label"]),a.knowledgeSpaceConfig.readonlyMode?(w(),C(y,{key:0},{default:b(()=>{var g,_;return[f(p,{closable:!1,title:(_=(g=a.knowledgeSpaceConfig.cfg)==null?void 0:g.placeholder)==null?void 0:_.knowledgeSpaceReadonlyModeTip,class:"form-item-tip",type:"warning"},null,8,["title"])]}),_:1})):Y("",!0),wu])):Y("",!0)}}}),Pu=pe(vu,[["__scopeId","data-v-15baacab"]]),Tu=c=>(mt("data-v-a71bed2e"),c=c(),ht(),c),ku={key:1,class:"single-knowledge-space"},Su=Tu(()=>k("div",{class:"form-item-bottom"},null,-1)),Eu=F({__name:"SingleKnowledgeSpace",props:{knowledgeSpaceConfig:{type:Object,default:{}},cateSlugs:{type:Array,default:[]}},emits:["emitSyncSingleCateSlugs"],setup(c,{emit:o}){const t=W("single-knowledge-space"),{t:s}=Z(),e=c,a=J(null),n=re({knowledgeSpaceConfig:e.knowledgeSpaceConfig,cateSlugs:e.cateSlugs,cate:{categorySelected:"",categoryList:[]},ksKeyword:"",isCateLoading:!1,isInit:!1}),i=o,l=yn(()=>{var p,g;return((g=(p=n==null?void 0:n.knowledgeSpaceConfig)==null?void 0:p.cfg)==null?void 0:g.knowledgeSpaceTitle)??s("main.cat")}),u=y=>{const p=y;t.debug("value=>",p),t.debug("label=>",p);const g=[];g.push(p),n.cateSlugs=g,t.debug("cateSlugs=>",n.cateSlugs),i("emitSyncSingleCateSlugs",g)},r=async()=>{try{n.isCateLoading=!0,t.debug("reload categories for single category woth search"),n.cate.categoryList=[],n.cate.categorySelected=void 0,await h(!1),a.value.visible=!0}catch(y){t.error("知识空间加载失败",y)}finally{n.isCateLoading=!1,n.isInit=!0}},h=async y=>{var d;let p=[];const g=n.knowledgeSpaceConfig.cfg;p=await(await _e.getAdaptor(n.knowledgeSpaceConfig.apiType,g)).getCategories(n.ksKeyword),t.debug("getCategories for single category",p),p.length>0&&(n.cate.categoryList=p.map(v=>({value:v.categoryId,label:v.categoryName})),y&&(n.cate.categorySelected=((d=n.cateSlugs)==null?void 0:d[0])??g.blogid??"",t.debug("读取已有知识空间 =>",{cateSlugs:le(n.cateSlugs)})))};return Ye(async()=>{var y,p;try{n.isCateLoading=!0,await h(!0),(p=(y=n==null?void 0:n.cate)==null?void 0:y.categorySelected)!=null&&p.toString().includes(_o)&&(n.knowledgeSpaceConfig.readonlyMode=!0,n.knowledgeSpaceConfig.readonlyModeTip="当前为自动映射目录模式，将根据笔记层级自动生成目录😄")}catch(g){t.error("知识空间加载失败",g)}finally{n.isCateLoading=!1,n.isInit=!0}}),(y,p)=>{var E,M;const g=Dt,_=Ie,d=Ce,v=rt,P=ct,S=Ne;return n.isInit?(w(),O("div",ku,[!n.knowledgeSpaceConfig.readonlyMode&&((M=(E=n.knowledgeSpaceConfig)==null?void 0:E.cfg)!=null&&M.cateSearchEnabled)?(w(),C(d,{key:0,class:"cate-input",label:"搜索关键词"},{default:b(()=>[f(_,{modelValue:n.ksKeyword,"onUpdate:modelValue":p[0]||(p[0]=x=>n.ksKeyword=x),placeholder:"请输入["+l.value+"]搜索关键词，输入完成后请按Enter键或者移走光标",onChange:r},null,8,["modelValue","placeholder"])]),_:1})):Y("",!0),f(d,{label:l.value},{default:b(()=>[f(P,{modelValue:n.cate.categorySelected,"onUpdate:modelValue":p[1]||(p[1]=x=>n.cate.categorySelected=x),placeholder:"请选择","no-data-text":"暂无数据",class:"m-2",size:"default",onChange:u,disabled:n.knowledgeSpaceConfig.readonlyMode,loading:n.isCateLoading,"loading-text":"加载中...",ref_key:"singleCateSelect",ref:a},{default:b(()=>[(w(!0),O(Ee,null,xe(n.cate.categoryList,x=>(w(),C(v,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","loading"])]),_:1},8,["label"]),n.knowledgeSpaceConfig.readonlyMode?(w(),C(d,{key:1},{default:b(()=>[f(S,{closable:!1,title:n.knowledgeSpaceConfig.readonlyModeTip,class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})):Y("",!0),Su])):(w(),C(g,{key:0,class:"placeholder",rows:1,animated:""}))}}}),Cu=pe(Eu,[["__scopeId","data-v-a71bed2e"]]),Au={key:0},Uu={key:1},Iu={key:2},xu=F({__name:"PublishKnowledgeSpace",props:{knowledgeSpaceType:{type:String,default:ee.CategoryType_None},knowledgeSpaceConfig:{type:Object,default:{}},cateSlugs:{type:Array,default:[]}},emits:["emitSyncCateSlugs"],setup(c,{emit:o}){const t=W("publish-categories"),s=c,e=re({knowledgeSpaceType:s.knowledgeSpaceType,knowledgeSpaceConfig:s.knowledgeSpaceConfig,cateSlugs:s.cateSlugs}),a=o,n=i=>{t.debug("sync single cateSlugs =>",{cateSlugs:le(i)}),a("emitSyncCateSlugs",i)};return(i,l)=>{const u=Cu,r=Pu;return e.knowledgeSpaceType===m(ee).CategoryType_Single?(w(),O("div",Au,[f(u,{"knowledge-space-config":e.knowledgeSpaceConfig,"onUpdate:knowledgeSpaceConfig":l[0]||(l[0]=h=>e.knowledgeSpaceConfig=h),"cate-slugs":e.cateSlugs,"onUpdate:cateSlugs":l[1]||(l[1]=h=>e.cateSlugs=h),onEmitSyncSingleCateSlugs:n},null,8,["knowledge-space-config","cate-slugs"])])):e.knowledgeSpaceType===m(ee).CategoryType_Tree_Single?(w(),O("div",Uu,[f(r,{"knowledge-space-config":e.knowledgeSpaceConfig,"onUpdate:knowledgeSpaceConfig":l[2]||(l[2]=h=>e.knowledgeSpaceConfig=h),"cate-slugs":e.cateSlugs,"onUpdate:cateSlugs":l[3]||(l[3]=h=>e.cateSlugs=h),onEmitSyncTreeSingleCateSlugs:n},null,8,["knowledge-space-config","cate-slugs"])])):(w(),O("div",Iu))}}}),Mu={class:"form-post-title"},Li=F({__name:"PublishTitle",props:{useAi:{type:Boolean,default:!1},modelValue:{type:String,default:""},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncPublishTitle"],setup(c,{emit:o}){const t=W("publish-title"),{t:s}=Z(),e=c,a=re({postTitle:e.modelValue,isLoading:!1,useAi:e.useAi,md:e.md,html:e.html});Je(()=>e.useAi,u=>{a.useAi=u}),Je(()=>e.modelValue,u=>{a.postTitle=u}),Je(()=>e.md,u=>{a.md=u}),Je(()=>e.html,u=>{a.html=u});const n=o,i=()=>{n("emitSyncPublishTitle",a.postTitle)},l=async()=>{try{a.isLoading=!0;const u=Fs.titlePrompt.content,{chat:r,getChatInput:h}=Ot(),y=await r(u,{name:"title",systemMessage:h(a==null?void 0:a.md,a.html)});if(T.isEmptyString(y)){Q.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const p=se.safeParse(y,{});if(T.isEmptyString(p==null?void 0:p.title))throw new Error("文档信息量太少，未能抽取有效信息");a.postTitle=p.title,t.info("使用AI智能生成的标题结果 =>",{inputWord:u,chatText:y}),n("emitSyncPublishTitle",a.postTitle),Q.success("使用人工智能提取标题成功")}catch(u){t.error(s("main.opt.failure")+"=>",u),Q.error(s("main.opt.failure")+"=>"+u)}finally{a.isLoading=!1}};return(u,r)=>{const h=Ie,y=Ce,p=Se;return w(),O("div",Mu,[f(y,{label:m(s)("main.title")},{default:b(()=>[f(h,{modelValue:a.postTitle,"onUpdate:modelValue":r[0]||(r[0]=g=>a.postTitle=g),onInput:i},null,8,["modelValue"])]),_:1},8,["label"]),a.useAi?(w(),C(y,{key:0},{default:b(()=>[f(p,{size:"small",loading:a.isLoading,type:"primary",onClick:l},{default:b(()=>[R(K(a.isLoading?m(s)("main.opt.loading"):m(s)("main.auto.fetch.title")),1)]),_:1},8,["loading"])]),_:1})):Y("",!0)])}}}),Du={key:1,id:"batch-publish-index"},Ou={class:"publish-form"},Vu={key:1,class:"normal-mode"},$u={key:2,class:"complex-mode"},Nu=["href","title"],Lu=F({__name:"SinglePublishDoPublish",setup(c){const o=W("single-publish-do-publish"),{t}=Z(),s=qe(),{query:e}=qe(),{kernelApi:a}=Ge(),{doSinglePublish:n,doSingleDelete:i,initPublishMethods:l,doForceSingleDelete:u}=Ks(),r=wt(),{getPublishCfg:h}=js(),y=Ke.systemCfg.map(V=>V.platformKey),p=re(s.params),g=p.key,_=p.id,d=re({isInit:!1,method:e.method,isPublishLoading:!1,isDeleteLoading:!1,errMsg:"",siyuanPost:{},platformPost:{},mergedPost:{},publishCfg:{},tagConfig:{},categoryConfig:{},knowledgeSpaceConfig:{},postPreviewUrl:"",useAi:!1,editType:Fe.EditMode_simple,actionEnable:!0}),v=async()=>{try{d.isPublishLoading=!0,d.actionEnable=!1,Re.value=!1,d.errMsg="",o.info("保存到系统平台开始");for(const B of y){const ye=await h(B),et=we.cloneDeep(d.mergedPost);await n(B,_,ye,et)}o.info("保存到系统平台结束"),o.info("单个常规发布开始"),d.mergedPost.editMode=d.editType;const V=await n(g,_,d.publishCfg,d.mergedPost);o.info("normal publish processResult =>",V),o.info("单个常规发布结束"),V.status?d.method===tt.METHOD_ADD?Q.success("文章发布成功！如需编辑请重新打开"):(d.actionEnable=!0,Q.success("文章更新成功！")):(d.actionEnable=!0,o.error(V.errMsg),d.errMsg=V.errMsg,Q.error(V.errMsg))}catch(V){o.error(t("main.opt.failure")+"=>",V),d.errMsg=V.toString(),Q.error(V.toString())}finally{d.isPublishLoading=!1,Re.value=!0}},P=async()=>{const V=L(),B=j();Pt.confirm(`确认要删除 [${V} - ${B}] 下的这篇文章吗，此平台的文章数据将永久删除 ？`,"温馨提示",{type:"error",icon:Ct(Vs),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{await S()}).catch(()=>{})},S=async()=>{try{d.isDeleteLoading=!0,d.actionEnable=!1,d.errMsg="";const V=await i(g,_,d.publishCfg);if(V.status){const B=L(),ye=j();Q.success(`[${B} - ${ye}] 文章删除成功`),setTimeout(()=>{d.method=tt.METHOD_ADD,window.location.href=Ht.setUrlParameter(window.location.href,"method",d.method),window.location.reload()},200)}else d.actionEnable=!0,o.error(V.errMsg),d.errMsg=V.errMsg,Q.error(V.errMsg)}catch(V){o.error(t("main.opt.failure")+"=>",V),d.errMsg=V.toString(),Q.error(V.toString())}finally{d.isDeleteLoading=!1}},E=async()=>{try{d.errMsg="",await u(g,_,d.publishCfg);const V=L(),B=j();Q.success(`[${V} - ${B}] 文章信息已强制删除`),setTimeout(()=>{d.method=tt.METHOD_ADD,window.location.href=Ht.setUrlParameter(window.location.href,"method",d.method),window.location.reload()},200)}catch(V){d.errMsg=V.message,Q.error(V.message)}finally{d.isDeleteLoading=!1}},M=async()=>{await x(),await z(),Q.success("属性已经成功同步到思源")},x=async()=>{var B,ye;const V={[st.Sys_memo]:d.mergedPost.shortDesc,[st.Sys_tags]:d.mergedPost.mt_keywords,[st.Custom_categories]:((ye=(B=d.mergedPost)==null?void 0:B.categories)==null?void 0:ye.join(","))??[]};await a.setBlockAttrs(_,V),o.debug("保存内置平台属性",V)},z=async()=>{const V=d.mergedPost.yaml,B=Ds(g);await a.setSingleBlockAttr(_,B,V),o.debug("保存当前平台属性",{yaml:le(V)})},L=()=>{var B;const V=(B=d.publishCfg)==null?void 0:B.dynCfg;return(V==null?void 0:V.platformName)||""},j=()=>{var ye,et,vt,nt,oe,de;const V=(ye=d.publishCfg)==null?void 0:ye.cfg;let B=(V==null?void 0:V.blogName)||"";if(V!=null&&V.knowledgeSpaceEnabled&&((vt=(et=d.mergedPost)==null?void 0:et.cate_slugs)==null?void 0:vt.length)>0){let ce;((oe=(nt=d.mergedPost)==null?void 0:nt.categories)==null?void 0:oe.length)>0?ce=(de=d.mergedPost)==null?void 0:de.categories[0]:ce="",B=ce??""}return B},I=yn(()=>{const V=L(),B=j();let ye="当前操作的平台为 - ";const et=V||g;return ye+=Mt.longPlatformName(et,11),B&&(ye+=" - "+B),ye}),A=async V=>{d.editType=V,o.debug("syncEditMode in single publish")},$=V=>{d.mergedPost.title=V,o.debug("syncPublishTitle in single publish")},q=V=>{d.mergedPost.shortDesc=V,d.mergedPost.mt_text_more=V,d.mergedPost.mt_excerpt=V,o.debug("syncDesc in single publish")},G=V=>{d.mergedPost.mt_keywords=V==null?void 0:V.join(","),o.debug("syncTags in single publish")},H=V=>{d.mergedPost.tags_slugs=V==null?void 0:V.join(","),o.debug("syncTagSlugs in single publish")},X=V=>{d.mergedPost.categories=V,o.debug("syncCates in single publish")},ve=V=>{d.mergedPost.cate_slugs=V,o.debug("syncCateSlugs in single publish")},Le=(V,B)=>{d.mergedPost.dateCreated=V,d.mergedPost.dateUpdated=B,o.debug("syncPublishTime in single publish")},Xe=(V,B)=>{d.mergedPost.post_status=V,d.mergedPost.wp_password=B,o.debug("syncPublishStatus in single publish")},Be=V=>{d.mergedPost=V,o.debug("syncPost in single publish")},ze=()=>{const V="/publish/singlePublish";o.info("will go to =>",V);const B={path:V,query:{id:_}};r.push(B)},He=async()=>{try{const{mergedPost:V,postPreviewUrl:B}=await l.doInitSinglePage(g,_,d.method,d.publishCfg);d.mergedPost=V,d.postPreviewUrl=B}catch(V){const B=t("main.opt.failure")+"=>"+V;throw o.error(t("main.opt.failure")+"=>",V),await a.pushErrMsg({msg:B,timeout:7e3}),V}},ie=()=>{let V=!1,B=0;for(;!V&&B<3;)try{Ot(),V=!0}catch(ye){o.error(`${t("main.opt.failure")} => ${ye}`),B++}return o.info(`第${B}次尝试就检测AI状态: ${V}`),V},Re=J(!1),{loadingTime:Vt}=zs(Re);return Ye(async()=>{var V,B;o.info("获取到的ID为=>",_);try{d.publishCfg=await h(g),await He(),d.mergedPost=await l.assignInitAttrs(d.mergedPost,_,d.publishCfg);const ye=d.publishCfg.cfg;d.tagConfig={apiType:g,cfg:ye},d.categoryConfig={cateEnabled:ye.cateEnabled,readonlyMode:d.method===tt.METHOD_EDIT&&!ye.allowCateChange,readonlyModeTip:(V=ye==null?void 0:ye.placeholder)==null?void 0:V.cateReadonlyModeTip,apiType:g,cfg:ye},d.knowledgeSpaceConfig={cateEnabled:ye.knowledgeSpaceEnabled,readonlyMode:d.method===tt.METHOD_EDIT&&!ye.allowKnowledgeSpaceChange,readonlyModeTip:(B=ye==null?void 0:ye.placeholder)==null?void 0:B.knowledgeSpaceReadonlyModeTip,apiType:g,cfg:ye},o.debug("single publish inited mergedPost =>",le(d.mergedPost)),d.useAi=ie(),d.editType=Fe.EditMode_simple}catch(ye){const et=t("main.opt.failure")+"=>"+ye;o.error(t("main.opt.failure")+"=>",ye),await a.pushErrMsg({msg:et,timeout:7e3})}finally{d.isInit=!0,Re.value=!0}}),(V,B)=>{const ye=Dt,et=Hs,vt=Ne,nt=Vi,oe=cu,de=Eo,ce=Ie,Te=Ce,$e=Oi,yt=Di,je=tu,kt=Np,pt=Se,Bt=Qe,hs=ai,fs=ni;return w(),C(Ve,{title:"常规发布","has-back-emit":!0,onBackEmit:ze},{default:b(()=>[d.isInit?(w(),O("div",Du,[f(et,{"loading-time":m(Vt)},null,8,["loading-time"]),f(vt,{class:"top-tip",title:I.value,type:"info",closable:!1},null,8,["title"]),d.useAi?(w(),C(vt,{key:0,class:"top-tip",title:m(t)("category.ai.enabled"),type:"success",closable:!0},null,8,["title"])):Y("",!0),m(T).isEmptyString(d.errMsg)?Y("",!0):(w(),C(vt,{key:1,class:"top-tip",title:d.errMsg,type:"error",closable:!0},null,8,["title"])),f(fs,null,{default:b(()=>[f(hs,null,{default:b(()=>[k("div",Ou,[f(Bt,{"label-width":"100px"},{default:b(()=>{var $t,he;return[f($i,{"edit-type":d.editType,"onUpdate:editType":B[0]||(B[0]=te=>d.editType=te),onEmitSyncEditMode:A},null,8,["edit-type"]),d.editType===m(Fe).EditMode_source?(w(),C(nt,{key:0,modelValue:d.mergedPost,"onUpdate:modelValue":B[1]||(B[1]=te=>d.mergedPost=te),"api-type":m(g),"page-id":m(_),cfg:d.publishCfg.cfg,onEmitSyncPost:Be,onEdmtSyncToSiyuan:M},null,8,["modelValue","api-type","page-id","cfg"])):(w(),O("div",Vu,[f(Li,{"use-ai":d.useAi,"onUpdate:useAi":B[2]||(B[2]=te=>d.useAi=te),modelValue:d.mergedPost.title,"onUpdate:modelValue":B[3]||(B[3]=te=>d.mergedPost.title=te),md:d.mergedPost.markdown,"onUpdate:md":B[4]||(B[4]=te=>d.mergedPost.markdown=te),html:d.mergedPost.html,"onUpdate:html":B[5]||(B[5]=te=>d.mergedPost.html=te),onEmitSyncPublishTitle:$},null,8,["use-ai","modelValue","md","html"]),($t=d.publishCfg.cfg)!=null&&$t.knowledgeSpaceEnabled?(w(),C(xu,{key:0,"knowledge-space-type":d.publishCfg.cfg.knowledgeSpaceType,"onUpdate:knowledgeSpaceType":B[6]||(B[6]=te=>d.publishCfg.cfg.knowledgeSpaceType=te),"knowledge-space-config":d.knowledgeSpaceConfig,"onUpdate:knowledgeSpaceConfig":B[7]||(B[7]=te=>d.knowledgeSpaceConfig=te),"cate-slugs":d.mergedPost.cate_slugs,"onUpdate:cateSlugs":B[8]||(B[8]=te=>d.mergedPost.cate_slugs=te),onEmitSyncCateSlugs:ve},null,8,["knowledge-space-type","knowledge-space-config","cate-slugs"])):Y("",!0),(he=d.publishCfg.cfg)!=null&&he.tagSlugEnabled?(w(),C(oe,{key:1,cfg:d.publishCfg.cfg,"onUpdate:cfg":B[9]||(B[9]=te=>d.publishCfg.cfg=te),"api-type":m(g),"onUpdate:apiType":B[10]||(B[10]=te=>as(g)?g.value=te:null),"tag-slugs":d.mergedPost.tags_slugs,"onUpdate:tagSlugs":B[11]||(B[11]=te=>d.mergedPost.tags_slugs=te),onEmitSyncTagSlugs:H},null,8,["cfg","api-type","tag-slugs"])):Y("",!0),f(de,{"border-style":"dashed"}),d.editType===m(Fe).EditMode_complex?(w(),O("div",$u,[f(Te,{label:m(t)("main.slug")},{default:b(()=>[f(ce,{modelValue:d.mergedPost.wp_slug,"onUpdate:modelValue":B[12]||(B[12]=te=>d.mergedPost.wp_slug=te),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),f($e,{"use-ai":d.useAi,"onUpdate:useAi":B[13]||(B[13]=te=>d.useAi=te),"page-id":m(_),"onUpdate:pageId":B[14]||(B[14]=te=>as(_)?_.value=te:null),desc:d.mergedPost.shortDesc,"onUpdate:desc":B[15]||(B[15]=te=>d.mergedPost.shortDesc=te),md:d.mergedPost.markdown,"onUpdate:md":B[16]||(B[16]=te=>d.mergedPost.markdown=te),html:d.mergedPost.html,"onUpdate:html":B[17]||(B[17]=te=>d.mergedPost.html=te),onEmitSyncDesc:q},null,8,["use-ai","page-id","desc","md","html"]),d.publishCfg.cfg.tagEnabled?(w(),C(yt,{key:0,"use-ai":d.useAi,"onUpdate:useAi":B[18]||(B[18]=te=>d.useAi=te),"page-id":m(_),"onUpdate:pageId":B[19]||(B[19]=te=>as(_)?_.value=te:null),tags:d.mergedPost.mt_keywords,"onUpdate:tags":B[20]||(B[20]=te=>d.mergedPost.mt_keywords=te),md:d.mergedPost.markdown,"onUpdate:md":B[21]||(B[21]=te=>d.mergedPost.markdown=te),html:d.mergedPost.html,"onUpdate:html":B[22]||(B[22]=te=>d.mergedPost.html=te),"tag-config":d.tagConfig,"onUpdate:tagConfig":B[23]||(B[23]=te=>d.tagConfig=te),onEmitSyncTags:G},null,8,["use-ai","page-id","tags","md","html","tag-config"])):Y("",!0),d.publishCfg.cfg.cateEnabled?(w(),C(je,{key:1,"use-ai":d.useAi,"onUpdate:useAi":B[24]||(B[24]=te=>d.useAi=te),"category-type":d.publishCfg.cfg.categoryType,"onUpdate:categoryType":B[25]||(B[25]=te=>d.publishCfg.cfg.categoryType=te),"category-config":d.categoryConfig,"onUpdate:categoryConfig":B[26]||(B[26]=te=>d.categoryConfig=te),categories:d.mergedPost.categories,"onUpdate:categories":B[27]||(B[27]=te=>d.mergedPost.categories=te),md:d.mergedPost.markdown,"onUpdate:md":B[28]||(B[28]=te=>d.mergedPost.markdown=te),html:d.mergedPost.html,"onUpdate:html":B[29]||(B[29]=te=>d.mergedPost.html=te),onEmitSyncCates:X},null,8,["use-ai","category-type","category-config","categories","md","html"])):Y("",!0),d.publishCfg.dynCfg.platformType===m(be).Metaweblog||d.publishCfg.dynCfg.platformType===m(be).Wordpress?(w(),C(kt,{key:2,modelValue:d.mergedPost,"onUpdate:modelValue":B[30]||(B[30]=te=>d.mergedPost=te),onEmitSyncPublishStatus:Xe},null,8,["modelValue"])):Y("",!0),d.publishCfg.dynCfg.platformType!==m(be).Metaweblog&&d.publishCfg.dynCfg.platformType!==m(be).Wordpress?(w(),C(Ni,{key:3,modelValue:d.mergedPost,"onUpdate:modelValue":B[31]||(B[31]=te=>d.mergedPost=te),onEmitSyncPublishTime:Le},null,8,["modelValue"])):Y("",!0),f(de,{"border-style":"dashed"})])):Y("",!0)])),f(Te,{"label-width":"100px",class:"form-action"},{default:b(()=>[f(pt,{type:"primary",loading:d.isPublishLoading,onClick:v,disabled:!d.actionEnable},{default:b(()=>[R(K(d.method===m(tt).METHOD_ADD?m(t)("main.publish"):m(t)("main.update")),1)]),_:1},8,["loading","disabled"]),d.method===m(tt).METHOD_EDIT?(w(),C(pt,{key:0,type:"danger",loading:d.isDeleteLoading,onClick:P,disabled:!d.actionEnable,class:"btn-rm-action"},{default:b(()=>[R(K(m(t)("main.cancel")),1)]),_:1},8,["loading","disabled"])):Y("",!0),d.method===m(tt).METHOD_EDIT?(w(),C(pt,{key:1,type:"danger",onClick:E,disabled:!d.actionEnable,class:"btn-rm-action"},{default:b(()=>[R(K(m(t)("main.force.cancel")),1)]),_:1},8,["disabled"])):Y("",!0),f(pt,{type:"warning",onClick:M,disabled:!d.actionEnable&&d.editType!==m(Fe).EditMode_source},{default:b(()=>[R(" 同步修改到思源笔记 ")]),_:1},8,["disabled"])]),_:1}),f(Te,null,{default:b(()=>[f(pt,{type:d.method===m(tt).METHOD_EDIT?"success":"danger",text:"",disabled:""},{default:b(()=>[R(K(d.method===m(tt).METHOD_EDIT?m(t)("main.publish.status.published"):m(t)("main.publish.status.unpublish")),1)]),_:1},8,["type"]),d.method===m(tt).METHOD_EDIT?(w(),O("a",{key:0,href:d.postPreviewUrl,title:d.postPreviewUrl,target:"_blank"},K(m(t)("main.publish.see.preview")),9,Nu)):Y("",!0)]),_:1})]}),_:1})])]),_:1})]),_:1})])):(w(),C(ye,{key:0,class:"placeholder",rows:5,animated:""}))]),_:1})}}}),Hu=pe(Lu,[["__scopeId","data-v-85665168"]]),Ru=c=>(mt("data-v-97f1c3c2"),c=c(),ht(),c),Gu={class:"form-tag-cates"},Bu={key:0},ju=Ru(()=>k("div",{class:"form-item-bottom"},null,-1)),Ku=F({__name:"CommonCategories",props:{useAi:{type:Boolean,default:!1},cates:{type:Array,default:[]},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncCates"],setup(c,{emit:o}){const t=W("common-categories"),{t:s}=Z(),e=c,a=J(),n=re({isLoading:!1,useAi:e.useAi,cate:{inputValue:"",dynamicCates:e.cates.length==0?[]:e.cates,inputVisible:!1},recommCates:[],md:e.md,html:e.html});Je(()=>e.useAi,u=>{n.useAi=u}),Je(()=>e.html,u=>{n.html=u});const i=o,l={handleTagClose:u=>{n.cate.dynamicCates.splice(n.cate.dynamicCates.indexOf(u),1),i("emitSyncCates",n.cate.dynamicCates)},tagShowInput:()=>{n.cate.inputVisible=!0,_n(()=>{a.value.input.focus()})},handleTagInputConfirm:()=>{n.cate.inputValue&&(n.cate.dynamicCates.push(n.cate.inputValue),i("emitSyncCates",n.cate.dynamicCates)),n.cate.inputVisible=!1,n.cate.inputValue=""},fetchCate:async()=>{try{n.isLoading=!0;const u=Fs.categoryPrompt.content,{chat:r,getChatInput:h}=Ot(),y=await r(u,{name:"categories",systemMessage:h(n==null?void 0:n.md,n.html)});if(T.isEmptyString(y)){Q.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const p=se.safeParse(y,{});if(!(p!=null&&p.categories)||(p==null?void 0:p.categories.length)==0)throw new Error("文档信息量太少，未能抽取有效信息");n.recommCates=p.categories,t.info("使用AI智能生成的分类结果 =>",{inputWord:u,chatText:y})}catch(u){t.error(s("main.opt.failure")+"=>",u),Q.error(s("main.opt.failure")+"=>"+u)}finally{n.isLoading=!1}}};return(u,r)=>{const h=Sn,y=Ie,p=Se,g=Ce,_=Ne;return w(),O("div",Gu,[f(g,{label:m(s)("main.commonn.cate.title")},{default:b(()=>[(w(!0),O(Ee,null,xe(n.cate.dynamicCates,d=>(w(),C(h,{key:d,"disable-transitions":!1,class:"mx-1 pub-tag",closable:"",onClose:v=>l.handleTagClose(d)},{default:b(()=>[R(K(d),1)]),_:2},1032,["onClose"]))),128)),n.cate.inputVisible?(w(),C(y,{key:0,ref_key:"tagRefInput",ref:a,modelValue:n.cate.inputValue,"onUpdate:modelValue":r[0]||(r[0]=d=>n.cate.inputValue=d),class:"ml-1 w-20 pub-tag-input",size:"small",onBlur:l.handleTagInputConfirm,onKeyup:qn(l.handleTagInputConfirm,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(w(),C(p,{key:1,class:"button-new-tag ml-1 el-tag",size:"small",onClick:l.tagShowInput},{default:b(()=>[R(K(m(s)("main.cate.new")),1)]),_:1},8,["onClick"]))]),_:1},8,["label"]),n.useAi?(w(),O("div",Bu,[n.recommCates.length>0?(w(),C(g,{key:0,class:"recomm-show"},{default:b(()=>[R(" 推荐的分类： "),(w(!0),O(Ee,null,xe(n.recommCates,d=>(w(),C(h,{class:"ml-2 recomm-cate",type:"success"},{default:b(()=>[R(K(d),1)]),_:2},1024))),256))]),_:1})):Y("",!0),f(g,{class:"cat-action"},{default:b(()=>[f(p,{size:"small",loading:n.isLoading,type:"primary",onClick:l.fetchCate},{default:b(()=>[R(K(n.isLoading?m(s)("main.opt.loading"):m(s)("main.auto.fetch.cate")),1)]),_:1},8,["loading","onClick"])]),_:1}),f(g,null,{default:b(()=>[f(_,{closable:!1,title:m(s)("category.ai.hand"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})])):Y("",!0),f(g,null,{default:b(()=>[f(_,{closable:!1,title:m(s)("category.batch.not.supported"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1}),ju])}}}),zu=pe(Ku,[["__scopeId","data-v-97f1c3c2"]]),Wu={},Fu={class:"publish-tips"};function Ju(c,o){const t=Ne;return w(),O("div",Fu,[f(t,{closable:!1,title:"多平台文章分发。其中思源笔记为内置平台，这里的修改发布后，也会同步更新思源笔记",class:"top-tip",type:"info"})])}const qu=pe(Wu,[["render",Ju],["__scopeId","data-v-79abd8eb"]]),Yu=c=>(mt("data-v-931dabf2"),c=c(),ht(),c),Xu=Yu(()=>k("p",null,"请选择要发布的平台：",-1)),Zu={class:"syp-distri-platform-container"},Qu=["onClick"],ed=["innerHTML"],td=["innerHTML"],sd=["innerHTML"],od=F({__name:"PublishPlatform",props:{id:{type:String,default:""}},emits:["emitSyncDynList"],setup(c,{emit:o}){const t=W("publish-platform"),s=c,{getSetting:e}=me(),a=Ke.systemCfg.map(u=>u.platformKey),n=re({dynamicConfigArray:[],selectedKeys:[].concat(a)}),i=o;i&&(t.info("selectedKeys=>",n.selectedKeys),i("emitSyncDynList",n.selectedKeys));const l=u=>{var r;n.selectedKeys.includes(u)?n.selectedKeys=((r=n.selectedKeys)==null?void 0:r.filter(h=>h!==u))??[]:n.selectedKeys.push(u),i&&(t.info("selectedKeys=>",n.selectedKeys),i("emitSyncDynList",n.selectedKeys))};return Ye(async()=>{var p;const u=await e(),h=(p=se.safeParse(u[De],{}).totalCfg)==null?void 0:p.filter(g=>g.isEnabled===!0&&g.isAuth===!0);n.dynamicConfigArray=h||[];const y=u[s.id]??{};n.dynamicConfigArray.forEach(g=>{const _=g.platformKey,d=Ae(_);if(!T.isEmptyString(d)){const v=y[d]??"";T.isEmptyString(v)||l(_)}})}),(u,r)=>{const h=Co,y=ii;return w(),O("div",null,[Xu,k("div",Zu,[(w(!0),O(Ee,null,xe(n.dynamicConfigArray,p=>(w(),O("a",{class:"distri-item",onClick:g=>l(p.platformKey)},[f(y,{content:m(Mt).longPlatformName(p.platformName,20),placement:"bottom"},{default:b(()=>[f(h,{class:"platform-icon"},{default:b(()=>[k("span",{innerHTML:p.platformIcon},null,8,ed)]),_:2},1024)]),_:2},1032,["content"]),n.selectedKeys.includes(p.platformKey)?(w(),O("span",{key:0,class:"icon-yes",innerHTML:m(ke).iconOTYes},null,8,td)):(w(),O("span",{key:1,class:"icon-no",innerHTML:m(ke).iconOTNo},null,8,sd))],8,Qu))),256))])])}}}),ad=pe(od,[["__scopeId","data-v-931dabf2"]]);var os=(c=>(c.Override="Override",c.Merge="Merge",c))(os||{}),nd={DEV_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"};const id={id:"batch-publish-index"},ld={class:"error-total-msg"},rd=["onClick"],cd={key:0,class:"success-result success-tips"},pd={class:"platform"},ud=["href"],dd={class:"publish-form"},gd={key:2,class:"normal-mode"},md={class:"distri-type"},hd={key:0,class:"complex-mode"},fd=F({__name:"BatchPublishIndex",props:{id:{type:String,default:""}},setup(c){const o=W("publisher-index"),t=c,{t:s}=Z(),{doSinglePublish:e,doSingleDelete:a,doForceSingleDelete:n,initPublishMethods:i}=Ks(),{blogApi:l}=Ge(),{getPublishCfg:u}=js(),{kernelApi:r}=Ge(),h=Ke.systemCfg.map(G=>G.platformKey),y=T.isEmptyString(t.id)?nd.VITE_DEV_PAGE_ID:t.id,p=re({isInit:!1,isPublishLoading:!1,isDeleteLoading:!1,showProcessResult:!1,errCount:0,successBatchResults:[],failBatchResults:[],siyuanPost:{},publishCfg:{},categoryConfig:{},useAi:!1,dynList:[],editType:Fe.EditMode_simple,distriPattern:os.Merge,actionEnable:!0}),g=async()=>{try{if(p.isPublishLoading=!0,$.value=!1,p.dynList.length===0)throw new Error("必须选择一个分发平台");p.errCount=0,p.failBatchResults=[],p.successBatchResults=[];const G=we.cloneDeep(p.siyuanPost);for(const H of p.dynList){let X;if(h.includes(H))o.info(`开始发布 [${H}] 系统内置平台`),X=G;else{o.info(`开始发布 [${H}] 自定义平台`);const Le=await u(H);p.publishCfg=Le,X=await i.assignInitAttrs(G,y,p.publishCfg),p.distriPattern===os.Override?(X=i.doOverideBatchPost(G,X),o.debug("批量分发模式文章已覆盖",{siyuanPost:le(G),mergedPost:le(X)})):(X=i.doMergeBatchPost(G,X),o.debug("批量分发模式文章已合并",{siyuanPost:le(G),mergedPost:le(X)}))}const ve=await e(H,y,p.publishCfg,X);ve.status?p.successBatchResults.push(ve):(p.failBatchResults.push(ve),p.errCount++)}p.actionEnable=!1,p.showProcessResult=!0,p.errCount===0?Q.success("多平台文章分发成功"):Q.error(`多平台文章分发失败，失败个数：${p.errCount}`)}catch(G){const H=s("main.opt.failure")+"=>"+G;o.error(s("main.opt.failure")+"=>",G),await r.pushErrMsg({msg:H,timeout:7e3})}finally{p.isPublishLoading=!1,$.value=!0}},_=async()=>{Pt.confirm(`确认要删除平台 ${p.dynList.join("、")} 下的这篇文章吗，此平台文章数据也将永久删除 [注意：系统内置平台会忽略，不做删除] ？`,"温馨提示",{type:"error",icon:Ct(Vs),confirmButtonText:s("main.opt.ok"),cancelButtonText:s("main.opt.cancel")}).then(async()=>{await d()}).catch(()=>{})},d=async()=>{try{if(p.isDeleteLoading=!0,p.dynList.length===0)throw new Error("必须选择一个分发平台");p.errCount=0,p.failBatchResults=[],p.successBatchResults=[];for(const G of p.dynList){if(h.includes(G)){o.info(`[${G}] 系统内置平台，不可删除，跳过`);continue}const H=await u(G);p.publishCfg=H;const X=await a(G,y,H);X.status||(p.failBatchResults.push(X),p.errCount++)}p.actionEnable=!1,p.showProcessResult=!0,p.errCount===0?Q.success("多平台文章删除成功"):Q.error(`多平台文章删除失败，失败个数：${p.errCount}`)}catch(G){const H=s("main.opt.failure")+"=>"+G;o.error(s("main.opt.failure")+"=>",G),await r.pushErrMsg({msg:H,timeout:7e3})}finally{p.isDeleteLoading=!1}},v=async(G,H,X)=>{try{await n(G,H,X)}catch(ve){Q.error(ve.message)}finally{p.isDeleteLoading=!1}},P=async()=>{const G={[st.Sys_memo]:p.siyuanPost.shortDesc,[st.Sys_tags]:p.siyuanPost.mt_keywords,[st.Custom_categories]:p.siyuanPost.categories.join(",")};await r.setBlockAttrs(y,G),o.info("内置平台，保存属性",G),Q.success("属性已经成功同步到思源")},S=G=>{p.siyuanPost.title=G,o.debug("syncPublishTitle in batch publish")},E=async G=>{p.editType=G,o.debug("syncEditMode in batch publish")},M=G=>{p.dynList=G,o.debug("syncDynList in batch publish")},x=G=>{p.siyuanPost.shortDesc=G,p.siyuanPost.mt_text_more=G,p.siyuanPost.mt_excerpt=G,o.debug("syncDesc in batch publish")},z=G=>{p.siyuanPost.mt_keywords=G==null?void 0:G.join(","),o.debug("syncTags in batch publish")},L=G=>{p.siyuanPost.categories=G,o.debug("syncCates in batch publish")},j=(G,H)=>{p.siyuanPost.dateCreated=G,p.siyuanPost.dateUpdated=H,o.debug("syncPublishTime in batch publish")},I=()=>{Ht.reloadPage()},A=()=>{let G=!1,H=0;for(;!G&&H<3;)try{Ot(),G=!0}catch(X){o.error(`${s("main.opt.failure")} => ${X}`),H++}return o.info(`第${H}次尝试就检测AI状态: ${G}`),G},$=J(!1),{loadingTime:q}=zs($);return Ye(async()=>{p.publishCfg=await u();const G=await l.getPost(y);p.siyuanPost=await i.assignInitSlug(G,y,p.publishCfg),o.debug("batch inited siyuanPost =>",le(p.siyuanPost)),p.useAi=A(),p.editType=Fe.EditMode_simple,p.isInit=!0,$.value=!0}),(G,H)=>{const X=Dt,ve=Hs,Le=Ne,Xe=Vi,Be=ko,ze=Ls,He=Ce,ie=Eo,Re=Ie,Vt=Oi,V=Di,B=zu,ye=Se,et=Qe,vt=ai,nt=ni;return w(),O("div",id,[f(nt,null,{default:b(()=>[p.isInit?(w(),C(vt,{key:1},{default:b(()=>[f(ve,{"loading-time":m(q)},null,8,["loading-time"]),f(qu),p.showProcessResult?(w(),O("div",{key:0,class:Jt(p.errCount>0?"batch-result fail-tips":"batch-result success-tips")},[k("div",ld,[R(" 错误平台个数 ["+K(p.errCount)+"] ，选择的总平台数 ["+K(p.dynList.length)+"] 。 ",1),k("a",{class:"refresh-page",onClick:I},"刷新页面")]),(w(!0),O(Ee,null,xe(p.failBatchResults,oe=>(w(),O("div",null,[R(" ["+K(oe.key)+"] "+K(m(T).isEmptyString(oe.name)?"":`[${oe.name}]`)+" "+K(oe.errMsg)+" ",1),k("a",{href:"javascript:void(0)",onClick:de=>v(oe.key,t.id,p.publishCfg)},"强制解除关联",8,rd)]))),256)),p.successBatchResults.length>0?(w(),O("div",cd,[R(" 已分发成功的结果如下： "),(w(!0),O(Ee,null,xe(p.successBatchResults,oe=>(w(),O("p",null,[k("span",pd,"["+K(oe.key)+"] "+K(m(T).isEmptyString(oe.name)?"":`[${oe.name}]`),1),R(" ， "),k("a",{href:oe.previewUrl,target:"_blank"},"查看文章",8,ud)]))),256))])):Y("",!0)],2)):Y("",!0),k("div",dd,[f(et,{"label-width":"100px"},{default:b(()=>[p.useAi?(w(),C(Le,{key:0,class:"top-tip",title:m(s)("category.ai.enabled"),type:"success",closable:!0},null,8,["title"])):Y("",!0),f($i,{"edit-type":p.editType,"onUpdate:editType":H[0]||(H[0]=oe=>p.editType=oe),onEmitSyncEditMode:E},null,8,["edit-type"]),p.editType===m(Fe).EditMode_source?(w(),C(Xe,{key:1,modelValue:p.siyuanPost,"onUpdate:modelValue":H[1]||(H[1]=oe=>p.siyuanPost=oe),"page-id":m(y)},null,8,["modelValue","page-id"])):(w(),O("div",gd,[f(Li,{"use-ai":p.useAi,"onUpdate:useAi":H[2]||(H[2]=oe=>p.useAi=oe),modelValue:p.siyuanPost.title,"onUpdate:modelValue":H[3]||(H[3]=oe=>p.siyuanPost.title=oe),onEmitSyncPublishTitle:S,md:p.siyuanPost.markdown,"onUpdate:md":H[4]||(H[4]=oe=>p.siyuanPost.markdown=oe),html:p.siyuanPost.html,"onUpdate:html":H[5]||(H[5]=oe=>p.siyuanPost.html=oe)},null,8,["use-ai","modelValue","md","html"]),k("div",md,[f(He,{label:"分发模式"},{default:b(()=>[f(ze,{modelValue:p.distriPattern,"onUpdate:modelValue":H[6]||(H[6]=oe=>p.distriPattern=oe),class:"ml-4 distri-type-check"},{default:b(()=>[f(Be,{value:m(os).Override,size:"large"},{default:b(()=>[R("覆盖")]),_:1},8,["value"]),f(Be,{value:m(os).Merge,size:"large"},{default:b(()=>[R("合并")]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1}),f(He,{class:"distri-tip"},{default:b(()=>[p.distriPattern===m(os).Override?(w(),C(Le,{key:0,closable:!1,title:m(s)("distri.type.overide.warn"),class:"distri-tip-alert",type:"error"},null,8,["title"])):(w(),C(Le,{key:1,closable:!1,title:m(s)("distri.type.merge.warn"),class:"distri-tip-alert",type:"warning"},null,8,["title"]))]),_:1})]),f(ie,{"border-style":"dashed"}),p.editType===m(Fe).EditMode_complex?(w(),O("div",hd,[f(He,{label:m(s)("main.slug")},{default:b(()=>[f(Re,{modelValue:p.siyuanPost.wp_slug,"onUpdate:modelValue":H[7]||(H[7]=oe=>p.siyuanPost.wp_slug=oe),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),f(Vt,{"use-ai":p.useAi,"onUpdate:useAi":H[8]||(H[8]=oe=>p.useAi=oe),"page-id":m(y),"onUpdate:pageId":H[9]||(H[9]=oe=>as(y)?y.value=oe:null),desc:p.siyuanPost.shortDesc,"onUpdate:desc":H[10]||(H[10]=oe=>p.siyuanPost.shortDesc=oe),md:p.siyuanPost.markdown,"onUpdate:md":H[11]||(H[11]=oe=>p.siyuanPost.markdown=oe),html:p.siyuanPost.html,"onUpdate:html":H[12]||(H[12]=oe=>p.siyuanPost.html=oe),onEmitSyncDesc:x},null,8,["use-ai","page-id","desc","md","html"]),f(V,{"use-ai":p.useAi,"onUpdate:useAi":H[13]||(H[13]=oe=>p.useAi=oe),"page-id":m(y),"onUpdate:pageId":H[14]||(H[14]=oe=>as(y)?y.value=oe:null),tags:p.siyuanPost.mt_keywords,"onUpdate:tags":H[15]||(H[15]=oe=>p.siyuanPost.mt_keywords=oe),md:p.siyuanPost.markdown,"onUpdate:md":H[16]||(H[16]=oe=>p.siyuanPost.markdown=oe),html:p.siyuanPost.html,"onUpdate:html":H[17]||(H[17]=oe=>p.siyuanPost.html=oe),onEmitSyncTags:z},null,8,["use-ai","page-id","tags","md","html"]),f(B,{"use-ai":p.useAi,"onUpdate:useAi":H[18]||(H[18]=oe=>p.useAi=oe),cates:p.siyuanPost.categories,"onUpdate:cates":H[19]||(H[19]=oe=>p.siyuanPost.categories=oe),onEmitSyncCates:L,md:p.siyuanPost.markdown,"onUpdate:md":H[20]||(H[20]=oe=>p.siyuanPost.markdown=oe),html:p.siyuanPost.html,"onUpdate:html":H[21]||(H[21]=oe=>p.siyuanPost.html=oe)},null,8,["use-ai","cates","md","html"]),f(Ni,{modelValue:p.siyuanPost,"onUpdate:modelValue":H[22]||(H[22]=oe=>p.siyuanPost=oe),onEmitSyncPublishTime:j},null,8,["modelValue"]),f(ie,{"border-style":"dashed"})])):Y("",!0)])),f(ad,{id:t.id,onEmitSyncDynList:M},null,8,["id"]),f(ie,{"border-style":"dashed"}),f(He,{"label-width":"100px",class:"form-action"},{default:b(()=>[f(ye,{type:"primary",loading:p.isPublishLoading,onClick:g,disabled:!p.actionEnable},{default:b(()=>[R(K(m(s)("main.publish.start")),1)]),_:1},8,["loading","disabled"]),f(ye,{type:"danger",loading:p.isDeleteLoading,onClick:_,disabled:!p.actionEnable,class:"btn-rm-action"},{default:b(()=>[R(K(m(s)("main.publish.remove")),1)]),_:1},8,["loading","disabled"]),f(ye,{type:"warning",onClick:P,disabled:!p.actionEnable},{default:b(()=>[R(" 同步修改到思源笔记 ")]),_:1},8,["disabled"])]),_:1})]),_:1})])]),_:1})):(w(),C(X,{key:0,class:"placeholder",rows:12,animated:"",style:{padding:"40px 12px"}}))]),_:1})])}}}),yd=pe(fd,[["__scopeId","data-v-21bfab97"]]),bd=F({__name:"BatchPublish",setup(c){const{query:o}=qe(),t=o.id??Ws();return(s,e)=>(w(),C(yd,{id:m(t)},null,8,["id"]))}}),_d={key:0},wd={class:"chat-output"},vd=F({__name:"AiChat",setup(c){const o=W("chatgpt-test"),{t}=Z(),{query:s}=qe(),{blogApi:e}=Ge(),a=s.id??Ws(),n=J(""),i=J(""),l=re({isLoading:!1,showPage:!T.isEmptyString(a),usePage:!1,siyuanPost:{}}),u=async()=>{if(n.value.trim()===""){Q.error("请输入文本");return}l.isLoading=!0;try{const{chat:h}=Ot();let y=n.value;l.usePage&&(T.isEmptyString(l.siyuanPost.markdown)||(y=`${l.siyuanPost.markdown}
${y}`,o.info("使用当前文档作为上下文")));const p=await h(y);if(T.isEmptyString(p)){Q.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}i.value+=`> ${n.value}
${p}

`,n.value=""}catch(h){o.error(t("main.opt.failure")+"=>",h),Q.error(t("main.opt.failure")+"=>"+h)}finally{l.isLoading=!1}},r=()=>{i.value=""};return Ye(async()=>{if(l.showPage){const h=await e.getPost(a);l.siyuanPost=h}}),(h,y)=>{const p=Ne,g=Ie,_=Ce,d=Xt,v=Se,P=Qe,S=Ve;return w(),C(S,{title:"AI聊天"},{default:b(()=>[l.usePage&&l.showPage&&!m(T).isEmptyString(l.siyuanPost.markdown)?(w(),C(p,{key:0,closable:!1,title:`当前为上下文模式，文档上下文为《${l.siyuanPost.title}》`,class:"top-tip",type:"success"},null,8,["title"])):(w(),C(p,{key:1,closable:!1,title:"当前为自由聊天模式",class:"top-tip",type:"info"})),f(P,{class:"chatgpt-form"},{default:b(()=>[f(_,null,{default:b(()=>[f(g,{modelValue:n.value,"onUpdate:modelValue":y[0]||(y[0]=E=>n.value=E),autosize:{minRows:4,maxRows:16},type:"textarea",class:"chat-input",placeholder:"请输入文本..."},null,8,["modelValue"])]),_:1}),f(_,null,{default:b(()=>[l.showPage&&!m(T).isEmptyString(l.siyuanPost.markdown)?(w(),O("div",_d,[f(d,{modelValue:l.usePage,"onUpdate:modelValue":y[1]||(y[1]=E=>l.usePage=E),class:"use-context"},null,8,["modelValue"]),R("   使用当前文档作为上下文 ")])):Y("",!0)]),_:1}),f(_,null,{default:b(()=>[f(v,{type:"primary",onClick:u,loading:l.isLoading},{default:b(()=>[R("发送消息")]),_:1},8,["loading"]),f(v,{type:"danger",onClick:r},{default:b(()=>[R("清屏")]),_:1})]),_:1}),f(_,null,{default:b(()=>[k("div",wd,[k("pre",null,K(i.value),1)])]),_:1})]),_:1})]),_:1})}}}),Pd=pe(vd,[["__scopeId","data-v-45683f97"]]),Td={id:"test-list",class:"test-list-container"},kd=F({__name:"Test",setup(c){const o=wt(),t=[{title:"思源笔记测试",path:"/test/siyuan"},{title:"博客园测试",path:"/test/cnblogs"},{title:"WordPress测试",path:"/test/wordpress"},{title:"Typecho测试",path:"/test/typecho"},{title:"语雀测试",path:"/test/yuque"},{title:"知乎测试",path:"/test/zhihu"},{title:"CSDN测试",path:"/test/csdn"},{title:"Picgo测试",path:"/test/picgo"},{title:"其他测试",path:"/test/other"},{title:"ChatGPT测试",path:"/test/chat"}],s=async e=>{await o.push({path:e.path,query:{showBack:"true"}})};return(e,a)=>{const n=Se,i=Ve;return w(),C(i,{title:"组件测试"},{default:b(()=>[k("div",Td,[(w(),O(Ee,null,xe(t,l=>f(n,{onClick:u=>s(l),type:"primary",size:"large",class:"test-button"},{default:b(()=>[R(K(l.title),1)]),_:2},1032,["onClick"])),64))])]),_:1})}}}),Sd=pe(kd,[["__scopeId","data-v-9ca673a2"]]),Ed={id:"siyuan-test"},Cd={class:"method-list"},Ad={class:"item"},Ud={class:"item"},Id={class:"item"},xd={key:0,class:"item"},Md={class:"item"},Dd={class:"item"},Jo="getUsersBlogs",qo="getRecentPostsCount",Yo="getRecentPosts",Xo="newPost",Zo="getPost",Qo="editPost",ea="deletePost",ta="getCategories",sa="getPreviewUrl",oa="newMediaObject",Od=F({__name:"SiyuanTest",setup(c){const o=W("siyuan-test"),{t}=Z(),s=J("{}"),e=J(!1),a=J(null),n=J(""),i=J(!1),l=J("getUsersBlogs"),u=re({options:[{value:Jo,label:"获取博客信息"},{value:qo,label:"获取最新文章数目"},{value:Yo,label:"获取最新文章列表"},{value:Xo,label:"发布文章"},{value:Zo,label:"获取文章详情"},{value:Qo,label:"编辑文章"},{value:ea,label:"删除文章"},{value:ta,label:"获取分类列表"},{value:sa,label:"获取文章预览地址"},{value:oa,label:"上传资源文件"}]}),r=p=>{switch(e.value=!1,p){case Jo:{s.value="{}";break}case qo:{s.value="{}";break}case Yo:{s.value=JSON.stringify({numOfPosts:10});break}case Xo:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case Zo:{s.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case Qo:{s.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case ea:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case ta:{s.value="{}";break}case sa:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case oa:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},h=async p=>{const g=p.target;g.files&&g.files[0]&&(a.value=g.files[0])},y=async()=>{i.value=!0,n.value="",n.value="siyuan requesting...";try{const p=new fe;switch(o.info("appInstance=>",p),l.value){case Jo:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),v=await U.blogApi(p,_).getUsersBlogs();n.value=JSON.stringify(v),o.info("siyuan users blogs=>",v);break}case qo:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),v=await U.blogApi(p,_).getRecentPostsCount();n.value=JSON.stringify(v),o.info("siyuan recent post count=>",v);break}case Yo:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),d=U.blogApi(p,_),v=JSON.parse(s.value),P=await d.getRecentPosts(v.numOfPosts);n.value=JSON.stringify(P),o.info("siyuan recent post=>",P);break}case Xo:{const g=new ut("http://127.0.0.1:6806","");g.notebook="20230506132031-qbtyjdk";const _=new bt(g),d=U.blogApi(p,_),v=JSON.parse(s.value);let P=new ot;P={...P,...v};const S=await d.newPost(P);n.value=JSON.stringify(S);break}case Zo:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),d=U.blogApi(p,_),P=JSON.parse(s.value).postid,S=await d.getPost(P);n.value=JSON.stringify(S),o.info("siyuan post=>",S);break}case Qo:{const g=new ut("http://127.0.0.1:6806","");g.notebook="20230506132031-qbtyjdk";const _=new bt(g),d=U.blogApi(p,_),v=JSON.parse(s.value),P=v.postid;let S=new ot;S={...S,...v.post};const E=await d.editPost(P,S);n.value=JSON.stringify(E);break}case ea:{const g=new ut("http://127.0.0.1:6806","");g.notebook="20230506132031-qbtyjdk";const _=new bt(g),d=U.blogApi(p,_),P=JSON.parse(s.value).postid,S=await d.deletePost(P);n.value=JSON.stringify(S);break}case ta:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),v=await U.blogApi(p,_).getCategories();n.value=JSON.stringify(v),o.info("siyuan categories=>",v);break}case sa:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),d=U.blogApi(p,_),P=JSON.parse(s.value).postid,S=await d.getPreviewUrl(P);n.value=JSON.stringify(S),o.info("siyuan preview url=>",S);break}case oa:{const g=new ut("http://127.0.0.1:6806",""),_=new bt(g),d=U.blogApi(p,_),v=a.value,P=await Gs(v),S=new ns(v.name,v.type,P);o.info("mediaObject=>",S);const E=await d.newMediaObject(S,async()=>{const M=new FormData,x=new Blob([S.bits]);return M.append("file[]",x,S.name),M.append("assetsDirPath","/assets/"),await new Qn(g).uploadAsset(M)});n.value=JSON.stringify(E),o.info("siyuan new mediaObject result=>",E);break}default:break}i.value=!1}catch(p){n.value=p,o.error(t("main.opt.failure")+"=>",p),i.value=!1}};return(p,g)=>{const _=rt,d=ct,v=Se,P=Ie,S=Ve;return w(),C(S,{title:"siyuan测试"},{default:b(()=>[k("div",Ed,[k("div",Cd,[f(d,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),class:"m-2",placeholder:"请选择方法名称",onChange:r},{default:b(()=>[(w(!0),O(Ee,null,xe(u.options,E=>(w(),C(_,{key:E.value,label:E.label,value:E.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",Ad,[f(v,{type:"primary",loading:i.value,onClick:y},{default:b(()=>[R("开始测试siyuan")]),_:1},8,["loading"])]),k("div",Ud,[f(v,null,{default:b(()=>[R("入参")]),_:1})]),k("div",Id,[f(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),O("div",xd,[k("input",{type:"file",onChange:h},null,32)])):Y("",!0),k("div",Md,[f(v,null,{default:b(()=>[R("结果")]),_:1})]),k("div",Dd,[f(P,{modelValue:n.value,"onUpdate:modelValue":g[2]||(g[2]=E=>n.value=E),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),Vd=pe(Od,[["__scopeId","data-v-cfa9acd3"]]),$d={id:"cnblogs-test"},Nd={class:"method-list"},Ld={class:"item"},Hd={class:"item"},Rd={class:"item"},Gd={key:0,class:"item"},Bd={class:"item"},jd={class:"item"},aa="getUsersBlogs",na="getRecentPostsCount",ia="getRecentPosts",la="newPost",ra="getPost",ca="editPost",pa="deletePost",ua="getCategories",da="getPreviewUrl",ga="newMediaObject",Kd=F({__name:"CnblogsTest",setup(c){const o=W("cnblogs-test"),{t}=Z(),s=J("{}"),e=J(!1),a=J(null),n=J(""),i=J(!1),l=J("getUsersBlogs"),u=re({options:[{value:aa,label:"获取博客信息"},{value:na,label:"获取最新文章数目"},{value:ia,label:"获取最新文章列表"},{value:la,label:"发布文章"},{value:ra,label:"获取文章详情"},{value:ca,label:"编辑文章"},{value:pa,label:"删除文章"},{value:ua,label:"获取分类列表"},{value:da,label:"获取文章预览地址"},{value:ga,label:"上传资源文件"}]}),r=p=>{switch(e.value=!1,p){case aa:{s.value="{}";break}case na:{s.value="{}";break}case ia:{s.value=JSON.stringify({numOfPosts:10});break}case la:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case ra:{s.value=JSON.stringify({postid:"17593464"});break}case ca:{s.value=JSON.stringify({postid:"17593464",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case pa:{s.value=JSON.stringify({postid:"17593463"});break}case ua:{s.value="{}";break}case da:{s.value=JSON.stringify({postid:"17243968"});break}case ga:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},h=async p=>{const g=p.target;g.files&&g.files[0]&&(a.value=g.files[0])},y=async()=>{i.value=!0,n.value="",n.value="cnblogs requesting...";try{const p=new fe;switch(o.info("appInstance=>",p),l.value){case aa:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const v=await d.getUsersBlogs();n.value=JSON.stringify(v),o.info("cnblogs users blogs=>",v);break}case na:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const v=await d.getRecentPostsCount();n.value=JSON.stringify(v),o.info("cnblogs getRecentPostsCount=>",v);break}case ia:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const v=await d.getRecentPosts(10);n.value=JSON.stringify(v),o.info("cnblogs getRecentPosts=>",v);break}case la:{const g=JSON.parse(s.value);let _=new ot;_={..._,...g};const v=await _e.getAdaptor("metaweblog_Cnblogs"),S=await U.blogApi(p,v).newPost(_);n.value=JSON.stringify(S),o.info("cnblogs newPost=>",S);break}case ra:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const P=JSON.parse(s.value).postid,S=await d.getPost(P);n.value=JSON.stringify(S),o.info("cnblogs getPost=>",S);break}case ca:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const v=JSON.parse(s.value),P=v.postid;let S=new ot;S={...S,...v.post};const E=await d.editPost(P,S);n.value=JSON.stringify(E);break}case pa:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const P=JSON.parse(s.value).postid,S=await d.deletePost(P);n.value=JSON.stringify(S);break}case ua:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const v=await d.getCategories();n.value=JSON.stringify(v),o.info("cnblogs getCategories=>",v);break}case da:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const P=JSON.parse(s.value).postid,S=await d.getPreviewUrl(P);n.value=JSON.stringify(S),o.info("cnblogs getPreviewUrl=>",S);break}case ga:{const _=await _e.getAdaptor("metaweblog_Cnblogs"),d=U.blogApi(p,_);o.info("cnblogsApi=>",d);const P=await In("https://static-rs-terwer.oss-cn-beijing.aliyuncs.com/test/image-20230812091531-hibwr1g.png"),S=P.imageBase64;o.debug("imageBase64=>",{imageBase64:S});const E=xn(S);o.debug("bits=>",E);const M=new ns(P.imageName,P.mimeType,E);o.info("mediaObject=>",M);const x=await d.newMediaObject(M);n.value=JSON.stringify(x),o.info("cnblogs new mediaObject result=>",x);break}default:break}i.value=!1}catch(p){n.value=p,o.error(t("main.opt.failure")+"=>",p),i.value=!1}};return(p,g)=>{const _=rt,d=ct,v=Se,P=Ie,S=Ve;return w(),C(S,{title:"博客园测试"},{default:b(()=>[k("div",$d,[k("div",Nd,[f(d,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),class:"m-2",placeholder:"请选择方法名称",onChange:r},{default:b(()=>[(w(!0),O(Ee,null,xe(u.options,E=>(w(),C(_,{key:E.value,label:E.label,value:E.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",Ld,[f(v,{type:"primary",loading:i.value,onClick:y},{default:b(()=>[R("开始测试cnblogs")]),_:1},8,["loading"])]),k("div",Hd,[f(v,null,{default:b(()=>[R("入参")]),_:1})]),k("div",Rd,[f(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),O("div",Gd,[k("input",{type:"file",onChange:h},null,32)])):Y("",!0),k("div",Bd,[f(v,null,{default:b(()=>[R("结果")]),_:1})]),k("div",jd,[f(P,{modelValue:n.value,"onUpdate:modelValue":g[2]||(g[2]=E=>n.value=E),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),zd=pe(Kd,[["__scopeId","data-v-4331baa2"]]),Wd={id:"wordpress-test"},Fd={class:"method-list"},Jd={class:"item"},qd={class:"item"},Yd={class:"item"},Xd={key:0,class:"item"},Zd={class:"item"},Qd={class:"item"},ma="getUsersBlogs",ha="getRecentPostsCount",fa="getRecentPosts",ya="newPost",ba="getPost",_a="editPost",wa="deletePost",va="getCategories",Pa="getPreviewUrl",Ta="newMediaObject",eg=F({__name:"WordpressTest",setup(c){const o=W("wordpress-test"),{t}=Z(),s=J("{}"),e=J(!1),a=J(null),n=J(""),i=J(!1),l=J("getUsersBlogs"),u=re({options:[{value:ma,label:"获取博客信息"},{value:ha,label:"获取最新文章数目"},{value:fa,label:"获取最新文章列表"},{value:ya,label:"发布文章"},{value:ba,label:"获取文章详情"},{value:_a,label:"编辑文章"},{value:wa,label:"删除文章"},{value:va,label:"获取分类列表"},{value:Pa,label:"获取文章预览地址"},{value:Ta,label:"上传资源文件"}]}),r=p=>{switch(e.value=!1,p){case ma:{s.value="{}";break}case ha:{s.value="{}";break}case fa:{s.value=JSON.stringify({numOfPosts:10});break}case ya:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case ba:{s.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case _a:{s.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case wa:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case va:{s.value="{}";break}case Pa:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case Ta:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},h=async p=>{const g=p.target;g.files&&g.files[0]&&(a.value=g.files[0])},y=async()=>{i.value=!0,n.value="",n.value="wordpress requesting...";try{const p=new fe;switch(o.info("appInstance=>",p),l.value){case ma:{const _=await _e.getAdaptor("wordpress_Wordpress"),v=await U.blogApi(p,_).getUsersBlogs();n.value=JSON.stringify(v),o.info("wordpress users blogs=>",v);break}case ha:break;case fa:{const _=await _e.getAdaptor("wordpress_Wordpress"),v=await U.blogApi(p,_).getRecentPosts(10);n.value=JSON.stringify(v),o.info("wordpress recent post=>",v);break}case ya:break;case ba:break;case _a:break;case wa:break;case va:break;case Pa:break;case Ta:{const g="wordpress_Wordpress",_=a.value,d=await Gs(_),v=new ns(_.name,_.type,d);o.info("mediaObject=>",v);const P={name:v.name,type:v.type,bits:v.bits,overwrite:!0},S=await _e.getAdaptor(g),M=await U.blogApi(p,S).newMediaObject(P);n.value=JSON.stringify(M),o.info("wordpress new mediaObject result=>",M);break}default:break}i.value=!1}catch(p){n.value=p,o.error(t("main.opt.failure")+"=>",p),i.value=!1}};return(p,g)=>{const _=rt,d=ct,v=Se,P=Ie,S=Ve;return w(),C(S,{title:"WordPress测试"},{default:b(()=>[k("div",Wd,[k("div",Fd,[f(d,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),class:"m-2",placeholder:"请选择方法名称",onChange:r},{default:b(()=>[(w(!0),O(Ee,null,xe(u.options,E=>(w(),C(_,{key:E.value,label:E.label,value:E.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",Jd,[f(v,{type:"primary",loading:i.value,onClick:y},{default:b(()=>[R("开始测试wordpress")]),_:1},8,["loading"])]),k("div",qd,[f(v,null,{default:b(()=>[R("入参")]),_:1})]),k("div",Yd,[f(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),O("div",Xd,[k("input",{type:"file",onChange:h},null,32)])):Y("",!0),k("div",Zd,[f(v,null,{default:b(()=>[R("结果")]),_:1})]),k("div",Qd,[f(P,{modelValue:n.value,"onUpdate:modelValue":g[2]||(g[2]=E=>n.value=E),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),tg=pe(eg,[["__scopeId","data-v-c35adef3"]]),sg={id:"typecho-test"},og={class:"method-list"},ag={class:"item"},ng={class:"item"},ig={class:"item"},lg={key:0,class:"item"},rg={class:"item"},cg={class:"item"},ka="getUsersBlogs",Sa="getRecentPostsCount",Ea="getRecentPosts",Ca="newPost",Aa="getPost",Ua="editPost",Ia="deletePost",xa="getCategories",Ma="getPreviewUrl",Da="newMediaObject",pg=F({__name:"TypechoTest",setup(c){const o=W("typecho-test"),t=J("{}"),s=J(!1),e=J(null),a=J(""),n=J(!1),i=J("getUsersBlogs"),l=re({options:[{value:ka,label:"获取博客信息"},{value:Sa,label:"获取最新文章数目"},{value:Ea,label:"获取最新文章列表"},{value:Ca,label:"发布文章"},{value:Aa,label:"获取文章详情"},{value:Ua,label:"编辑文章"},{value:Ia,label:"删除文章"},{value:xa,label:"获取分类列表"},{value:Ma,label:"获取文章预览地址"},{value:Da,label:"上传资源文件"}]}),u=y=>{switch(s.value=!1,y){case ka:{t.value="{}";break}case Sa:{t.value="{}";break}case Ea:{t.value=JSON.stringify({numOfPosts:10});break}case Ca:{t.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case Aa:{t.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case Ua:{t.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case Ia:{t.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case xa:{t.value="{}";break}case Ma:{t.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case Da:{t.value="{}",s.value=!0;break}default:{t.value="{}";break}}},r=async y=>{const p=y.target;p.files&&p.files[0]&&(e.value=p.files[0])},h=async()=>{n.value=!0,a.value="",a.value="typecho requesting...";try{const y=new fe;switch(o.info("appInstance=>",y),i.value){case ka:{const g=await _e.getAdaptor("metaweblog_Typecho"),d=await U.blogApi(y,g).getUsersBlogs();a.value=JSON.stringify(d),o.info("typecho users blogs=>",d);break}case Sa:break;case Ea:break;case Ca:break;case Aa:break;case Ua:break;case Ia:break;case xa:break;case Ma:break;case Da:{const g=await _e.getAdaptor("metaweblog_Typecho"),_="https://static-rs-terwer.oss-cn-beijing.aliyuncs.com/test/image-20230812091531-hibwr1g.png",d=_.substring(_.lastIndexOf("/")+1),P=(await In(_)).imageBase64;o.debug("imageBase64=>",{imageBase64:P});const S=xn(P);o.debug("bits=>",S);const E=new ns(d,"image/png",S);o.info("mediaObject=>",E);const M=U.blogApi(y,g);o.info("typechoApi=>",M);const x=await M.newMediaObject(E);a.value=JSON.stringify(x),o.info("typecho new mediaObject result=>",x);break}default:break}n.value=!1}catch(y){a.value=y,o.error(y),n.value=!1}};return(y,p)=>{const g=rt,_=ct,d=Se,v=Ie,P=Ve;return w(),C(P,{title:"Typecho测试"},{default:b(()=>[k("div",sg,[k("div",og,[f(_,{modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=S=>i.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:u},{default:b(()=>[(w(!0),O(Ee,null,xe(l.options,S=>(w(),C(g,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",ag,[f(d,{type:"primary",loading:n.value,onClick:h},{default:b(()=>[R("开始测试typecho")]),_:1},8,["loading"])]),k("div",ng,[f(d,null,{default:b(()=>[R("入参")]),_:1})]),k("div",ig,[f(v,{modelValue:t.value,"onUpdate:modelValue":p[1]||(p[1]=S=>t.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),s.value?(w(),O("div",lg,[k("input",{type:"file",onChange:r},null,32)])):Y("",!0),k("div",rg,[f(d,null,{default:b(()=>[R("结果")]),_:1})]),k("div",cg,[f(v,{modelValue:a.value,"onUpdate:modelValue":p[2]||(p[2]=S=>a.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),ug=pe(pg,[["__scopeId","data-v-bd526ffb"]]),dg={id:"yuque-test"},gg={class:"method-list"},mg={class:"item"},hg={class:"item"},fg={class:"item"},yg={key:0,class:"item"},bg={class:"item"},_g={class:"item"},Oa="getUsersBlogs",Va="getRecentPostsCount",$a="getRecentPosts",Na="newPost",La="getPost",Ha="editPost",Ra="deletePost",Ga="getCategories",Ba="getPreviewUrl",ja="newMediaObject",wg=F({__name:"YuqueTest",setup(c){const o=W("yuque-test"),{t}=Z(),s=J("{}"),e=J(!1),a=J(null),n=J(""),i=J(!1),l=J("getUsersBlogs"),u=re({options:[{value:Oa,label:"获取博客信息"},{value:Va,label:"获取最新文章数目"},{value:$a,label:"获取最新文章列表"},{value:Na,label:"发布文章"},{value:La,label:"获取文章详情"},{value:Ha,label:"编辑文章"},{value:Ra,label:"删除文章"},{value:Ga,label:"获取分类列表"},{value:Ba,label:"获取文章预览地址"},{value:ja,label:"上传资源文件"}]}),r=p=>{switch(e.value=!1,p){case Oa:{s.value="{}";break}case Va:{s.value="{}";break}case $a:{s.value=JSON.stringify({numOfPosts:10});break}case Na:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case La:{s.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case Ha:{s.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case Ra:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case Ga:{s.value="{}";break}case Ba:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case ja:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},h=async p=>{const g=p.target;g.files&&g.files[0]&&(a.value=g.files[0])},y=async()=>{i.value=!0,n.value="",n.value="yuque requesting...";try{const p=new fe;switch(o.info("appInstance=>",p),l.value){case Oa:{const _=await _e.getAdaptor("common_Yuque"),v=await U.blogApi(p,_).getUsersBlogs();n.value=JSON.stringify(v),o.info("yuque users blogs=>",v);break}case Va:break;case $a:break;case Na:break;case La:break;case Ha:break;case Ra:break;case Ga:break;case Ba:break;case ja:{const g=a.value,_=await Gs(g),d=new ns(g.name,g.type,_);o.info("mediaObject=>",d);const v={name:d.name,type:d.type,bits:d.bits,overwrite:!0},P="http://127.0.0.1:3000/xmlrpc.php",E=await new ei(P,"",{}).methodCall("metaWeblog.newMediaObject",["","terwer","123456",v]);n.value=JSON.stringify(E),o.info("yuque new mediaObject result=>",E);break}default:break}i.value=!1}catch(p){n.value=p,o.error(t("main.opt.failure")+"=>",p),i.value=!1}};return(p,g)=>{const _=rt,d=ct,v=Se,P=Ie,S=Ve;return w(),C(S,{title:"语雀测试"},{default:b(()=>[k("div",dg,[k("div",gg,[f(d,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),class:"m-2",placeholder:"请选择方法名称",onChange:r},{default:b(()=>[(w(!0),O(Ee,null,xe(u.options,E=>(w(),C(_,{key:E.value,label:E.label,value:E.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",mg,[f(v,{type:"primary",loading:i.value,onClick:y},{default:b(()=>[R("开始测试yuque")]),_:1},8,["loading"])]),k("div",hg,[f(v,null,{default:b(()=>[R("入参")]),_:1})]),k("div",fg,[f(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),O("div",yg,[k("input",{type:"file",onChange:h},null,32)])):Y("",!0),k("div",bg,[f(v,null,{default:b(()=>[R("结果")]),_:1})]),k("div",_g,[f(P,{modelValue:n.value,"onUpdate:modelValue":g[2]||(g[2]=E=>n.value=E),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),vg=pe(wg,[["__scopeId","data-v-52e82541"]]),Pg={id:"zhihu-test"},Tg={class:"method-list"},kg={class:"item"},Sg={class:"item"},Eg={class:"item"},Cg={key:0,class:"item"},Ag={class:"item"},Ug={class:"item"},Ka="getMetaData",Ig=F({__name:"ZhihuTest",setup(c){const o=W("zhihu-test"),{t}=Z(),s=J("{}"),e=J(!1),a=J(null),n=J(""),i=J(!1),l=J("getMetaData"),u=re({options:[{value:Ka,label:"获取元数据信息"}]}),r=p=>{switch(e.value=!1,p){case Ka:{s.value="{}";break}default:{s.value="{}";break}}},h=async p=>{const g=p.target;g.files&&g.files[0]&&(a.value=g.files[0])},y=async()=>{i.value=!0,n.value="",n.value="zhihu requesting...";try{const p=new fe;switch(o.info("appInstance=>",p),l.value){case Ka:{const _=await _e.getAdaptor("custom_Zhihu"),v=await U.webApi(p,_).getMetaData();n.value=JSON.stringify(v),o.info("zhihu meta data=>",v);break}default:break}i.value=!1}catch(p){n.value=p,o.error(t("main.opt.failure")+"=>",p),i.value=!1}};return(p,g)=>{const _=rt,d=ct,v=Se,P=Ie,S=Ve;return w(),C(S,{title:"知乎测试"},{default:b(()=>[k("div",Pg,[k("div",Tg,[f(d,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),class:"m-2",placeholder:"请选择方法名称",onChange:r},{default:b(()=>[(w(!0),O(Ee,null,xe(u.options,E=>(w(),C(_,{key:E.value,label:E.label,value:E.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",kg,[f(v,{type:"primary",loading:i.value,onClick:y},{default:b(()=>[R("开始测试zhihu")]),_:1},8,["loading"])]),k("div",Sg,[f(v,null,{default:b(()=>[R("入参")]),_:1})]),k("div",Eg,[f(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),O("div",Cg,[k("input",{type:"file",onChange:h},null,32)])):Y("",!0),k("div",Ag,[f(v,null,{default:b(()=>[R("结果")]),_:1})]),k("div",Ug,[f(P,{modelValue:n.value,"onUpdate:modelValue":g[2]||(g[2]=E=>n.value=E),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),xg=pe(Ig,[["__scopeId","data-v-4c16df45"]]),Mg={id:"csdn-test"},Dg={class:"method-list"},Og={class:"item"},Vg={class:"item"},$g={class:"item"},Ng={key:0,class:"item"},Lg={class:"item"},Hg={class:"item"},za="getMetaData",Wa="getUsersBlogs",Rg=F({__name:"CsdnTest",setup(c){const o=W("csdn-test"),{t}=Z(),s=J("{}"),e=J(!1),a=J(null),n=J(""),i=J(!1),l=J("getMetaData"),u=re({options:[{value:za,label:"获取元数据信息"},{value:Wa,label:"获取博客信息"}]}),r=p=>{switch(e.value=!1,p){case za:{s.value="{}";break}case Wa:{s.value="{}";break}default:{s.value="{}";break}}},h=async p=>{const g=p.target;g.files&&g.files[0]&&(a.value=g.files[0])},y=async()=>{i.value=!0,n.value="",n.value="csdn requesting...";try{const p=new fe;switch(o.info("appInstance=>",p),l.value){case za:{const _=await _e.getAdaptor("custom_Csdn"),v=await U.webApi(p,_).getMetaData();n.value=JSON.stringify(v),o.info("csdn meta data=>",v);break}case Wa:{const _=await _e.getAdaptor("custom_Csdn"),v=await U.webApi(p,_).getUsersBlogs();n.value=JSON.stringify(v),o.info("csdn users blogs=>",v);break}default:break}i.value=!1}catch(p){n.value=p,o.error(t("main.opt.failure")+"=>",p),i.value=!1}};return(p,g)=>{const _=rt,d=ct,v=Se,P=Ie,S=Ve;return w(),C(S,{title:"CSDN测试"},{default:b(()=>[k("div",Mg,[k("div",Dg,[f(d,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),class:"m-2",placeholder:"请选择方法名称",onChange:r},{default:b(()=>[(w(!0),O(Ee,null,xe(u.options,E=>(w(),C(_,{key:E.value,label:E.label,value:E.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",Og,[f(v,{type:"primary",loading:i.value,onClick:y},{default:b(()=>[R("开始测试csdn")]),_:1},8,["loading"])]),k("div",Vg,[f(v,null,{default:b(()=>[R("入参")]),_:1})]),k("div",$g,[f(P,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=E=>s.value=E),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),O("div",Ng,[k("input",{type:"file",onChange:h},null,32)])):Y("",!0),k("div",Lg,[f(v,null,{default:b(()=>[R("结果")]),_:1})]),k("div",Hg,[f(P,{modelValue:n.value,"onUpdate:modelValue":g[2]||(g[2]=E=>n.value=E),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}}),Gg=pe(Rg,[["__scopeId","data-v-6e5e83d6"]]),Bg={id:"picgo-test"},jg=F({__name:"PicgoTest",props:{pageId:{type:String,default:""}},setup(c){const o=W("picgo-test"),{handlePicgo:t}=Do(),{query:s}=qe(),e=s.id??Ws(),a=c,n=async()=>{const i=T.isEmptyString(a.pageId)?e:a.pageId,l=await t(i);o.debug("图片处理完毕, md =>",l)};return(i,l)=>{const u=Se,r=Ve;return w(),C(r,{title:"Picgo测试"},{default:b(()=>[k("div",Bg,[f(u,{onClick:n},{default:b(()=>[R("测试")]),_:1})])]),_:1})}}}),Kg=pe(jg,[["__scopeId","data-v-21d58747"]]),zg={id:"other-test"},Wg=`

​​![image](https://img1.terwer.space/api/public/202308142037187.png)​​

dfgvdfgfd

地方GV发的

​![image](https://img1.terwer.space/api/public/202308142036226.png)​

‍

​![](https://img1.terwer.space/202308142041443.png)​
`,Fg=F({__name:"OtherTest",setup(c){const o=re({content:Wg}),t=()=>{const s=o.content,e=pi.markdownToNotion(s);console.log("notionObject =>",e)};return(s,e)=>{const a=Ie,n=Ce,i=Se,l=Qe,u=Ve;return w(),C(u,{title:"其他测试"},{default:b(()=>[k("div",zg,[f(l,null,{default:b(()=>[f(n,null,{default:b(()=>[f(a,{modelValue:o.content,"onUpdate:modelValue":e[0]||(e[0]=r=>o.content=r),style:{width:"75%","margin-right":"16px"},type:"textarea",rows:10},null,8,["modelValue"])]),_:1}),f(n,null,{default:b(()=>[f(i,{onClick:t},{default:b(()=>[R("测试Notion")]),_:1})]),_:1})]),_:1})])]),_:1})}}}),Jg=pe(Fg,[["__scopeId","data-v-d3239933"]]),qg={class:"chat-output"},Yg=F({__name:"ChatgptTest",setup(c){const o=W("chatgpt-test"),{t}=Z(),s=J(""),e=J(""),a=re({isLoading:!1}),n=async()=>{if(s.value.trim()===""){Q.error("请输入文本");return}a.isLoading=!0;try{const{chat:l}=Ot(),u=await l(s.value);if(T.isEmptyString(u)){Q.error("请求错误，请在底部偏好设置修改请求地址和ChatGPT key！");return}e.value+=`> ${s.value}
${u}

`,s.value=""}catch(l){o.error(t("main.opt.failure")+"=>",l),Q.error(t("main.opt.failure")+"=>"+l)}finally{a.isLoading=!1}},i=()=>{e.value=""};return(l,u)=>{const r=Ie,h=Ce,y=Se,p=Qe,g=Ve;return w(),C(g,{title:"AI聊天"},{default:b(()=>[f(p,{class:"chatgpt-form"},{default:b(()=>[f(h,null,{default:b(()=>[f(r,{modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=_=>s.value=_),autosize:{minRows:4,maxRows:16},type:"textarea",class:"chat-input",placeholder:"请输入文本..."},null,8,["modelValue"])]),_:1}),f(h,null,{default:b(()=>[f(y,{type:"primary",onClick:n,loading:a.isLoading},{default:b(()=>[R("发送消息")]),_:1},8,["loading"]),f(y,{type:"danger",onClick:i},{default:b(()=>[R("清屏")]),_:1})]),_:1}),f(h,null,{default:b(()=>[k("div",qg,[k("pre",null,K(e.value),1)])]),_:1})]),_:1})]),_:1})}}}),Xg=pe(Yg,[["__scopeId","data-v-e49ecba0"]]),Js=()=>{const{t:c}=Z(),o=Xr(c),t=[...Ke.commonCfg,...Ke.githubCfg,...Ke.gitlabCfg,...Ke.metaweblogCfg,...Ke.wordpressCfg,...Ke.customCfg];return{getPrePlatformKeys:()=>t.map(l=>l.platformKey),platformTypeList:o,getPlatformType:l=>o.find(u=>u.type===l),getAllPrePlatformList:()=>t,getPrePlatformList:l=>t.filter(u=>u.platformType===l),getPrePlatform:l=>t.find(u=>u.platformKey===l)}},Zg=["src"],Hi=F({__name:"DrawerBoxBridge",props:{src:{type:String,default:""}},setup(c){const{t:o}=Z();return(t,s)=>{const e=pl("resize");return w(),O("div",null,[Yn(k("iframe",{width:"100%",src:c.src,frameborder:"0"},null,8,Zg),[[e,{loadText:m(o)("page.loading")}]])])}}}),Qg={class:"platform-title"},em={class:"platform-desc"},tm={class:"text-desc"},sm={class:"icon-list"},om={class:"platform-box"},am={class:"el-icon"},nm=["innerHTML"],im={key:0,class:"add-action"},lm=F({__name:"PlatformQuickAdd",props:{apiType:{type:String,default:""}},setup(c){const o=W("platform-quick-add"),t=c;Z(),wt();const s=qe(),{getPlatformType:e,getPrePlatformList:a,getAllPrePlatformList:n}=Js(),i=re(s.params),l=J(t.apiType??i.type),u=J(!1),r=J(""),h=J("");Je(()=>t.apiType,v=>{l.value=v,d()});const y=re({platformGroup:{},pre:[]}),p=(v,P)=>{r.value=v,h.value=P,u.value=!0},g=(v,P)=>{const E=`${window.origin}${Cn}#${P}`;o.debug(`Publisher will go to ${E}`),p(v,E)},_=v=>{const P=(v==null?void 0:v.platformType)??"",S=(v==null?void 0:v.platformKey)??"",E=(v==null?void 0:v.subPlatformType)??"",M=`/setting/platform/add/${P}?showBack=trye&key=${S}&sub=${E}`,x=Mt.longPlatformName((v==null?void 0:v.platformName)??(v==null?void 0:v.platformType)??"");g(`添加 ${x} 平台`,M)},d=()=>{l.value==="all"?(y.platformGroup={type:"all",title:"全部",img:"",description:"全部平台列表"},y.pre=n()):(y.platformGroup=e(l.value),y.pre=a(l.value))};return Ye(()=>{d()}),(v,P)=>{const S=Ne,E=Ns,M=Se,x=To,z=En;return w(),O("div",null,[f(x,{class:"platform-add-card"},{default:b(()=>{var L,j;return[k("div",Qg,K(l.value==="all"?"全部":((L=y.platformGroup)==null?void 0:L.title)??l.value),1),k("div",em,[k("div",tm,K(((j=y.platformGroup)==null?void 0:j.description)??""),1),k("p",null,[f(S,{class:"desc-tip",type:"info",title:"点击图标快速添加，或者点击下方按钮自定义添加"})])]),k("div",sm,[k("div",om,[(w(!0),O(Ee,null,xe(y.pre,I=>(w(),C(E,{class:"define-item",onClick:A=>_(I),title:I.platformName},{default:b(()=>[k("i",am,[k("span",{innerHTML:I==null?void 0:I.platformIcon},null,8,nm)]),R(" "+K(m(Mt).shortPlatformName(I.platformName,6)),1)]),_:2},1032,["onClick","title"]))),256))])]),l.value!=="all"?(w(),O("div",im,[f(M,{type:"primary",size:"large",onClick:P[0]||(P[0]=I=>_({platformType:l.value}))},{default:b(()=>{var I;return[R(" 添加自定义 "+K(((I=y.platformGroup)==null?void 0:I.title)??l.value)+" 对接 ",1)]}),_:1})])):Y("",!0)]}),_:1}),f(z,{modelValue:u.value,"onUpdate:modelValue":P[1]||(P[1]=L=>u.value=L),size:"85%",title:r.value,direction:"rtl","destroy-on-close":!0},{default:b(()=>[f(Hi,{src:h.value},null,8,["src"])]),_:1},8,["modelValue","title"])])}}}),Ri=pe(lm,[["__scopeId","data-v-31ba5f78"]]),rm=F({__name:"PublishPlatformStore",setup(c){const o=W("publish-platform-import"),{getSetting:t}=me(),{platformTypeList:s}=Js(),e=J("all"),a=re({setting:{},dynamicConfigArray:[],platformTypeList:s}),n=l=>{e.value=l},i=async()=>{a.setting=await t(),o.info("get setting from platform setting",a.setting);const l=se.safeParse(a.setting[De],{});a.dynamicConfigArray=(l==null?void 0:l.totalCfg)||[],o.debug("store dynamic init page=>",a.dynamicConfigArray)};return Ye(async()=>{await i()}),(l,u)=>{const r=Rl,h=Ls,y=Ri;return w(),O("div",null,[(w(),C(h,{modelValue:e.value,"onUpdate:modelValue":u[1]||(u[1]=p=>e.value=p),style:{"margin-bottom":"30px"},key:e.value},{default:b(()=>[f(r,{key:"all",value:"all",onClick:u[0]||(u[0]=p=>n("all"))},{default:b(()=>[R("全部")]),_:1}),(w(!0),O(Ee,null,xe(m(s),p=>(w(),C(r,{key:p.type,value:p.type,onClick:g=>n(p.type)},{default:b(()=>[R(K(p.title),1)]),_:2},1032,["value","onClick"]))),128))]),_:1},8,["modelValue"])),f(y,{"api-type":e.value},null,8,["api-type"])])}}}),cm={class:"flex flex-wrap gap-4 import-select"},pm={class:"log-message-box"},um={class:"import-panel"},dm={class:"import-panel"},gm=F({__name:"PublishPlatformImport",setup(c){const o=W("publish-platform-import"),{t}=Z(),{getSetting:s,updateSetting:e,deleteKey:a}=me(),{platformTypeList:n,getPrePlatformList:i,getAllPrePlatformList:l}=Js(),u=J(!1),r=J(""),h=J(!1),y=J(""),p=re({setting:{},dynamicConfigArray:[],isImportLoading:!1,showLogMessage:!1,logMessage:"",customImport:{path:[],datas:[]}}),g=(z,L)=>{const j=Me.formatIsoToZh(new Date().toISOString(),!0);p.logMessage+=`[${j}] ${z} ${L}
`},_=z=>{let L=0;for(const j of z){const I=j.platformKey;if(mi(p.dynamicConfigArray,I)){g(I,`${I} 已经存在，忽略导入`);continue}const A=we.cloneDeep(j);p.dynamicConfigArray.push(A),g(I,"已加入导入列表"),p.setting[I]={},g(I,"已导入并初始化成功"),L++}return L},d=()=>{Pt.confirm("确认要导入全部内置平台吗？","温馨提示",{type:"warning",icon:Ct(Vs),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{await v()}).catch(()=>{})},v=async()=>{p.showLogMessage=!0,p.isImportLoading=!0,p.logMessage="";let z=0;if(z+=_(Ke.commonCfg),z+=_(Ke.githubCfg),z+=_(Ke.gitlabCfg),z+=_(Ke.metaweblogCfg),z+=_(Ke.wordpressCfg),z+=_(Ke.customCfg),p.isImportLoading=!1,z>0){const L=dt(p.dynamicConfigArray);p.setting[De]=L,await e(p.setting),await x(),p.logMessage+="全部导入成功并保存",Q.success("全部导入成功并保存")}else p.logMessage+="未发现新平台，忽略导入",Q.warning("未发现新平台，忽略导入")},P=()=>{u.value=!0,r.value="自定义导入"},S=()=>{h.value=!0,y.value="从「挂件版」 v0.8.1 导入"},E=async(z,L)=>{if(z.isLeaf)return L([]);let j,I=z.data.value||"";if(I===""&&p.customImport.path.length==0?j="":(I===""&&(I=""),j=I),T.isEmptyString(j)){const A=[];n.forEach($=>{const q={value:$.type,label:$.title,isLeaf:!1};A.push(q)}),L(A)}else{const A=[];i(j).forEach(q=>{if(q.platformType===j){const G={value:q.platformKey,label:q.platformName,isLeaf:!0};A.push(G)}p.dynamicConfigArray.some(G=>G.platformKey===q.platformKey)&&p.customImport.path.push(q.platformKey)}),L(A)}},M=async()=>{const z=p.customImport.path;if(z.length===0){p.logMessage+="未选择平台，忽略导入",Q.warning("未选择平台，忽略导入");return}const L=[];l().forEach(A=>{z.includes(A.platformKey)&&L.push(A)}),p.showLogMessage=!0,p.isImportLoading=!0,p.logMessage="";let I=0;if(I+=_(L),p.isImportLoading=!1,I>0){const A=dt(p.dynamicConfigArray);p.setting[De]=A,await e(p.setting),await x(),p.logMessage+="选择的自定义平台已成功导入并保存",Q.success("选择的自定义平台已成功导入并保存")}else p.logMessage+="未发现新平台，忽略导入",Q.warning("未发现新平台，忽略导入")},x=async()=>{p.setting=await s(),o.info("get setting from platform setting",p.setting);const z=se.safeParse(p.setting[De],{});p.dynamicConfigArray=(z==null?void 0:z.totalCfg)||[],o.debug("import dynamic init page=>",p.dynamicConfigArray)};return Ye(async()=>{await x()}),(z,L)=>{const j=To,I=Ie,A=So,$=Ce,q=Se,G=Qe,H=En,X=Ne;return w(),O("div",cm,[f(j,{shadow:"always",class:"select-item",onClick:d},{default:b(()=>[R(" 一键全部导入")]),_:1}),f(j,{shadow:"hover",class:"select-item",onClick:P},{default:b(()=>[R("自定义导入")]),_:1}),f(j,{shadow:"hover",class:"select-item",onClick:S},{default:b(()=>[R(" 从旧版 v0.8.1 版本「思源笔记挂件」导入 ")]),_:1}),k("div",pm,[p.showLogMessage?(w(),C(I,{key:0,modelValue:p.logMessage,"onUpdate:modelValue":L[0]||(L[0]=ve=>p.logMessage=ve),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])):Y("",!0)]),f(H,{modelValue:u.value,"onUpdate:modelValue":L[2]||(L[2]=ve=>u.value=ve),size:"85%",title:r.value,direction:"rtl","destroy-on-close":!0},{default:b(()=>[k("div",um,[f(G,null,{default:b(()=>[f($,null,{default:b(()=>[f(A,{modelValue:p.customImport.path,"onUpdate:modelValue":L[1]||(L[1]=ve=>p.customImport.path=ve),"show-checkbox":"",lazy:"",multiple:"","check-on-click-node":"","default-expand-all":"",load:E,"empty-text":m(t)("main.data.empty"),"no-data-text":m(t)("main.data.empty"),placeholder:m(t)("main.opt.select")},null,8,["modelValue","empty-text","no-data-text","placeholder"])]),_:1}),f($,null,{default:b(()=>[f(q,{onClick:M,type:"primary"},{default:b(()=>[R("开始导入")]),_:1})]),_:1})]),_:1})])]),_:1},8,["modelValue","title"]),f(H,{modelValue:h.value,"onUpdate:modelValue":L[3]||(L[3]=ve=>h.value=ve),size:"85%",title:y.value,direction:"rtl","destroy-on-close":!0},{default:b(()=>[k("div",dm,[f(X,{closable:!1,title:m(t)("import.v081.warn"),class:"form-item-tip",type:"warning"},null,8,["title"])])]),_:1},8,["modelValue","title"])])}}}),mm=pe(gm,[["__scopeId","data-v-ab6f53f5"]]),hm=c=>(mt("data-v-0f21bfc2"),c=c(),ht(),c),fm=["href"],ym=hm(()=>k("a",{href:"https://img1.terwer.space/api/public/202309051734289.png",target:"_blank"},"此图片",-1)),bm=F({__name:"CookieSetting",props:{apiType:"",setting:{},settingCfg:{}},emits:["emitHideDlg"],setup(c,{emit:o}){const t=W("cookie-setting"),s=c,e=o,{t:a}=Z(),{updateSetting:n}=me(),i=J(),l=re({key:s.apiType,settingData:s.setting,settingCfgData:s.settingCfg}),u=re({}),r=async h=>{if(!(!h||!await h.validate((p,g)=>{p?t.debug("校验成功"):t.error(a("main.opt.failure"),g)}))){if(T.isEmptyString(l.key)){Q.error("平台key不能为空，请排查。如有问题，请联系作者");return}l.settingData[l.key]=l.settingCfgData,await n(l.settingData),e&&e("emitHideDlg"),Q.success(a("main.opt.success"))}};return(h,y)=>{const p=Ne,g=Ce,_=Ie,d=Se,v=Qe;return w(),O("div",null,[f(v,{class:"add-form",ref_key:"formRef",ref:i,"label-width":"100px",model:l.settingCfgData,rules:u},{default:b(()=>[f(p,{class:"top-tip",title:"检测到当前为浏览器页面或者受平台技术限制，无法获取Cookie，请手动粘贴平台Cookie。本插件承诺，所有数据仅在您的本地存储，我们不会上传或者分享你的任何数据，请放心使用。如有疑问请查看帮助文档。",type:"error",closable:!1}),f(g,null,{default:b(()=>[R(" 特别提示：受平台限制，当前无法自动获取cookie，请在Chrome浏览器手动打开   "),k("a",{href:l.settingCfgData.home,target:"_blank"},K(l.settingCfgData.home),9,fm),R("  并登录，然后使用开发者工具找到cookie，最后复制粘贴到下方文本框，可参考 "),ym,R(" 的指引。 ")]),_:1}),f(g,{label:"平台Cookie"},{default:b(()=>[f(_,{modelValue:l.settingCfgData.password,"onUpdate:modelValue":y[0]||(y[0]=P=>l.settingCfgData.password=P),style:{width:"75%","margin-right":"16px"},placeholder:"请直接粘贴平台cookie，为了您的隐私安全，请勿泄露cookie给任何人",type:"textarea",rows:10},null,8,["modelValue"])]),_:1}),f(g,null,{default:b(()=>[f(d,{type:"primary",onClick:y[1]||(y[1]=P=>r(i.value))},{default:b(()=>[R(K(m(a)("setting.blog.save")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}}),_m=pe(bm,[["__scopeId","data-v-0f21bfc2"]]),wm={key:0},vm={key:1},Pm={class:"publish-right-setting"},Tm={class:"platform-item"},km=["innerHTML"],Sm={class:"item-right"},Em={class:"text"},Cm=["title"],Am=["onClick"],Um=["innerHTML"],Im={class:"actions"},xm=F({__name:"PublishPlatformSettingList",setup(c){const o=W("publish-platform-setting-list"),{t}=Z(),s=wt(),{getSetting:e,updateSetting:a,deleteKey:n}=me(),{getPrePlatformKeys:i}=Js(),{isInSiyuanOrSiyuanNewWin:l,isInChromeExtension:u}=at(),r=re({setting:{},dynamicConfigArray:[],newPlatformCount:0,newPlatformTip:"",webAuthLoadingMap:{},cookieSettingFormVisible:!1,dlgCookieTitle:"",dlgKey:"",dlgSettingCfg:{}}),h=A=>{s.push({path:`/setting/platform/update/${A.platformKey}`,query:{showBack:"true"}})},y=async A=>{r.dynamicConfigArray=Wt(r.dynamicConfigArray,A.platformKey,A);const $=dt(r.dynamicConfigArray);r.setting[De]=$,await a(r.setting)},p=async A=>{const $=A.platformKey;await s.push({path:`/setting/platform/single/${$}`,query:{showBack:"true"}})},g=A=>{Pt.confirm(`确认要删除【${A.platformName}】吗，所有与此平台相关的配置都将永久删除？`,"温馨提示",{type:"error",icon:Ct(Vs),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{r.dynamicConfigArray=Yr(r.dynamicConfigArray,A.platformKey);const $=dt(r.dynamicConfigArray);r.setting[De]=$,delete r.setting[A.platformKey],n(A.platformKey),await a(r.setting),await I(),Q.success(t("main.opt.success"))}).catch(()=>{})},_=async A=>{A.cookieLimit?await P(A):l()?await d(A):u()?v(A):await P(A)},d=async A=>{Pt.confirm(`将打开 [${A.platformName}] 登录授权页面，您需要在新页面完成登录，然后点击验证查看授权结果，是否继续？`,"网页授权",{type:"warning",icon:Ct(Rn),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{if(A.isAuth){A.isAuth=!1,r.dynamicConfigArray=Wt(r.dynamicConfigArray,A.platformKey,A);const $=dt(r.dynamicConfigArray);r.setting[De]=$,await a(r.setting),o.info("已授权，将清空状态，并重新进行授权，授权完成需要重新验证")}else o.info("未授权，准备开始授权");Fo(A.authUrl)}).catch(()=>{})},v=A=>{Pt.confirm(`将打开 [${A.platformName}] 登录授权页面，您需要在新页面完成登录，然后点击验证查看授权结果，是否继续？`,"网页授权",{type:"warning",icon:Ct(Rn),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{if(A.isAuth){A.isAuth=!1,r.dynamicConfigArray=Wt(r.dynamicConfigArray,A.platformKey,A);const $=dt(r.dynamicConfigArray);r.setting[De]=$,await a(r.setting),o.info("已授权，将清空状态，并重新进行授权，授权完成需要重新验证")}else o.info("未授权，准备开始授权");window.open(A.authUrl)}).catch(()=>{})},P=async A=>{await S(A)},S=async A=>{if(A.isAuth){A.isAuth=!1,r.dynamicConfigArray=Wt(r.dynamicConfigArray,A.platformKey,A);const G=dt(r.dynamicConfigArray);r.setting[De]=G,await a(r.setting),o.info("已授权，将清空状态，并重新进行授权，授权完成需要重新验证")}else o.info("未授权，准备开始授权");const $=se.safeParse(r.setting[A.platformKey],{}),q=await _e.getCfg(A.platformKey,$);r.dlgKey=A.platformKey,r.dlgSettingCfg=q,r.dlgCookieTitle=`${A.platformName} Cookie 设置`,r.cookieSettingFormVisible=!0},E=async A=>{A.cookieLimit?await L(A):l()?M(A):u()?await z(A):await L(A)},M=A=>{const $=async(q,G)=>{o.debug("get cookie result=>",G),r.webAuthLoadingMap[q.platformKey]=!0;const H=new fe,X=await _e.getCfg(q.platformKey),ve=await _e.getAdaptor(q.platformKey,X),Le=U.webApi(H,ve);try{const Be=await Le.buildCookie(G),ze=X;ze.password=Be,r.setting[q.platformKey]=ze,await a(r.setting),Le.updateCfg(ze);const He=await Le.getMetaData();if(o.debug("get meta data=>",He),He.flag){q.isAuth=!0;const ie=se.safeParse(r.setting[q.platformKey],{});ie.metadata=He,r.setting[q.platformKey]=ie,await a(r.setting),o.info("已更新最新的metadata"),Q.success("验证成功，该平台可正常使用")}else q.isAuth=!1,Q.error("验证失败，该平台将不可用")}catch(Be){q.isAuth=!1;const ze=t("main.opt.failure")+"=>"+Be;o.error(t("main.opt.failure")+"=>",Be);const He=q.logoutUrl??X.logoutUrl;if(T.isEmptyString(He))Q.error(ze);else{const ie=ze+"，是否需要退出登录？注意：！！！本窗口只负责退出，登录信息填写无效！！！，需要稍后重新点击授权操作登录？";x(ie,He)}}r.dynamicConfigArray=Wt(r.dynamicConfigArray,q.platformKey,q);const Xe=dt(r.dynamicConfigArray);r.setting[De]=Xe,await a(r.setting),r.webAuthLoadingMap[q.platformKey]=!1};Fo(A.authUrl,A,$)},x=(A,$)=>{Pt.confirm(A,"温馨提示",{type:"error",icon:Ct(bn),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{Fo($)}).catch(()=>{})},z=async A=>{r.webAuthLoadingMap[A.platformKey]=!0;try{const q=new fe,G=await _e.getCfg(A.platformKey),H=await _e.getAdaptor(A.platformKey,G),ve=await U.webApi(q,H).getMetaData();if(ve.flag){A.isAuth=!0;const Le=G;Le.metadata=ve,r.setting[A.platformKey]=Le,await a(r.setting),o.info("已更新最新的metadata"),Q.success("验证成功，该平台可正常使用")}else A.isAuth=!1,Q.error("验证失败，该平台将不可用")}catch(q){A.isAuth=!1,Q.error(t("main.opt.failure")+"=>"+q+"，如果是登录过期，请在左侧点击「授权」修改新的 cookie 或者参考 https://blog.terwer.space/s/20230810132040-nn4q7vs FAQ4 解决"),o.error(t("main.opt.failure")+"=>",q)}r.dynamicConfigArray=Wt(r.dynamicConfigArray,A.platformKey,A);const $=dt(r.dynamicConfigArray);r.setting[De]=$,await a(r.setting),r.webAuthLoadingMap[A.platformKey]=!1},L=async A=>{await z(A)},j=()=>{r.cookieSettingFormVisible=!1},I=async()=>{r.setting=await e(),o.info("get setting from platform setting",r.setting);const A=se.safeParse(r.setting[De],{});r.dynamicConfigArray=(A==null?void 0:A.totalCfg)||[],o.debug("dynamic init page=>",r.dynamicConfigArray);const $=[],q=i(),G=r.dynamicConfigArray.map(H=>H.platformKey);r.newPlatformCount=0;for(const H of q)G.includes(H)||(r.newPlatformCount++,$.push(H));r.newPlatformCount>0&&(r.newPlatformTip=t("platform.new.platform").replace("[count]",r.newPlatformCount).replace("[platform]",$.join(", ")))};return Ye(async()=>{await I()}),(A,$)=>{const q=Ne,G=Co,H=Ns,X=Pn,ve=Xt,Le=Se,Xe=Tn,Be=kn,ze=_m,He=Gl;return w(),O("div",null,[r.dynamicConfigArray.length===0?(w(),O("div",wm,[f(q,{class:"no-tip",type:"error",title:m(t)("platform.must.select.one")},null,8,["title"])])):(w(),O("div",vm,[k("div",Pm,[f(Be,{gutter:20,class:"platform-list"},{default:b(()=>[(w(!0),O(Ee,null,xe(r.dynamicConfigArray,ie=>(w(),C(Xe,{key:ie.platformKey,span:11,class:"platform-item-box"},{default:b(()=>[k("div",Tm,[f(G,{class:"item-left-icon"},{default:b(()=>[k("span",{class:"item-icon",innerHTML:ie.platformIcon},null,8,km)]),_:2},1024),k("div",Sm,[k("div",Em,[f(X,{value:ie.isAuth?"已授权":ie.authMode===m(ge).API?"设置无效":"没有授权",class:"badge-item",type:ie.isAuth?"success":"danger"},{default:b(()=>[k("span",{title:ie.platformName},K(m(Mt).longPlatformName(ie.platformName,11)),9,Cm),k("span",{class:"name-edit",onClick:Re=>h(ie)},[f(G,null,{default:b(()=>[k("span",{innerHTML:m(ke).iconIFEdit},null,8,Um)]),_:1})],8,Am),f(H,{type:ie.authMode===m(ge).API?"primary":"info",class:"auth-mode-text"},{default:b(()=>[R(K(ie.authMode===m(ge).API?"API授权":"网页授权"),1)]),_:2},1032,["type"])]),_:2},1032,["value","type"])]),k("div",Im,[f(ve,{modelValue:ie.isEnabled,"onUpdate:modelValue":Re=>ie.isEnabled=Re,"inline-prompt":"",size:"small",class:"action-btn action-switch","active-text":"已启用","inactive-text":"未启用",onChange:Re=>y(ie)},null,8,["modelValue","onUpdate:modelValue","onChange"]),ie.isEnabled&&ie.authMode===m(ge).API?(w(),C(H,{key:0,class:"action-btn action-setting",onClick:Re=>p(ie)},{default:b(()=>[f(G,null,{default:b(()=>[f(m(Vo))]),_:1}),R(" 设置 ")]),_:2},1032,["onClick"])):Y("",!0),ie.isEnabled&&ie.authMode===m(ge).WEBSITE&&ie.isAuth?(w(),C(H,{key:1,class:"action-btn action-setting",onClick:Re=>p(ie)},{default:b(()=>[f(G,null,{default:b(()=>[f(m(Vo))]),_:1}),R(" 设置 ")]),_:2},1032,["onClick"])):Y("",!0),ie.isEnabled&&ie.authMode===m(ge).WEBSITE?(w(),C(H,{key:2,class:"action-btn action-web-setting",onClick:Re=>_(ie)},{default:b(()=>[f(G,null,{default:b(()=>[f(m(Vo))]),_:1}),R(" "+K(ie.isAuth?"再次授权":"授权"),1)]),_:2},1032,["onClick"])):Y("",!0),ie.isEnabled&&ie.authMode===m(ge).WEBSITE&&!ie.isAuth?(w(),C(Le,{key:3,class:"action-btn action-web-auth",onClick:Re=>E(ie),size:"small",loading:r.webAuthLoadingMap[ie.platformKey]===!0},{default:b(()=>[f(G,null,{default:b(()=>[f(m(ul))]),_:1}),R(" 验证 ")]),_:2},1032,["onClick","loading"])):Y("",!0),ie.isEnabled?Y("",!0):(w(),C(H,{key:4,class:"action-btn action-del",onClick:Re=>g(ie)},{default:b(()=>[f(G,null,{default:b(()=>[f(m(Vs))]),_:1}),R(" 删除 ")]),_:2},1032,["onClick"]))])])])]),_:2},1024))),128))]),_:1}),r.newPlatformCount>0?(w(),C(Be,{key:0},{default:b(()=>[f(q,{type:"error",title:r.newPlatformTip},null,8,["title"])]),_:1})):Y("",!0)]),f(He,{modelValue:r.cookieSettingFormVisible,"onUpdate:modelValue":$[3]||($[3]=ie=>r.cookieSettingFormVisible=ie),title:r.dlgCookieTitle},{default:b(()=>[f(ze,{"api-type":r.dlgKey,"onUpdate:apiType":$[0]||($[0]=ie=>r.dlgKey=ie),setting:r.setting,"onUpdate:setting":$[1]||($[1]=ie=>r.setting=ie),"setting-cfg":r.dlgSettingCfg,"onUpdate:settingCfg":$[2]||($[2]=ie=>r.dlgSettingCfg=ie),onEmitHideDlg:j},null,8,["api-type","setting","setting-cfg"])]),_:1},8,["modelValue","title"])]))])}}}),Mm=pe(xm,[["__scopeId","data-v-bd276958"]]),Dm={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Om=k("path",{fill:"currentColor",d:"M9 19v-2h12v2zm0-6v-2h12v2zm0-6V5h12v2zM5 20q-.825 0-1.412-.587T3 18t.588-1.412T5 16t1.413.588T7 18t-.587 1.413T5 20m0-6q-.825 0-1.412-.587T3 12t.588-1.412T5 10t1.413.588T7 12t-.587 1.413T5 14m0-6q-.825 0-1.412-.587T3 6t.588-1.412T5 4t1.413.588T7 6t-.587 1.413T5 8"},null,-1),Vm=[Om];function $m(c,o){return w(),O("svg",Dm,[...Vm])}const Nm={name:"material-symbols-format-list-bulleted",render:$m},Lm={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Hm=k("path",{fill:"currentColor",d:"m14 12l-4-4v3H2v2h8v3m10 2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3h2V6h12v12H6v-3H4v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2"},null,-1),Rm=[Hm];function Gm(c,o){return w(),O("svg",Lm,[...Rm])}const Bm={name:"mdi-import",render:Gm},jm={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Km=k("path",{fill:"currentColor",d:"M20.506 10.896v7.989q0 .69-.463 1.153t-1.152.462H5.12q-.69 0-1.153-.462t-.462-1.153v-8.027q-.633-.467-.926-1.225t-.013-1.617l.973-3.208q.2-.612.645-.96Q4.63 3.5 5.286 3.5h13.4q.655 0 1.098.326q.442.326.648.943l1.011 3.246q.281.86-.012 1.631t-.926 1.25m-6.3-.396q.963 0 1.438-.54q.475-.539.4-1.114L15.38 4.5h-2.873v4.2q0 .737.504 1.268q.504.532 1.196.532m-4.5 0q.806 0 1.303-.532t.497-1.268V4.5H8.633l-.666 4.423q-.061.466.407 1.021t1.332.556m-4.45 0q.661 0 1.124-.45t.576-1.123L7.583 4.5H5.287q-.327 0-.52.144t-.288.433l-.923 3.158q-.246.788.21 1.527t1.49.738m13.5 0q.898 0 1.434-.7q.537-.7.266-1.565l-.973-3.196q-.096-.289-.289-.414t-.519-.125h-2.246l.627 4.427q.113.673.576 1.123t1.124.45"},null,-1),zm=[Km];function Wm(c,o){return w(),O("svg",jm,[...zm])}const Fm={name:"material-symbols-light-storefront",render:Wm},Jm={class:"right-setting-tips"},qm={class:"el-alert el-alert--warning is-light",role:"alert"},Ym={class:"el-alert__content"},Xm={class:"el-alert__title"},Zm=dl('<h2 data-v-155d66e9>FAQ:</h2><div class="setting-help" data-v-155d66e9> 不会配置，或者配置遇到问题？ 请加QQ群 <span style="font-weight:bold;color:red;" data-v-155d66e9><a href="https://qm.qq.com/cgi-bin/qm/qr?_wv=1027&amp;k=1Q1-wOLkBaG-iD0MBnNhNL25tbLSCwZx&amp;authKey=tBdJDGuWuXK%2B77hHlwwT6y8UAp9AGZTwQq6RzUa%2ByX81HCSHu4XVGqY0gbsBUcW0&amp;noverify=0&amp;group_code=895063267" target="_blank" data-v-155d66e9> 895063267 </a></span> 讨论。 </div><div class="setting-help" data-v-155d66e9> 需要详细的配置指导？请查看在线文档 <a href="https://blog.terwer.space/s/20230810132040-nn4q7vs" target="_blank" data-v-155d66e9>平台配置指南</a></div><div class="tips-form" data-v-155d66e9> 我想要的平台这里没有？<a href="https://terwergreen.feishu.cn/share/base/form/shrcnGRdThUiqnhBg15xgclMM0c" target="_blank" data-v-155d66e9> 点击这里提交发布工具平台适配跟踪表 </a></div><div class="tips-form" data-v-155d66e9> 我还有其他问题或者想私下沟通作者？<a href="mailto:youweics@163.com" data-v-155d66e9> 直接发邮件到：youweics@163.com </a></div>',5),Qm=F({__name:"PublishSettingTips",setup(c){const{t:o}=Z();return(t,s)=>(w(),O("div",Jm,[k("div",qm,[k("div",Ym,[k("div",Xm,[k("div",null,K(m(o)("setting.platform.right.tips0")),1),k("div",null,K(m(o)("setting.platform.right.tips1")),1),k("div",null,K(m(o)("setting.platform.right.tips2")),1),k("div",null,K(m(o)("setting.platform.right.tips3")),1),k("div",null,K(m(o)("setting.platform.right.tips4")),1)])])]),Zm]))}}),eh=pe(Qm,[["__scopeId","data-v-155d66e9"]]),th={class:"publish-setting-body"},sh={class:"el-icon"},oh={class:"el-icon"},ah={class:"el-icon"},nh=F({__name:"PublishSetting",setup(c){const{t:o}=Z(),t=J("publish");return(s,e)=>{const a=Mm,n=li,i=mm,l=rm,u=ri,r=Ve;return w(),C(r,{title:m(o)("service.tab.publish.setting")},{default:b(()=>[k("div",th,[(w(),C(u,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=h=>t.value=h),class:"setting-tabs",key:t.value},{default:b(()=>[f(n,{name:"publish"},{label:b(()=>[k("span",null,[k("i",sh,[f(m(Nm))]),R(" "+K(m(o)("service.tab.publish.setting")),1)])]),default:b(()=>[f(a)]),_:1}),f(n,{name:"import"},{label:b(()=>[k("span",null,[k("i",oh,[f(m(Bm))]),R(" "+K(m(o)("setting.platform.import")),1)])]),default:b(()=>[f(i)]),_:1}),f(n,{name:"store"},{label:b(()=>[k("span",null,[k("i",ah,[f(m(Fm))]),R(" "+K(m(o)("setting.platform.store")),1)])]),default:b(()=>[f(l)]),_:1})]),_:1},8,["modelValue"])),f(eh)])]),_:1},8,["title"])}}}),Gi=pe(nh,[["__scopeId","data-v-491a3b4c"]]),ih=F({__name:"SetIndex",setup(c){return(o,t)=>(w(),C(Gi))}}),lh=F({__name:"Setting",setup(c){return(o,t)=>(w(),C(ih))}}),rh={key:0},ch=["innerHTML"],ph={key:0},uh=F({__name:"PlatformAddForm",setup(c){const o=W("platform-add-form"),{t}=Z(),s=wt(),e=qe(),{query:a}=qe(),{getPlatformType:n,getPrePlatform:i}=Js(),{getSetting:l,updateSetting:u,checkKeyExists:r}=me(),h=re(e.params),y=h.type,p=J(),g=re({setting:{},ptype:y,subtype:void 0,subtypeOptions:[],isPre:!1,dynCfg:new xs(y,Ms(y,void 0),"None-1"),dynamicConfigArray:[]}),_=re({platformName:[{required:!0,message:()=>t("form.validate.name.required")}],authMode:[{required:!0,message:()=>t("form.validate.name.required")}],platformIcon:[{required:!0,message:()=>t("form.validate.name.required")}]}),d=M=>{if(!g.subtype)return Q.error("请选择子平台类型"),!1;const x=g.dynCfg.platformKey;return r(x)?(Q.error(t("dynamic.platform.opt.key.exist")),!1):!0},v=async M=>{if(!M||!d()||!await M.validate((j,I)=>{j?o.debug("校验成功"):o.error(t("main.opt.failure"),I)}))return;const z=g.dynCfg;g.dynamicConfigArray.push(z);const L=dt(g.dynamicConfigArray);g.setting[De]=L,g.setting[z.platformKey]={},await u(g.setting),Q.success(t("main.opt.success")),await s.push({path:"/setting/publish"})},P=async()=>{await S(g.ptype,g.subtype)},S=async(M,x)=>{const z=a.key;g.setting=await l();const L=se.safeParse(g.setting[De],{});if(g.dynamicConfigArray=(L==null?void 0:L.totalCfg)||[],!g.ptype){Q.error("平台类型不能为空");return}const j=n(g.ptype);let I=T.isEmptyString(j.img)?ke.iconEPPlus:`<img src="${j.img}" alt="platform-icon" class="img-platform-icon" style="width: 32px;height: 32px;"/>`;const A=!T.isEmptyString(z),$=!T.isEmptyString(x);if(A&&$)if(g.subtype=x,mi(g.dynamicConfigArray,z)){const G=i(z);I=G.platformIcon;const H=Ms(M,x),X=new xs(M,H,H,x,I);X.authMode=G.authMode,X.authUrl=G.authUrl??"",X.domain=G.domain??"",g.dynCfg=X,o.debug("pkey already exists, initialize the new one")}else{const G=i(z);g.dynCfg=G,g.isPre=!0,o.debug("Initialized via pkey")}else if($){g.subtype=x;const q=Ms(M,x);g.dynCfg=new xs(M,q,q,x,I),o.debug("Initialized by subtype")}else{g.subtypeOptions=qr(M);const q=Ms(M,x);g.dynCfg=new xs(M,q,q,x,I),o.debug("Initialize by selecting a subtype")}};return(async()=>{const M=h.type,x=a.sub;await S(M,x)})(),(M,x)=>{const z=Ne,L=rt,j=ct,I=Ce,A=Ie,$=Co,q=Xt,G=Se,H=Qe;return w(),C(Ve,{title:"新增自定义平台 - "+m(y)},{default:b(()=>[f(H,{class:"add-form",ref_key:"formRef",ref:p,"label-width":"100px",model:g.dynCfg,rules:_},{default:b(()=>[g.isPre?(w(),C(z,{key:0,class:"top-tip",title:"当前为初次添加，将导入该平台的预定义模板；如果再次添加，将生成可修改的新实例",type:"error",closable:!1})):Y("",!0),f(z,{class:"top-tip",title:"当前平台类型为=>"+m(y),type:"info",closable:!1},null,8,["title"]),g.subtypeOptions.length>0?(w(),C(I,{key:1,label:"子平台类型"},{default:b(()=>[f(j,{modelValue:g.subtype,"onUpdate:modelValue":x[0]||(x[0]=X=>g.subtype=X),class:"m-2",placeholder:"请选择",onChange:P},{default:b(()=>[(w(!0),O(Ee,null,xe(g.subtypeOptions,X=>(w(),C(L,{key:X,label:X,value:X},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(w(),C(z,{key:2,class:"top-tip",title:"子平台类型为=>"+g.subtype,type:"info",closable:!1},null,8,["title"])),f(I,{label:m(t)("dynamic.platform.key"),prop:"platformKey"},{default:b(()=>[R(K(g.dynCfg.platformKey),1)]),_:1},8,["label"]),f(I,{label:"平台名称",prop:"platformName"},{default:b(()=>[g.isPre?(w(),O("span",rh,K(g.dynCfg.platformName),1)):(w(),C(A,{key:1,modelValue:g.dynCfg.platformName,"onUpdate:modelValue":x[1]||(x[1]=X=>g.dynCfg.platformName=X)},null,8,["modelValue"]))]),_:1}),f(I,{label:"平台图标",prop:"platformIcon",class:"cfg-icon"},{default:b(()=>[g.isPre?Y("",!0):(w(),C(A,{key:0,modelValue:g.dynCfg.platformIcon,"onUpdate:modelValue":x[2]||(x[2]=X=>g.dynCfg.platformIcon=X),style:{width:"75%","margin-right":"16px"},placeholder:"直接粘贴svg代码或者img标签代码",type:"textarea",rows:10},null,8,["modelValue"])),f($,null,{default:b(()=>[k("span",{innerHTML:g.dynCfg.platformIcon},null,8,ch)]),_:1})]),_:1}),f(I,{label:"授权方式",prop:"authMode"},{default:b(()=>[g.isPre?(w(),O("span",ph,K(g.dynCfg.authMode===m(ge).API?"API授权":"网页授权"),1)):(w(),C(j,{key:1,modelValue:g.dynCfg.authMode,"onUpdate:modelValue":x[3]||(x[3]=X=>g.dynCfg.authMode=X),placeholder:"请选择",disabled:!0},{default:b(()=>[f(L,{value:m(ge).API,label:"API授权"},null,8,["value"]),f(L,{value:m(ge).WEBSITE,label:"网页授权"},null,8,["value"])]),_:1},8,["modelValue"]))]),_:1}),g.dynCfg.authMode===m(ge).WEBSITE?(w(),C(I,{key:3,label:"登录地址",prop:"authUrl"},{default:b(()=>[f(A,{modelValue:g.dynCfg.authUrl,"onUpdate:modelValue":x[4]||(x[4]=X=>g.dynCfg.authUrl=X),placeholder:"请输入该平台的网页登录地址"},null,8,["modelValue"])]),_:1})):Y("",!0),g.dynCfg.authMode===m(ge).WEBSITE?(w(),C(I,{key:4,label:"主域名",prop:"domain"},{default:b(()=>[f(A,{modelValue:g.dynCfg.domain,"onUpdate:modelValue":x[5]||(x[5]=X=>g.dynCfg.domain=X),placeholder:"请输入该平台的主域名"},null,8,["modelValue"])]),_:1})):Y("",!0),f(I,{label:"是否启用"},{default:b(()=>[f(q,{modelValue:g.dynCfg.isEnabled,"onUpdate:modelValue":x[6]||(x[6]=X=>g.dynCfg.isEnabled=X)},null,8,["modelValue"])]),_:1}),f(I,null,{default:b(()=>[f(G,{type:"primary",onClick:x[7]||(x[7]=X=>v(p.value))},{default:b(()=>[R(K(m(t)("dynamic.platform.opt.add")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}}),dh=pe(uh,[["__scopeId","data-v-05372838"]]),gh=["innerHTML"],mh=F({__name:"PlatformUpdateForm",setup(c){const o=W("platform-update-form"),{t}=Z(),s=wt(),e=qe(),{getSetting:a,updateSetting:n}=me(),l=re(e.params).key,u=J(),r=re({key:l,dynCfg:new xs(be.Common,Ms(be.Common,void 0),"None-1"),setting:{},dynamicConfigArray:[]}),h=re({platformName:[{required:!0,message:()=>t("form.validate.name.required")}],authMode:[{required:!0,message:()=>t("form.validate.name.required")}],platformIcon:[{required:!0,message:()=>t("form.validate.name.required")}]}),y=async _=>{if(!_||!await _.validate((S,E)=>{S?o.debug("校验成功"):o.error(t("main.opt.failure"),E)}))return;const v=r.dynCfg;Wt(r.dynamicConfigArray,l,v);const P=dt(r.dynamicConfigArray);r.setting[De]=P,await n(r.setting),Q.success(t("main.opt.success")),await s.push({path:"/setting/publish"})},p=async _=>{r.setting=await a();const d=se.safeParse(r.setting[De],{});r.dynamicConfigArray=(d==null?void 0:d.totalCfg)||[],r.dynCfg=Io(r.dynamicConfigArray,_)};return(async()=>{await p(r.key)})(),(_,d)=>{const v=Ne,P=Ce,S=Ie,E=Co,M=rt,x=ct,z=Xt,L=Se,j=Qe;return w(),C(Ve,{title:"修改平台定义 - "+m(l)},{default:b(()=>[f(j,{class:"update-form",ref_key:"formRef",ref:u,"label-width":"100px",model:r.dynCfg,rules:h},{default:b(()=>[f(v,{class:"top-tip",title:"当前平台类型为=>"+r.dynCfg.platformKey,type:"info",closable:!1},null,8,["title"]),f(v,{class:"top-tip",title:"子平台类型为=>"+r.dynCfg.subPlatformType,type:"info",closable:!1},null,8,["title"]),f(v,{class:"top-tip",title:"注意：为了保留配置信息的完整性，编辑平台时授权方式不可修改，如需切换，请新建新的实例",type:"warning",closable:!1}),f(P,{label:m(t)("dynamic.platform.key"),prop:"platformKey"},{default:b(()=>[R(K(r.dynCfg.platformKey),1)]),_:1},8,["label"]),f(P,{label:"平台名称",prop:"platformName"},{default:b(()=>[f(S,{modelValue:r.dynCfg.platformName,"onUpdate:modelValue":d[0]||(d[0]=I=>r.dynCfg.platformName=I)},null,8,["modelValue"])]),_:1}),f(P,{label:"平台图标",prop:"platformIcon",class:"cfg-icon"},{default:b(()=>[f(S,{modelValue:r.dynCfg.platformIcon,"onUpdate:modelValue":d[1]||(d[1]=I=>r.dynCfg.platformIcon=I),style:{width:"75%","margin-right":"16px"},placeholder:"直接粘贴svg代码或者img标签代码",type:"textarea",rows:10},null,8,["modelValue"]),f(E,null,{default:b(()=>[k("span",{innerHTML:r.dynCfg.platformIcon},null,8,gh)]),_:1})]),_:1}),f(P,{label:"授权方式",prop:"authMode"},{default:b(()=>[f(x,{modelValue:r.dynCfg.authMode,"onUpdate:modelValue":d[2]||(d[2]=I=>r.dynCfg.authMode=I),placeholder:"请选择",disabled:!0},{default:b(()=>[f(M,{value:m(ge).API,label:"API授权"},null,8,["value"]),f(M,{value:m(ge).WEBSITE,label:"网页授权"},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),r.dynCfg.authMode===m(ge).WEBSITE?(w(),C(P,{key:0,label:"登录地址",prop:"authUrl"},{default:b(()=>[f(S,{modelValue:r.dynCfg.authUrl,"onUpdate:modelValue":d[3]||(d[3]=I=>r.dynCfg.authUrl=I),placeholder:"请输入该平台的网页登录地址"},null,8,["modelValue"])]),_:1})):Y("",!0),r.dynCfg.authMode===m(ge).WEBSITE?(w(),C(P,{key:1,label:"主域名",prop:"domain"},{default:b(()=>[f(S,{modelValue:r.dynCfg.domain,"onUpdate:modelValue":d[4]||(d[4]=I=>r.dynCfg.domain=I),placeholder:"请输入该平台的主域名"},null,8,["modelValue"])]),_:1})):Y("",!0),f(P,{label:"是否启用"},{default:b(()=>[f(z,{modelValue:r.dynCfg.isEnabled,"onUpdate:modelValue":d[5]||(d[5]=I=>r.dynCfg.isEnabled=I)},null,8,["modelValue"])]),_:1}),f(P,null,{default:b(()=>[f(L,{type:"primary",onClick:d[6]||(d[6]=I=>y(u.value))},{default:b(()=>[R(K(m(t)("dynamic.platform.opt.add")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}}),hh=pe(mh,[["__scopeId","data-v-b15af0bd"]]),fh=["href"],yh=["href"],bh={target:"_blank",href:"https://gitee.com/terwer/siyuan-plugin-publisher#%E6%8D%90%E8%B5%A0"},_h=F({__name:"CommonBlogSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},emits:["onHomeChange","onApiUrlChange","onUsernameChange"],setup(c,{emit:o}){const t=W("commonblog-setting"),s=new fe,{t:e}=Z(),{getSetting:a,updateSetting:n}=me(),{getPicbedServiceType:i,checkPicgoInstalled:l}=Do(),{isInSiyuanOrSiyuanNewWin:u}=at(),r=c,h=o,y=j=>{h&&h("onHomeChange",j,d.cfg)},p=j=>{h&&h("onUsernameChange",j,d.cfg)},g=J(!1),_=J(null),d=re({cfg:{},ksKeyword:"",isCateLoading:!1,kwSpaces:[],settingTips:"",dynCfg:{},setting:{},dynamicConfigArray:[],isInit:!1,proxy:{useMiddleware:!1,useCorsAnywhere:!1,useSiyuanProxy:!1}});Je(()=>d.cfg.blogid,(j,I)=>{j!==I&&(v(j),t.debug("Watch logic triggered:",j))},{immediate:!0});const v=j=>{var $;const I=e("setting.blog.platform.support.common")+r.apiType+" ";let A=d.cfg.blogName;if(($=r.cfg)!=null&&$.knowledgeSpaceEnabled){const q=d.kwSpaces.find(G=>G.value===j);console.log(q),A=q?q.label:d.cfg.blogid??d.cfg.blogName,d.cfg.blogName=A}d.settingTips=I+A},P=async()=>{g.value=!0;let j;const I=await _e.getAdaptor(r.apiType,d.cfg),A=U.blogApi(s,I);try{await A.checkAuth();try{await S(A),d.cfg.apiStatus=!0}catch($){d.cfg.apiStatus=!1,j=$.toString()}t.info("======校验正常结束======")}catch($){if(typeof $=="boolean"){if($===!0)try{await S(A),d.cfg.apiStatus=!0}catch(q){d.cfg.apiStatus=!1,j=q.toString()}else d.cfg.apiStatus=!1,j="校验失败，请检查平台配置";t.info("======校验修正结束======")}else d.cfg.apiStatus=!1,j=$.toString(),t.error(e("main.opt.failure")+"=>",$)}if(d.cfg.apiStatus)Q.success(e("main.opt.success"));else{const $=e("setting.blog.vali.error")+`=>${j.toString()}`;t.error($),Q.error($)}d.dynCfg&&(d.dynCfg.isAuth=d.cfg.apiStatus),await E(!0),g.value=!1,t.debug("Commonblog通用Setting验证完毕")},S=async j=>{const I=await j.getUsersBlogs(d.ksKeyword);if(I&&I.length>0){d.kwSpaces.length==0&&I.forEach($=>{const q={label:$.blogName,value:$.blogid};d.kwSpaces.push(q)});const A=I[0];d.cfg.blogid=A.blogid,d.cfg.blogName=A.blogName;for(const $ in A.metadataMap)d.cfg[$]=A.metadataMap[$]}},E=async j=>{t.debug("prepare to store cfg=>",{cfg:le(d.cfg)}),t.debug("Commonblog通用Setting保存配置"),d.setting[r.apiType]=d.cfg;const I=dt(d.dynamicConfigArray);d.setting[De]=I,await n(d.setting),j!==!0&&Q.success(e("main.opt.success"))},M=async j=>{try{const I=await _e.getAdaptor(r.apiType,d.cfg);t.debug("commonblogApiAdaptor=>",I);const $=await U.blogApi(s,I).getUsersBlogs(j);$&&$.length>0&&($.forEach(q=>{const G={label:q.blogName,value:q.blogid};d.kwSpaces.push(G)}),v(d.cfg.blogid),t.debug("已强制刷新"))}catch(I){t.error(e("main.opt.failure"),I)}},x=async()=>{var j;try{d.isCateLoading=!0,t.debug("reload categories for single category woth search"),d.kwSpaces=[],d.cfg.blogid=void 0,(j=r.cfg)!=null&&j.knowledgeSpaceEnabled&&await M(d.ksKeyword),_.value.visible=!0}catch(I){t.error("知识空间加载失败",I)}finally{d.isCateLoading=!1,d.isInit=!0}},z=async()=>{await l()||(Q.error(e("publisher.picbed.picgo.not.install")),d.cfg.picbedService=_t.None)},L=async()=>{var A;d.setting=await a();const j=se.safeParse(d.setting[De],{});d.dynamicConfigArray=(j==null?void 0:j.totalCfg)||[],d.dynCfg=Io(d.dynamicConfigArray,r.apiType),t.debug("Commonblog通用Setting配置初始化");let I=r.cfg;if(ae.isEmptyObject(I)){const $=d.setting[r.apiType];I=se.safeParse($,{})}I?(t.debug("get setting conf=>",I),d.cfg=I,(A=r.cfg)!=null&&A.knowledgeSpaceEnabled&&await M(d.ksKeyword)):Q.error("Read init config error, your config may not work")};return Ye(async()=>{await L();const{isUseSiyuanProxy:j}=xo(d.cfg.middlewareUrl,d.cfg.corsAnywhereUrl);d.proxy.useSiyuanProxy=j,d.proxy.useCorsAnywhere=!T.isEmptyString(d.cfg.corsAnywhereUrl),d.proxy.useMiddleware=!T.isEmptyString(d.cfg.middlewareUrl),d.cfg.picbedService=await i(d.cfg),d.isInit=!0}),(j,I)=>{const A=Dt,$=Ne,q=Ie,G=Ce,H=ko,X=Ls,ve=rt,Le=ct,Xe=Se,Be=Qe;return d.isInit?(w(),C(Be,{key:1,"label-width":"120px"},{default:b(()=>{var ze,He,ie,Re,Vt;return[f($,{closable:!1,title:d.settingTips,class:"top-tip",type:"info"},null,8,["title"]),(ze=r.cfg)!=null&&ze.knowledgeSpaceEnabled?(w(),C($,{key:0,closable:!1,title:m(e)("knowledgeSpaceEnabled.Tips").replace(/\[knowledge-space-title\]/g,(He=r.cfg)==null?void 0:He.knowledgeSpaceTitle),class:"top-tip",type:"info"},null,8,["title"])):Y("",!0),At(j.$slots,"header",{cfg:d.cfg},void 0,!0),f(G,{label:m(e)("setting.common.home")},{default:b(()=>{var V;return[f(q,{modelValue:d.cfg.home,"onUpdate:modelValue":I[0]||(I[0]=B=>d.cfg.home=B),placeholder:(V=r.cfg)==null?void 0:V.placeholder.homePlaceholder,onInput:y},null,8,["modelValue","placeholder"])]}),_:1},8,["label"]),f(G,{label:m(e)("setting.common.apiurl")},{default:b(()=>{var V;return[f(q,{modelValue:d.cfg.apiUrl,"onUpdate:modelValue":I[1]||(I[1]=B=>d.cfg.apiUrl=B),placeholder:(V=r.cfg)==null?void 0:V.placeholder.apiUrlPlaceholder},null,8,["modelValue","placeholder"])]}),_:1},8,["label"]),r.cfg.usernameEnabled?(w(),C(G,{key:1,label:d.cfg.usernameLabel??m(e)("setting.common.username")},{default:b(()=>{var V;return[f(q,{modelValue:d.cfg.username,"onUpdate:modelValue":I[2]||(I[2]=B=>d.cfg.username=B),placeholder:(V=r.cfg)==null?void 0:V.placeholder.usernamePlaceholder,onInput:p},null,8,["modelValue","placeholder"])]}),_:1},8,["label"])):Y("",!0),d.cfg.passwordType===m(Oe).PasswordType_Password?(w(),C(G,{key:2,label:d.cfg.passwordLabel??m(e)("setting.common.password"),required:""},{default:b(()=>[f(q,{type:"password",modelValue:d.cfg.password,"onUpdate:modelValue":I[3]||(I[3]=V=>d.cfg.password=V),"show-password":"",placeholder:r.cfg.placeholder.passwordPlaceholder},null,8,["modelValue","placeholder"]),d.cfg.showTokenTip?(w(),O("a",{key:0,href:d.cfg.tokenSettingUrl,target:"_blank"},K(m(e)("setting.common.username.gen"))+"："+K(d.cfg.tokenSettingUrl),9,fh)):Y("",!0)]),_:1},8,["label"])):d.cfg.passwordType===m(Oe).PasswordType_Token?(w(),C(G,{key:3,label:d.cfg.passwordLabel??m(e)("setting.common.token"),required:""},{default:b(()=>[f(q,{type:"password",modelValue:d.cfg.password,"onUpdate:modelValue":I[4]||(I[4]=V=>d.cfg.password=V),"show-password":"",placeholder:r.cfg.placeholder.passwordPlaceholder},null,8,["modelValue","placeholder"]),d.cfg.showTokenTip?(w(),O("a",{key:0,href:d.cfg.tokenSettingUrl,target:"_blank"},K(m(e)("setting.common.token.gen"))+"："+K(d.cfg.tokenSettingUrl),9,yh)):Y("",!0)]),_:1},8,["label"])):(w(),C(G,{key:4,label:d.cfg.passwordLabel??"平台Cookie",required:""},{default:b(()=>[f(q,{modelValue:d.cfg.password,"onUpdate:modelValue":I[5]||(I[5]=V=>d.cfg.password=V),style:{width:"75%","margin-right":"16px"},placeholder:"请直接粘贴平台cookie，为了您的隐私安全，请勿泄露cookie给任何人",type:"textarea",rows:10,disabled:!0},null,8,["modelValue"]),f($,{closable:!1,title:"此处数据为网页授权自动生成，仅在您本地浏览器存储，不支持修改。为了您的安全，请勿泄露此处信息给任何人。",class:"inline-tip",type:"error"})]),_:1},8,["label"])),At(j.$slots,"main",{cfg:d.cfg},void 0,!0),f(G,{label:m(e)("setting.blog.previewUrl")},{default:b(()=>{var V;return[f(q,{modelValue:d.cfg.previewUrl,"onUpdate:modelValue":I[6]||(I[6]=B=>d.cfg.previewUrl=B),placeholder:(V=r.cfg)==null?void 0:V.placeholder.previewUrlPlaceholder,disabled:!r.cfg.allowPreviewUrlChange},null,8,["modelValue","placeholder","disabled"])]}),_:1},8,["label"]),f(G,{label:m(e)("setting.blog.pageType")},{default:b(()=>[f(X,{modelValue:d.cfg.pageType,"onUpdate:modelValue":I[7]||(I[7]=V=>d.cfg.pageType=V),class:"ml-4"},{default:b(()=>[f(H,{value:m(ue).Markdown,size:"large"},{default:b(()=>[R("Markdown")]),_:1},8,["value"]),f(H,{value:m(ue).Html,size:"large"},{default:b(()=>[R("HTML")]),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),(ie=r.cfg)!=null&&ie.cateSearchEnabled?(w(),C(G,{key:5,class:"cate-input",label:"搜索关键词"},{default:b(()=>{var V;return[f(q,{modelValue:d.ksKeyword,"onUpdate:modelValue":I[8]||(I[8]=B=>d.ksKeyword=B),placeholder:"请输入["+((V=r.cfg)==null?void 0:V.knowledgeSpaceTitle)+"]搜索关键词，输入完成后请按Enter键或者移走光标",onChange:x},null,8,["modelValue","placeholder"])]}),_:1})):Y("",!0),(Re=r.cfg)!=null&&Re.knowledgeSpaceEnabled?(w(),C(G,{key:6,label:(Vt=r.cfg)==null?void 0:Vt.knowledgeSpaceTitle},{default:b(()=>[f(Le,{modelValue:d.cfg.blogid,"onUpdate:modelValue":I[9]||(I[9]=V=>d.cfg.blogid=V),class:"m-2",placeholder:m(e)("main.opt.select"),"no-data-text":m(e)("main.data.empty"),loading:d.isCateLoading,"loading-text":"加载中...",ref_key:"singleCateSelect",ref:_},{default:b(()=>[(w(!0),O(Ee,null,xe(d.kwSpaces,V=>(w(),C(ve,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","no-data-text","loading"])]),_:1},8,["label"])):Y("",!0),f(G,{label:m(e)("publisher.picbed.service")},{default:b(()=>[f(X,{modelValue:d.cfg.picbedService,"onUpdate:modelValue":I[10]||(I[10]=V=>d.cfg.picbedService=V),class:"ml-4"},{default:b(()=>[f(H,{value:m(_t).None,size:"large"},{default:b(()=>[R(K(m(e)("publisher.picbed.none")),1)]),_:1},8,["value"]),d.cfg.picgoPicbedSupported?(w(),C(H,{key:0,value:m(_t).PicGo,size:"large",onClick:z},{default:b(()=>[R(K(m(e)("publisher.picbed.picgo"))+" ",1),k("sup",null,K(m(e)("publisher.picbed.recom1")),1)]),_:1},8,["value"])):Y("",!0),d.cfg.bundledPicbedSupported?(w(),C(H,{key:1,value:m(_t).Bundled,size:"large"},{default:b(()=>[R(K(m(e)("publisher.picbed.bundled"))+" ",1),k("sup",null,K(m(e)("publisher.picbed.recom2")),1)]),_:1},8,["value"])):Y("",!0)]),_:1},8,["modelValue"])]),_:1},8,["label"]),!d.proxy.useSiyuanProxy&&!m(u)()&&!d.proxy.useCorsAnywhere?(w(),C(G,{key:7,label:m(e)("setting.blog.middlewareUrl")},{default:b(()=>[f(q,{modelValue:d.cfg.middlewareUrl,"onUpdate:modelValue":I[11]||(I[11]=V=>d.cfg.middlewareUrl=V),placeholder:m(e)("setting.blog.middlewareUrl.tip")},null,8,["modelValue","placeholder"]),f($,{closable:!1,title:m(e)("setting.blog.middlewareUrl.my.tip"),class:"top-tip",type:"info"},null,8,["title"])]),_:1},8,["label"])):Y("",!0),!d.proxy.useSiyuanProxy&&!m(u)()?(w(),C(G,{key:8,label:m(e)("setting.blog.middlewareUrl.new")},{default:b(()=>[f(q,{modelValue:d.cfg.corsAnywhereUrl,"onUpdate:modelValue":I[12]||(I[12]=V=>d.cfg.corsAnywhereUrl=V),placeholder:m(e)("setting.blog.corsAnywhereUrl.tip")},null,8,["modelValue","placeholder"]),f($,{closable:!1,title:m(e)("setting.blog.middlewareUrl.my.new.tip"),class:"top-tip",type:"warning"},null,8,["title"])]),_:1},8,["label"])):Y("",!0),!d.proxy.useSiyuanProxy&&!m(u)()?(w(),C(G,{key:9},{default:b(()=>[f($,{closable:!1,title:m(e)("setting.blog.middlewareUrl.my.warn.tip"),class:"top-tip",type:"error"},null,8,["title"]),f($,{closable:!1,title:m(e)("setting.blog.middlewareUrl.my.fee.tip"),class:"top-tip",type:"error"},null,8,["title"]),k("a",bh,K(m(e)("setting.blog.middlewareUrl.my.coffee")),1)]),_:1})):Y("",!0),f(G,null,{default:b(()=>[f(Xe,{type:"primary",loading:g.value,onClick:P},{default:b(()=>[R(K(g.value?m(e)("setting.blog.vali.ing"):m(e)("setting.blog.vali")),1)]),_:1},8,["loading"]),d.cfg.apiStatus?Y("",!0):(w(),C($,{key:0,title:m(e)("setting.blog.vali.tip.metaweblog"),type:"warning",closable:!1},null,8,["title"])),d.cfg.apiStatus?(w(),C($,{key:1,title:m(e)("setting.blog.vali.ok.metaweblog"),type:"success",closable:!1},null,8,["title"])):Y("",!0)]),_:1}),f(G,null,{default:b(()=>[f(Xe,{type:"primary",onClick:E},{default:b(()=>[R(K(m(e)("setting.blog.save")),1)]),_:1}),f(Xe,null,{default:b(()=>[R(K(m(e)("setting.blog.cancel")),1)]),_:1})]),_:1}),At(j.$slots,"footer",{cfg:d.cfg},void 0,!0)]}),_:3})):(w(),C(A,{key:0,class:"placeholder",rows:5,animated:""}))}}}),ts=pe(_h,[["__scopeId","data-v-3d0f0988"]]),qs=F({__name:"CustomWebSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},setup(c){const o=c;return(t,s)=>{const e=ts;return w(),C(e,{"api-type":o.apiType,cfg:o.cfg},null,8,["api-type","cfg"])}}});class wh extends ps{}const vh=F({__name:"JuejinSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>cn(s.apiType)),o=await o,t(),o),n=a,i=new wh;return i.homePlaceholder=e("setting.juejin.home.tip"),i.apiUrlPlaceholder=e("setting.juejin.apiUrl.tip"),i.passwordPlaceholder=e("setting.juejin.password.tip"),i.previewUrlPlaceholder=e("setting.juejin.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(qs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}});class Ph extends ps{}const Th=F({__name:"JianshuSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>rn(s.apiType)),o=await o,t(),o),n=a,i=new Ph;return i.homePlaceholder=e("setting.jianshu.home.tip"),i.apiUrlPlaceholder=e("setting.jianshu.apiUrl.tip"),i.passwordPlaceholder=e("setting.jianshu.password.tip"),i.previewUrlPlaceholder=e("setting.jianshu.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(qs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}});class kh extends ps{}const Sh=F({__name:"WechatSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>ln(s.apiType)),o=await o,t(),o),n=a,i=new kh;return i.homePlaceholder=e("setting.wechat.home.tip"),i.apiUrlPlaceholder=e("setting.wechat.apiUrl.tip"),i.passwordPlaceholder=e("setting.wechat.password.tip"),i.previewUrlPlaceholder=e("setting.wechat.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(qs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}});class Eh extends ps{}const Ch=F({__name:"CsdnSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>nn(s.apiType)),o=await o,t(),o),n=a,i=new Eh;return i.homePlaceholder=e("setting.csdn.home.tip"),i.apiUrlPlaceholder=e("setting.csdn.apiUrl.tip"),i.passwordPlaceholder=e("setting.csdn.password.tip"),i.previewUrlPlaceholder=e("setting.csdn.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(qs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}}),Ah=F({__name:"ZhihuSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>tn(s.apiType)),o=await o,t(),o),n=a,i=new wi;return i.homePlaceholder=e("setting.zhihu.home.tip"),i.apiUrlPlaceholder=e("setting.zhihu.apiUrl.tip"),i.usernamePlaceholder=e("setting.zhihu.username.tip"),i.passwordPlaceholder=e("setting.zhihu.password.tip"),i.previewUrlPlaceholder=e("setting.zhihu.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(qs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}}),gs=F({__name:"MetaweblogSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},setup(c){const o=c;return(t,s)=>{const e=ts;return w(),C(e,{"api-type":o.apiType,cfg:o.cfg},null,8,["api-type","cfg"])}}});class Uh extends Qt{}const Ih=F({__name:"WordpressSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,e=(u,r)=>{const{home:h,apiUrl:y}=Mn.parseHomeAndUrl(u);r.home=h,r.apiUrl=y,T.isEmptyString(r.home)&&(r.apiUrl="")},{t:a}=Z(),{cfg:n}=([o,t]=Ue(()=>Za(s.apiType)),o=await o,t(),o),i=n,l=new Uh;return l.homePlaceholder=a("setting.wordpress.home.tip"),l.usernamePlaceholder=a("setting.wordpress.username.tip"),l.passwordPlaceholder=a("setting.wordpress.password.tip"),l.apiUrlPlaceholder=a("setting.wordpress.apiUrl.tip"),l.previewUrlPlaceholder=a("setting.wordpress.previewUrl.tip"),i.placeholder=l,(u,r)=>(w(),C(gs,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:e},null,8,["api-type","cfg"]))}});class xh extends Qt{}const Mh=F({__name:"JvueSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>gn(s.apiType)),o=await o,t(),o),n=a,i=new xh;return i.homePlaceholder=e("setting.jvue.home.tip"),i.usernamePlaceholder=e("setting.jvue.username.tip"),i.passwordPlaceholder=e("setting.jvue.password.tip"),i.apiUrlPlaceholder=e("setting.jvue.apiUrl.tip"),i.previewUrlPlaceholder=e("setting.jvue.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(gs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}});class Dh extends Qt{}const Oh=F({__name:"TypechoSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,e=(u,r)=>{const{home:h,apiUrl:y}=Dn.parseHomeAndUrl(u);r.home=h,r.apiUrl=y,T.isEmptyString(r.home)&&(r.apiUrl="")},{t:a}=Z(),{cfg:n}=([o,t]=Ue(()=>Qa(s.apiType)),o=await o,t(),o),i=n,l=new Dh;return l.homePlaceholder=a("setting.typecho.home.tip"),l.usernamePlaceholder=a("setting.typecho.username.tip"),l.passwordPlaceholder=a("setting.typecho.password.tip"),l.apiUrlPlaceholder=a("setting.typecho.apiUrl.tip"),l.previewUrlPlaceholder=a("setting.typecho.previewUrl.tip"),i.placeholder=l,(u,r)=>(w(),C(gs,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:e},null,8,["api-type","cfg"]))}});class Vh extends Qt{}const $h=F({__name:"CnblogsSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>Xa(s.apiType)),o=await o,t(),o),n=a,i=new Vh;return i.homePlaceholder=e("setting.cnblogs.home.tip"),i.usernamePlaceholder=e("setting.cnblogs.username.tip"),i.passwordPlaceholder=e("setting.cnblogs.password.tip"),i.apiUrlPlaceholder=e("setting.cnblogs.apiUrl.tip"),i.previewUrlPlaceholder=e("setting.cnblogs.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(gs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}}),Nh=F({__name:"OthermetaSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>sn(s.apiType)),o=await o,t(),o),n=a,i=new Qt;return i.homePlaceholder=e("setting.metaweblog.home.tip"),i.usernamePlaceholder=e("setting.metaweblog.username.tip"),i.passwordPlaceholder=e("setting.metaweblog.password.tip"),i.apiUrlPlaceholder=e("setting.metaweblog.apiUrl.tip"),i.previewUrlPlaceholder=e("setting.metaweblog.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(gs,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}}),Lh={key:1},Hh=F({__name:"CommonGithubSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},setup(c){const o=W("common-blog-setting"),t=c,{t:s}=Z(),e=re({showAdvancedConfig:!1,advanceBtnText:"显示更多配置"}),a=()=>{e.showAdvancedConfig?(e.showAdvancedConfig=!e.showAdvancedConfig,e.advanceBtnText="显示更多配置"):(e.showAdvancedConfig=!e.showAdvancedConfig,e.advanceBtnText="隐藏更多配置")},n=i=>{i.blogid=i.defaultPath,o.debug("sync defaultPath to blogid",{cfg:le(i)})};return(i,l)=>{const u=Ie,r=Ce,h=Xt,y=ts;return w(),C(y,{"api-type":t.apiType,cfg:t.cfg},{header:b(p=>[At(i.$slots,"header",{cfg:p.cfg},void 0,!0)]),main:b(p=>[f(r,{label:m(s)("setting.blog.type.github.repo")},{default:b(()=>[f(u,{modelValue:p.cfg.githubRepo,"onUpdate:modelValue":g=>p.cfg.githubRepo=g,placeholder:m(s)("setting.blog.type.github.repo.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.yamlLinkEnabled")},{default:b(()=>[f(h,{modelValue:p.cfg.yamlLinkEnabled,"onUpdate:modelValue":g=>p.cfg.yamlLinkEnabled=g},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.type.github.default.branch")},{default:b(()=>[f(u,{modelValue:p.cfg.githubBranch,"onUpdate:modelValue":g=>p.cfg.githubBranch=g,placeholder:m(s)("setting.blog.type.github.default.branch.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.type.github.default.path")},{default:b(()=>[f(u,{modelValue:p.cfg.defaultPath,"onUpdate:modelValue":g=>p.cfg.defaultPath=g,onInput:g=>n(p.cfg),placeholder:m(s)("setting.blog.type.github.default.path.tip")},null,8,["modelValue","onUpdate:modelValue","onInput","placeholder"])]),_:2},1032,["label"]),p.cfg.picbedService===m(_t).Bundled?(w(),C(r,{key:0,label:m(s)("setting.blog.type.github.images.path")},{default:b(()=>[f(u,{modelValue:p.cfg.imageStorePath,"onUpdate:modelValue":g=>p.cfg.imageStorePath=g,placeholder:m(s)("setting.blog.type.github.images.path.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])):Y("",!0),f(r,{label:m(s)("setting.blog.mdFilenameRule")},{default:b(()=>[f(u,{modelValue:p.cfg.mdFilenameRule,"onUpdate:modelValue":g=>p.cfg.mdFilenameRule=g,placeholder:m(s)("setting.blog.mdFilenameRule.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.previewPostUrl")},{default:b(()=>[f(u,{modelValue:p.cfg.previewPostUrl,"onUpdate:modelValue":g=>p.cfg.previewPostUrl=g,placeholder:m(s)("setting.blog.previewPostUrl.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,null,{default:b(()=>[k("a",{href:"javascript:;",onClick:a},K(e.advanceBtnText),1)]),_:1}),e.showAdvancedConfig?(w(),O("div",Lh,[f(r,{label:m(s)("setting.blog.type.github.msg")},{default:b(()=>[f(u,{modelValue:p.cfg.defaultMsg,"onUpdate:modelValue":g=>p.cfg.defaultMsg=g,placeholder:m(s)("setting.blog.type.github.msg.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.type.github.author")},{default:b(()=>[f(u,{modelValue:p.cfg.author,"onUpdate:modelValue":g=>p.cfg.author=g,placeholder:m(s)("setting.blog.type.github.author")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.type.github.email")},{default:b(()=>[f(u,{modelValue:p.cfg.email,"onUpdate:modelValue":g=>p.cfg.email=g,placeholder:m(s)("setting.blog.type.github.email.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(r,{label:m(s)("setting.blog.type.github.site")},{default:b(()=>[f(u,{modelValue:p.cfg.site,"onUpdate:modelValue":g=>p.cfg.site=g,placeholder:m(s)("setting.blog.type.github.site.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])])):Y("",!0),At(i.$slots,"main",{cfg:p.cfg},void 0,!0)]),footer:b(p=>[At(i.$slots,"footer",{cfg:p.cfg},void 0,!0)]),_:3},8,["api-type","cfg"])}}}),ft=pe(Hh,[["__scopeId","data-v-c4700664"]]);class ms extends Zt{}class Bi extends ms{}class Rh extends Bi{}const Gh=F({__name:"GitlabvitepressSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>yo(s.apiType)),o=await o,t(),o),n=a,i=new Rh;i.homePlaceholder=e("setting.blog.gitlab.url.tip"),i.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),i.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),i.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),n.placeholder=i;const l=(u,r)=>{T.isEmptyString(r.home)?r.apiUrl="":(r.apiUrl=r.home,r.tokenSettingUrl=`${r.home}/-/profile/personal_access_tokens`)};return(u,r)=>{const h=ft;return w(),C(h,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l},{header:b(y=>[]),main:b(y=>[]),footer:b(y=>[]),_:1},8,["api-type","cfg"])}}});class ji extends ms{}class Ki extends ji{}const Bh=F({__name:"Gitlabvuepress2Setting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>fo(s.apiType)),o=await o,t(),o),n=a,i=new Ki;i.homePlaceholder=e("setting.blog.gitlab.url.tip"),i.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),i.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),i.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),n.placeholder=i;const l=(u,r)=>{T.isEmptyString(r.home)?r.apiUrl="":(r.apiUrl=r.home,r.tokenSettingUrl=`${r.home}/-/profile/personal_access_tokens`)};return(u,r)=>{const h=ft;return w(),C(h,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l},{header:b(y=>[]),main:b(y=>[]),footer:b(y=>[]),_:1},8,["api-type","cfg"])}}}),jh=F({__name:"GitlabvuepressSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>go(s.apiType)),o=await o,t(),o),n=a,i=new Ki;i.homePlaceholder=e("setting.blog.gitlab.url.tip"),i.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),i.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),i.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),n.placeholder=i;const l=(r,h)=>{T.isEmptyString(h.home)?h.apiUrl="":(h.apiUrl=h.home,h.tokenSettingUrl=`${h.home}/-/profile/personal_access_tokens`),T.isEmptyString(h.home)||T.isEmptyString(h.username)?h.site="":h.site=T.pathJoin(h.home,"/"+h.username)},u=(r,h)=>{T.isEmptyString(h.home)||T.isEmptyString(h.username)?h.site="":h.site=T.pathJoin(h.home,"/"+h.username)};return(r,h)=>{const y=ft;return w(),C(y,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l,onOnUsernameChange:u},{header:b(p=>[]),main:b(p=>[]),footer:b(p=>[]),_:1},8,["api-type","cfg"])}}});class zi extends ms{}class Kh extends zi{}const zh=F({__name:"GitlabjekyllSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>po(s.apiType)),o=await o,t(),o),n=a,i=new Kh;i.homePlaceholder=e("setting.blog.gitlab.url.tip"),i.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),i.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),i.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),n.placeholder=i;const l=(u,r)=>{T.isEmptyString(r.home)?r.apiUrl="":(r.apiUrl=r.home,r.tokenSettingUrl=`${r.home}/-/profile/personal_access_tokens`)};return(u,r)=>{const h=ft;return w(),C(h,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l},{header:b(y=>[]),main:b(y=>[]),footer:b(y=>[]),_:1},8,["api-type","cfg"])}}});class Wi extends ms{}class Wh extends Wi{}const Fh=F({__name:"GitlabhugoSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>ro(s.apiType)),o=await o,t(),o),n=a,i=new Wh;i.homePlaceholder=e("setting.blog.gitlab.url.tip"),i.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),i.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),i.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),n.placeholder=i;const l=(u,r)=>{T.isEmptyString(r.home)?r.apiUrl="":(r.apiUrl=r.home,r.tokenSettingUrl=`${r.home}/-/profile/personal_access_tokens`)};return(u,r)=>{const h=ft;return w(),C(h,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l},{header:b(y=>[]),main:b(y=>[]),footer:b(y=>[]),_:1},8,["api-type","cfg"])}}});class Fi extends ms{}class Jh extends Fi{}const qh=F({__name:"GitlabhexoSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>io(s.apiType)),o=await o,t(),o),n=a,i=new Jh;i.homePlaceholder=e("setting.blog.gitlab.url.tip"),i.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),i.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),i.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),n.placeholder=i;const l=(u,r)=>{T.isEmptyString(r.home)?r.apiUrl="":(r.apiUrl=r.home,r.tokenSettingUrl=`${r.home}/-/profile/personal_access_tokens`)};return(u,r)=>{const h=ft;return w(),C(h,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l},{header:b(y=>[]),main:b(y=>[]),footer:b(y=>[]),_:1},8,["api-type","cfg"])}}}),Yh=F({__name:"VitepressSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>ho(s.apiType)),o=await o,t(),o),n=a,i=new Bi;return i.homePlaceholder=e("setting.blog.github.url.tip"),i.usernamePlaceholder=e("setting.blog.type.github.user.tip"),i.passwordPlaceholder=e("setting.blog.type.github.token.tip"),i.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),n.placeholder=i,(l,u)=>{const r=ft;return w(),C(r,{"api-type":s.apiType,cfg:m(n)},{header:b(h=>[]),main:b(h=>[]),footer:b(h=>[]),_:1},8,["api-type","cfg"])}}});class Xh extends ms{}const Zh=F({__name:"Vuepress2Setting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>mo(s.apiType)),o=await o,t(),o),n=a,i=new Xh;return i.homePlaceholder=e("setting.blog.github.url.tip"),i.usernamePlaceholder=e("setting.blog.type.github.user.tip"),i.passwordPlaceholder=e("setting.blog.type.github.token.tip"),i.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),n.placeholder=i,(l,u)=>{const r=ft;return w(),C(r,{"api-type":s.apiType,cfg:m(n)},{header:b(h=>[]),main:b(h=>[]),footer:b(h=>[]),_:1},8,["api-type","cfg"])}}}),Qh=F({__name:"VuepressSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>uo(s.apiType)),o=await o,t(),o),n=a,i=new ji;i.homePlaceholder=e("setting.blog.github.url.tip"),i.usernamePlaceholder=e("setting.blog.type.github.user.tip"),i.passwordPlaceholder=e("setting.blog.type.github.token.tip"),i.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),n.placeholder=i;const l=(r,h)=>{T.isEmptyString(h.home)||T.isEmptyString(h.username)?h.site="":h.site=T.pathJoin(h.home,"/"+h.username)},u=(r,h)=>{T.isEmptyString(h.home)||T.isEmptyString(h.username)?h.site="":h.site=T.pathJoin(h.home,"/"+h.username)};return(r,h)=>{const y=ft;return w(),C(y,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l,onOnUsernameChange:u},{header:b(p=>[]),main:b(p=>[]),footer:b(p=>[]),_:1},8,["api-type","cfg"])}}}),ef=F({__name:"JekyllSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>co(s.apiType)),o=await o,t(),o),n=a,i=new zi;return i.homePlaceholder=e("setting.blog.github.url.tip"),i.usernamePlaceholder=e("setting.blog.type.github.user.tip"),i.passwordPlaceholder=e("setting.blog.type.github.token.tip"),i.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),n.placeholder=i,(l,u)=>{const r=ft;return w(),C(r,{"api-type":s.apiType,cfg:m(n)},{header:b(h=>[]),main:b(h=>[]),footer:b(h=>[]),_:1},8,["api-type","cfg"])}}}),tf=F({__name:"HugoSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>lo(s.apiType)),o=await o,t(),o),n=a,i=new Wi;return i.homePlaceholder=e("setting.blog.github.url.tip"),i.usernamePlaceholder=e("setting.blog.type.github.user.tip"),i.passwordPlaceholder=e("setting.blog.type.github.token.tip"),i.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),n.placeholder=i,(l,u)=>{const r=ft;return w(),C(r,{"api-type":s.apiType,cfg:m(n)},{header:b(h=>[]),main:b(h=>[]),footer:b(h=>[]),_:1},8,["api-type","cfg"])}}}),sf=F({__name:"HexoSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>no(s.apiType)),o=await o,t(),o),n=a,i=new Fi;return i.homePlaceholder=e("setting.blog.github.url.tip"),i.usernamePlaceholder=e("setting.blog.type.github.user.tip"),i.passwordPlaceholder=e("setting.blog.type.github.token.tip"),i.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),i.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),n.placeholder=i,(l,u)=>{const r=ft;return w(),C(r,{"api-type":s.apiType,cfg:m(n)},{header:b(h=>[]),main:b(h=>[]),footer:b(h=>[]),_:1},8,["api-type","cfg"])}}});class of extends Zt{}const af=F({__name:"HaloSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>pn(s.apiType)),o=await o,t(),o),n=a,i=new of;i.homePlaceholder=e("setting.halo.home.tip"),i.usernamePlaceholder=e("setting.halo.username.tip"),i.passwordPlaceholder=e("setting.halo.password.tip"),i.apiUrlPlaceholder=e("setting.halo.apiUrl.tip"),i.previewUrlPlaceholder=e("setting.halo.previewUrl.tip"),n.placeholder=i;const l=(u,r)=>{T.isEmptyString(r.home)?r.apiUrl="":r.apiUrl=r.home};return(u,r)=>(w(),C(ts,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:l},null,8,["api-type","cfg"]))}});class nf extends Zt{}const lf=F({__name:"NotionSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>on(s.apiType)),o=await o,t(),o),n=a,i=new nf;return i.homePlaceholder=e("setting.notion.home.tip"),i.passwordPlaceholder=e("setting.notion.password.tip"),i.apiUrlPlaceholder=e("setting.notion.apiurl.tip"),i.previewUrlPlaceholder=e("setting.notion.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(ts,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}});class rf extends Zt{}const cf=F({__name:"YuqueSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>en(s.apiType)),o=await o,t(),o),n=a,i=new rf;return i.homePlaceholder=e("setting.yuque.home.tip"),i.usernamePlaceholder=e("setting.yuque.username.tip"),i.passwordPlaceholder=e("setting.yuque.password.tip"),i.apiUrlPlaceholder=e("setting.yuque.apiurl.tip"),i.previewUrlPlaceholder=e("setting.yuque.previewUrl.tip"),n.placeholder=i,(l,u)=>(w(),C(ts,{"api-type":s.apiType,cfg:m(n)},null,8,["api-type","cfg"]))}});class pf extends Zt{}const uf=F({__name:"TelegraphSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,{t:e}=Z(),{cfg:a}=([o,t]=Ue(()=>dn(s.apiType)),o=await o,t(),o),n=a;n.usernameLabel=e("setting.telegraph.username.label"),n.passwordLabel=e("setting.telegraph.password.label");const i=new pf;i.homePlaceholder=e("setting.telegraph.home.tip"),i.usernamePlaceholder=e("setting.telegraph.username.tip"),i.passwordPlaceholder=e("setting.telegraph.password.tip"),i.apiUrlPlaceholder=e("setting.telegraph.apiurl.tip"),i.previewUrlPlaceholder=e("setting.telegraph.previewUrl.tip"),n.placeholder=i;const l=u=>{u.password="",u.accessToken="",u.saveHash=""};return(u,r)=>{const h=ko,y=Ls,p=Ce,g=Ie,_=Xt;return w(),C(ts,{"api-type":s.apiType,cfg:m(n)},{header:b(d=>[f(p,{label:"登录模式",required:""},{default:b(()=>[f(y,{modelValue:d.cfg.postType,"onUpdate:modelValue":v=>d.cfg.postType=v,class:"ml-4",onChange:()=>{l(d.cfg)}},{default:b(()=>[f(h,{value:m(Yt).ANONYMOUS,size:"large"},{default:b(()=>[R(K(m(e)("setting.telegraph.login.anonymous")),1)]),_:1},8,["value"]),f(h,{value:m(Yt).LOGIN_USER,size:"large"},{default:b(()=>[R(K(m(e)("setting.telegraph.login.user")),1)]),_:1},8,["value"])]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)]),main:b(d=>[d.cfg.postType===m(Yt).LOGIN_USER?(w(),C(p,{key:0,label:"Access Token",required:""},{default:b(()=>[f(g,{modelValue:d.cfg.accessToken,"onUpdate:modelValue":v=>d.cfg.accessToken=v,placeholder:m(e)("setting.telegraph.accessToken.tip"),type:"password","show-password":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)):Y("",!0),f(p,{label:"Hash",required:""},{default:b(()=>[f(g,{modelValue:d.cfg.saveHash,"onUpdate:modelValue":v=>d.cfg.saveHash=v,placeholder:m(e)("setting.telegraph.saveHash.tip"),type:"password","show-password":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024),f(p,{label:"刷新授权"},{default:b(()=>[f(_,{modelValue:d.cfg.forceReAuth,"onUpdate:modelValue":v=>d.cfg.forceReAuth=v,placeholder:m(e)("setting.telegraph.forceReAuth.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1024)]),footer:b(d=>[]),_:1},8,["api-type","cfg"])}}});class Ji{static parseHomeAndUrl(o){this.logger.debug(`Parsing Home address: ${o}`);let t="";return o.endsWith("/xmlrpc.php")?(t=o,o=o.replace("/xmlrpc.php","")):(o=o.replace(/\/$/,""),t=`${o}/xmlrpc.php`),this.logger.debug(`Parse result: home=${o}, apiUrl=${t}`),{home:o,apiUrl:t}}}D(Ji,"logger",W("wordpress-dot-com-utils"));class df extends Qt{}const gf=F({__name:"WordpressdotcomSetting",props:{apiType:{type:String,default:""}},async setup(c){let o,t;const s=c,e=(u,r)=>{const{home:h,apiUrl:y}=Ji.parseHomeAndUrl(u);r.home=h,r.apiUrl=y,T.isEmptyString(r.home)&&(r.apiUrl="")},{t:a}=Z(),{cfg:n}=([o,t]=Ue(()=>mn(s.apiType)),o=await o,t(),o),i=n,l=new df;return l.homePlaceholder=a("setting.wordpressdotcom.home.tip"),l.usernamePlaceholder=a("setting.wordpressdotcom.username.tip"),l.passwordPlaceholder=a("setting.wordpressdotcom.password.tip"),l.apiUrlPlaceholder=a("setting.wordpressdotcom.apiUrl.tip"),l.previewUrlPlaceholder=a("setting.wordpressdotcom.previewUrl.tip"),i.placeholder=l,(u,r)=>(w(),C(gs,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:e},null,8,["api-type","cfg"]))}}),mf={key:27},hf=F({__name:"SingleSettingIndex",setup(c){const{t:o}=Z(),t=qe(),e=re(t.params).key,a=ao(e);return(n,i)=>{const l=cf,u=lf,r=af,h=sf,y=tf,p=ef,g=Qh,_=Zh,d=Yh,v=qh,P=Fh,S=zh,E=jh,M=Bh,x=Gh,z=Nh,L=$h,j=Oh,I=Mh,A=Ih,$=Ah,q=Ch,G=Sh,H=Th,X=vh,ve=Ne;return w(),C(Ve,{title:m(o)("setting.entry.title")+m(e)},{default:b(()=>[m(a)===m(N).Common_Yuque?(w(),C(l,{key:0,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Common_Notion?(w(),C(u,{key:1,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Common_Halo?(w(),C(r,{key:2,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Common_Telegraph?(w(),C(uf,{key:3,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Github_Hexo?(w(),C(h,{key:4,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Github_Hugo?(w(),C(y,{key:5,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Github_Jekyll?(w(),C(p,{key:6,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Github_Vuepress?(w(),C(g,{key:7,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Github_Vuepress2?(w(),C(_,{key:8,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Github_Vitepress?(w(),C(d,{key:9,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Gitlab_Hexo?(w(),C(v,{key:10,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Gitlab_Hugo?(w(),C(P,{key:11,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Gitlab_Jekyll?(w(),C(S,{key:12,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Gitlab_Vuepress?(w(),C(E,{key:13,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Gitlab_Vuepress2?(w(),C(M,{key:14,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Gitlab_Vitepress?(w(),C(x,{key:15,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Metaweblog_Metaweblog?(w(),C(z,{key:16,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Metaweblog_Cnblogs?(w(),C(L,{key:17,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Metaweblog_Typecho?(w(),C(j,{key:18,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Metaweblog_Jvue?(w(),C(I,{key:19,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Wordpress_Wordpress?(w(),C(A,{key:20,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Wordpress_Wordpressdotcom?(w(),C(gf,{key:21,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Custom_Zhihu?(w(),C($,{key:22,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Custom_CSDN?(w(),C(q,{key:23,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Custom_Wechat?(w(),C(G,{key:24,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Custom_Jianshu?(w(),C(H,{key:25,"api-type":m(e)},null,8,["api-type"])):m(a)===m(N).Custom_Juejin?(w(),C(X,{key:26,"api-type":m(e)},null,8,["api-type"])):(w(),O("span",mf,[f(ve,{closable:!1,title:m(o)("setting.entry.not.supported"),class:"top-tip",type:"error"},null,8,["title"])]))]),_:1},8,["title"])}}}),ff=pe(hf,[["__scopeId","data-v-cc98cb8d"]]),yf={key:0},bf={key:0},_f={key:1},wf=F({__name:"PostBind",setup(c){const o=W("post-bind"),{t}=Z(),{query:s}=qe(),{getPublishCfg:e}=js(),{updateSetting:a}=me(),{kernelApi:n}=Ge(),i=J(),l=re({}),u=re({}),r=re({pageId:"",siyuanPost:{},dynamicConfigArray:[],postIdMap:{}}),h=J(`将对文档「${r.pageId}」进行修复`);Je(()=>r.pageId,g=>{h.value=`将对文档「${g}」进行修复`});const y=async g=>{if(T.isEmptyString(r.pageId)){Q.error("");return}try{const d=(await e()).setting,v=ae.getProperty(d,r.pageId,{});r.dynamicConfigArray=r.dynamicConfigArray.map(P=>{const S=r.postIdMap[P.platformKey],E=ae.getProperty(d,P.platformKey,{}),M=E==null?void 0:E.posidKey;return!T.isEmptyString(M)&&!T.isEmptyString(r.pageId)&&(v[M]=S),P}),d[r.pageId]=v,o.debug("prepare to save setting =>",{setting:le(d)}),await a(d),Q.success(t("main.opt.success"))}catch(_){o.error(t("main.opt.failure")+"=>",_),Q.error(t("main.opt.failure")+"=>"+_)}},p=()=>{Q.warning(t("import.v081.warn"))};return Ye(async()=>{var S;const g=U.emptyOrDefault(s.id,Ws()),_=await fi(g);if(r.pageId=_,!T.isEmptyString(r.pageId)){r.siyuanPost=await n.getBlockByID(r.pageId);const E=U.emptyOrDefault((S=r.siyuanPost)==null?void 0:S.content,r.pageId);h.value=`将对文档「${E}」进行修复`}const d=await e(),v=d.setting;r.dynamicConfigArray=d.dynamicConfigArray;const P=ae.getProperty(v,r.pageId,{});r.dynamicConfigArray.forEach(E=>{let M="";const x=ae.getProperty(v,E.platformKey,{}),z=x==null?void 0:x.posidKey;!T.isEmptyString(z)&&!T.isEmptyString(r.pageId)&&(M=ae.getProperty(P,z)),r.postIdMap[E.platformKey]=M})}),(g,_)=>{const d=Ne,v=Ie,P=Ce,S=Eo,E=Se,M=Qe;return w(),O("div",null,[f(d,{class:"top-tip",title:m(t)("post.bind.auto.tips"),type:"error",closable:!1},null,8,["title"]),f(P,null,{default:b(()=>[f(v,{modelValue:r.pageId,"onUpdate:modelValue":_[0]||(_[0]=x=>r.pageId=x),placeholder:"请输入需要修复的文档根 ID"},null,8,["modelValue"])]),_:1}),f(S,{"border-style":"dashed"}),m(T).isEmptyString(r.pageId)?(w(),O("div",yf,[f(d,{class:"top-tip",title:m(t)("post.bind.auto.error"),type:"warning",closable:!1},null,8,["title"])])):(w(),C(M,{key:1,"label-width":"85px",class:"post-bind-form",ref_key:"ruleFormRef",ref:i,model:l,rules:u,"status-icon":""},{default:b(()=>[f(d,{class:"top-tip",title:h.value,type:"warning",closable:!1},null,8,["title"]),r.dynamicConfigArray.length>0?(w(),O("div",bf,[(w(!0),O(Ee,null,xe(r.dynamicConfigArray,(x,z)=>Yn((w(),C(P,{key:z,label:x.platformName},{default:b(()=>[f(v,{modelValue:r.postIdMap[x.platformKey],"onUpdate:modelValue":L=>r.postIdMap[x.platformKey]=L},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])),[[gl,x.isEnabled&&x.isEnabled]])),128))])):(w(),O("div",_f,[f(d,{class:"top-tip",title:m(t)("post.bind.auto.empty"),type:"info",closable:!1},null,8,["title"])])),f(P,null,{default:b(()=>[f(E,{type:"primary",onClick:_[1]||(_[1]=x=>y(i.value))},{default:b(()=>[R(K(m(t)("post.bind.conf.save")),1)]),_:1}),f(E,{type:"warning",onClick:p},{default:b(()=>[R(K(m(t)("post.bind.conf.v081")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"]))])}}}),vf=pe(wf,[["__scopeId","data-v-90e60352"]]),Pf={class:"locale-changer"},Tf=F({__name:"ChangeLocal",async setup(c){let o,t;const s=W("change-local"),{getSetting:e,updateSetting:a}=me(),{t:n,locale:i}=Z(),l=[{value:"zh_CN",label:"简体中文"},{value:"en_US",label:"English"}],u=([o,t]=Ue(()=>e()),o=await o,t(),o),r=async h=>{i.value=h,u.lang=h,await a(u),s.info("lang changed to",h)};return $s(()=>{u!=null&&u.lang&&(i.value=u==null?void 0:u.lang)}),(h,y)=>{const p=rt,g=ct,_=Ce,d=Qe;return w(),O("div",Pf,[f(d,{"label-width":"85px"},{default:b(()=>[f(_,{label:m(n)("lang.choose")},{default:b(()=>[f(g,{modelValue:m(i),"onUpdate:modelValue":y[0]||(y[0]=v=>as(i)?i.value=v:null),placeholder:m(n)("lang.choose.placeholder"),onChange:r},{default:b(()=>[(w(),O(Ee,null,xe(l,(v,P)=>f(p,{key:P,label:v.label,value:v.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})])}}}),qi=F({__name:"SiyuanSetting",setup(c){const{t:o}=Z(),{getSiyuanSetting:t}=Un(),s=t();return(e,a)=>{const n=Ie,i=Ce,l=Qe;return w(),C(l,{"label-width":"125px",class:"siyuan-setting-form"},{default:b(()=>[f(i,{label:m(o)("setting.blog.siyuan.apiurl"),prop:"apiUrl"},{default:b(()=>[f(n,{modelValue:m(s).apiUrl,"onUpdate:modelValue":a[0]||(a[0]=u=>m(s).apiUrl=u),autocomplete:"off",placeholder:m(o)("setting.blog.siyuan.apiurl.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),f(i,{label:m(o)("setting.blog.siyuan.password"),prop:"pwd"},{default:b(()=>[f(n,{modelValue:m(s).password,"onUpdate:modelValue":a[1]||(a[1]=u=>m(s).password=u),type:"password",autocomplete:"off",placeholder:m(o)("setting.blog.siyuan.password.tip"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})}}}),kf=c=>(mt("data-v-aedab5c6"),c=c(),ht(),c),Sf=kf(()=>k("div",{class:"form-item-bottom"},null,-1)),Ef=F({__name:"AiSetting",setup(c){const{t:o}=Z(),{getPublishPreferenceSetting:t}=xt(),s=t();return(e,a)=>{const n=Ie,i=Ce,l=Ne,u=Qe;return w(),C(u,{"label-width":"135px",class:"ai-setting-form"},{default:b(()=>[f(i,{label:m(o)("pref.setting.aicode")},{default:b(()=>[f(n,{modelValue:m(s).experimentalAICode,"onUpdate:modelValue":a[0]||(a[0]=r=>m(s).experimentalAICode=r),type:"password",autocomplete:"off",placeholder:m(o)("pref.setting.aicode.tip"),disabled:m(s).experimentalUseSiyuanNoteAIConfig},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),f(i,{label:m(o)("pref.setting.ai.baseurl")},{default:b(()=>[f(n,{modelValue:m(s).experimentalAIBaseUrl,"onUpdate:modelValue":a[1]||(a[1]=r=>m(s).experimentalAIBaseUrl=r),autocomplete:"off",placeholder:m(o)("pref.setting.ai.baseurl.tip"),disabled:m(s).experimentalUseSiyuanNoteAIConfig},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),f(i,{label:m(o)("pref.setting.ai.proxy.url")},{default:b(()=>[f(n,{modelValue:m(s).experimentalAIProxyUrl,"onUpdate:modelValue":a[2]||(a[2]=r=>m(s).experimentalAIProxyUrl=r),autocomplete:"off",placeholder:m(o)("pref.setting.ai.proxy.url.tip"),disabled:m(s).experimentalUseSiyuanNoteAIConfig},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),m(s).experimentalUseSiyuanNoteAIConfig?(w(),C(i,{key:0},{default:b(()=>[f(l,{closable:!1,title:m(o)("config.ai.use.siyuan"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})):Y("",!0),Sf]),_:1})}}}),Cf=pe(Ef,[["__scopeId","data-v-aedab5c6"]]),Af={key:0},Uf=F({__name:"PreferenceSetting",setup(c){const{t:o}=Z(),{getPublishPreferenceSetting:t}=xt(),{isInSiyuanWin:s,isInSiyuanWidget:e}=at(),a=t(),n=s()||e()&&T.isEmptyString(hi());return(i,l)=>{const u=Xt,r=Ce,h=Eo,y=Qe;return w(),C(y,{inline:"","label-width":"125px",class:"publish-preference-setting-form"},{default:b(()=>[f(r,{label:m(o)("preference.setting.fixTitle")},{default:b(()=>[f(u,{modelValue:m(a).fixTitle,"onUpdate:modelValue":l[0]||(l[0]=p=>m(a).fixTitle=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.keepTitle")},{default:b(()=>[f(u,{modelValue:m(a).keepTitle,"onUpdate:modelValue":l[1]||(l[1]=p=>m(a).keepTitle=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.removeH1")},{default:b(()=>[f(u,{modelValue:m(a).removeFirstH1,"onUpdate:modelValue":l[2]||(l[2]=p=>m(a).removeFirstH1=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.removeWidgetTag")},{default:b(()=>[f(u,{modelValue:m(a).removeMdWidgetTag,"onUpdate:modelValue":l[3]||(l[3]=p=>m(a).removeMdWidgetTag=p)},null,8,["modelValue"])]),_:1},8,["label"]),m(n)?(w(),O("div",Af,[f(h,{"border-style":"dashed",class:"psd"}),f(r,{label:m(o)("preference.setting.showDocQuickMenu")},{default:b(()=>[f(u,{modelValue:m(a).showDocQuickMenu,"onUpdate:modelValue":l[4]||(l[4]=p=>m(a).showDocQuickMenu=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(h,{"border-style":"dashed",class:"psd"}),f(r,{label:m(o)("preference.setting.showQuickMenu")},{default:b(()=>[f(u,{modelValue:m(a).showQuickMenu,"onUpdate:modelValue":l[5]||(l[5]=p=>m(a).showQuickMenu=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.showSingleMenu")},{default:b(()=>[f(u,{modelValue:m(a).showSingleMenu,"onUpdate:modelValue":l[6]||(l[6]=p=>m(a).showSingleMenu=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.showBatchMenu")},{default:b(()=>[f(u,{modelValue:m(a).showBatchMenu,"onUpdate:modelValue":l[7]||(l[7]=p=>m(a).showBatchMenu=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.showAIMenu")},{default:b(()=>[f(u,{modelValue:m(a).showAIMenu,"onUpdate:modelValue":l[8]||(l[8]=p=>m(a).showAIMenu=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.showExtendMenu")},{default:b(()=>[f(u,{modelValue:m(a).showExtendMenu,"onUpdate:modelValue":l[9]||(l[9]=p=>m(a).showExtendMenu=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(r,{label:m(o)("preference.setting.showArticleManageMenu")},{default:b(()=>[f(u,{modelValue:m(a).showArticleManageMenu,"onUpdate:modelValue":l[10]||(l[10]=p=>m(a).showArticleManageMenu=p)},null,8,["modelValue"])]),_:1},8,["label"])])):Y("",!0)]),_:1})}}}),If=pe(Uf,[["__scopeId","data-v-e9d0a8ac"]]),xf=F({__name:"GeneralSetting",setup(c){const{t:o}=Z();return(t,s)=>{const e=li,a=Cf,n=qi,i=Tf,l=vf,u=ri,r=Ve;return w(),C(r,{title:m(o)("service.tab.change.local")},{default:b(()=>[f(u,{"tab-position":"left",class:"general-setting-box"},{default:b(()=>[f(e,{label:m(o)("service.tab.change.local")},{default:b(()=>[f(If)]),_:1},8,["label"]),f(e,{label:m(o)("sys.config.ai")},{default:b(()=>[f(a)]),_:1},8,["label"]),f(e,{label:m(o)("siyuan.config.setting")},{default:b(()=>[f(n)]),_:1},8,["label"]),f(e,{label:m(o)("lang.choose")},{default:b(()=>[f(i)]),_:1},8,["label"]),f(e,{label:m(o)("service.tab.post.bind")},{default:b(()=>[f(l)]),_:1},8,["label"])]),_:1})]),_:1},8,["title"])}}}),Mf=pe(xf,[["__scopeId","data-v-1598226e"]]),Df=""+new URL("assets/icon.png",import.meta.url).href,Ys=c=>(mt("data-v-cec1a207"),c=c(),ht(),c),Of={id:"about-box"},Vf=Ys(()=>k("div",{class:"logo"},[k("img",{src:Df,alt:"logo"})],-1)),$f={class:"notice"},Nf={class:"title"},Lf={class:"param slogan"},Hf=Ys(()=>k("div",{class:"space"},null,-1)),Rf={class:"param"},Gf=["href"],Bf=Ys(()=>k("div",{class:"space"},null,-1)),jf={class:"third-libs"},Kf=Ys(()=>k("div",{class:"lib-title"},"Thanks for third party libraries:",-1)),zf={class:"lib-container"},Wf={class:"lib-item"},Ff={key:0,class:"lib-item"},Jf=Ys(()=>k("a",{target:"_blank",href:"https://github.com/terwer/siyuan-plugin-publisher/blob/main/package.json#L54"},"more... ",-1)),qf=[Jf],Yf=F({__name:"About",setup(c){const{t:o}=Z(),t=re({v:di,deps:Object.entries(gi).slice(0,24)});return(s,e)=>{const a=Ve;return w(),C(a,{title:"关于作者"},{default:b(()=>[k("div",Of,[Vf,k("div",$f,[k("p",Nf,"发布工具 v"+K(t.v),1),k("div",Lf,[k("span",null,K(m(o)("slogan.make.written.fun")),1)]),Hf,k("div",Rf,[R("Created by "),k("a",{href:m(sr),target:"_blank"},"terwer",8,Gf)]),Bf,k("div",jf,[Kf,k("div",zf,[(w(!0),O(Ee,null,xe(t.deps,n=>(w(),O("div",Wf,K(n),1))),256)),t.deps.length>=24?(w(),O("div",Ff,qf)):Y("",!0)])])])])]),_:1})}}}),Xf=pe(Yf,[["__scopeId","data-v-cec1a207"]]),Zf={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Qf=k("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h6l2 2h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm7-3h2v-4.2l1.6 1.6L16 13l-4-4l-4 4l1.4 1.4l1.6-1.6z"},null,-1),ey=[Qf];function ty(c,o){return w(),O("svg",Zf,[...ey])}const sy={name:"material-symbols-drive-folder-upload",render:ty},oy={viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},ay=k("path",{fill:"currentColor",d:"M160 96a96 96 0 1 1 192 0a96 96 0 1 1-192 0m80 152v264l-48.4-24.2c-20.9-10.4-43.5-17-66.8-19.3l-96-9.6C12.5 457.2 0 443.5 0 427V224c0-17.7 14.3-32 32-32h30.3c63.6 0 125.6 19.6 177.7 56m32 264V248c52.1-36.4 114.1-56 177.7-56H480c17.7 0 32 14.3 32 32v203c0 16.4-12.5 30.2-28.8 31.8l-96 9.6c-23.2 2.3-45.9 8.9-66.8 19.3z"},null,-1),ny=[ay];function iy(c,o){return w(),O("svg",oy,[...ny])}const ly={name:"fa6-solid-book-open-reader",render:iy},ry={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},cy=k("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h9v2H5v14h14v-9h2v9q0 .825-.587 1.413T19 21zM17 9V7h-2V5h2V3h2v2h2v2h-2v2zM6 17h12l-3.75-5l-3 4L9 13zM5 5v14z"},null,-1),py=[cy];function uy(c,o){return w(),O("svg",ry,[...py])}const dy={name:"material-symbols-add-photo-alternate-outline",render:uy},gy={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},my=k("path",{fill:"currentColor",d:"m2.45 10.575l4.2-4.2q.35-.35.825-.5t.975-.05l1.3.275Q8.4 7.7 7.625 9t-1.5 3.15zm5.125 2.275q.575-1.8 1.563-3.4t2.387-3q2.2-2.2 5.025-3.287t5.275-.663q.425 2.45-.65 5.275T17.9 12.8q-1.375 1.375-3 2.388t-3.425 1.587zm6.9-3q.575.575 1.413.575T17.3 9.85t.575-1.412t-.575-1.413t-1.412-.575t-1.413.575t-.575 1.413t.575 1.412m-.7 12.025l-1.6-3.675q1.85-.725 3.163-1.5t2.912-2.125l.25 1.3q.1.5-.05.988t-.5.837zM4.05 16.05q.875-.875 2.125-.888t2.125.863t.875 2.125t-.875 2.125q-.625.625-2.087 1.075t-4.038.8q.35-2.575.8-4.025T4.05 16.05"},null,-1),hy=[my];function fy(c,o){return w(),O("svg",gy,[...hy])}const yy={name:"material-symbols-rocket-launch",render:fy},by={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},_y=k("path",{fill:"currentColor",d:"M18 11h-8V9h8m2-5v12H8V4zm0-2H8c-1.1 0-2 .9-2 2v12a2 2 0 0 0 2 2h12c1.11 0 2-.89 2-2V4a2 2 0 0 0-2-2M4 6H2v14a2 2 0 0 0 2 2h14v-2H4z"},null,-1),wy=[_y];function vy(c,o){return w(),O("svg",by,[...wy])}const Py={name:"mdi-minus-box-multiple-outline",render:vy};class Fn{static async preCheckPicgoPlugin(){const{kernelApi:o}=Ge();return await qa(o,"/data/plugins/siyuan-plugin-picgo/plugin.json","text")}static async preCheckBlogPlugin(){const{kernelApi:o}=Ge();return await qa(o,"/data/plugins/siyuan-blog/plugin.json","text")}}const Yi=c=>(mt("data-v-a0047030"),c=c(),ht(),c),Ty={class:"admin-box"},ky={id:"post-list"},Sy={class:"search-btn"},Ey={class:"value"},Cy={key:0,class:"data-empty-box"},Ay={key:1,class:"data-box"},Uy={m:"4",style:{"padding-left":"10px"},class:"tb-extend"},Iy={m:"t-0 b-2"},xy={m:"t-0 b-2"},My={m:"t-0 b-2"},Dy={m:"t-0 b-2"},Oy={m:"t-0 b-2"},Vy={m:"t-0 b-2"},$y={key:0},Ny=["onClick"],Ly={class:"el-icon"},Hy=["innerHTML"],Ry={key:1},Gy=Yi(()=>k("div",{style:{"text-align":"center"}},"标题",-1)),By={key:0,class:"yaml-count-sign"},jy=Yi(()=>k("div",{style:{"text-align":"center"}},"操作",-1)),Fa=8,Ky=F({__name:"Admin",setup(c){const{t:o}=Z(),{kernelApi:t,blogApi:s}=Ge(),{isInSiyuanWidget:e,isInSiyuanOrSiyuanNewWin:a}=at(),n=wt(),{getReadOnlyPublishPreferenceSetting:i}=xt(),{getReadOnlySiyuanSetting:l}=Un(),{getSetting:u}=me(),r=W("admin"),h=J(!1),y=J("prev,pager,next"),p=J(""),g=J([]),_=J(!1),d=[],v=J(0),P=J(0),S=J(1),E=J(!1),M=J(!1),x=J([]),z=l(),L=J(!1),j=J(""),I=J(""),A=(de,ce)=>{const Te=de?g.value.filter($(de)):g.value;ce(Te)},$=de=>ce=>ce.value.toLowerCase().indexOf(de.toLowerCase())===0,q=de=>{},G=()=>{nt()},H=de=>{nt()},X=async de=>{S.value=de,await nt()},ve=async de=>{S.value=de,await nt()},Le=async de=>{S.value=de,await nt()},Xe=(de,ce)=>{j.value=de,I.value=ce,L.value=!0},Be=(de,ce)=>{const $e=`${window.origin}${Cn}#${ce}`;r.debug(`Publisher will go to ${$e}`),Xe(de,$e)},ze=(de,ce)=>{const Te=`${z.value.apiUrl}/plugins/siyuan-blog/#${ce}`;r.debug(`Blog will go to ${Te}`),Xe(de,Te)},He=(de,ce)=>{const Te=`${z.value.apiUrl}/plugins/siyuan-plugin-picgo/#${ce}`;r.debug(`Picgo will go to ${Te}`),Xe(de,Te)},ie=de=>{const ce=`${z.value.apiUrl}/plugins/siyuan-plugin-picgo/#${de}`;r.debug(`Picgo will go to ${ce}`),window.open(ce)},Re=(de,ce)=>{const Te=ce.postid;Be("极速发布",`/publish/quickSelect?id=${Te}`)},Vt=(de,ce)=>{const Te=ce.postid;Be("单个发布",`/publish/singlePublish?id=${Te}`)},V=async(de,ce)=>{const Te=ce.postid;Be("常规发布",`/publish/singlePublish/doPublish/${de}/${Te}?method=edit`)},B=(de,ce)=>{const Te=ce.postid;Be("批量发布",`/publish/batchPublish?id=${Te}`)},ye=(de,ce)=>{const Te=window,$e=ce.postid;if(!ce.isShared){Q.warning(o("message.publish.notShared")),Te.event.stopPropagation();return}ze("文章预览",`/post/${$e}`)},et=(de,ce)=>{const Te=ce.postid;a()?He("图床",`/?pageId=${Te}`):ie(`/?pageId=${Te}`)},vt=async(de,ce,Te)=>{},nt=async()=>{h.value=!0;let de=1,ce=[],Te=!1;try{const $e=await fi();if(e()&&!T.isEmptyString($e))if(de=await t.getSubdocCount($e,_.value),de>1&&(Te=!0),Te){const yt=await t.getSubdocs($e,S.value-1,Fa,p.value,_.value);for(let je=0;je<yt.length;je++){const pt=yt[je].root_id,Bt=await s.getPost(pt);ce.push(Bt)}r.info("挂件模式，有子文档，展示子文档")}else r.info("挂件模式，没有子文档，直接显示发布页面"),await n.push({path:"/publish/singlePublish",query:{id:$e}});else de=await s.getRecentPostsCount(p.value,_.value),ce=await s.getRecentPosts(Fa,S.value-1,p.value,_.value),r.info("无法获取页面ID，可能是浏览器环境或者浏览器插件展示文档列表");r.debug("postList=>",ce),P.value=de,d.splice(0,d.length);for(let yt=0;yt<ce.length;yt++){const je=ce[yt];let kt=je.title;i().value.fixTitle&&(kt=Ut.removeTitleNumber(kt).replace(/\.md/g,""));const Bt=T.getByLength(kt,or,!1),hs=Os.mdToHtml(je.description),fs=je==null?void 0:je.shortDesc,$t=se.safeParse(je.attrs,{}),he=$t["custom-publish-status"]==="publish",te=$t["custom-expires"]&&$t["custom-expires"]-Date.now()<0,jt=await t.getBlockAttrs(je.postid),Kt={},ys={};for(let Xs in jt){if(!Xs.startsWith("custom-")||!Xs.endsWith("-yaml"))continue;const Oo=Xs.replace("-yaml","").replace("custom-","").replace("-","_");Kt[Oo]=jt[Xs],ys[Oo]=Io(x.value,Oo)}const Xi={postid:je.postid,title:kt,shortTitle:Bt,dateCreated:Me.formatIsoToZhDate(je.dateCreated.toISOString(),!0),mt_keywords:je.mt_keywords,description:U.emptyOrDefault(hs,"暂无内容"),shortDesc:U.emptyOrDefault(fs,"暂无内容"),isShared:he&&!te,yamlCount:Object.keys(Kt).length,yamlAttrs:Kt,dynCfgs:ys};d.push(Xi)}}catch($e){r.error(o("main.opt.failure")+"=>",$e),Q.error(o("main.opt.failure")+"=>"+$e)}finally{h.value=!1}v.value++},oe=async()=>{E.value=await Fn.preCheckPicgoPlugin(),M.value=await Fn.preCheckBlogPlugin();const de=await u(),ce=se.safeParse(de[De],{});x.value=(ce==null?void 0:ce.totalCfg)||[],await nt(),r.debug("Post init page=>",d)};return $s(async()=>{await oe()}),(de,ce)=>{const Te=Bl,$e=Se,yt=jl,je=Dt,kt=Ns,pt=Kl,Bt=ii,hs=zl,fs=Wl,$t=En;return w(),O("div",Ty,[k("div",ky,[k("div",Sy,[f(Te,{class:"s-input",modelValue:p.value,"onUpdate:modelValue":ce[0]||(ce[0]=he=>p.value=he),"fetch-suggestions":A,"popper-class":"my-autocomplete",placeholder:"请输入关键字",onChange:G,onSelect:q},{default:b(({item:he})=>[k("div",Ey,K(he.value),1)]),_:1},8,["modelValue"]),f($e,{class:"s-btn",type:"primary",onClick:G},{default:b(()=>[R("搜索")]),_:1}),f(yt,{class:"s-filter-item s-filter-published",size:"large",modelValue:_.value,"onUpdate:modelValue":ce[1]||(ce[1]=he=>_.value=he),onChange:H},{default:b(()=>[R("已发布 ")]),_:1},8,["modelValue"])]),h.value?(w(),O("div",Cy,[f(je,{loading:h.value,rows:5,animated:""},null,8,["loading"])])):(w(),O("div",Ay,[(w(),C(hs,{class:"tb-data",data:d,key:v.value,border:"",stripe:"","highlight-current-row":"","empty-text":"笔记数据为空或者思源笔记未启动！",onRowClick:vt,style:{width:"100%","min-width":"600px"}},{default:b(()=>[f(pt,{type:"expand"},{default:b(he=>[k("div",Uy,[k("p",Iy,"ID: "+K(he.row.postid),1),k("p",xy,"发布时间: "+K(he.row.dateCreated),1),k("p",My,"标题: "+K(he.row.title),1),k("p",Dy," 标签: "+K(he.row.mt_keywords===""?"暂无标签":he.row.mt_keywords),1),k("p",Oy,"摘要: "+K(he.row.shortDesc),1),k("p",Vy,[R(" 平台: "),he.row.yamlCount>0?(w(),O("span",$y,[(w(!0),O(Ee,null,xe(he.row.yamlAttrs,(te,jt)=>(w(),O("span",{key:jt,class:"box-item"},[k("a",{onClick:Kt=>V(jt.toString(),he.row)},[f(kt,null,{default:b(()=>{var Kt,ys;return[k("i",Ly,[k("span",{innerHTML:((Kt=he.row.dynCfgs[jt])==null?void 0:Kt.platformIcon)??m(ke).iconOTRemove},null,8,Hy)]),R(" "+K(((ys=he.row.dynCfgs[jt])==null?void 0:ys.platformName)??"[已删除]"),1)]}),_:2},1024)],8,Ny)]))),128))])):(w(),O("span",Ry,"暂无平台"))])])]),_:1}),f(pt,{prop:"title"},{header:b(()=>[Gy]),default:b(he=>[f(Bt,{content:he.row.yamlCount>0?"文章已发布到："+Object.keys(he.row.yamlAttrs).toString():"尚未发布",class:"box-item",effect:"light",placement:"right","popper-class":"publish-menu-tooltip"},{default:b(()=>[k("span",null,K(he.row.title),1)]),_:2},1032,["content"]),he.row.yamlCount>0?(w(),O("sup",By,K(he.row.yamlCount),1)):Y("",!0)]),_:1}),f(pt,{align:"center",width:"420"},{header:b(()=>[jy]),default:b(he=>[f($e,{size:"small",onClick:te=>Re(he.$index,he.row)},{default:b(()=>[f(m(yy)),R("  闪发 ")]),_:2},1032,["onClick"]),f($e,{size:"small",onClick:te=>Vt(he.$index,he.row)},{default:b(()=>[f(m(sy)),R("  单发 ")]),_:2},1032,["onClick"]),f($e,{size:"small",onClick:te=>B(he.$index,he.row)},{default:b(()=>[f(m(Py)),R("  批发 ")]),_:2},1032,["onClick"]),M.value&&he.row.isShared?(w(),C($e,{key:0,size:"small",onClick:te=>ye(he.$index,he.row)},{default:b(()=>[f(m(ly)),R("  查看 ")]),_:2},1032,["onClick"])):Y("",!0),E.value?(w(),C($e,{key:1,size:"small",onClick:te=>et(he.$index,he.row)},{default:b(()=>[f(m(dy)),R("  图床 ")]),_:2},1032,["onClick"])):Y("",!0)]),_:1})]),_:1})),f(fs,{small:"",background:"",layout:y.value,total:P.value,class:"mt-4","page-size":Fa,onPrevClick:X,onNextClick:ve,"current-page":S.value,onCurrentChange:Le},null,8,["layout","total","current-page"])]))]),f($t,{modelValue:L.value,"onUpdate:modelValue":ce[2]||(ce[2]=he=>L.value=he),size:"85%",title:j.value,direction:"rtl","destroy-on-close":!0},{default:b(()=>[f(Hi,{src:I.value},null,8,["src"])]),_:1},8,["modelValue","title"])])}}}),zy=pe(Ky,[["__scopeId","data-v-a0047030"]]),Wy={key:1},Fy={class:"platform-title"},Jy={class:"platform-desc"},qy={class:"one-key-preview"},Yy={class:"icon-list"},Xy={class:"el-icon"},Zy=["innerHTML"],Qy=F({__name:"QuickPublishSelectPlatform",props:{id:{type:String,default:""}},setup(c){const o=W("quick-publish-select-platform"),t=new fe,{getPostPreviewUrl:s}=Ks(),{kernelApi:e}=Ge(),{getReadOnlyPublishPreferenceSetting:a}=xt(),n=c,{t:i}=Z(),{query:l}=qe(),u=wt(),{getSetting:r}=me(),h=re({isInit:!1,pageId:T.isEmptyString(l.id)?n.id:l.id,enabledConfigArray:[],postInfo:{},postMeta:{},unpublishCount:0}),y=J(""),p=(E,M)=>{E.stopPropagation();const x=`/workers/quickPublish/${M}/${h.pageId}`;o.info("will go to =>",x);const z={path:x,query:{showBack:"true"}};u.push(z)},g=E=>{const M=Ae(E),x=ae.getProperty(h.postMeta,M);return!T.isEmptyString(x)},_=async(E,M)=>{if(E.stopPropagation(),!g(M)){h.unpublishCount++;return}const z=await _e.getCfg(M),L=await _e.getAdaptor(M,z),j=U.blogApi(t,L),I=await s(j,h.pageId,z);window.open(I)},d=async E=>{Pt.confirm("将在默认浏览器打开所有已发布平台的文章预览页面，是否继续？","温馨提示",{type:"error",icon:Ct(bn),confirmButtonText:i("main.opt.ok"),cancelButtonText:i("main.opt.cancel")}).then(async()=>{for(const M of h.enabledConfigArray)await _(E,M.platformKey);(h.enabledConfigArray.length===0||h.unpublishCount===h.enabledConfigArray.length)&&(h.unpublishCount=0,Q.error("文章未发布过，请至少发布到一个平台！"))}).catch(()=>{})},v=async()=>{const E=await r(),M=se.safeParse(E[De],{}),x=(M==null?void 0:M.totalCfg)||[];if(h.enabledConfigArray=x.filter(L=>L.isEnabled&&L.isAuth),h.postMeta=ae.getProperty(E,h.pageId,{}),h.postInfo=await e.getBlockByID(h.pageId),a().value.fixTitle){const L=Ut.removeTitleNumber(h.postInfo.content).replace(/\.md/g,"");y.value=L}else y.value=h.postInfo.content},P=J(!1),{loadingTime:S}=zs(P);return $s(async()=>{await v(),h.isInit=!0,P.value=!0}),(E,M)=>{const x=Hs,z=Dt,L=Ne,j=Se,I=Ns,A=Pn,$=To,q=Tn,G=kn,H=Ve;return w(),O(Ee,null,[f(x,{"loading-time":m(S),style:{padding:"0 24px"}},null,8,["loading-time"]),h.isInit?(w(),O("div",Wy,[f(H,{title:"文章极速发布"},{default:b(()=>[k("div",Fy,K(y.value),1),k("div",Jy,[k("p",null,[f(L,{class:"desc-tip",type:"error",title:"点击图标即可极速发布或者更新 🚀。"})])]),k("div",qy,[f(j,{type:"primary",size:"small",onClick:d},{default:b(()=>[R("一键预览")]),_:1})]),f(G,{gutter:20,class:"row-box"},{default:b(()=>[(w(!0),O(Ee,null,xe(h.enabledConfigArray,X=>(w(),C(q,{span:8,sm:12,xs:12,md:12,lg:8,xl:8,title:X.platformName,class:"platform-select-card"},{default:b(()=>[f($,{class:"card-item"},{default:b(()=>[k("div",Yy,[f(A,{type:g(X.platformKey)?"success":"danger",value:g(X.platformKey)?"预览":"未发布",class:Jt(g(X.platformKey)?"item published-item":"item"),onClick:bo(ve=>_(ve,X.platformKey),["stop"])},{default:b(()=>[f(I,{class:"define-item",onClick:bo(ve=>p(ve,X.platformKey),["stop"])},{default:b(()=>[k("i",Xy,[k("span",{innerHTML:X==null?void 0:X.platformIcon},null,8,Zy)]),R(" "+K(m(Mt).longPlatformName(X==null?void 0:X.platformName,11)),1)]),_:2},1032,["onClick"])]),_:2},1032,["type","value","class","onClick"])])]),_:2},1024)]),_:2},1032,["title"]))),256))]),_:1})]),_:1})])):(w(),C(z,{key:0,class:"placeholder platform-skt",rows:12,animated:""}))],64)}}}),eb=pe(Qy,[["__scopeId","data-v-3e7c1d4b"]]),tb=[{path:"/publish/quickSelect",component:eb},{path:"/workers/quickPublish/:key/:id",component:kp},{path:"/publish/singlePublish",component:$p},{path:"/publish/singlePublish/doPublish/:key/:id",component:Hu},{path:"/",component:zy},{path:"/publish/batchPublish",component:bd},{path:"/ai/chat",component:Pd},{path:"/test",component:Sd},{path:"/test/siyuan",component:Vd},{path:"/test/cnblogs",component:zd},{path:"/test/wordpress",component:tg},{path:"/test/typecho",component:ug},{path:"/test/yuque",component:vg},{path:"/test/zhihu",component:xg},{path:"/test/csdn",component:Gg},{path:"/test/picgo",component:Kg},{path:"/test/other",component:Jg},{path:"/test/chat",component:Xg},{path:"/setting",component:lh},{path:"/setting/publish",component:Gi},{path:"/setting/platform/quickadd/:type",component:Ri},{path:"/setting/platform/add/:type",component:dh},{path:"/setting/platform/update/:key",component:hh},{name:"setting-platform-single",path:"/setting/platform/single/:key",component:ff},{path:"/setting/general",component:Mf},{path:"/setting/siyuan",component:qi},{path:"/about",component:Xf}],sb=()=>Sl({history:El(),routes:tb}),ob={"lang.choose":"语言选择","lang.choose.placeholder":"请选择语言","theme.mode.choose":"切换模式","theme.mode.dark":"暗黑模式","theme.mode.light":"浅色模式","service.tab.manage":"文章管理","service.tab.publish.service":"发布服务","service.tab.publish.setting":"发布配置","service.tab.platform.setting":"平台配置","service.tab.post.bind":"文章绑定","service.tab.service.switch":"服务开关","service.tab.change.local":"偏好设置","main.publish.editmode":"编辑模式","main.publish.editmode.simple":"简洁模式","main.publish.editmode.complex":"详细模式","main.publish.editmode.source":"源码模式","main.publish.vuepress.tip":"推荐Vuepress的V1版本，配合 vuepress-theme-vdoing 使用，后续bug也只会对V1和此主题进行更新","main.publish.github.error.tip":"配置错误或者api不可用，请检查。若修改过配置，请刷新页面","main.publish.github":"发布页面","main.publish.github.tip":"自动将文章的markdown文本发布到Vuepress对应的Github仓库（需要先进行相关配置）","main.publish.github.no.tip":"您未开启Github pages发布，请切换源码模式复制YAML以及Markdown文本","main.publish.github.choose.path":"发布目录","main.publish.github.published.path":"发布路径","main.publish.github.choose.path.use.default":"默认目录","main.publish.github.choose.path.use.default.tip":"使用默认目录，则默认所有文章都发布在配置好的默认目录下（可在发布配置设置），无需每次发布的时候来选择目录，当前平台的默认目录为：","main.publish.github.choose.title":"文件名称","main.publish.github.choose.title.tip":"Vuepress-theme-vdoing支持文件名加上序号来标识，如果你不清楚此用法，请不要修改文件名","main.publish.github.failure":"发布失败，请自行复制右侧文本","main.publish.see.preview":"点击这里查看最新文章","main.publish.see.md.preview":"点击这里查看MD文件","main.publish.see.real.preview":"点击这里查看最新文章","main.publish.to.wordpress":"发布到Wordpress","main.title":"文章标题","main.slug":"文章别名","main.auto.fetch.slug":"自动生成别名","main.use.google.translate":"使用Google翻译API","main.use.hash":"别名后缀","main.use.hash.tip":"不使用hash会展示更有意义的url，但是可能导致文章别名重复（后果是Vuepress会Build失败除非手动解决别名唯一问题），请知悉。","main.force.refresh":"刷新别名","main.force.refresh.tip":"为了防止误操作更新别名，别名不为空的时候默认不会更新别名，如需更新，请勾选刷新别名。","main.desc":"文章摘要","main.auto.fetch.desc":"自动提取摘要","main.create.time":"发布时间","main.update.time":"更新时间","main.create.time.placeholder":"请选择发布时间","main.update.time.placeholder":"请选择更新时间","main.tag":"文章标签","main.tag.new":"新标签","main.tag.select":"请选择标签","main.auto.fetch.tag":"自动提取标签","main.tag.auto.switch":"自动标签","main.tag.auto.switch.no.tip":"自动标签已关闭，将不会自动生成标签","main.tag.empty":"暂无标签","main.tag.close":"收起选项","main.cat":"文章分类","main.cat.empty":"暂无分类","main.cat.select":"请选择分类","main.yaml.formatter":"YAML Formatter","main.siyuan.to.yaml":"文章属性转YAML","main.yaml.to.siyuan":"YAML转文章属性","main.save.attr.to.siyuan":"保存属性到思源","main.copy":"复制","main.publish":"发布","main.publish.loading":"发布中...","main.loading":"加载中...","main.update":"更新","main.cancel":"取消","main.publish.oneclick.attr":"一键生成属性","main.publish.oneclick.attr.finish":"属性已生成","main.publish.status.unpublish":"未发布","main.publish.status.published":"已发布","main.publish.to.vuepress":"发布到Vuepress","main.publish.to.hugo":"发布到Hugo","main.publish.to.hexo":"发布到Hexo","main.publish.to.jekyll":"发布到Jekyll","main.publish.to.jvue":"发布到JVue","main.publish.to.conf":"发布到Confluence","main.publish.to.cnblogs":"发布到博客园","main.publish.to.liandi":"发布到链滴","main.publish.to.yuque":"发布到语雀","main.publish.to.kms":"发布到KMS","main.opt.success":"操作成功","main.opt.failure":"操作失败","main.copy.success":"复制成功","main.copy.failure":"复制失败","main.opt.quick":"快捷操作","main.opt.status.publish":"文章已发布","main.opt.status.updated":"文章已更新","main.opt.status.cancel":"文章发布已取消","main.opt.loading":"操作中...","main.opt.warning":"警告信息","main.opt.tip":"温馨提示","main.opt.ok":"确认","main.opt.cancel":"取消","main.opt.select":"请选择","main.opt.warning.tip":"此操作不可恢复，是否继续？","setting.noneed":"无需配置","setting.blog.setting":"设置","setting.blog.index":"偏好设置","setting.blog.type":"博客类型","setting.blog.type.placeholder":"请选择博客类型","setting.blog.type.wordpress.value":"Wordpress","setting.blog.type.wordpress.label":"Wordpress","setting.blog.type.metaweblog.value":"MetaweblogApi","setting.blog.type.metaweblog.label":"Metaweblog API","setting.blog.type.github.value":"Github","setting.blog.type.github.label":"Github","setting.blog.type.github.user":"Github用户名","setting.blog.type.github.user.tip":"Github用户名，例如：terwer","setting.blog.type.github.repo":"git仓库名","setting.blog.type.github.repo.tip":"git仓库名，例如：hexo-blog","setting.blog.type.github.token":"Github令牌","setting.blog.type.github.token.tip":"Github令牌，例如：ghp_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX","setting.blog.type.github.token.gen":"Github 个人令牌生成地址","setting.blog.type.github.default.branch":"默认分支","setting.blog.type.github.default.branch.tip":"默认分支（旧版仓库为master，新版仓库默认为main），例如：main","setting.blog.type.github.default.path":"存储目录","setting.blog.type.github.default.path.tip":"存储目录例如：docs，部分平台可使用[auto]作为特殊占位符，代表自动映射层级目录，例如：docs/[auto]","setting.blog.type.github.images.path":"图片存储目录","setting.blog.type.github.images.path.tip":"图片存储目录，相对于仓库根目录，留空则使用相对于根目录的 images 目录","setting.blog.type.github.msg":"提交信息","setting.blog.type.github.msg.tip":"提交信息，例如：auto published by siyuan-publish-publisher","setting.blog.type.github.author":"作者","setting.blog.type.github.author.tip":"作者，例如：terwer","setting.blog.type.github.email":"邮箱","setting.blog.type.github.email.tip":"邮箱","setting.blog.type.github.site":"作者主页","setting.blog.type.github.site.tip":"作者主页，如果为空默认为：[GitHub地址]/[用户名]","setting.blog.url":"博客网址","setting.blog.github.url.tip":"Github首页地址","setting.blog.username":"账号","setting.blog.password":"密码/Token","setting.blog.apiurl":"API地址","setting.blog.github.apiurl.tip":"Github 的 REST API 地址，通常是：https://api.github.com","setting.blog.previewPostUrl":"文章预览规则","setting.blog.previewPostUrl.tip":"预览规则（占位符：[yyyy] [MM] [dd] [postid]），例如：/post/[postid].html 或者 /[cats]/[yyyy]/[mm]/[dd]/[postid].html","setting.blog.previewUrl":"预览规则","setting.blog.previewUrl.tip":"如果不明白原理，请勿修改此选项。MD文件预览规则（占位符：[user] [repo] [branch] [docpath]），通常是：/[user]/[repo]/blob/[branch]/[docpath]","setting.blog.mdFilenameRule":"文件规则","setting.blog.mdFilenameRule.tip":"Markdown文件名规则(占位符：[yyyy] [MM] [dd] [slug] [filename])，例如：[filename].md、[slug].md、[yyyy]-[mm]-[dd]-[slug].md","setting.blog.pageType":"发布格式","setting.blog.validate":"验证","setting.blog.save":"保存","setting.blog.vali":"验证","setting.blog.vali.tip":"强烈建议保存之前先验证配置以保证api的可用性，验证过程中将发送一篇测试文章，您可以稍后在平台手动删除它。您也可以先保存，稍后修改，但是在验证通过之前该api将不可使用。","setting.blog.vali.tip.metaweblog":"配置错误或者api不可用，请检查。若修改过配置，请刷新页面","setting.blog.vali.ing":"验证中...","setting.blog.vali.ok":"验证通过，不要忘了点击下方保存哟(*^▽^*)","setting.blog.vali.ok.metaweblog":"配置已保存并验证通过","setting.blog.vali.error":"API验证失败，请检查配置","setting.blog.platform.support.github":"您当前操作的是支持Github的平台：","setting.blog.platform.support.metaweblog":"您当前操作的是支持metaweblog的平台：","setting.blog.cancel":"取消","setting.vuepress":"Vuepress","setting.hugo":"Hugo","setting.hexo":"Hexo","setting.jekyll":"Jekyll","setting.jvue":"JVue","setting.conf":"Confluence","setting.conf.tip":"发布到Confluence需要配合我的另一个适配器项目使用（强烈推荐），请参考：https://github.com/terwer/node-metaweblog-api-adaptor","setting.cnblogs":"博客园","setting.wordpress":"Wordpress","setting.liandi":"链滴","setting.yuque":"语雀","setting.kms":"KMS","setting.other1":"其他1","service.switch.vuepress":"Vuepress","service.switch.hugo":"Hugo","service.switch.hexo":"Hexo","service.switch.jekyll":"Jekyll","service.switch.jvue":"JVue","service.switch.conf":"Confluence","service.switch.cnblogs":"博客园","service.switch.wordpress":"Wordpress","service.switch.yuque":"语雀","service.switch.liandi":"链滴","service.switch.wechat":"微信聊天","service.switch.wemp":"微信公众号","service.switch.zhihu":"知乎","service.switch.kms":"知识仓库","service.switch.must.select.one":"您必须选择一个至少平台","post.bind.vuepress.slug":"Vuepress别名","post.bind.hugo.slug":"Hugo别名","post.bind.hexo.slug":"Hexo别名","post.bind.jekyll.slug":"Jekyll别名","post.bind.cnblogs.postid":"博客园别名","post.bind.jvue.postid":"JVue的ID","post.bind.conf.postid":"Conf的ID","post.bind.wordpress.postid":"WP的ID","post.bind.liandi.postid":"链滴的ID","post.bind.yuque.postid":"语雀的ID","post.bind.kms.postid":"KMS的ID","post.bind.conf.save":"保存","post.bind.conf.v081":"检测 v0.8.1 元数据并导入","post.bind.auto.error":"未检测到ID，请手动输入文档根 ID ，然后再进行修复","post.bind.auto.empty":"该文档未发布过，无需修复","post.bind.conf.cancel":"取消","form.validate.name.required":"请输入名称","form.validate.name.length":"长度必须在0到1之间","form.validate.github.auto.delete":"自动删除","dynamic.platform.new":"平台管理","dynamic.platform.tip":"如果内置的发布服务无法满足或者需要添加多个实例，您可以在这里添加受支持的平台，目前支持通用平台（Zhihu、语雀、CSDN等）、Github（HUGO、HEXO、Jekyll等）、metaweblog API（开源中国等）和Wordpress API","dynamic.platform.type":"平台类型[必选]","dynamic.platform.subtype":"子平台名称","dynamic.platform.type.metaweblog":"metaweblog API","dynamic.platform.type.wordpress":"Wordpress","dynamic.platform.type.github":"Github","dynamic.platform.type.common":"通用平台","dynamic.platform.type.custom":"自定义","dynamic.platform.key":"平台key","dynamic.platform.key.tip":"平台唯一标识，不能重复，例如：myblog","dynamic.platform.name":"平台名称","dynamic.platform.name.tip":"平台名称，例如：我的博客","dynamic.platform.opt.add":"提交","dynamic.platform.opt.noselect":"请选择平台类型","dynamic.platform.opt.key.exist":"平台key已经存在","dynamic.platform.opt.del.confirm":"删除此平台将会彻底移除此平台相关配置信息，是否继续？","dynamic.platform.opt.del.select":"删除","dynamic.platform.opt.item.select":"未选择","dynamic.platform.opt.item.select.tip":"当前选择的是：","dynamic.platform.opt.item.no.select.tip":"请选择要删除的行","setting.common.home":"平台首页","setting.common.tip":"平台首页，用于预览文章，例如：https://terwer.space","setting.common.apiurl":"API地址","setting.common.token":"鉴权token","setting.common.token.gen":"Token生成地址","setting.common.username":"用户名","setting.common.username.gen":"访问策略设置","setting.common.password":"密码","setting.blog.platform.support.common":"您当前操作的平台是：","platform.must.select.one":"哇哦，离使用就差一步啦 o(╥﹏╥)o ，您必须添加并启用至少一个平台。可通过「平台导入」获取去插件闪商店自定义添加。","blog.list.toptip":"温馨提示：单击表格行可以进入文章详情页，详情页有发布按钮哦! (〃'▽'〃)","config.error.msg":"配置错误，请前往对应发布配置修改","config.platform.none":"没有启用的发布平台，请前往服务开关开启","post.delete.by.platform":"文章已被平台自行删除，请点击取消强制解除关联","blog.top-data-tip":"温馨提示：1. 0.1.0+ 以后，可通过【偏好设置->思源设置】来修改默认伺服配置，支持本地和远程；如果是远程还需要设置token，如果使用浏览器插件或者挂件之外的访问方式还需要设置跨域请求代理。 2、升级新版之前强烈建议导出配置，防止配置丢失。 3、如果出现新版本不兼容的异常情况，建议清空配置。此操作不可恢复，请谨慎操作！","blog.top-data-tip.siyuan":"温馨提示：1、当前处于挂件模式，从 0.1.0 版本开始，无需在所有页面引用挂件了，只需要在父级页面引用一个挂件即可。具体规则如下：(1). 如果检测到没有子文档，会兼容 0.0.3 版本以前的方式，展示当前文档的发布页面。 (2). 如果检测到有子文档，会以列表加分页的方式展示所有子文档列表。可单独选择某个子文档进行发布操作。 2、升级新版之前强烈建议导出配置，防止配置丢失。 3、如果出现新版本不兼容的异常情况，建议清空配置。此操作不可恢复，请谨慎操作！","blog.newwin.open":"页签模式","blog.change.siyuan.api":"思源地址","setting.blog.siyuan.current.apiurl":"当前API地址=>","setting.blog.middlewareUrl":"跨域请求代理","setting.blog.middlewareUrl.tip":"某些场景下需要（例如自部署模式，Nginx伺服等、vite开发环境伺服等），其他情况可忽略","setting.blog.middlewareUrl.my.tip":"部分跨域场景可用（不支持绕过浏览器拒绝的 header ，例如 origin、referer 等；请求体不支持 FormData 等二进制格式，仅支持字符串），出于性能考虑，建议自己部署一份，请使用 https://github.com/terwer/node-metaweblog-api-adaptor 进行部署。","setting.blog.middlewareUrl.my.fee.tip":"🤝由于共享代理占用巨大的成本，或者因为不可抗力原因可能会取消共享，为了保证服务可用性，建议自己部署一份，或者请作者喝一杯咖啡，鼓励我们持续共享🌹。参考之前的前辈大佬倒下的故事：https://linux.do/t/topic/1051","setting.blog.middlewareUrl.my.coffee":"赞助咖啡☕️","setting.conf.export":"导出配置","setting.conf.import":"导入配置","setting.conf.transport":"导入导出","setting.conf.clear":"清空配置","page.no.id":"请求非法，原因：pageId获取失败","yaml.show.type.yaml":"YAML","yaml.show.type.md":"MD正文","yaml.show.type.yamlmd":"YAML+MD正文","yaml.show.type.html":"HTML正文","main.read.mode":"只读模式","main.edit.mode":"编辑模式","main.read.mode.tip1":"温馨提示：为了数据一致性，多平台分发或者未提供YAML适配器时无法处理平台属性，YAML将仅显示公共属性且只能只读。","main.read.mode.tip2":"YAML如有修改，请务必点击保存按钮，否则修改内容将丢失！","main.read.mode.tip3":"为了标识文章的唯一性，slug修改将忽略，其他属性可同步。","main.read.mode.tip4":"如需删除了内置的YAML属性，删除之后请务必先同步到思源笔记，否则切换模式会还原。","main.opt.onclick.confirm.tip":"此操作默认将重新生成除别名以外的所有属性，如果只想修改个别属性，请在详细模式点击单独的功能按钮进行对应操作，是否继续？","main.cat.list.error":"分类获取失败","main.yaml.no.save":"您编辑过YAML，点击确认可同步YAML到属性，取消将丢失YAML修改，是否继续？","setting.github.baseUrl":"Git平台地址","setting.github.baseUrl.tip":"Git平台地址，用于MD文件预览，默认是：https://github.com","preference.setting.fixTitle":"去除标题编号","preference.setting.removeH1":"去除正文H1","preference.setting.removeH1.tip":"删除H1可能会误删除Markdown里面的#开头的注释，如需开启，请使用2个以上的#注释，是否继续？","preference.setting.newWin":"新窗口操作","siyuan.browser.show.close.btn":"显示关闭按钮","siyuan.browser.menu.quick.btn":"一键快速发布","siyuan.browser.menu.publish.btn":"文章发布（自动检测，有子文档->列表页；无子文档->发布页）","siyuan.browser.menu.preview.btn":"文章预览（当前文章只读预览）","siyuan.browser.menu.manage.btn":"文章管理（全部文章统一管理）","siyuan.browser.menu.anki.btn":"Anki标记（配合ankisiyuan生成Anki标记）","siyuan.browser.menu.picture.btn":"PicGO图床（支持图床配置与图片上传）","siyuan.browser.menu.setting.btn":"偏好设置（系统设置统一入口）","anki.siyuan.deck":"牌组","anki.siyuan.deck.new":"新牌组","anki.siyuan.tag":"标签","anki.siyuan.tag.new":"新标签","picgo.chrome.tip":"您当前使用的是浏览器插件，需要从这里下载配置 PicGo 客户端：https://github.com/Molunerfinn/PicGo/releases","picgo.siyuan.tip":"您当前使用的是思源笔记挂件，PicGO已内置，只需配置即可","post.detail.button.copy.id":"复制本文ID","post.detail.button.share.link":"复制分享链接","post.detail.button.browser.open":"默认浏览器打开","post.detail.button.pic.manage":"图片管理","post.detail.button.anki.mark":"Anki标记","post.detail.index.send.to.publish":"发布到其他平台","post.detail.index.export.to.pdf":"导出为PDF","picgo.upload.status":"上传状态","picgo.upload.select.pic":"选择图片","picgo.upload.clipboard":"剪贴板图片","picgo.upload.onclick":"一键上传本地图片到图床","picgo.download.onclick":"一键下载远程图片到本地","picgo.download.local.to.bed":"上传本地图片到图床","picgo.download.bed.to.local":"下载远程图片到本地","picgo.pic.preview":"图片预览","picgo.pic.setting":"图床设置","picgo.pic.setting.no.tip":"由于您当前使用的是浏览器插件，无法直接集成 PicGo ，只能通过 HTTP 请求间接调用本地 PicGo 客户端上图片，请直接在本地 PicGo 客户端进行设置。如需体验更加完整的功能，请通过思源笔记挂件版挂载菜单打开新窗口的方式使用。详情请参考：https://docs.publish.terwer.space/post/the-pendant-mode-is-used-in-the-method-of-mounting-menu-169wrw.html","github.use.permalink":"永久链接","github.use.permalink.no.warn":"您已关闭永久链接，formatter将不会生成标记，这在某些特殊场景下可能有用，大部分情况下需要开启此选项，注意：目前仅仅在HUGO平台生效，主要是适配Docsy","github.menu.title":"菜单标题","github.menu.title.placeholder":"菜单栏标题（HUGO平台专用，为空则不显示在菜单）","github.weight":"显示权重","github.weight.placeholder":"权重（决定显示顺序，越小显示越靠前）","github.use.date":"显示日期","github.use.date.no.warn":"您已关闭日期显示，将不会在formatter生成date字段","github.post.picgo.use":"使用图床","github.post.picgo.use.tip":"启用此选项，将会自动将此文档包含的所有本地图片上传至自定义图床（远程图片不上传），请确保PicGO图床配置正确","github.post.picgo.start.upload":"图床已开启，即将上传本地图片到图床","github.post.picgo.picbed.error":"文档可能已经成功发布，但是图片上传失败或者当前场景不支持图片上传，详细信息","setting.yuque.home.tip":"语雀平台首页，通常固定是：https://www.yuque.com/","setting.yuque.username.tip":"语雀平台用户名，注意是【账户设置】里面固定连接里面的用户名，不是用户昵称哦(*^▽^*)","setting.yuque.password.tip":"语雀平台的Token，请按照链接点击获取，只需要勾选【读取你的知识库】和【修改和读取你的文档】两个权限即可","setting.yuque.apiurl.tip":"语雀平台的API地址，通常固定是：https://www.yuque.com/api/v2","setting.yuque.previewUrl.tip":"语雀平台的文章预览规则，通常是：/[notebook]/[postid]","setting.notion.home.tip":"Notion平台首页，通常固定是：https://www.notion.so/","setting.notion.password.tip":"Notion平台的Token，请按照链接点击获取，需要勾选【Read content】、【Update content】、【Insert content】三个权限","setting.notion.apiurl.tip":"Notion平台的API地址，通常固定是：https://api.notion.com/v1","setting.notion.previewUrl.tip":"Notion平台的文章预览规则，通常是：/[postid]","setting.liandi.home.tip":"链滴平台首页，通常固定是：https://ld246.com/","setting.liandi.username.tip":"链滴平台用户名，注意是点击【个人主页】之后URL上member后面显示的用户名，不是用户昵称哦(*^▽^*)","setting.liandi.password.tip":"链滴平台的Token，请按照链接点击获取","setting.liandi.apiurl.tip":"链滴平台的API地址，通常固定是：https://ld246.com/api/v2","setting.kms.home.tip":"KMS平台首页，例如：http://localhost:9564/kms16_release/kms/multidoc","setting.kms.username.tip":"KMS平台Rest账户用户名，请按照链接指示创建","setting.kms.password.tip":"KMS平台Rest账户密码，请按照链接指示创建","setting.kms.apiurl.tip":"KMS平台的API地址，例如：http://localhost:9564/kms16_release/api/kms-multidoc/kmsMultidocKnowledgeRestService","siyuan.local.share.tip":"温馨提示：如果发现分享链接或者浏览器打开无法显示或者网络连接被拒绝，请按照下面操作排查。1：思源笔记->设置->关于->打开网络伺服；2：在浏览器打开之后，点击底部思源地址，修改对应地址为局域网ip地址。","setting.cnblogs.home.tip":"您的博客园首页，通常是：https://www.cnblogs.com/<您的用户名>","setting.cnblogs.username.tip":"您的博客园MetaWeblog登录名，可前往您的博客园后台->设置查看，注意：是登录名，不是用户昵称哦(*^▽^*)","setting.cnblogs.password.tip":"您的博客园MetaWeblog访问令牌，可前往您的博客园后台->设置查看","setting.cnblogs.apiUrl.tip":"您的博客园MetaWeblog访问地址，可前往您的博客园后台->设置查看，通常是：https://rpc.cnblogs.com/metaweblog/<您的用户名>","setting.cnblogs.previewUrl.tip":"博客园平台的文章预览规则，通常是：/p/[postid].html","setting.wordpress.home.tip":"WordPress首页","setting.wordpress.username.tip":"WordPress登录名，注意：是登录名，不是用户昵称哦(*^▽^*)","setting.wordpress.password.tip":"WordPress登录密码","setting.wordpress.apiUrl.tip":"WordPress的xmlrpc远程发布地址，通常是：https://<WordPress博客地址>/xmlrpc.php","setting.wordpress.previewUrl.tip":"WordPress平台的文章预览规则，通常是：?p=[postid]","setting.wordpressdotcom.home.tip":"WordPress.com 首页","setting.wordpressdotcom.username.tip":"WordPress.com 登录名，注意：是登录名或者邮箱，不是用户昵称哦(*^▽^*)","setting.wordpressdotcom.password.tip":"WordPress.com 登录密码","setting.wordpressdotcom.apiUrl.tip":"WordPress.com 的xmlrpc远程发布地址，通常是：https://<WordPress登录名>.wordpress.com/xmlrpc.php","setting.wordpressdotcom.previewUrl.tip":"WordPress.com 平台的文章预览规则，通常是：?p=[postid]","setting.oschina.home.tip":"开源中国首页，通常是：https://my.oschina.net/<您的用户名>","setting.oschina.username.tip":"开源中国登录名，可以输入登录邮箱","setting.oschina.password.tip":"开源中国登录密码","setting.oschina.apiUrl.tip":"开源中国的xmlrpc远程发布地址，通常固定是：https://www.oschina.net/action/xmlrpc","setting.oschina.previewUrl.tip":"开源中国平台的文章预览规则，通常是：/blog/[postid]","setting.typecho.home.tip":"Typecho平台的首页","setting.typecho.username.tip":"Typecho平台登录名","setting.typecho.password.tip":"Typecho平台密码","setting.typecho.apiUrl.tip":"Typecho平台的xmlrpc远程发布地址，通常固定是：https://<平台地址>/index.php/action/xmlrpc","setting.typecho.previewUrl.tip":"Typecho平台的文章预览规则，通常是：/index.php/archives/[postid]","setting.metaweblog.home.tip":"Metaweblog平台的首页","setting.metaweblog.username.tip":"Metaweblog平台登录名","setting.metaweblog.password.tip":"Metaweblog平台密码","setting.metaweblog.apiUrl.tip":"Metaweblog平台的xmlrpc远程发布地址","setting.metaweblog.previewUrl.tip":"Metaweblog平台的文章预览规则，[postid]可作文文章ID占位符","setting.jvue.home.tip":"Jvue平台的首页，例如：http://localhost:3000","setting.jvue.username.tip":"Jvue平台登录名","setting.jvue.password.tip":"Jvue平台密码","setting.jvue.apiUrl.tip":"Jvue平台的xmlrpc远程发布地址，通常固定是：https://<平台地址>/xmlrpc，例如：http://localhost:8008/xmlrpc","setting.jvue.previewUrl.tip":"Jvue平台的文章预览规则，通常是：/post/[postid].html","setting.conf.home.tip":"Confluence Cloud，首页，通常是：https://<您的用户名>.atlassian.net/wiki/spaces/<空间名>","setting.conf.username.tip":"Confluence登录名，可前往您的atlassian账户获取","setting.conf.password.tip":"Confluence访问令牌，可前往您的atlassian账户获取","setting.conf.apiUrl.tip":"可前往 https://developer.atlassian.com/cloud/confluence/rest/v1/#api-wiki-rest-api-content-get 查看文档","setting.conf.previewUrl.tip":"Confluence平台文章预览规则，通常是：/pages/[postid]","setting.zhihu.home.tip":"知乎专栏首页地址，通常固定","setting.zhihu.username.tip":"知乎用户名，必须设置正确，否则无法获取专栏","setting.zhihu.password.tip":"知乎Cookie，请勿修改","setting.zhihu.apiUrl.tip":"通常固定，请勿修改","setting.zhihu.previewUrl.tip":"知乎平台文章预览规则，通常是：/[postid]","setting.csdn.home.tip":"CSDN博客首页地址，通常固定","setting.csdn.password.tip":"CSDN的Cookie，请勿修改","setting.csdn.apiUrl.tip":"通常固定，请勿修改","setting.csdn.previewUrl.tip":"CSDN平台文章预览规则","setting.wechat.home.tip":"微信公众号首页地址，通常固定","setting.wechat.password.tip":"微信公众号的Cookie，请勿修改","setting.wechat.apiUrl.tip":"通常固定，请勿修改","setting.wechat.previewUrl.tip":"微信公众号平台文章预览规则","setting.jianshu.home.tip":"简书首页地址，通常固定","setting.jianshu.password.tip":"简书的Cookie，请勿修改","setting.jianshu.apiUrl.tip":"通常固定，请勿修改","setting.jianshu.previewUrl.tip":"简书平台文章预览规则","setting.juejin.home.tip":"掘金首页地址，通常固定","setting.juejin.password.tip":"掘金的Cookie，请勿修改","setting.juejin.apiUrl.tip":"通常固定，请勿修改","setting.juejin.previewUrl.tip":"掘金平台文章预览规则","setting.halo.home.tip":"Halo首页地址，需要包括域名端口，例如：http://localhost:8090","setting.halo.username.tip":"Halo博客登录名","setting.halo.password.tip":"Halo博客登录密码","setting.halo.apiUrl.tip":"Halo博客API地址，一般与Halo首页相同","setting.halo.previewUrl.tip":"Halo博客文章预览规则，默认 /archives/{slug}，占位符有 {slug} {name} {year} {month} {day}，可在 [halo-home-url]/console/settings?tab=routeRules设置","setting.flowus.home.tip":"Flowus首页地址，通常固定","setting.flowus.password.tip":"Flowus的Cookie，请勿修改","setting.flowus.apiUrl.tip":"通常固定，请勿修改","setting.flowus.previewUrl.tip":"Flowus平台文章预览规则","setting.picgo.refer.to":"详情请参考：","setting.picgo.refer.to.online.doc":"PicGO配置在线文档","setting.picgo.picbed":"图床设置","setting.picgo.picgo":"PicGO设置","main.opt.edit":"编辑","main.opt.delete":"删除","setting.picgo.picgo.open.config.file":"打开配置文件","setting.picgo.picgo.click.to.open":"点击打开","setting.picgo.picgo.choose.showed.picbed":"请选择显示的图床","setting.picgo.picbed.selected.tip":"已选中","setting.picgo.picbed.unselected.tip":"未选中","setting.picgo.picbed.set.default":"设为默认图床","setting.picgo.picbed.current.selected.tip":"已选中图床：","setting.picgo.picbed.current.tip":"当前默认图床是：","setting.picgo.picbed.uploader.config.name":"图床配置名","setting.picgo.picbed.uploader.config.name.placeholder":"请输入配置名称","setting.picgo.config.name":"配置名称","setting.picgo.config.name.placeholder":"请输入配置名称","setting.picgo.index.tip":"注意：1、此处上传的图片不会自动插入文档中，请手动点击按钮复制链接，然后 Ctrl+V 粘贴到文档中。2、对于文档当中原本已经存在的本地图片，点击上传之后不会直接替换原始图片，只会存储本地图片与图床图片的映射信息，需要在发布文章时手动勾选【使用图床】才会进行临时链接替换，请知悉。这样做是为了不破坏其他地方对文档图片的处理。当然，您也可以手动复制图床链接，然后删除原图片，替换为图床图片。3、该图片列表仅展示此文档包含的图片。","setting.picgo.index.copy.link":"复制链接","setting.picgo.setting.timestamp.rename":"时间戳重命名","setting.picgo.setting.close":"关","setting.picgo.setting.open":"开","setting.picgo.setting.log.file":"日志文件","setting.picgo.plugin":"插件设置","setting.picgo.plugin.list":"插件列表","setting.picgo.plugin.import.local":"导入本地插件","setting.picgo.plugin.install":"安装","setting.picgo.plugin.installing":"安装中","setting.picgo.plugin.installed":"已安装","setting.picgo.plugin.doing.something":"进行中","setting.picgo.plugin.search.placeholder":"搜索npm上的PicGo插件，或者点击上方按钮查看优秀插件列表。推荐：watermark-elec、s3","setting.picgo.plugin.gui.not.implemented":"该插件未对可视化界面进行优化, 是否继续安装?","setting.picgo.setting.node.path":"Node安装路径","setting.picgo.setting.node.path.tip":"请输入Node安装完整路径，例如：/opt/node16/bin，Node版本>=16","setting.picgo.setting.node.registry":"NPM的registry","setting.picgo.setting.node.registry.tip":"国内推荐：https://registry.npmmirror.com","setting.picgo.setting.node.proxy":"NPM代理","setting.picgo.setting.node.proxy.tip":"一般可留空，如有特殊需求可设置自定义代理","setting.picgo.setting.config.tip":"注意：横线以上的属性会改变上传图片的行为，配置可自动保存。横线以下的属性仅仅在安装插件时用到，并且需要点击【确认】按钮才能保存。","setting.picgo.plugin.install.success":"插件已经成功安装，请清除搜索关键字刷新列表。点击插件对应【设置】图标可查看插件详情，并对插件进行自定义设置。如果是图床扩展，请关闭重新打开，然后启用图床并进行设置。","syp.about":"关于作者","setting.picgo.plugin.uninstall":"卸载插件","setting.picgo.plugin.uninstall.success":"插件已经成功卸载。","setting.picgo.plugin.enable":"启用插件","setting.picgo.plugin.disable":"禁用插件","setting.picgo.plugin.update":"更新插件","setting.picgo.plugin.config.setting":"插件设置","setting.picgo.plugin.work":"已兼容","setting.picgo.plugin.nowork":"不兼容","setting.picgo.plugin.nouse":"不可用","setting.picgo.plugin.update.success":"更新成功","setting.conf.import.syp":"导入挂件配置","setting.conf.import.picgo":"导入PicGO配置","setting.conf.export.syp":"导出挂件配置","setting.conf.export.picgo":"导出PicGO配置","setting.conf.import.syp.tip":"请选择有效的历史备份json文件进行导入。注意：挂件配置会进行配置替换。","setting.conf.import.picgo.tip":"请选择有效的历史备份json文件进行导入。注意：PicGO插件的注册信息不导入。为了配置的兼容性，请卸载所有插件之后，进行PicGO配置导出操作。卸载PicGO插件不会删除插件配置，只会删除插件文件以及插件注册记录。请放心卸载。","setting.conf.export.syp.tip":"将导出对应的json配置文件，强烈建议定期进行配置备份。原则上支持向后兼容。如有不兼容问题，会特别说明。","setting.conf.export.picgo.tip":"将导出对应的json配置文件，强烈建议定期进行配置备份。原则上支持向后兼容。如有不兼容问题，会特别说明。","setting.conf.clear.syp":"清空挂件配置","setting.conf.clear.picgo":"清空PicGO配置","setting.conf.clear.tip":"清空配置不可恢复，请谨慎操作。强烈建议先备份配置。","setting.conf.clear.picgo.tip":"清空配置不可恢复，请谨慎操作。强烈建议先备份配置。此操作会删除PicGO相关配置文件夹，包括配置、插件、缓存等，仅在PicGO加载发生异常，并且完全无法使用的时候使用，否则丢失配置后果自负！","setting.main.background":"挂件背景","setting.main.background.tip":"支持16进制和rgb，例如：#000000，未设置或者留空不变。如果新窗口设置，请重新刷新文档。","setting.picgo.manage":"图床管理","setting.platform.import":"平台导入","setting.platform.store":"插件商店","setting.platform.add":"新增平台","setting.platform.add.this":"新增此平台","setting.platform.universal":"通用平台","setting.platform.universal.desc":"目前支持的通用平台有：语雀、Notion等，采用API授权。这些平台通常提供了现代化的REST API，可以方便的进行集成。","setting.platform.wordpress":"WordPress","setting.platform.wordpress.desc":"Wordpress 通过Xmlrpc API支持，采用 API 授权。WordPress是一个自由开源的博客软件和内容管理系统，具有数量众多的优质插件和主题。","setting.platform.github":"Github","setting.platform.github.desc":"目前支持Github发布的的平台有：Hexo、Hugo、Jekyll、Vitepress等，采用 API 授权。GitHub 是一个使用 Git 进行软件开发和版本控制的代码平台。","setting.platform.gitlab":"Gitlab","setting.platform.gitlab.desc":"Gitlab基本上与Github的使用方式类似，唯一的区别是Gitlab支持自己本地部署或者云服务器部署。","setting.platform.metaweblog":"Metaweblog","setting.platform.metaweblog.desc":"目前支持Metaweblog的平台有：博客园、Typecho等，采用 API 授权。MetaWeblog API 作为XML-RPC Web 服务实现，是目前公认的开放博客标准。","setting.platform.custom":"自定义 HTTP 协议","setting.platform.custom.desc":"目前支持自定义HTTP协议的平台有：知乎等，采用网页授权。自定义HTTP协议通过类似 WeChatSync 的方式实现。","setting.platform.right.tips0":"特别提示：","setting.platform.right.tips1":"1、在这里可以进行发布配置，直接点击 [设置图标] 即可进行配置。","setting.platform.right.tips2":"2、如需新增平台，直接点击「平台导入」或者「插件商店」进行添加。","setting.platform.right.tips3":"3、目前支持 网页授权 和 API 授权两种方式，API授权 复杂点但是相对稳定，网页授权简单但是可能会失效。网页授权模式实现思路类似 wechatsync 。","setting.platform.right.tips4":"4、如需兼容其他平台，请联系我：youweics@163.com 或者填写下面的表单。","setting.entry.title":"平台统一设置 - ","setting.entry.not.supported":"不支持的平台","setting.upgrade.syp.tip1":"准备开始迁移...","setting.upgrade.syp.tip2":"迁移成功.","setting.upgrade.syp.tip3":"已经是最新，无需迁移.","setting.upgrade.syp.tip4":"迁移失败，错误如下","setting.upgrade.syp.tip5":"迁移操作完成.","setting.upgrade.syp.doTip1":"检测配置文件是否为最新版本","setting.upgrade.syp.doTip2":"检测到旧配置，准备升级配置文件","setting.upgrade.syp.doTip3":"旧配置升级","setting.upgrade.syp.doTip4":"没有版本更新，跳过升级","main.publish.start":"开始同步","main.publish.remove":"批量删除","setting.blog.knowledge.space":"知识空间/知识库","main.data.empty":"暂无数据","knowledgeSpaceEnabled.Tips":"验证通过之后，将列出可用的 [[knowledge-space-title]] 列表，您可以根据需要修改默认 [[knowledge-space-title]] 并保存","post.bind.auto.tips":"此处ID为发布工具自动保存，仅作为修复数据使用，如果您不清楚原理，请勿修改","siyuan.config.setting":"思源设置","setting.blog.siyuan.apiurl":"思源API地址","setting.blog.siyuan.apiurl.tip":"思源笔记的API地址，包括端口，默认是：http://127.0.0.1:6806","setting.blog.siyuan.password":"思源Token","setting.blog.siyuan.password.tip":"思源笔记鉴权Token，请从【设置->关于】复制，如果是本地笔记留空即可","slogan.make.written.fun":"让创作回归乐趣","category.batch.not.supported":"注意：批量分发模式部分平台不支持公共分类，例如语雀、知乎等","yuque.edit.cate.no.change":"由于语雀平台的限制，暂时不支持编辑所属知识库。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的知识库发布","main.commonn.cate.title":"公共分类","main.cate.new":"新分类","pref.setting.aicode":"ChatGPT请求key","pref.setting.aicode.tip":"ChatGPT请求key或者第三方代理key，如果是代理key，请设置请求地址","pref.setting.ai.baseurl":"ChatGPT请求地址","pref.setting.ai.baseurl.tip":"ChatGPT请求地址，如果是ChatGPT官方，可留空","preference.setting.removeWidgetTag":"去除挂件HTML","pref.setting.ai.proxy.url":"ChatGPT代理地址","pref.setting.ai.proxy.url.tip":"可留空，注意：填写了代理会忽略ChatGPT请求地址","main.auto.fetch.title":"自动提取标题","main.auto.fetch.cate":"自动提取分类","category.ai.hand":"由于各平台分类体系不一致，分类需要手动进行校准，不会自动保存","category.ai.enabled":"检测到您已经配置AI，可请前往详细模式进行操作。小贴士：由于网络或者其他问题，如果第一次失败生成，多试几次或许就能出结果哟~😄","sys.config.ai":"AI 设置","config.ai.use.siyuan":"思源笔记内部，直接使用思源笔记配置，无需配置","setting.blog.yamlLinkEnabled":"YAML永久链接","distri.type.overide.warn":"注意：覆盖模式下会用当前数据覆盖所有选择的平台，请谨慎操作。","distri.type.merge.warn":"注意：为了保留平台数据，合并模式下，标题和摘要的修改无效，您可在在常规发布单独修改对应平台的标题和摘要，标签和分类会与所选择的平台数据合并。","preference.setting.keepTitle":"不更新原始标题","setting.blog.gitlab.url.tip":"Gitlab首页，例如：http://localhost:8002","setting.blog.type.gitlab.user.tip":"Gitlab的用户名","setting.blog.type.gitlab.token.tip":"Gitlab的token，请参考下面链接设置，并保证有api权限","setting.blog.gitlab.apiurl.tip":"Gitlab的API地址，一般与首页相同","setting.blog.gitlab.previewUrl.tip":"文章预览地址，一般默认即可","main.force.cancel":"强制删除","loading.cost":"操作耗时","preference.setting.showDocQuickMenu":"显示文档菜单","preference.setting.showQuickMenu":"显示极速发布","preference.setting.showSingleMenu":"显示常规发布","preference.setting.showBatchMenu":"显示批量分发","preference.setting.showAIMenu":"显示AI菜单","preference.setting.showExtendMenu":"显示扩展菜单","preference.setting.showArticleManageMenu":"显示文章管理菜单","message.publish.notShared":"文章尚未分享，无法在外部查看。请分享文章或者在PC 客户端内部通过插件菜单进行预览。","setting.telegraph.username.label":"作者","setting.telegraph.password.label":"Uuid","setting.telegraph.home.tip":"telegra.ph平台首页，通常固定是：https://telegra.ph/","setting.telegraph.username.tip":"作者，会显示在文章详情，可自行设置，默认为空","setting.telegraph.password.tip":"匿名模式无需填写，点击验证之后可自动获取，登录模式请从请从 TG 客户端授权之后跳转的浏览器里面找到 Cookie tph_uuid 填到这里","setting.telegraph.apiurl.tip":"telegra.ph的API地址，通常固定是：https://telegra.ph/","setting.telegraph.previewUrl.tip":"telegra.ph的文章预览规则，通常是：/[notebook]/[postid]","setting.telegraph.accessToken.tip":"匿名模式无需填写，登录模式请从请从 TG 客户端授权之后跳转的浏览器找到 Cookie tph_token 填到这里","setting.telegraph.saveHash.tip":"匿名模式无需填写，点击验证之后可自动获取，登录模式请从 TG 客户端授权之后跳转的浏览器里面找到 https://edit.telegra.ph/check 返回的 save_hash 填到这里","setting.telegraph.forceReAuth.tip":"授权信息生效之后可勾选此项，然后会重新授权","setting.telegraph.login.anonymous":"匿名发布","setting.telegraph.login.user":"登录发布","page.loading":"页面加载中...","setting.blog.middlewareUrl.new":"新代理(推荐)","setting.blog.corsAnywhereUrl.tip":"1.20.0+ 全新CORS全局代理，优先级高，设置之后会忽略上面旧的代理地址。设置之后可彻底解决浏览器跨域、科学上网问题","setting.blog.middlewareUrl.my.new.tip":"1.20.0+ 新版CORS代理，彻底解决「科学上网」、「CORS 跨域」两大问题，支持全局跨域请求（支持绕过 header、请求体支持 FormData）。受限于 CORS 策略，「Docker 版本」必须设置 CORS 代理，否则大部分场景将无法使用。技术细节可参考 MDN：https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS 以及 https://developer.mozilla.org/zh-CN/docs/Glossary/CORS。可私发邮件到 youweics@163.com 付费咨询🤝。","setting.blog.middlewareUrl.my.warn.tip":"⚠️特别提醒：请求限制为 「10万次/天」、「1000次/10分钟」，频次为「所有人共享」，因此资源十分珍贵。为了大家的利益，请勿恶意请求，否则，我们会关闭此共享代理。","platform.new.platform":"检测到还有 [count] 个内置平台 [platform] 尚未导入，您可以使用平台导入批量导入，或者去插件商店自行添加。","import.v081.warn":"考虑到 v0.8.1 已经是很早的版本了，此功能可能不再需要。如果您需要此功能，可反馈至 youweics@163.com ，我们会根据需求决定是否实现此功能。","publisher.picbed.service":"图床服务","publisher.picbed.none":"不使用","publisher.picbed.picgo":"PicGo 插件","publisher.picbed.picgo.not.install":"此功能需要「PicGo 图床」插件 1.9.0+ 支持，请先从集市安装","publisher.picbed.bundled":"当前平台","publisher.picbed.recom1":"强烈推荐","publisher.picbed.recom2":"推荐","publisher.post.status":"文章状态","publisher.post.status.pubish":"发布","publisher.post.status.draft":"草稿","publisher.post.status.private":"私密","publisher.post.status.future":"定时","publisher.post.password":"密码保护","publisher.post.password.tip":"请输入文章密码，留空则不设置","publisher.post.future":"定时发布"},ab={"lang.choose":"Language","lang.choose.placeholder":"Please select language","theme.mode.choose":"Mode","theme.mode.dark":"Dark mode","theme.mode.light":"Light mode","service.tab.manage":"Post manage","service.tab.publish.service":"Publish service","service.tab.publish.setting":"Publish setting","service.tab.platform.setting":"Platform setting","service.tab.post.bind":"Post bind","service.tab.service.switch":"Service switch","service.tab.change.local":"Change language","main.publish.editmode":"Edit mode","main.publish.editmode.simple":"Simple","main.publish.editmode.complex":"Complex","main.publish.editmode.source":"Source","main.publish.vuepress.tip":"Recommends use it with vuepress-theme-vdoing , and the subsequent bug will only update this theme","main.publish.github.error.tip":"Configure error or API is not available, please check. If you modify the configuration, please refresh the page","main.publish.github":"Send Github","main.publish.github.tip":"Checking the Markdown text of the article to the GitHub warehouse corresponding to Vuepress (need to perform related configuration first, unsatisfactory or configuration error will be ignored)","main.publish.github.choose.path":"Choose path","main.publish.github.published.path":"Published path","main.publish.github.choose.path.use.default":"Default path","main.publish.github.choose.path.use.default.tip":"Using the default directory, all articles are published in the configuration default directory, no need to select the directory every time it is published","main.publish.github.no.tip":"You have not opened github release, please copy the right text on your own","main.publish.github.choose.title":"File name","main.publish.github.choose.title.tip":"Vuepress-theme-VDoing support file name plus serial number to identify. If you don’t know this usage, please do not modify the file name","main.publish.see.preview":"Click here see new post","main.publish.see.md.preview":"Click here see new md file","main.publish.see.real.preview":"Click here see new post","main.publish.to.wordpress":"Send to WP","main.title":"Post title","main.slug":"Post slug","main.auto.fetch.slug":"Auto fetch slug","main.use.google.translate":"Use Google translate API","main.use.hash":"Use hash","main.use.hash.tip":"Do not use HASH to show more meaningful URLs, but it may cause the only path of the article to repeat (the consequence is that Vuepress will build a failure unless manual solution to the other problem), please know","main.force.refresh":"Force refresh","main.force.refresh.tip":"In order to prevent the wrongdoing aliases by mistake, the attribute will not be updated by default. If you need to update, please check for compulsory refresh.","main.desc":"Post desc","main.auto.fetch.desc":"Auto fetch desc","main.create.time":"Pub time","main.update.time":"Update time","main.create.time.placeholder":"Please select time","main.update.time.placeholder":"Please select time","main.tag":"Post tag","main.tag.new":"New tag","main.tag.close":"Close tag","main.tag.select":"Select tag","main.auto.fetch.tag":"Auto fetch tag","main.tag.empty":"No tags","main.tag.auto.switch":"Tag switch","main.tag.auto.switch.no.tip":"Auto tag is closed","main.cat":"Category","main.cat.empty":"No Category","main.cat.select":"Please select category","main.yaml.formatter":"YAML Formatter","main.siyuan.to.yaml":"Siyuan attr to YAML","main.yaml.to.siyuan":"YAML to Siyuan attr","main.save.attr.to.siyuan":"Save attr to Siyuan","main.copy":"Copy","main.publish":"Publish","main.publish.loading":"Publishing...","main.loading":"Loading...","main.update":"Update","main.cancel":"Cancel","main.publish.oneclick.attr":"Click to attr","main.publish.oneclick.attr.finish":"Make attr finished","main.publish.status.unpublish":"Unpublish","main.publish.status.published":"Published","main.publish.to.vuepress":"Send to Vuepress","main.publish.to.hugo":"Send to Hugo","main.publish.to.hexo":"Send to Hexo","main.publish.to.jekyll":"Send to Jekyll","main.publish.to.jvue":"Send to JVue","main.publish.to.conf":"Send to Confluence","main.publish.to.cnblogs":"Send to Cnblogs","main.publish.to.liandi":"Send to Liandi","main.publish.to.yuque":"Send to Yuque","main.publish.to.kms":"Send to KMS","main.opt.success":"Success","main.opt.failure":"Error","main.copy.success":"Copy Success","main.copy.failure":"Copy Error","main.opt.quick":"Quick","main.opt.status.publish":"Post published success","main.opt.status.cancel":"Post publishing has been canceled","main.opt.loading":"Loading...","main.opt.warning":"Warning","main.opt.ok":"Confirm","main.opt.cancel":"Cancel","main.opt.select":"Select","main.opt.warning.tip":"The operation will delete the data, whether to continue?","main.opt.tip":"Tips","setting.noneed":"No need setting","setting.blog.setting":" Setting","setting.blog.index":"System setting","setting.blog.type":"Blog type","setting.blog.type.placeholder":"Please select type","setting.blog.type.wordpress.value":"Wordpress","setting.blog.type.wordpress.label":"Wordpress","setting.blog.type.metaweblog.value":"MetaweblogApi","setting.blog.type.metaweblog.label":"Metaweblog API","setting.blog.type.github.value":"Github","setting.blog.type.github.label":"Github","setting.blog.type.github.user":"Github user","setting.blog.type.github.user.tip":"Github user, eg:terwer","setting.blog.type.github.repo":"Github repo","setting.blog.type.github.repo.tip":"Github repo, eg:hexo-blog","setting.blog.type.github.token":"Github token","setting.blog.type.github.token.tip":"Github token, eg:ghp_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX","setting.blog.type.github.token.gen":"Generate Github Personal Token","setting.blog.type.github.default.path":"Doc path","setting.blog.type.github.default.path.tip":"Doc path, eg:docs/_posts","setting.blog.type.github.images.path":"Image store path","setting.blog.type.github.images.path.tip":"Image store path, eg:images","setting.blog.type.github.msg":"Commit msg","setting.blog.type.github.msg.tip":"Commit msg, eg:auto published by sy-post-publisher","setting.blog.type.github.author":"Author","setting.blog.type.github.author.tip":"Author, eg:terwer","setting.blog.type.github.email":"Email","setting.blog.type.github.email.tip":"Email","setting.blog.type.github.site":"Author's Page","setting.blog.type.github.site.tip":"Author's page, defaults to: [GitHub URL]/[Username] if left empty. Please do not change the key, translate the value to English.","setting.blog.url":"Blog addr","setting.blog.github.url.tip":"Github homepage address","setting.blog.github.apiurl.tip":"Github's REST API address, typically: https://api.github.com","setting.blog.previewPostUrl":"Preview rule","setting.blog.previewPostUrl.tip":"Preview Rules (place occupied: [yyyy] [mm] [dd] [postid]), for example:/post/[postid].html or /[cats]/[yyyy]/[mm]/[dd]/[[dd]/[postid].html","setting.blog.previewUrl":"MD preview rule","setting.blog.previewUrl.tip":"MD file preview rules (place occupied: [user] [repo] [Branch] [docpath]), for example:/[user]/[repo]/blob/[branch]/[docpath]","setting.blog.mdFilenameRule":"File rule","setting.blog.mdFilenameRule.tip":"Markdown File Name Rules (Plasma: [yyyy] [MM] [dd] [slug] [filename]), for example: [filename].md or [slug].md or [yyyy]-[MM]-[dd]-[slug].md","setting.blog.username":"Username","setting.blog.password":"Password","setting.blog.apiurl":"API Url","setting.blog.pageType":"Page Type","setting.blog.validate":"Validate","setting.blog.save":"Save","setting.blog.vali":"Validate","setting.blog.vali.tip":"Please verify the configuration to ensure the availability of the API, and it will not be used without verification.","setting.blog.vali.tip.metaweblog":"Please verify the configuration to ensure the availability of the API, and it will not be used without verification.","setting.blog.vali.ing":"Validating...","setting.blog.vali.ok":"Available","setting.blog.vali.ok.metaweblog":"The configuration has been saved and verified","setting.blog.vali.error":"Validate error","setting.blog.platform.support.github":"Current github supported platform:","setting.blog.platform.support.metaweblog":"Current metaweblog supported platform:","setting.blog.cancel":"Cancel","setting.vuepress":"Vuepress","setting.hugo":"Hugo","setting.hexo":"Hexo","setting.jekyll":"Jekyll","setting.jvue":"JVue","setting.conf":"Confluence","setting.conf.tip":"Published to Confluence needs to cooperate with my other adapter project (strong recommendation), please refer to:https://github.com/terwer/node-metaweblog-api-adaptor","setting.cnblogs":"Cnblogs","setting.wordpress":"Wordpress","setting.liandi":"Liandi","setting.yuque":"Yuque","setting.kms":"KMS","setting.other1":"Other1","service.switch.vuepress":"Vuepress","service.switch.hugo":"Hugo","service.switch.hexo":"Hexo","service.switch.jekyll":"Jekyll","service.switch.jvue":"JVue","service.switch.conf":"Confluence","service.switch.cnblogs":"Cnblogs","service.switch.wordpress":"Wordpress","service.switch.yuque":"Yuque","service.switch.liandi":"Liandi","service.switch.wechat":"WeChat","service.switch.wemp":"WeMedia","service.switch.zhihu":"Zhihu","service.switch.kms":"LandrayKms","service.switch.must.select.one":"You must add at least one platform","post.bind.vuepress.slug":"Vuepress slug","post.bind.hugo.slug":"Hugo slug","post.bind.hexo.slug":"Hexo slug","post.bind.jekyll.slug":"Jekyll slug","post.bind.cnblogs.postid":"Cnblogs ID","post.bind.jvue.postid":"JVue ID","post.bind.conf.postid":"Conf ID","post.bind.wordpress.postid":"WP ID","post.bind.liandi.postid":"Liandi ID","post.bind.yuque.postid":"Yuque ID","post.bind.kms.postid":"KMS ID","post.bind.conf.save":"Save","post.bind.conf.v081":"Examine the v0.8.1 metadata and import it","post.bind.auto.error":"No ID detected, kindly input the document root ID manually, before proceeding with the repair.","post.bind.auto.empty":"This document has never been published, hence no repair is necessary","post.bind.conf.cancel":"Cancel","form.validate.name.required":"Please input name","form.validate.name.length":"Length should be 0 to 1","form.validate.github.auto.delete":"Auto delete","dynamic.platform.new":"New platform","dynamic.platform.tip":"If the built -in release service cannot be satisfied or multiple instances need to be added, you can add supporting platforms here. Currently supporting Metaweblog API and WordPress API","dynamic.platform.type":"Platform type","dynamic.platform.subtype":"Platform subtype","dynamic.platform.type.metaweblog":"metaweblog API","dynamic.platform.type.wordpress":"Wordpress","dynamic.platform.type.common":"Common","dynamic.platform.type.custom":"Custom","dynamic.platform.key":"Platform key","dynamic.platform.key.tip":"The unique logo of the platform, cannot be repeated, for example: myblog","dynamic.platform.type.github":"Github","dynamic.platform.name":"Platform name","dynamic.platform.name.tip":"Platform name, for example: my blog","dynamic.platform.opt.add":"Submit","dynamic.platform.opt.noselect":"Please select platform type","dynamic.platform.opt.key.exist":"Platform key exists","dynamic.platform.opt.del.select":"Delete","dynamic.platform.opt.del.confirm":"Deleting this platform will completely remove the relevant configuration information of this platform. Do you continue?","dynamic.platform.opt.item.select":"Item no select","dynamic.platform.opt.item.select.tip":"The current selection is:","dynamic.platform.opt.item.no.select.tip":"Please select the line to be deleted","setting.common.home":"Home","setting.common.tip":"The platform homepage is used to preview articles, for example: https://terwork.space","setting.common.apiurl":"API","setting.common.token":"Token","setting.common.token.gen":"Token addr","setting.common.username":"Username","setting.common.username.gen":"Username setting","setting.common.password":"Password","setting.blog.platform.support.common":"Current platform：","platform.must.select.one":"You must enable at least one platform","blog.list.toptip":"Reminder: Click the table line to enter the article details page. The details page has the release button! (〃'▽'〃)","config.error.msg":"Network or config error, no data fetched","config.platform.none":"No available platform, please go to switch","post.delete.by.platform":"The article has been deleted by the platform by itself, please click to cancel the compulsory lifting connection","blog.top-data-tip":"Reminder: Please ensure that the Siyuan notes are started and opened the servo. The default servo address: http://127.0.0.0.1: 6806.0.0. Note: The modification will cover the value of the startup setting.","blog.top-data-tip.siyuan":"It is currently in the pendant mode. Starting from version 0.1.0, there is no need to reference the pendant on all pages. You only need to reference a pendant on the parent page. The specific rules are as follows: 1. If there are no subsidiaries, it will be compatible with the previous method of version 0.0.3 to display the release page of the current document. 2. If a subsidiary document is detected, all the subsidiaries will be displayed in a list and paging. You can choose a sub -document separately for release operations.","blog.newwin.open":"Open in a new window","blog.change.siyuan.api":"Modify Siyuan API address","setting.blog.siyuan.current.apiurl":"Current apiUrl=>","setting.blog.middlewareUrl.tip":"In certain scenarios, a necessity might arise (as seen in self-hosting environments, Nginx server setups, Vite development environments, etc.), while other situations could warrant overlooking this requirement.","setting.blog.middlewareUrl.my.tip":"In most cases, it is unnecessary, yet in specific contexts within 'browser environments,' 'docker environments,' 'Nginx server' setups, and the like, it might become essential. If a proxy deployment is absent, one can utilize my shared address: https://api.terwer.space/api/middleware. For performance considerations, I recommend self-deployment; kindly employ https://github.com/terwer/node-metaweblog-api-adaptor for deployment.","setting.blog.middlewareUrl.my.fee.tip":"🤝Due to substantial costs associated with shared proxies or potential unforeseeable circumstances that may lead to its discontinuation, for the sake of service continuity, deploying one's instance is advised. Alternatively, consider inviting the author for a coffee to support ongoing sharing endeavors🌹.","setting.blog.middlewareUrl.my.coffee":"Sponsor a coffee☕️","setting.conf.export":"Export config","setting.conf.import":"Import config","setting.conf.transport":"Transport","setting.conf.clear":"Clear config","page.no.id":"pageId fetch error","main.read.mode":"Readonly","main.edit.mode":"Editable","main.read.mode.tip1":"Tips: The multi-platform distribution mode will display the built-in public YAML, and the general release can display the platform's custom YAML.","main.read.mode.tip2":"To identify the uniqueness of the article, slug modifications are ignored and other attributes can be synchronized.","main.read.mode.tip3":"！！！ This feature is advanced, if you are unclear about the YAML syntax and purpose, do not modify it!!","main.opt.onclick.confirm.tip":"This operation will re -generate all attributes other than alias. If you just want to modify individual attributes, please click the individual function button to operate in the detailed mode. Do you continue?","main.cat.list.error":"Category list get error","main.yaml.no.save":"Have you edited YAML, do you synchronize to attributes, and cancel the loss of YAML modification?","setting.github.baseUrl":"Git repo index","setting.github.baseUrl.tip":"Git platform address is used for md file preview, the default is: https://github.com","preference.setting.fixTitle":"Fix title","preference.setting.removeH1":"Remove h1","preference.setting.removeH1.tip":"Delete H1 may accidentally delete the beginning of the beginning of Markdown. If you need to open it, please use more than 2 ones.","preference.setting.newWin":"New win","siyuan.browser.show.close.btn":"Show close btn","siyuan.browser.menu.quick.btn":"Quick publish","siyuan.browser.menu.publish.btn":"Publish","siyuan.browser.menu.preview.btn":"Preview","siyuan.browser.menu.manage.btn":"Manage","siyuan.browser.menu.anki.btn":"Anki","siyuan.browser.menu.picture.btn":"PicGo","siyuan.browser.menu.setting.btn":"Setting","anki.siyuan.deck":"Deck","anki.siyuan.deck.new":"New deck","anki.siyuan.tag":"Tag","anki.siyuan.tag.new":"New tag","picgo.chrome.tip":"If you are using a browser plug -in, you need to download the configuration Picgo client from here: https://github.com/Molunerfinn/PicGo/releases","picgo.siyuan.tip":"If you are using Siyuan notes pendants, you need to configure your own integration of PICGO. The pendant version of the PICGO configuration file is:`[Siyuan Workspace]/data/widgets/sy-post-publisher/lib/picgo/picgo.cfg.json`，Please refer to the official picgo document for configuration：https://picgo.github.io/PicGo-Core-Doc/zh/guide/config.html#%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90","post.detail.button.copy.id":"Copy post ID","post.detail.button.share.link":"Copy share link","post.detail.button.browser.open":"Open with default browser","post.detail.button.pic.manage":"Picture manage","post.detail.button.anki.mark":"Anki mark","post.detail.index.send.to.publish":"Send to other platform","post.detail.index.export.to.pdf":"Export to PDF","picgo.upload.status":"Upload status","picgo.upload.select.pic":"Select picture","picgo.upload.clipboard":"Clipboard picture","picgo.upload.onclick":"One click upload","picgo.download.onclick":"One click download","picgo.download.local.to.bed":"Upload picture to bed","picgo.download.bed.to.local":"Upload picture from bed","picgo.pic.preview":"Picture preview","picgo.pic.setting":"Picture setting","picgo.pic.setting.no.tip":"You are currently using the browser plug -in and cannot inherit PicGo. You can only call the local Picgo client on the local Picgo client through HTTP","github.use.permalink":"Use permalink","github.use.permalink.no.warn":"You have closed the permanent link, and Formatter will not generate a mark, which may be useful in some scenarios","github.menu.title":"Menu title","github.menu.title.placeholder":"The menu column title (HUGO platform is dedicated, but the empty is not displayed in the menu)","github.weight":"Weight","github.weight.placeholder":"Weight (decide to display the order, the smaller the display, the more upward)","github.use.date":"Show date","github.use.date.no.warn":"You have closed the date show that it will not generate the date field in Formatter","github.post.picgo.use":"Use picbed","github.post.picgo.use.tip":"To enable this option, the local picture will be uploaded to the custom diagram bed (the remote picture is not uploaded), please make sure that the PICGO diagram bed configuration is correct","github.post.picgo.start.upload":"The picture bed has been opened, and the picture bed is about to upload the picture bed to the bed","github.post.picgo.picbed.error":"The picture uploaded to the picture bed failed, it may be an error in the configuration of the graph, please check the picture bed configuration","setting.yuque.home.tip":"The homepage of the language bird platform is usually fixed: https://www.yuque.com/","setting.yuque.username.tip":"The user name of the spark platform, note that the user name is fixed in [account settings], not the user nickname (*^▽^*)","setting.yuque.password.tip":"For the token of the spark platform, please follow the link to get it. You only need to grant the document to read and modify the two permissions.","setting.yuque.apiurl.tip":"The API address of the language bird platform is usually fixed: https://www.yuque.com/api/v2","setting.yuque.previewUrl.tip":"Article preview rules for the Yuque platform, Usually: /[notebook]/[postid]","setting.notion.home.tip":"The homepage of the Notion platform is usually fixed: https://www.notion.so/","setting.notion.password.tip":"For the token of the Notion platform, please click the link to get it, you need to check the three permissions of [Read content], [Update content], and [Insert content].","setting.notion.apiurl.tip":"The API address of the Notion platform is usually fixed: https://api.notion.com/v1","setting.notion.previewUrl.tip":"Article preview rules for the Notion platform, usually:/[postid]","setting.liandi.home.tip":"The homepage of the chain drop platform is usually fixed: https://ld246.com/","setting.liandi.username.tip":"The user name of the chain drop platform, note that after clicking [Personal Homepage], the user name displayed behind the MEMBER on the URL is not a user nickname (*^▽^*)","setting.liandi.password.tip":"Token on the chain drop platform, please click on the link to get","setting.liandi.apiurl.tip":"The API address of the chain drop platform is usually fixed: https://ld246.com/api/v2","setting.kms.home.tip":"KMS platform homepage, for example: http:// localhost: 9564/kms16_release/kms/multidoc","setting.kms.username.tip":"KMS platform REST account user name, please create according to the link instruction","setting.kms.password.tip":"KMS platform REST account password, please create according to the link instruction","setting.kms.apiurl.tip":"The API address of the KMS platform, for example: http:// localhost: 9564/kms16_release/API/KMS-Multidoc/KMSMultidOWRESTSERVICE","siyuan.local.share.tip":"Reminder: If you find that the sharing link or the browser can be displayed or the network connection is rejected, please check according to the following operation. 1: Siyuan Note-> Settings-> About-> Open the network servo; 2: After the browser is opened, click the bottom Siyuan address at the bottom to modify the corresponding address to the local area network IP address.","setting.cnblogs.home.tip":"The homepage of your blog park is usually: https://www.cnblogs.com/ <your username>","setting.cnblogs.username.tip":"Your blog garden MetaWeblog login name, you can go to your blog garden background-> Settings, note: login name, not a user nickname (*^▽^*)","setting.cnblogs.password.tip":"Your blog garden Metaweblog access token, you can go to your blog garden backstage-> Settings","setting.cnblogs.apiUrl.tip":"Your blog garden Metaweblog access address, you can go to your blog park background-> settings, usually: https://rpc.cnblogs.com/metaweblog/ <Your username>","setting.cnblogs.previewUrl.tip":"Preview rules for your blog garden article","setting.wordpress.home.tip":"Wordpress homepage","setting.wordpress.username.tip":"WordPress login name, note: it is login name, not a user nickname (*^▽^*)","setting.wordpress.password.tip":"Wordpress login password","setting.wordpress.apiUrl.tip":"WordPress's XMLRPC remote release address, usually: https:// <WordPress blog address> /xmlrpc.php","setting.wordpress.previewUrl.tip":"The preview rules of the WordPress platform are usually :? P = [Postid]","setting.wordpressdotcom.home.tip":"Wordpress homepage","setting.wordpressdotcom.username.tip":"WordPress login name, note: it is login name, not a user nickname (*^▽^*)","setting.wordpressdotcom.password.tip":"Wordpress login password","setting.wordpressdotcom.apiUrl.tip":"WordPress's XMLRPC remote release address, usually: https:// <WordPress login name>.wordpress.com/xmlrpc.php","setting.wordpressdotcom.previewUrl.tip":"The preview rules of the WordPress platform are usually :? P = [Postid]","setting.oschina.home.tip":"Homepage of open source China, usually: https://my.oschina.net/ <Your username>","setting.oschina.username.tip":"Open source China login name, you can enter the login mailbox","setting.oschina.password.tip":"Open source China login password","setting.oschina.apiUrl.tip":"Open source China XMLRPC remote publishing address, usually fixed: https://www.oschina.net/ACTION/xmlrpc","setting.oschina.previewUrl.tip":"The preview rules of the open source China platform are usually:/blog/[postid]","setting.typecho.home.tip":"Homepage of the Typecho platform","setting.typecho.username.tip":"Typecho platform login name","setting.typecho.password.tip":"Typecho platform password","setting.typecho.apiUrl.tip":"The XMLRPC remote publishing address of the Typecho platform is usually fixed: https: // <platform address> /index.php/xmlrpc","setting.typecho.previewUrl.tip":"The preview rules of the Typecho platform are usually: /index.php/archives/ [Postid]","setting.metaweblog.home.tip":"The homepage of the Metaweblog platform","setting.metaweblog.username.tip":"Metaweblog platform login","setting.metaweblog.password.tip":"Metaweblog platform password","setting.metaweblog.apiUrl.tip":"The xmlrpc remote publishing address for the Metaweblog platform","setting.metaweblog.previewUrl.tip":"Article preview rules for the Metaweblog platform, [postid] can be composed article ID placeholder","setting.jvue.home.tip":"Homepage of the Jvue platform","setting.jvue.username.tip":"Jvue platform login name","setting.jvue.password.tip":"Jvue platform password","setting.jvue.apiUrl.tip":"The XMLRPC remote release address of the Jvue platform is usually fixed: https: // <platform address>/xmlrpc","setting.jvue.previewUrl.tip":"The preview rules of the Jvue platform are usually:/post/[postid] .html","setting.conf.home.tip":"Confluence Cloud, homepage, usually: https: // <your user name> .atlassian.net/wiki/spaces/<Space name>","setting.conf.username.tip":"CONFLUENCE login name, you can go to your Atlassian account to get","setting.conf.password.tip":"Confluence access token, you can go to your Atlassian account to get","setting.conf.apiUrl.tip":"You can go to https://developper.atlassian.com/Cloud/confluence/rest/v1/1/1/","setting.conf.previewUrl.tip":"CONFLUENCE platform articles preview rules, usually:/pages/[postid]","setting.zhihu.home.tip":"The address of the front page of the column, usually fixed","setting.zhihu.username.tip":"Zhihu username, must be set correctly, otherwise you cannot get the column","setting.zhihu.password.tip":"Know cookies, please do not modify them","setting.zhihu.apiUrl.tip":"Usually fixed, do not modify","setting.zhihu.previewUrl.tip":"Zhihu platform article preview rules, usually: //[postid]","setting.csdn.home.tip":"CSDN blog homepage address, usually fixed","setting.csdn.password.tip":"CSDN cookies, do not modify","setting.csdn.apiUrl.tip":"Usually fixed, do not modify","setting.csdn.previewUrl.tip":"CSDN Platform Article Preview Rules","setting.wechat.home.tip":"The address of the home page of the WeChat public account is usually fixed","setting.wechat.password.tip":"Please do not modify the cookies of WeChat official account","setting.wechat.apiUrl.tip":"Usually fixed, do not modify","setting.wechat.previewUrl.tip":"WeChat official account platform article preview rules","setting.jianshu.home.tip":"Jianshu homepage address, usually fixed","setting.jianshu.password.tip":"Jianshu's Cookie, do not modify","setting.jianshu.apiUrl.tip":"Usually fixed, do not modify","setting.jianshu.previewUrl.tip":"Jianshu platform article preview rules","setting.juejin.home.tip":"Juejin homepage address, usually fixed","setting.juejin.password.tip":"Juejin's Cookie, do not modify","setting.juejin.apiUrl.tip":"Usually fixed, do not modify","setting.juejin.previewUrl.tip":"Juejin platform article preview rules","setting.halo.home.tip":"Halo homepage address, should include the domain and port, for example: http://localhost:8090","setting.halo.username.tip":"Halo blog login name","setting.halo.password.tip":"Halo blog login password","setting.halo.apiUrl.tip":"Halo blog API address, typically the same as the Halo homepage","setting.halo.previewUrl.tip":"Halo blog article preview rule, default /archives/{slug}, with placeholders {slug} {name} {year} {month} {day}, can be set in [halo-home-url]/console/settings?tab=routeRules","setting.flowus.home.tip":"Flowus homepage address, usually fixed","setting.flowus.password.tip":"Flowus cookie, do not modify","setting.flowus.apiUrl.tip":"Usually fixed, do not modify","setting.flowus.previewUrl.tip":"Flowus platform article preview rules","setting.picgo.refer.to":"For details, please refer to:","setting.picgo.refer.to.online.doc":"Picgo configuration online documentation","setting.picgo.picbed":"Picbed setting","setting.picgo.picgo":"PicGo setting","main.opt.edit":"Edit","main.opt.delete":"Delete","setting.picgo.picgo.open.config.file":"Open config file","setting.picgo.picgo.click.to.open":"Click open","setting.picgo.picgo.choose.showed.picbed":"Please select showed picbed","setting.picgo.picbed.selected.tip":"Selected","setting.picgo.picbed.unselected.tip":"Unselected","setting.picgo.picbed.set.default":"Set as default picbed","setting.picgo.picbed.current.selected.tip":"Current selected picbed is:","setting.picgo.picbed.current.tip":"Current picbed is:","setting.picgo.picbed.uploader.config.name":"Picbed config name","setting.picgo.picbed.uploader.config.name.placeholder":"Please input config name","setting.picgo.config.name":"Config name","setting.picgo.config.name.placeholder":"Please input config name","setting.picgo.index.tip":"Note: The image uploaded here will not be automatically inserted into the document. Please manually click the copy button to copy the link, and then Ctrl+V to paste it into the document. This picture list only shows the pictures contained in this document.","setting.picgo.index.copy.link":"Copy link","setting.picgo.setting.timestamp.rename":"Timestamp rename","setting.picgo.setting.close":"Close","setting.picgo.setting.open":"Open","setting.picgo.setting.log.file":"Log file","setting.picgo.plugin":"Plugin setting","setting.picgo.plugin.list":"Plugin list","setting.picgo.plugin.import.local":"Import local plugin","setting.picgo.plugin.install":"Install","setting.picgo.plugin.installing":"Installing","setting.picgo.plugin.installed":"Installed","setting.picgo.plugin.doing.something":"Loading","setting.picgo.plugin.search.placeholder":"Search the picgo plug -in on NPM, or click the button above to view the excellent plug -in list","setting.picgo.plugin.gui.not.implemented":"This plug -in does not optimize the visual interface, is it continued to be installed?","setting.picgo.setting.node.path":"Node install path","setting.picgo.setting.node.path.tip":"Please enter Node to install the full path, for example: /opt/node-v16.14.0-darwin-x64/bin, node version> = 16","setting.picgo.setting.node.registry":"NPM registry","setting.picgo.setting.node.registry.tip":"Mainland recommend：https://registry.npmmirror.com","setting.picgo.setting.node.proxy":"NPM proxy","setting.picgo.setting.node.proxy.tip":"Generally, you can leave empty. If you have special needs, you can set a custom agent","setting.picgo.setting.config.tip":"Note: The attributes above the horizontal line will change the behavior of uploading pictures, and the configuration can be stored automatically. The attribute below the horizontal line is only used when installing the plug -in, and you need to click the [Confirm] button to save.","setting.picgo.plugin.install.success":"The plug -in has been successfully installed, please clear the search keyword refresh list. Click the plug -in corresponding [Settings] icon to view the plug -in details and customize the plug -in","syp.about":"About me","setting.picgo.plugin.uninstall":"Uninstall plugin","setting.picgo.plugin.uninstall.success":"Plugin is uninstalled successfully","setting.picgo.plugin.enable":"Enable plugin","setting.picgo.plugin.disable":"Disable plugin","setting.picgo.plugin.update":"Update plugin","setting.picgo.plugin.config.setting":"Plugin setting","setting.picgo.plugin.work":"Work","setting.picgo.plugin.nowork":"Nowork","setting.picgo.plugin.nouse":"Nouse","setting.picgo.plugin.update.success":"Update success","setting.conf.import.syp":"Import pendant configuration","setting.conf.import.picgo":"Import picgo configuration","setting.conf.export.syp":"Export pendant configuration","setting.conf.export.picgo":"Export picgo configuration","setting.conf.import.syp.tip":"Please select effective historical backup JSON files for import. Note: The pendant configuration will be replaced.","setting.conf.import.picgo.tip":"Please select effective historical backup JSON files for import. Note: PICGO configuration will be replaced directly. For the compatibility of configuration, please uninstall all plug -in and perform the picgo configuration export operation. Uninstall the PICGO plugin will not delete the plug -in configuration, only the plug -in file and the plug -in registration record will be deleted. Please rest assured.","setting.conf.export.syp.tip":"The corresponding JSON configuration file will be exported, and configuration backups are strongly recommended. In principle, support is compatible. If there is any compatibility problem, it will be specifically explained.","setting.conf.export.picgo.tip":"The corresponding JSON configuration file will be exported, and configuration backups are strongly recommended. In principle, support is compatible. If there is any compatibility problem, it will be specifically explained.","setting.conf.clear.syp":"Clear pendant configuration","setting.conf.clear.picgo":"Clear picgo configuration","setting.conf.clear.tip":"Clear configuration cannot be restored, please do it carefully. It is strongly recommended to backup configuration first.","setting.conf.clear.picgo.tip":"Clear configuration cannot be restored, please do it carefully. It is strongly recommended to backup configuration first. This operation will delete PicGo -related configuration folders, including configuration, plug -in, cache, etc. It is used only when picgo is completely unavailable, otherwise the consequences of the loss of configuration will be at your own risk!","setting.main.background":"Widget background","setting.main.background.tip":"Support hexadecimal and RGB, for example: #000000, no settings or staying empty unchanged","setting.platform.gitlab":"Gitlab","setting.platform.gitlab.desc":"Gitlab is basically similar to Github, except that Gitlab supports its own on-premises or cloud server deployment","setting.picgo.manage":"Picture manage","setting.platform.import":"Platform import","setting.platform.store":"Plugin store","setting.platform.add":"Add platform","setting.platform.add.this":"Add this platform","setting.platform.universal":"Universal platform","setting.platform.universal.desc":"Currently supported general platforms include Zhihu, Yuque, CSDN, etc. Click the icon to quickly add, or click the button below to customize and add","setting.platform.wordpress":"WordPress","setting.platform.wordpress.desc":"WordPress is a free and open source blog software and Content management system based on PHP and MySQL. WordPress has a plugin architecture and template system. As of April 2018, over 30.6% of the top 10 million websites used WordPress. WordPress is the most popular website Content management system. Approximately 40% of global websites (7500 million) are built using WordPress. WordPress is currently the most popular blog system on the Internet. WordPress stands out in the most famous stage of online publishing. Today, it is used on over 70 million sites.","setting.platform.github":"Github","setting.platform.github.desc":"At present, the platforms that support Github release are: Hexo, Hugo, Jekyll, Vitepress, etc., using API authorization. GitHub is a platform and cloud-based service that uses Git for software development and version control, allowing developers to store and manage their code.","setting.platform.metaweblog":"Metaweblog","setting.platform.metaweblog.desc":"At present, the platforms that support Metaweblog are: Blog Park, Typecho, etc., using API authorization. The MetaWeblog API is an application programming interface created by software developer Dave Winer that allows writing, editing, and deletion using Web services. The API is implemented as an XML-RPC Web service with three methods whose names describe its functionality: metaweblog.newPost(), metaweblog.getPost(), and metaweblog.editPost(). These methods take parameters that specify the username and password of the blogger and information related to a single blog entry.","setting.platform.custom":"Customization","setting.platform.custom.desc":"Customize the HTTP protocol, stay tuned","setting.platform.right.tips0":"Special Notes:","setting.platform.right.tips1":"1. You can publish the configuration here, and you can directly click the menu or the following icons to configure it.","setting.platform.right.tips2":"2. If you need to add a new platform, click the left button directly.","setting.platform.right.tips3":"3. At present, we support webpage authorization and API authorization. The complex points of API authorization are relatively stable. The webpage authorization is simple but may fail. Surprise: Webpage authorization mode 100 compatible","setting.platform.right.tips4":"4. If you need to be compatible with other platforms, please contact me","setting.entry.title":"Platform Unified Settings - ","setting.entry.not.supported":"Unsupported platforms","setting.upgrade.syp.tip1":"Ready to start migration ...","setting.upgrade.syp.tip2":"Migration successfully.","setting.upgrade.syp.tip3":"It is already the latest, no need to migrate.","setting.upgrade.syp.tip4":"Migration failed, the error is as follows","setting.upgrade.syp.tip5":"The migration operation is completed.","setting.upgrade.syp.doTip1":"Detect whether the configuration file is the latest version","setting.upgrade.syp.doTip2":"Detected old configuration, preparation to upgrade the configuration file","setting.upgrade.syp.doTip3":"Old configuration upgraded","setting.upgrade.syp.doTip4":"No update for version, skip upgrade","main.publish.start":"Start syncing","main.publish.remove":"Remove","setting.blog.knowledge.space":"Knowledge space/Knowledge base","main.data.empty":"No data","knowledgeSpaceEnabled.Tips":"After validation, a list of available knowledge spaces is listed, and you can modify the default knowledge spaces as needed and save them","post.bind.auto.tips":"The ID here is automatically saved by the publishing tool, if you are not clear about the principle, please do not modify it","siyuan.config.setting":"Source settings","setting.blog.siyuan.apiurl":"Siyuan API","setting.blog.siyuan.apiurl.tip":"The API address of Siyuan Note, including ports, The default address of Siyuan API is: http://127.0.0.1;6806","setting.blog.siyuan.password":"Siyuan Token","setting.blog.siyuan.password.tip":"Siyuan Token, which is empty by default","slogan.make.written.fun":"Let creation return to fun","category.batch.not.supported":"Note: Some platforms in the bulk distribution mode do not support public classification, such as Yuque and Zhihu","yuque.edit.cate.no.change":"Due to the limitations of the Yuque platform, editing the knowledge base is not supported at the moment. If you want to move a document, click Undelete and then select the new knowledge base publication again","main.commonn.cate.title":"Public category","main.cate.new":"New category","pref.setting.aicode":"ChatGPT request key","pref.setting.aicode.tip":"ChatGPT request key or third-party proxy key, if it is a proxy key, please set the request address","pref.setting.ai.baseurl":"ChatGPT request address","pref.setting.ai.baseurl.tip":"The ChatGPT request address, if it is official ChatGPT, can be left blank","preference.setting.removeWidgetTag":"Remove the widget HTML","pref.setting.ai.proxy.url":"ChatGPT proxy address","pref.setting.ai.proxy.url.tip":"Can be left blank, note: Filling in the proxy will ignore the ChatGPT request address","main.auto.fetch.title":"Auto fetch title","main.auto.fetch.cate":"Auto fetch category","category.ai.hand":"Due to inconsistent classification systems across platforms, classifications need to be calibrated manually and are not automatically saved","category.ai.enabled":"AI is available, please go to the detailed mode to operate","sys.config.ai":"AI configuration","config.ai.use.siyuan":"Inside Siyuan notes, you can directly use Siyuan notes to configure, no configuration is required","setting.blog.yamlLinkEnabled":"YAML permalink","distri.type.overide.warn":"Note: Please use caution when overwriting the selected platform with the current data.","distri.type.merge.warn":"Note: In merge mode, the title and abstract changes are not valid, and the labels and categories are merged with the selected platform data.","preference.setting.keepTitle":"Do not update the original title","setting.blog.gitlab.url.tip":"GitLab homepage, e.g., http://localhost:8002","setting.blog.type.gitlab.user.tip":"Username for GitLab","setting.blog.type.gitlab.token.tip":"Token for GitLab, please refer to the link below for setup and ensure API permissions are granted","setting.blog.gitlab.apiurl.tip":"GitLab API address, usually the same as the homepage","setting.blog.gitlab.previewUrl.tip":"Article preview address, usually the default","main.force.cancel":"Force delete","loading.cost":"Loading cost","preference.setting.showDocQuickMenu":"Show doc menu","preference.setting.showQuickMenu":"Show quick publish","preference.setting.showSingleMenu":"Show normal publish","preference.setting.showBatchMenu":"Show batch publish","preference.setting.showAIMenu":"Show AI menu","preference.setting.showExtendMenu":"Show extend menu","preference.setting.showArticleManageMenu":"Show artile manage menu","message.publish.notShared":"The article has not been shared and therefore cannot be viewed externally. Kindly share the article or preview it within the PC client through the plugin menu.","setting.telegraph.username.label":"Author","setting.telegraph.password.label":"Uuid","setting.telegraph.home.tip":"The primary landing page of the telegra.ph platform typically remains constant at: https://telegra.ph/","setting.telegraph.username.tip":"The individual credited as the author, a detail showcased in the article's specifics, is customizable at will, with the default setting being empty.","setting.telegraph.password.tip":"The uuid pertinent to the current environment. Please note: 1. Anonymous mode automatically retrieves this detail, requiring no manual input; 2. Logging in as a user necessitates the entry of the Cookie's thp_uuid.","setting.telegraph.apiurl.tip":"The designated API endpoint for telegra.ph, routinely established as: https://telegra.ph/","setting.telegraph.previewUrl.tip":"The prescribed pattern for previewing telegra.ph articles commonly follows this structure: /[notebook]/[postid]","setting.telegraph.accessToken.tip":"This item is unnecessary in anonymous mode. For authenticated sessions, please procure the tph_token from the browser post authorization via the TG client. To ensure the sanctity of your privacy, exercise caution against sharing this token with any third party.","setting.telegraph.saveHash.tip":"No need to fill out; automatic retrieval after clicking validation.","setting.telegraph.forceReAuth.tip":"After the authorization information takes effect, uncheck this option, and then reauthorize. Note: Old articles may become uneditable as a result.","setting.telegraph.login.anonymous":"Anonymous","setting.telegraph.login.user":"User","page.loading":"Page is loading...","setting.blog.middlewareUrl.new":"Fresh Proxy (Recommended)","setting.blog.corsAnywhereUrl.tip":"CORS Global Proxy, once configured, helps alleviate browser common-origin issues.","setting.blog.middlewareUrl.my.new.tip":"Enhanced CORS proxy, enabling comprehensive common-origin requests. It is advisable to deploy independently. For deployment guidance, kindly refer to https://github.com/Zibri/cloudflare-cors-anywhere.","reminder.blog.middlewareUrl.my.warning":"A special note: Request limits are set at '100,000 times/day' and '1,000 times/10 minutes'. For the benefit of all, kindly refrain from malicious requests; otherwise, we reserve the right to terminate this proxy service.","platform.new.platform":"It has been observed that there are still [count] internal platforms [platform] awaiting importation. You may utilize the platform importation tool for a bulk import, or alternatively, manually add them from the plugin store.","import.v081.warn":"Given that v0.8.1 is considered a significantly antiquated iteration, this feature may no longer be pertinent. Should you find yourself in need of this functionality, please direct your feedback to youweics@qq.com, and we shall deliberate on its implementation based on demand.","publisher.picbed.service":"Image Hosting Service","publisher.picbed.none":"Not in use","publisher.picbed.picgo":"PicGo Plugin","publisher.picbed.picgo.not.install":"PicGo plugin not detected. You may proceed to the plugin store for installation before enabling it.","publisher.picbed.bundled":"Current Platform","publisher.picbed.recom1":"Strongly Recommended","publisher.picbed.recom2":"Recommended","publisher.post.status":"Article Status","publisher.post.status.publish":"Published","publisher.post.status.draft":"Draft","publisher.post.status.private":"Private","publisher.post.status.future":"Scheduled","publisher.post.password":"Password Protection","publisher.post.password.tip":"Please enter the password for the article; leave blank if not setting one","publisher.post.future":"Scheduled Publishing"},Jn=fl({legacy:!1,locale:"zh_CN",fallbackLocale:"en_US",messages:{zh_CN:ob,en_US:ab}}),nb={mounted(c,o){const t=Fl.service({lock:!0,text:o.value.loadText}),s={log:o.value.log||Rt,checkOrigin:o.value.checkOrigin||!1,iframeResizerEnable:o.value.iframeResizerEnable||!0,autoResize:o.value.autoResize||!1,warningTimeout:o.value.warningTimeout||3e4};c.addEventListener("load",()=>{_n(()=>{const e=we.max([document.body.offsetWidth,document.body.scrollWidth,document.documentElement.offsetWidth,document.documentElement.scrollWidth]);c.style.height=e+"px",tr(s,c)})}),c.onload=function(){t.close()}},unmounted(c){const o=c;o.iFrameResizer&&o.iFrameResizer.removeListeners()}},ib=async c=>{const o=ml(xr);o.use(Jn);const t=Ul();o.use(t);const s=sb();return o.use(s),o.directive("resize",nb),{i18n:Jn,router:s,app:o}};(async()=>(await ib()).app.mount("#app"))();
