import{r as R}from"./chunk.vendor_bn-js.js";import{r as _}from"./chunk.vendor_brorand.js";var l,w;function y(){if(w)return l;w=1;var d=R(),g=_();function f(u){this.rand=u||new g.Rand}return l=f,f.create=function(r){return new f(r)},f.prototype._randbelow=function(r){var e=r.bitLength(),o=Math.ceil(e/8);do var i=new d(this.rand.generate(o));while(i.cmp(r)>=0);return i},f.prototype._randrange=function(r,e){var o=e.sub(r);return r.add(this._randbelow(o))},f.prototype.test=function(r,e,o){var i=r.bitLength(),c=d.mont(r),m=new d(1).toRed(c);e||(e=Math.max(1,i/48|0));for(var a=r.subn(1),v=0;!a.testn(v);v++);for(var s=r.shrn(v),p=a.toRed(c),b=!0;e>0;e--){var n=this._randrange(new d(2),a);o&&o(n);var t=n.toRed(c).redPow(s);if(!(t.cmp(m)===0||t.cmp(p)===0)){for(var h=1;h<v;h++){if(t=t.redSqr(),t.cmp(m)===0)return!1;if(t.cmp(p)===0)break}if(h===v)return!1}}return b},f.prototype.getDivisor=function(r,e){var o=r.bitLength(),i=d.mont(r),c=new d(1).toRed(i);e||(e=Math.max(1,o/48|0));for(var m=r.subn(1),a=0;!m.testn(a);a++);for(var v=r.shrn(a),s=m.toRed(i);e>0;e--){var p=this._randrange(new d(2),m),b=r.gcd(p);if(b.cmpn(1)!==0)return b;var n=p.toRed(i).redPow(v);if(!(n.cmp(c)===0||n.cmp(s)===0)){for(var t=1;t<a;t++){if(n=n.redSqr(),n.cmp(c)===0)return n.fromRed().subn(1).gcd(r);if(n.cmp(s)===0)break}if(t===a)return n=n.redSqr(),n.fromRed().subn(1).gcd(r)}}return!1},l}export{y as r};
