import{B as s}from"./chunk.vendor_vite-plugin-node-polyfills.js";import{r as h}from"./chunk.vendor_elliptic.js";import{r as v}from"./chunk.vendor_bn-js.js";var y,o;function P(){if(o)return y;o=1;var c=h(),f=v();y=function(t){return new u(t)};var i={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};i.p224=i.secp224r1,i.p256=i.secp256r1=i.prime256v1,i.p192=i.secp192r1=i.prime192v1,i.p384=i.secp384r1,i.p521=i.secp521r1;function u(e){this.curveType=i[e],this.curveType||(this.curveType={name:e}),this.curve=new c.ec(this.curveType.name),this.keys=void 0}u.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},u.prototype.computeSecret=function(e,t,r){t=t||"utf8",s.isBuffer(e)||(e=new s(e,t));var n=this.curve.keyFromPublic(e).getPublic(),p=n.mul(this.keys.getPrivate()).getX();return a(p,r,this.curveType.byteLength)},u.prototype.getPublicKey=function(e,t){var r=this.keys.getPublic(t==="compressed",!0);return t==="hybrid"&&(r[r.length-1]%2?r[0]=7:r[0]=6),a(r,e)},u.prototype.getPrivateKey=function(e){return a(this.keys.getPrivate(),e)},u.prototype.setPublicKey=function(e,t){return t=t||"utf8",s.isBuffer(e)||(e=new s(e,t)),this.keys._importPublic(e),this},u.prototype.setPrivateKey=function(e,t){t=t||"utf8",s.isBuffer(e)||(e=new s(e,t));var r=new f(e);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this};function a(e,t,r){Array.isArray(e)||(e=e.toArray());var n=new s(e);if(r&&n.length<r){var p=new s(r-n.length);p.fill(0),n=s.concat([p,n])}return t?n.toString(t):n}return y}export{P as r};
