import{r as $}from"./chunk.vendor_parse-asn1.js";import{r as C}from"./chunk.vendor_randombytes.js";import{r as R}from"./chunk.vendor_create-hash.js";import{r as y}from"./chunk.vendor_safe-buffer.js";import{r as H}from"./chunk.vendor_bn-js.js";import{r as z}from"./chunk.vendor_browserify-rsa.js";var b={},q,M;function I(){if(M)return q;M=1;var l=R(),u=y().Buffer;q=function(f,c){for(var d=u.alloc(0),m=0,p;d.length<c;)p=v(m++),d=u.concat([d,l("sha1").update(f).update(p).digest()]);return d.slice(0,c)};function v(f){var c=u.allocUnsafe(4);return c.writeUInt32BE(f,0),c}return q}var k,N;function Z(){return N||(N=1,k=function(u,v){for(var f=u.length,c=-1;++c<f;)u[c]^=v[c];return u}),k}var P,U;function _(){if(U)return P;U=1;var l=H(),u=y().Buffer;function v(f,c){return u.from(f.toRed(l.mont(c.modulus)).redPow(new l(c.publicExponent)).fromRed().toArray())}return P=v,P}var D,A;function F(){if(A)return D;A=1;var l=$(),u=C(),v=R(),f=I(),c=Z(),d=H(),m=_(),p=z(),s=y().Buffer;D=function(i,n,r){var e;i.padding?e=i.padding:r?e=1:e=4;var a=l(i),o;if(e===4)o=B(a,n);else if(e===1)o=E(a,n,r);else if(e===3){if(o=new d(n),o.cmp(a.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return r?p(o,a):m(o,a)};function B(t,i){var n=t.modulus.byteLength(),r=i.length,e=v("sha1").update(s.alloc(0)).digest(),a=e.length,o=2*a;if(r>n-o-2)throw new Error("message too long");var w=s.alloc(n-r-o-2),g=n-a-1,S=u(a),x=c(s.concat([e,w,s.alloc(1,1),i],g),f(S,g)),j=c(S,f(x,a));return new d(s.concat([s.alloc(1),j,x],n))}function E(t,i,n){var r=i.length,e=t.modulus.byteLength();if(r>e-11)throw new Error("message too long");var a;return n?a=s.alloc(e-r-3,255):a=h(e-r-3),new d(s.concat([s.from([0,n?1:2]),a,s.alloc(1),i],e))}function h(t){for(var i=s.allocUnsafe(t),n=0,r=u(t*2),e=0,a;n<t;)e===r.length&&(r=u(t*2),e=0),a=r[e++],a&&(i[n++]=a);return i}return D}var L,W;function G(){if(W)return L;W=1;var l=$(),u=I(),v=Z(),f=H(),c=z(),d=R(),m=_(),p=y().Buffer;L=function(t,i,n){var r;t.padding?r=t.padding:n?r=1:r=4;var e=l(t),a=e.modulus.byteLength();if(i.length>a||new f(i).cmp(e.modulus)>=0)throw new Error("decryption error");var o;n?o=m(new f(i),e):o=c(i,e);var w=p.alloc(a-o.length);if(o=p.concat([w,o],a),r===4)return s(e,o);if(r===1)return B(e,o,n);if(r===3)return o;throw new Error("unknown padding")};function s(h,t){var i=h.modulus.byteLength(),n=d("sha1").update(p.alloc(0)).digest(),r=n.length;if(t[0]!==0)throw new Error("decryption error");var e=t.slice(1,r+1),a=t.slice(r+1),o=v(e,u(a,r)),w=v(a,u(o,i-r-1));if(E(n,w.slice(0,r)))throw new Error("decryption error");for(var g=r;w[g]===0;)g++;if(w[g++]!==1)throw new Error("decryption error");return w.slice(g)}function B(h,t,i){for(var n=t.slice(0,2),r=2,e=0;t[r++]!==0;)if(r>=t.length){e++;break}var a=t.slice(2,r-1);if((n.toString("hex")!=="0002"&&!i||n.toString("hex")!=="0001"&&i)&&e++,a.length<8&&e++,e)throw new Error("decryption error");return t.slice(r)}function E(h,t){h=p.from(h),t=p.from(t);var i=0,n=h.length;h.length!==t.length&&(i++,n=Math.min(h.length,t.length));for(var r=-1;++r<n;)i+=h[r]^t[r];return i}return L}var X;function K(){return X||(X=1,function(l){l.publicEncrypt=F(),l.privateDecrypt=G(),l.privateEncrypt=function(v,f){return l.publicEncrypt(v,f,!0)},l.publicDecrypt=function(v,f){return l.privateDecrypt(v,f,!0)}}(b)),b}export{K as r};
