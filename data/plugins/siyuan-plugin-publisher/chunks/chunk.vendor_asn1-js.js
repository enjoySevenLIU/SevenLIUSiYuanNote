import{r as ae}from"./chunk.vendor_bn-js.js";import{r as S}from"./chunk.vendor_inherits.js";import{r as $}from"./chunk.vendor_vite-plugin-node-polyfills.js";import{r as ce}from"./chunk.vendor_minimalistic-assert.js";import{r as ue}from"./chunk.vendor_vm-browserify.js";var we=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function je(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}function Be(h){if(h.__esModule)return h;var u=h.default;if(typeof u=="function"){var p=function l(){return this instanceof l?Reflect.construct(u,arguments,this.constructor):u.apply(this,arguments)};p.prototype=u.prototype}else p={};return Object.defineProperty(p,"__esModule",{value:!0}),Object.keys(h).forEach(function(l){var d=Object.getOwnPropertyDescriptor(h,l);Object.defineProperty(p,l,d.get?d:{enumerable:!0,get:function(){return h[l]}})}),p}var x={},D={},M;function fe(){return M||(M=1,function(h){var u=K(),p=S(),l=h;l.define=function(o,a){return new d(o,a)};function d(c,o){this.name=c,this.body=o,this.decoders={},this.encoders={}}d.prototype._createNamed=function(o){var a;try{a=ue().runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{a=function(i){this._initNamed(i)}}return p(a,o),a.prototype._initNamed=function(i){o.call(this,i)},new a(this)},d.prototype._getDecoder=function(o){return o=o||"der",this.decoders.hasOwnProperty(o)||(this.decoders[o]=this._createNamed(u.decoders[o])),this.decoders[o]},d.prototype.decode=function(o,a,y){return this._getDecoder(a).decode(o,y)},d.prototype._getEncoder=function(o){return o=o||"der",this.encoders.hasOwnProperty(o)||(this.encoders[o]=this._createNamed(u.encoders[o])),this.encoders[o]},d.prototype.encode=function(o,a,y){return this._getEncoder(a).encode(o,y)}}(D)),D}var k={},q={},F;function le(){if(F)return q;F=1;var h=S();function u(l){this._reporterState={obj:null,path:[],options:l||{},errors:[]}}q.Reporter=u,u.prototype.isError=function(d){return d instanceof p},u.prototype.save=function(){var d=this._reporterState;return{obj:d.obj,pathLen:d.path.length}},u.prototype.restore=function(d){var c=this._reporterState;c.obj=d.obj,c.path=c.path.slice(0,d.pathLen)},u.prototype.enterKey=function(d){return this._reporterState.path.push(d)},u.prototype.exitKey=function(d){var c=this._reporterState;c.path=c.path.slice(0,d-1)},u.prototype.leaveKey=function(d,c,o){var a=this._reporterState;this.exitKey(d),a.obj!==null&&(a.obj[c]=o)},u.prototype.path=function(){return this._reporterState.path.join("/")},u.prototype.enterObject=function(){var d=this._reporterState,c=d.obj;return d.obj={},c},u.prototype.leaveObject=function(d){var c=this._reporterState,o=c.obj;return c.obj=d,o},u.prototype.error=function(d){var c,o=this._reporterState,a=d instanceof p;if(a?c=d:c=new p(o.path.map(function(y){return"["+JSON.stringify(y)+"]"}).join(""),d.message||d,d.stack),!o.options.partial)throw c;return a||o.errors.push(c),c},u.prototype.wrapResult=function(d){var c=this._reporterState;return c.options.partial?{result:this.isError(d)?null:d,errors:c.errors}:d};function p(l,d){this.path=l,this.rethrow(d)}return h(p,Error),p.prototype.rethrow=function(d){if(this.message=d+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,p),!this.stack)try{throw new Error(this.message)}catch(c){this.stack=c.stack}return this},q}var j={},G;function L(){if(G)return j;G=1;var h=S(),u=w().Reporter,p=$.Buffer;function l(c,o){if(u.call(this,o),!p.isBuffer(c)){this.error("Input not Buffer");return}this.base=c,this.offset=0,this.length=c.length}h(l,u),j.DecoderBuffer=l,l.prototype.save=function(){return{offset:this.offset,reporter:u.prototype.save.call(this)}},l.prototype.restore=function(o){var a=new l(this.base);return a.offset=o.offset,a.length=this.offset,this.offset=o.offset,u.prototype.restore.call(this,o.reporter),a},l.prototype.isEmpty=function(){return this.offset===this.length},l.prototype.readUInt8=function(o){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(o||"DecoderBuffer overrun")},l.prototype.skip=function(o,a){if(!(this.offset+o<=this.length))return this.error(a||"DecoderBuffer overrun");var y=new l(this.base);return y._reporterState=this._reporterState,y.offset=this.offset,y.length=this.offset+o,this.offset+=o,y},l.prototype.raw=function(o){return this.base.slice(o?o.offset:this.offset,this.length)};function d(c,o){if(Array.isArray(c))this.length=0,this.value=c.map(function(a){return a instanceof d||(a=new d(a,o)),this.length+=a.length,a},this);else if(typeof c=="number"){if(!(0<=c&&c<=255))return o.error("non-byte EncoderBuffer value");this.value=c,this.length=1}else if(typeof c=="string")this.value=c,this.length=p.byteLength(c);else if(p.isBuffer(c))this.value=c,this.length=c.length;else return o.error("Unsupported type: "+typeof c)}return j.EncoderBuffer=d,d.prototype.join=function(o,a){return o||(o=new p(this.length)),a||(a=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(y){y.join(o,a),a+=y.length}):(typeof this.value=="number"?o[a]=this.value:typeof this.value=="string"?o.write(this.value,a):p.isBuffer(this.value)&&this.value.copy(o,a),a+=this.length)),o},j}var N,z;function de(){if(z)return N;z=1;var h=w().Reporter,u=w().EncoderBuffer,p=w().DecoderBuffer,l=ce(),d=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(d),o=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function a(i,e){var r={};this._baseState=r,r.enc=i,r.parent=e||null,r.children=null,r.tag=null,r.args=null,r.reverseArgs=null,r.choice=null,r.optional=!1,r.any=!1,r.obj=!1,r.use=null,r.useDecoder=null,r.key=null,r.default=null,r.explicit=null,r.implicit=null,r.contains=null,r.parent||(r.children=[],this._wrap())}N=a;var y=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return a.prototype.clone=function(){var e=this._baseState,r={};y.forEach(function(t){r[t]=e[t]});var n=new this.constructor(r.parent);return n._baseState=r,n},a.prototype._wrap=function(){var e=this._baseState;c.forEach(function(r){this[r]=function(){var t=new this.constructor(this);return e.children.push(t),t[r].apply(t,arguments)}},this)},a.prototype._init=function(e){var r=this._baseState;l(r.parent===null),e.call(this),r.children=r.children.filter(function(n){return n._baseState.parent===this},this),l.equal(r.children.length,1,"Root node can have only one child")},a.prototype._useArgs=function(e){var r=this._baseState,n=e.filter(function(t){return t instanceof this.constructor},this);e=e.filter(function(t){return!(t instanceof this.constructor)},this),n.length!==0&&(l(r.children===null),r.children=n,n.forEach(function(t){t._baseState.parent=this},this)),e.length!==0&&(l(r.args===null),r.args=e,r.reverseArgs=e.map(function(t){if(typeof t!="object"||t.constructor!==Object)return t;var s={};return Object.keys(t).forEach(function(f){f==(f|0)&&(f|=0);var v=t[f];s[v]=f}),s}))},o.forEach(function(i){a.prototype[i]=function(){var r=this._baseState;throw new Error(i+" not implemented for encoding: "+r.enc)}}),d.forEach(function(i){a.prototype[i]=function(){var r=this._baseState,n=Array.prototype.slice.call(arguments);return l(r.tag===null),r.tag=i,this._useArgs(n),this}}),a.prototype.use=function(e){l(e);var r=this._baseState;return l(r.use===null),r.use=e,this},a.prototype.optional=function(){var e=this._baseState;return e.optional=!0,this},a.prototype.def=function(e){var r=this._baseState;return l(r.default===null),r.default=e,r.optional=!0,this},a.prototype.explicit=function(e){var r=this._baseState;return l(r.explicit===null&&r.implicit===null),r.explicit=e,this},a.prototype.implicit=function(e){var r=this._baseState;return l(r.explicit===null&&r.implicit===null),r.implicit=e,this},a.prototype.obj=function(){var e=this._baseState,r=Array.prototype.slice.call(arguments);return e.obj=!0,r.length!==0&&this._useArgs(r),this},a.prototype.key=function(e){var r=this._baseState;return l(r.key===null),r.key=e,this},a.prototype.any=function(){var e=this._baseState;return e.any=!0,this},a.prototype.choice=function(e){var r=this._baseState;return l(r.choice===null),r.choice=e,this._useArgs(Object.keys(e).map(function(n){return e[n]})),this},a.prototype.contains=function(e){var r=this._baseState;return l(r.use===null),r.contains=e,this},a.prototype._decode=function(e,r){var n=this._baseState;if(n.parent===null)return e.wrapResult(n.children[0]._decode(e,r));var t=n.default,s=!0,f=null;if(n.key!==null&&(f=e.enterKey(n.key)),n.optional){var v=null;if(n.explicit!==null?v=n.explicit:n.implicit!==null?v=n.implicit:n.tag!==null&&(v=n.tag),v===null&&!n.any){var _=e.save();try{n.choice===null?this._decodeGeneric(n.tag,e,r):this._decodeChoice(e,r),s=!0}catch{s=!1}e.restore(_)}else if(s=this._peekTag(e,v,n.any),e.isError(s))return s}var g;if(n.obj&&s&&(g=e.enterObject()),s){if(n.explicit!==null){var b=this._decodeTag(e,n.explicit);if(e.isError(b))return b;e=b}var m=e.offset;if(n.use===null&&n.choice===null){if(n.any)var _=e.save();var E=this._decodeTag(e,n.implicit!==null?n.implicit:n.tag,n.any);if(e.isError(E))return E;n.any?t=e.raw(_):e=E}if(r&&r.track&&n.tag!==null&&r.track(e.path(),m,e.length,"tagged"),r&&r.track&&n.tag!==null&&r.track(e.path(),e.offset,e.length,"content"),n.any?t=t:n.choice===null?t=this._decodeGeneric(n.tag,e,r):t=this._decodeChoice(e,r),e.isError(t))return t;if(!n.any&&n.choice===null&&n.children!==null&&n.children.forEach(function(se){se._decode(e,r)}),n.contains&&(n.tag==="octstr"||n.tag==="bitstr")){var B=new p(t);t=this._getUse(n.contains,e._reporterState.obj)._decode(B,r)}}return n.obj&&s&&(t=e.leaveObject(g)),n.key!==null&&(t!==null||s===!0)?e.leaveKey(f,n.key,t):f!==null&&e.exitKey(f),t},a.prototype._decodeGeneric=function(e,r,n){var t=this._baseState;return e==="seq"||e==="set"?null:e==="seqof"||e==="setof"?this._decodeList(r,e,t.args[0],n):/str$/.test(e)?this._decodeStr(r,e,n):e==="objid"&&t.args?this._decodeObjid(r,t.args[0],t.args[1],n):e==="objid"?this._decodeObjid(r,null,null,n):e==="gentime"||e==="utctime"?this._decodeTime(r,e,n):e==="null_"?this._decodeNull(r,n):e==="bool"?this._decodeBool(r,n):e==="objDesc"?this._decodeStr(r,e,n):e==="int"||e==="enum"?this._decodeInt(r,t.args&&t.args[0],n):t.use!==null?this._getUse(t.use,r._reporterState.obj)._decode(r,n):r.error("unknown tag: "+e)},a.prototype._getUse=function(e,r){var n=this._baseState;return n.useDecoder=this._use(e,r),l(n.useDecoder._baseState.parent===null),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},a.prototype._decodeChoice=function(e,r){var n=this._baseState,t=null,s=!1;return Object.keys(n.choice).some(function(f){var v=e.save(),_=n.choice[f];try{var g=_._decode(e,r);if(e.isError(g))return!1;t={type:f,value:g},s=!0}catch{return e.restore(v),!1}return!0},this),s?t:e.error("Choice not matched")},a.prototype._createEncoderBuffer=function(e){return new u(e,this.reporter)},a.prototype._encode=function(e,r,n){var t=this._baseState;if(!(t.default!==null&&t.default===e)){var s=this._encodeValue(e,r,n);if(s!==void 0&&!this._skipDefault(s,r,n))return s}},a.prototype._encodeValue=function(e,r,n){var t=this._baseState;if(t.parent===null)return t.children[0]._encode(e,r||new h);var _=null;if(this.reporter=r,t.optional&&e===void 0)if(t.default!==null)e=t.default;else return;var s=null,f=!1;if(t.any)_=this._createEncoderBuffer(e);else if(t.choice)_=this._encodeChoice(e,r);else if(t.contains)s=this._getUse(t.contains,n)._encode(e,r),f=!0;else if(t.children)s=t.children.map(function(m){if(m._baseState.tag==="null_")return m._encode(null,r,e);if(m._baseState.key===null)return r.error("Child should have a key");var E=r.enterKey(m._baseState.key);if(typeof e!="object")return r.error("Child expected, but input is not object");var B=m._encode(e[m._baseState.key],r,e);return r.leaveKey(E),B},this).filter(function(m){return m}),s=this._createEncoderBuffer(s);else if(t.tag==="seqof"||t.tag==="setof"){if(!(t.args&&t.args.length===1))return r.error("Too many args for : "+t.tag);if(!Array.isArray(e))return r.error("seqof/setof, but data is not Array");var v=this.clone();v._baseState.implicit=null,s=this._createEncoderBuffer(e.map(function(m){var E=this._baseState;return this._getUse(E.args[0],e)._encode(m,r)},v))}else t.use!==null?_=this._getUse(t.use,n)._encode(e,r):(s=this._encodePrimitive(t.tag,e),f=!0);var _;if(!t.any&&t.choice===null){var g=t.implicit!==null?t.implicit:t.tag,b=t.implicit===null?"universal":"context";g===null?t.use===null&&r.error("Tag could be omitted only for .use()"):t.use===null&&(_=this._encodeComposite(g,f,b,s))}return t.explicit!==null&&(_=this._encodeComposite(t.explicit,!1,"context",_)),_},a.prototype._encodeChoice=function(e,r){var n=this._baseState,t=n.choice[e.type];return t||l(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),t._encode(e.value,r)},a.prototype._encodePrimitive=function(e,r){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(r,e);if(e==="objid"&&n.args)return this._encodeObjid(r,n.reverseArgs[0],n.args[1]);if(e==="objid")return this._encodeObjid(r,null,null);if(e==="gentime"||e==="utctime")return this._encodeTime(r,e);if(e==="null_")return this._encodeNull();if(e==="int"||e==="enum")return this._encodeInt(r,n.args&&n.reverseArgs[0]);if(e==="bool")return this._encodeBool(r);if(e==="objDesc")return this._encodeStr(r,e);throw new Error("Unsupported tag: "+e)},a.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},a.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)},N}var V;function w(){return V||(V=1,function(h){var u=h;u.Reporter=le().Reporter,u.DecoderBuffer=L().DecoderBuffer,u.EncoderBuffer=L().EncoderBuffer,u.Node=de()}(k)),k}var O={},T={},J;function he(){return J||(J=1,function(h){var u=te();h.tagClass={0:"universal",1:"application",2:"context",3:"private"},h.tagClassByName=u._reverse(h.tagClass),h.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},h.tagByName=u._reverse(h.tag)}(T)),T}var Z;function te(){return Z||(Z=1,function(h){var u=h;u._reverse=function(l){var d={};return Object.keys(l).forEach(function(c){(c|0)==c&&(c=c|0);var o=l[c];d[o]=c}),d},u.der=he()}(O)),O}var C={},U,H;function ne(){if(H)return U;H=1;var h=S(),u=K(),p=u.base,l=u.bignum,d=u.constants.der;function c(i){this.enc="der",this.name=i.name,this.entity=i,this.tree=new o,this.tree._init(i.body)}U=c,c.prototype.decode=function(e,r){return e instanceof p.DecoderBuffer||(e=new p.DecoderBuffer(e,r)),this.tree._decode(e,r)};function o(i){p.Node.call(this,"der",i)}h(o,p.Node),o.prototype._peekTag=function(e,r,n){if(e.isEmpty())return!1;var t=e.save(),s=a(e,'Failed to peek tag: "'+r+'"');return e.isError(s)?s:(e.restore(t),s.tag===r||s.tagStr===r||s.tagStr+"of"===r||n)},o.prototype._decodeTag=function(e,r,n){var t=a(e,'Failed to decode tag of "'+r+'"');if(e.isError(t))return t;var s=y(e,t.primitive,'Failed to get length of "'+r+'"');if(e.isError(s))return s;if(!n&&t.tag!==r&&t.tagStr!==r&&t.tagStr+"of"!==r)return e.error('Failed to match tag: "'+r+'"');if(t.primitive||s!==null)return e.skip(s,'Failed to match body of: "'+r+'"');var f=e.save(),v=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(v)?v:(s=e.offset-f.offset,e.restore(f),e.skip(s,'Failed to match body of: "'+r+'"'))},o.prototype._skipUntilEnd=function(e,r){for(;;){var n=a(e,r);if(e.isError(n))return n;var t=y(e,n.primitive,r);if(e.isError(t))return t;var s;if(n.primitive||t!==null?s=e.skip(t):s=this._skipUntilEnd(e,r),e.isError(s))return s;if(n.tagStr==="end")break}},o.prototype._decodeList=function(e,r,n,t){for(var s=[];!e.isEmpty();){var f=this._peekTag(e,"end");if(e.isError(f))return f;var v=n.decode(e,"der",t);if(e.isError(v)&&f)break;s.push(v)}return s},o.prototype._decodeStr=function(e,r){if(r==="bitstr"){var n=e.readUInt8();return e.isError(n)?n:{unused:n,data:e.raw()}}else if(r==="bmpstr"){var t=e.raw();if(t.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");for(var s="",f=0;f<t.length/2;f++)s+=String.fromCharCode(t.readUInt16BE(f*2));return s}else if(r==="numstr"){var v=e.raw().toString("ascii");return this._isNumstr(v)?v:e.error("Decoding of string type: numstr unsupported characters")}else{if(r==="octstr")return e.raw();if(r==="objDesc")return e.raw();if(r==="printstr"){var _=e.raw().toString("ascii");return this._isPrintstr(_)?_:e.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(r)?e.raw().toString():e.error("Decoding of string type: "+r+" unsupported")}},o.prototype._decodeObjid=function(e,r,n){for(var t,s=[],f=0;!e.isEmpty();){var v=e.readUInt8();f<<=7,f|=v&127,v&128||(s.push(f),f=0)}v&128&&s.push(f);var _=s[0]/40|0,g=s[0]%40;if(n?t=s:t=[_,g].concat(s.slice(1)),r){var b=r[t.join(" ")];b===void 0&&(b=r[t.join(".")]),b!==void 0&&(t=b)}return t},o.prototype._decodeTime=function(e,r){var n=e.raw().toString();if(r==="gentime")var t=n.slice(0,4)|0,s=n.slice(4,6)|0,f=n.slice(6,8)|0,v=n.slice(8,10)|0,_=n.slice(10,12)|0,g=n.slice(12,14)|0;else if(r==="utctime"){var t=n.slice(0,2)|0,s=n.slice(2,4)|0,f=n.slice(4,6)|0,v=n.slice(6,8)|0,_=n.slice(8,10)|0,g=n.slice(10,12)|0;t<70?t=2e3+t:t=1900+t}else return e.error("Decoding "+r+" time is not supported yet");return Date.UTC(t,s-1,f,v,_,g,0)},o.prototype._decodeNull=function(e){return null},o.prototype._decodeBool=function(e){var r=e.readUInt8();return e.isError(r)?r:r!==0},o.prototype._decodeInt=function(e,r){var n=e.raw(),t=new l(n);return r&&(t=r[t.toString(10)]||t),t},o.prototype._use=function(e,r){return typeof e=="function"&&(e=e(r)),e._getDecoder("der").tree};function a(i,e){var r=i.readUInt8(e);if(i.isError(r))return r;var n=d.tagClass[r>>6],t=(r&32)===0;if((r&31)===31){var s=r;for(r=0;(s&128)===128;){if(s=i.readUInt8(e),i.isError(s))return s;r<<=7,r|=s&127}}else r&=31;var f=d.tag[r];return{cls:n,primitive:t,tag:r,tagStr:f}}function y(i,e,r){var n=i.readUInt8(r);if(i.isError(n))return n;if(!e&&n===128)return null;if(!(n&128))return n;var t=n&127;if(t>4)return i.error("length octect is too long");n=0;for(var s=0;s<t;s++){n<<=8;var f=i.readUInt8(r);if(i.isError(f))return f;n|=f}return n}return U}var R,Y;function pe(){if(Y)return R;Y=1;var h=S(),u=$.Buffer,p=ne();function l(d){p.call(this,d),this.enc="pem"}return h(l,p),R=l,l.prototype.decode=function(c,o){for(var a=c.toString().split(/[\r\n]+/g),y=o.label.toUpperCase(),i=/^-----(BEGIN|END) ([^-]+)-----$/,e=-1,r=-1,n=0;n<a.length;n++){var t=a[n].match(i);if(t!==null&&t[2]===y)if(e===-1){if(t[1]!=="BEGIN")break;e=n}else{if(t[1]!=="END")break;r=n;break}}if(e===-1||r===-1)throw new Error("PEM section not found for: "+y);var s=a.slice(e+1,r).join("");s.replace(/[^a-z0-9\+\/=]+/gi,"");var f=new u(s,"base64");return p.prototype.decode.call(this,f,o)},R}var Q;function ve(){return Q||(Q=1,function(h){var u=h;u.der=ne(),u.pem=pe()}(C)),C}var A={},I,W;function ie(){if(W)return I;W=1;var h=S(),u=$.Buffer,p=K(),l=p.base,d=p.constants.der;function c(i){this.enc="der",this.name=i.name,this.entity=i,this.tree=new o,this.tree._init(i.body)}I=c,c.prototype.encode=function(e,r){return this.tree._encode(e,r).join()};function o(i){l.Node.call(this,"der",i)}h(o,l.Node),o.prototype._encodeComposite=function(e,r,n,t){var s=y(e,r,n,this.reporter);if(t.length<128){var _=new u(2);return _[0]=s,_[1]=t.length,this._createEncoderBuffer([_,t])}for(var f=1,v=t.length;v>=256;v>>=8)f++;var _=new u(2+f);_[0]=s,_[1]=128|f;for(var v=1+f,g=t.length;g>0;v--,g>>=8)_[v]=g&255;return this._createEncoderBuffer([_,t])},o.prototype._encodeStr=function(e,r){if(r==="bitstr")return this._createEncoderBuffer([e.unused|0,e.data]);if(r==="bmpstr"){for(var n=new u(e.length*2),t=0;t<e.length;t++)n.writeUInt16BE(e.charCodeAt(t),t*2);return this._createEncoderBuffer(n)}else return r==="numstr"?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):r==="printstr"?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(r)?this._createEncoderBuffer(e):r==="objDesc"?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+r+" unsupported")},o.prototype._encodeObjid=function(e,r,n){if(typeof e=="string"){if(!r)return this.reporter.error("string objid given, but no values map found");if(!r.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=r[e].split(/[\s\.]+/g);for(var t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(var t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,e[0]*40+e[1])}for(var s=0,t=0;t<e.length;t++){var f=e[t];for(s++;f>=128;f>>=7)s++}for(var v=new u(s),_=v.length-1,t=e.length-1;t>=0;t--){var f=e[t];for(v[_--]=f&127;(f>>=7)>0;)v[_--]=128|f&127}return this._createEncoderBuffer(v)};function a(i){return i<10?"0"+i:i}o.prototype._encodeTime=function(e,r){var n,t=new Date(e);return r==="gentime"?n=[a(t.getFullYear()),a(t.getUTCMonth()+1),a(t.getUTCDate()),a(t.getUTCHours()),a(t.getUTCMinutes()),a(t.getUTCSeconds()),"Z"].join(""):r==="utctime"?n=[a(t.getFullYear()%100),a(t.getUTCMonth()+1),a(t.getUTCDate()),a(t.getUTCHours()),a(t.getUTCMinutes()),a(t.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+r+" time is not supported yet"),this._encodeStr(n,"octstr")},o.prototype._encodeNull=function(){return this._createEncoderBuffer("")},o.prototype._encodeInt=function(e,r){if(typeof e=="string"){if(!r)return this.reporter.error("String int or enum given, but no values map");if(!r.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=r[e]}if(typeof e!="number"&&!u.isBuffer(e)){var n=e.toArray();!e.sign&&n[0]&128&&n.unshift(0),e=new u(n)}if(u.isBuffer(e)){var t=e.length;e.length===0&&t++;var f=new u(t);return e.copy(f),e.length===0&&(f[0]=0),this._createEncoderBuffer(f)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var t=1,s=e;s>=256;s>>=8)t++;for(var f=new Array(t),s=f.length-1;s>=0;s--)f[s]=e&255,e>>=8;return f[0]&128&&f.unshift(0),this._createEncoderBuffer(new u(f))},o.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},o.prototype._use=function(e,r){return typeof e=="function"&&(e=e(r)),e._getEncoder("der").tree},o.prototype._skipDefault=function(e,r,n){var t=this._baseState,s;if(t.default===null)return!1;var f=e.join();if(t.defaultBuffer===void 0&&(t.defaultBuffer=this._encodeValue(t.default,r,n).join()),f.length!==t.defaultBuffer.length)return!1;for(s=0;s<f.length;s++)if(f[s]!==t.defaultBuffer[s])return!1;return!0};function y(i,e,r,n){var t;if(i==="seqof"?i="seq":i==="setof"&&(i="set"),d.tagByName.hasOwnProperty(i))t=d.tagByName[i];else if(typeof i=="number"&&(i|0)===i)t=i;else return n.error("Unknown tag: "+i);return t>=31?n.error("Multi-octet tag encoding unsupported"):(e||(t|=32),t|=d.tagClassByName[r||"universal"]<<6,t)}return I}var P,X;function _e(){if(X)return P;X=1;var h=S(),u=ie();function p(l){u.call(this,l),this.enc="pem"}return h(p,u),P=p,p.prototype.encode=function(d,c){for(var o=u.prototype.encode.call(this,d),a=o.toString("base64"),y=["-----BEGIN "+c.label+"-----"],i=0;i<a.length;i+=64)y.push(a.slice(i,i+64));return y.push("-----END "+c.label+"-----"),y.join(`
`)},P}var ee;function ye(){return ee||(ee=1,function(h){var u=h;u.der=ie(),u.pem=_e()}(A)),A}var re;function K(){return re||(re=1,function(h){var u=h;u.bignum=ae(),u.define=fe().define,u.base=w(),u.constants=te(),u.decoders=ve(),u.encoders=ye()}(x)),x}export{Be as a,we as c,je as g,K as r};
